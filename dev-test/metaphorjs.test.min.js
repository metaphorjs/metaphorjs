(function(){function B(l){return"function"==typeof l}function w(l){return"string"===typeof l||l===""+l}function I(l){return"object"===typeof l&&5===ha(l)}function J(){}function X(l){if(l&&void 0!=!l.length&&l!==""+l){for(var g=[],c=-1,a=l.length>>>0;++c!==a;g[c]=l[c]);return g}return l?[l]:[]}function ia(l){return"object"==typeof l&&3===ha(l)&&!l.nodeType&&l.constructor===Object}function sa(l){return!0===l||!1===l}function q(){var l=!1,g=!1,c=X(arguments),a=c.shift(),b,e,d;sa(c[c.length-1])&&(l=c.pop());
sa(c[c.length-1])&&(g=l,l=c.pop());for(;c.length;)if(b=c.shift())for(e in b)if(b.hasOwnProperty(e)&&void 0!==(d=b[e]))if(g)if(a[e]&&ia(a[e])&&ia(d))q(a[e],d,l,g);else{if(!0===l||void 0==a[e])ia(d)?(a[e]={},q(a[e],d,l,!0)):a[e]=d}else if(!0===l||void 0==a[e])a[e]=d;return a}function rb(l){return"undefined"===typeof window?!1:l===window||l&&l.document&&l.location&&l.alert&&l.setInterval}function Ra(l,g){if(l===g)return!0;if(null===l||null===g)return!1;if(l!==l&&g!==g)return!0;var c=typeof l,a;if(c===
typeof g&&"object"===c)if(I(l)){if(!I(g))return!1;if((c=l.length)===g.length){for(a=0;a<c;a++)if(!Ra(l[a],g[a]))return!1;return!0}}else{if(10===ha(l))return 10===ha(g)&&l.getTime()===g.getTime();if(9===ha(l)&&9===ha(g))return l.toString()===g.toString();if(rb(l)||rb(g)||I(g))return!1;c={};for(a in l)if("$"!==a.charAt(0)&&!B(l[a])){if(!Ra(l[a],g[a]))return!1;c[a]=!0}for(a in g)if(!c.hasOwnProperty(a)&&"$"!==a.charAt(0)&&void 0!==g[a]&&!B(g[a]))return!1;return!0}return!1}function Ca(l,g){if("undefined"!=
typeof window&&l===window)throw Error("Cannot copy window object");if("undefined"!=typeof global&&l===global)throw Error("Cannot copy global object");if(g){if(l===g)throw Error("Objects are identical");if(I(l))for(var c=g.length=0,a=l.length;c<a;c++)g.push(Ca(l[c]));else{for(c in g)delete g[c];for(c in l)l.hasOwnProperty(c)&&("$"==c.charAt(0)||B(l[c])?g[c]=l[c]:g[c]=Ca(l[c]))}}else(g=l)&&(I(l)?g=Ca(l,[]):10===ha(l)?g=new Date(l.getTime()):9===ha(l)?g=new RegExp(l.source):ia(l)&&(g=Ca(l,{})));return g}
function V(l,g,c,a){return setTimeout(function(){l.apply(g,c||[])},a||0)}function La(l){if(null===l||"object"!=typeof l)return!1;l=ha(l);return 2<l||-1==l}function sb(l,g){var c=function(){};c.prototype=l.prototype;c=new c;l=l.apply(c,g);return La(l)||!1===l?l:c}function Nb(l,g,c,a,b,e){b=b||"before";return function(){if("instead"==b)return g.apply(c||a,arguments);if("before"==b){var d=g.apply(c||a,arguments);var f=!1!==d?l.apply(a||c,arguments):null}else f=l.apply(a||c,arguments),d=g.apply(c||a,
arguments);return e?d:f}}function Ob(l){return!l||"string"===typeof l&&(l=l.toLowerCase(),"false"===l||"no"===l||"0"===l)?!1:!0}function Ma(){return!1}function Sa(){return!0}function Y(l){if(!l)return!1;var g;if("object"!=(g=typeof l)&&"function"!=g)return!1;l=l.then;return B(l)?l:!1}function Ta(l){var g=Da.global(),c="regex_"+l;return g.get(c)||g.add(c,new RegExp(l))}function ab(l){return l.replace(/-./g,function(g){return g.charAt(1).toUpperCase()})}function tb(l,g){if(!l||!w(l))return null;try{var c=
new DOMParser;var a=c.parseFromString(l,g||"text/xml")}catch(b){T(b),a=void 0}if(!a||a.getElementsByTagName("parsererror").length)throw Error("Invalid XML: "+l);return a}function bb(l){l=ha(l);return 3>l&&-1<l}function ub(l,g,c){c||(c="asc");l=l.slice();if(ia(g)&&g.fn){var a=g.fn;var b=g.context}l.sort(function(e,d){if(a)return a.call(b,e,d);var c=typeof e,k=e,h=d;if(c!=typeof d)return 0;"object"===c&&(B(g)?(k=g(e),h=g(d)):(k=e[g],h=d[g]));if("number"===typeof k)return k-h;k=(""+k).toLowerCase();
h=(""+h).toLowerCase();return k===h?0:k>h?1:-1});return"desc"==c?l.reverse():l}function ra(l){return l.substr(0,1).toUpperCase()+l.substr(1)}var vb={templates:{"a*b":"<p>a * b = {{--813}}</p>","a+b":"<p>a + b = {{--816}}</p>",app1:'<h1>MetaphorJs Feature test</h1><div class="cases"><div class="case"><h4>Bindings (read only)</h4><label class="case-label">Inline</label><div id="inline-binding" class="test">{{--822}}</div><label class="case-label">mjs-bind</label><div id="binding" {bind}="--81F" class="test"></div><label class="case-label">mjs-bind-html</label><div id="html-binding" {bind-html}="--81I" class="test"></div><label class="case-label">Plain attribute (href)</label><p class="test"><a id="attr-binding-href" [href]="http://{{--822}}.com">{{--81F}}</a></p></div><div class="case"><h4>Bindings (read only)</h4><label class="case-label">Input field (value)</label><p class="test"><input id="binding-input-value" type="text" [value]="this.a"></p><label class="case-label">Input field (mjs-bind) (locked)</label><p class="test"><input id="binding-input-bind" type="text" {bind}="--81U" {bind.$locked}></p><label class="case-label">Checkbox (mjs-bind)</label><p class="test"><input id="binding-checkbox" type="checkbox" {bind}="--81Y"></p><label class="case-label">Radio (mjs-bind) (locked)</label><p class="test"><input id="radio-bind-1" checked="checked" type="radio" value="inline1" name="radio-bind" {bind}="--822" {bind.$locked}> <input id="radio-bind-2" type="radio" value="inline2" name="radio-bind"> <input id="radio-bind-3" type="radio" value="inline3" name="radio-bind"></p></div><div class="case"><h4>Bindings (read only)</h4><label class="case-label">Select (mjs-bind)</label><p class="test"><select id="select-bind" {bind}="--81U"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select></p><label class="case-label">Textarea (mjs-bind)</label><p class="test"><textarea id="textarea-bind-attr" {bind}="--822"></textarea></p><label class="case-label">Textarea (inline)</label><p class="test"><textarea id="textarea-bind-inline">{{--822}}</textarea></p></div><div class="case"><h4>Muplitple inline binding</h4><div id="multiple-inline-binding" class="test">{{--822}}<b>{{--81F}}</b>{{--81I}}</div></div><div class="case"><h4>Filters</h4><label class="case-label">Uppercase (mjs-bind)</label><div id="filter-uppercase-binding" class="test" {bind}="this.text | uppercase"></div><label class="case-label">Uppercase (inline)</label><div id="filter-uppercase-inline" class="test">{{this.text | uppercase}}</div><label class="case-label">Lowercase (inline)</label><div id="filter-lowercase-inline" class="test">{{this.text | lowercase}}</div><label class="case-label">Limit to (string)</label><div id="filter-limit-string" class="test">{{this.text | limitTo:this.a}}</div></div><div class="case"><h4>Filters</h4><label class="case-label">Linkify</label><p id="filter-linkify" class="test" {bind-html}="this.linkified | linkify"></p></div><div class="case"><h4>Expressions</h4><label class="case-label">.a + .b</label><div id="expr-a-plus-b" class="test">{{--88E}}</div><label class="case-label">.bool ? "true" : "false"</label><div id="expr-bool" class="test">{{--88F}}</div></div><div class="case"><h4>Model</h4><label class="case-label">Input (number) (.a)</label><p class="test"><input {model}="this.a" type="number" data-type="number" id="model-input-a"></p><label class="case-label">Checkbox (.bool)</label><p class="test"><input id="model-checkbox-bool" type="checkbox" {model}="this.bool"></p><label class="case-label">Radio (.inline)</label><p class="test"><input id="model-radio-1" checked="checked" type="radio" name="r" value="inline1" {model}="this.inline">1<label><input id="model-radio-2" type="radio" name="r" value="inline2">2</label><input id="model-radio-3" type="radio" name="r" value="inline3">3</p><label class="case-label">Select (.a)</label><p class="test"><select id="model-select-a" {model}="this.a" data-type="number"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select></p></div><div class="case"><h4>Model</h4><label class="case-label">Textarea (.text)</label><p class="test"><textarea id="model-textarea" {model}="this.text"></textarea></p><label class="case-label">Input (string .text)</label><p class="test"><input type="text" id="model-input" {model}="this.text"></p></div><div class="case"><h4>mjs-class</h4><label class="case-label">Plain attribute</label><div class="test"><p id="class-inline" [class]="this.inline">---</p></div><label class="case-label">mjs-class (string)</label><div class="test"><p id="class-string" {class}="--822">---</p></div><label class="case-label">mjs-class ({bool: .bool, inline1: .a == 0})</label><div class="test"><p id="class-object" {class}="--84C">---</p></div></div><div class="case"><h4>mjs-if, mjs-show, mjs-hide</h4><div id="if-bool" {if}="--81Y" class="test" {if.$animate}>this should appear if .bool = true</div><div id="show-bool" {show}="--81Y" class="test" {show.$animate}>this should show if .bool = true</div><div id="hide-bool" {hide}="--81Y" class="test" {hide.$animate}>this should hide if .bool = true</div></div><div class="case"><h4>mjs-include</h4><label class="case-label">immediate</label><div {include}="test-template" {include.$animate}><p>transcluded text</p></div><label class="case-label">immediate (via tag)</label><mjs-include src="test-template"><p>transcluded text</p></mjs-include><label class="case-label">ajax</label><div {include}="template.html"><p>Transcluded text</p></div></div><div class="case"><h4>mjs-validate</h4><form name="myForm" {validate} {class.error}="--84W" {class.$animate}><div><input name="field1" data-validate-required {class}="--84Z"></div><div {class}="--851"><label><input type="radio" name="radio1" value="1" data-validate-required> -- 1</label><label><input type="radio" name="radio1" value="2"> -- 2</label><label><input type="radio" name="radio1" value="3"> -- 3</label></div><div><input type="submit" value="Submit"> <input type="reset" value="Reset"></div></form></div><div class="case" {init}="--85C"><h4>dynamic list</h4><label><input id="radio-sep-1" type="radio" name="sep" value="/\\n|,/" {model}="this.sep"> /\\n|,/</label><label><input type="radio" name="sep" value="/\\n/"> /\\n/</label><label><input type="radio" name="sep" value=","> ,</label><br><br><textarea {model}="split:this.sep >> this.dynamicList" {model.$binding}="input"></textarea><ul><li {each}="item in this.dynamicList" {bind}="--85P" {bind.$recursive}></li></ul></div><div class="case"><h4>mjs-options</h4><label class="case-label">Generated from .alist</label><p class="test"><select {bind}="--81U" {options}="this.alist"><option>not selected</option></select></p><label class="case-label">Generated from .dynamicList</label><p class="test"><select {options}="{\n                        name: this.item,\n                        value: this.$index,\n                        group: this.$index - (this.$index % 2),\n                        disabledGroup: this.$index == 0,\n                        disabled: this.$index == 4\n                        } in this.dynamicList"><option>default value</option></select></p></div><div class="case" {cmp}="Test.TplComponent" id="tplComponentTest"><h2>{{--88G}}</h2>mjs-include change template:<br><a href="#" (click)="--864">a + b</a>|<a href="#" (click)="--866">a * b</a><div {include}="--868" {include.$animate} id="tplComponetInc"></div></div><div class="case" {cmp}="Test.StringTemplate"></div><div class="case" {cmp}="Test.ChangeTemplate">mjs-cmp change template:<br><a href="#" (click)="--86D">tpl1</a>|<a href="#" (click)="--86F">tpl2</a></div><div class="case"><h4>Router</h4><div {router}="Test.MyView" {router.$animate}></div>pushUrl:<a href="/1">/1</a>|<a href="/2">/2</a>|<a href="/3">/3</a>|<a href="http://www.kuindji.com">outside</a><br><br></div><div class="case" {ignore}>This element is ignored by renderer: {{--88H}}</div><div class="case" {router} {router.$cmp}="--86R" {router.$default-cmp}:="Test.ViewComponent1"><p>change cmp:<a href="#" (click)="--86U">Cmp1</a>|<a href="#" (click)="--86W">Cmp2</a></p></div></div><div class="cases"><div class="case double" {init}="--86Z"><h4>mjs-each (attr)</h4><input {model}="this.newItem" (key.enter)="--872"> <input type="button" {disabled}="--874" (click)="--875" value="Add item"><ul {show}="--81Y" {show.$animate}><li {each}="item in this.list | filter:this.listFilter | sortBy:\'txt\':this.sortBy" {each.$animate} {each.$animate-move}><label {class}="--879"><input type="checkbox" {model}="this.item.bool"> {{--88I}} - {{--88J}} - {{--88K}} - {{--88L}} - {{--88M}} - {{--88N}}</label><a href="#" (click)="--87C">x</a></li></ul><input {model}="this.listFilter" placeholder="Search"><a href="#" (click)="--87F">asc</a><a href="#" (click)="--87H">desc</a></div><div class="case double"><h4>mjs-each (tag)</h4><mjs-each value="item in this.list | filter:this.listFilter | sortBy:\'txt\':this.sortBy"><div><label {class}="--879"><input type="checkbox" {model}="this.item.bool"> {{--88I}} - {{--88J}} - {{--88K}} - {{--88L}} - {{--88M}} - {{--88N}}</label><a href="#" (click)="--87C">x</a></div></mjs-each></div><div class="case" id="newComponent">Dynamically created component on existing element will go here</div><div class="case" id="renderToComponent">Dynamically created component with renderTo will go here</div><div class="case double" {cmp}="Test.MyComponent" {cmp.$as}="ctrl"><p {cmp-prop}="para">Component\'s transcluded text + {{--88H}}</p><a href="#" (click)="--87U">reverse</a>|<a href="#" (click)="--87W">create new component on existing element</a>|<a href="#" (click)="--87Y">create new component and render to</a>|<a href="#" (click)="--880">create new dialog</a><br><br><button (click)="--884">Load store</button><button (click)="--886">Clear store</button><ul><li {each}="item in this.store" {each.$animate}>{{--88O}}</li></ul></div><div class="case double" id="myComponent1" {cmp}="Test.MyComponent"><p>This is another instance with deferred value: {{--88P}}</p></div><div class="case double"><tagc $as:="ctrl" $test:="Value from config"></tagc></div></div>',
app2:'<div class="case"><h4>app\'s resolved value</h4><p class="test">{{--89H}}</p></div><div class="case"><h4>recursive rendering</h4><p><a href="#" (click)="--88X">Change level 2</a></p><p class="test">This is level 1:<span {bind}="--890" {bind.$recursive}></span></p></div><div class="case"><h4>lang substitution</h4><label class="case-label">using normal expression with filter: \'key\' | l</label><p class="test">{{\'key\' | l}}</p><p class="test" {bind}="\'subkey1\' | l" {bind.$recursive}></p></div><div class="case"><h4>pluralization</h4><p><a href="#" (click)="--89A">Increase B</a></p><label class="case-label">using normal expression:</label><p class="test">{{--89I}} {{\'plr\' | p:this.b}}</p><p><input type="number" data-type="number" {model}="this.people"></p><p class="test" {bind}="\'viewing\' | p:this.people" {bind.$recursive}></p></div>',
"cmp1-template":"<h2>{{--88G}}</h2><div {transclude}></div>",dirs:'<div class="form_select" (click)="--89N" {class.loading}="--89O" {class.disabled}="--89P" {class.search}="--89Q" {class.multiple}="--89R" {class.black}="--89S"><input type="hidden" #el_hidden_field [name]="this.field.hiddenInputName" [value]="this.field.$$selection | join:\',\'"><i #el_icon_down (click)="--89V">\x3c!-- include icons/down.html --\x3e</i><a class="form_select__label" {each}="item in this.field.getMultiSelection()" style="display: inline-block !important;">{{--8AY}}<i class="delete icon" (click)="--89Y"></i></a><input type="text" #el_search class="search" [disabled]="this.field.disabled" {show}="--89Q" {show.$display}="inline-block" (focus)="--8A0" (blur)="--8A1" (key.backspace)="--8A2" {model}="this.searchQuery"><span class="sizer" #el_sizer {if}="--8A4" {bind}="--8A5"></span><div class="default text" #el_default_text (click)="--8A7" {show}="--8A8" {show.$display}="inline-block" {show.$save-state}="--8A9" {bind}="--8AA"></div><div class="text" #el_text (click)="--8A7" {class.default}="--8AC" {show}="--8AD" {show.$save-state}="--8AE" {show.$display}="inline-block" {bind}="--8AF"></div>\x3c!-- replaces two previous text blocks with invisible placeholder --\x3e<div style="display: none" class="default text" {show}="--8AH" {show.$display}="inline-block">&nbsp;</div><select class="form-select_hidden-select" #el_hidden_select (click)="--8AJ" (change)="--8AK" {show}="--8AL" {show.$display}="block" {options}="this.field._getSelectOptions()"></select><div class="form-select-menu" #el_menu {class.black}="--89S"><div class="items" #el_menu_items><div class="disabled item" #el_menu_disabled {if}="--8AP" (click)="--8AQ" {bind-html}="--8AR"></div><div class="empty item" #el_menu_empty style="color: #999;" {if}="--8AT" (click)="--8AU" {bind-html}="--8AV"></div><div class="item" {each}="item in this.field.store" (click)="--8AX" {bind}="--8AY"></div></div><div class="pagination_container" {cmp}="Pagination" {cmp.$autoscroll}="false" {show}="--8B0" (click)="--8B1"></div></div></div>',
tagc:'<div class="component"><p>This is a tag component.</p><p>{{--8B7}}</p></div>',"test-template":"<p>{{--8BB}}</p><div {transclude}></div>"},templateOptions:{dirs:{includes:!0}},expressionOpts:{813:"r",816:"r","86U":"p","86W":"p","87C":"p","88H":"r","89Y":"p","8AX":"p","8AY":"p","8B1":"p","8BB":"r"},funcs:{813:function(l,g){try{return l.$root.a*l.$root.b}catch(c){console.log("this.$root.a * this.$root.b"),console.log(c)}},816:function(l,g){try{return l.$root.a+l.$root.b}catch(c){console.log("this.$root.a + this.$root.b"),
console.log(c)}},822:function(l,g){try{return l.inline}catch(c){console.log("this.inline"),console.log(c)}},851:function(l,g){try{return{error:l.myForm.radio1.$invalid}}catch(c){console.log("{error: this.myForm.radio1.$invalid}"),console.log(c)}},864:function(l,g){try{l.tpl="a+b"}catch(c){console.log("this.tpl = 'a+b'"),console.log(c)}},866:function(l,g){try{l.tpl="a*b"}catch(c){console.log("this.tpl = 'a*b'"),console.log(c)}},868:function(l,g){try{return l.tpl}catch(c){console.log("this.tpl"),console.log(c)}},
872:function(l,g){try{l.newItem&&(l.list.push({bool:!1,txt:l.newItem}),l.newItem="")}catch(c){console.log("if (this.newItem) { this.list.push({bool: false, txt: this.newItem}); this.newItem = ''; }"),console.log(c)}},874:function(l,g){try{return!l.newItem}catch(c){console.log("!this.newItem"),console.log(c)}},875:function(l,g){try{l.list.push({bool:!1,txt:l.newItem}),l.newItem=""}catch(c){console.log("this.list.push({bool: false, txt: this.newItem}); this.newItem = '';"),console.log(c)}},879:function(l,
g){try{return{cls3:l.item.bool}}catch(c){console.log("{cls3: this.item.bool}"),console.log(c)}},880:function(l,g){try{l.ctrl.createDialog()}catch(c){console.log("this.ctrl.createDialog()"),console.log(c)}},884:function(l,g){try{l.store.load()}catch(c){console.log("this.store.load()"),console.log(c)}},886:function(l,g){try{l.store.clear()}catch(c){console.log("this.store.clear()"),console.log(c)}},890:function(l,g){try{return l.level1}catch(c){console.log("this.level1"),console.log(c)}},"81F":function(l,
g){try{return l.text}catch(c){console.log("this.text"),console.log(c)}},"81I":function(l,g){try{return l.html}catch(c){console.log("this.html"),console.log(c)}},"81U":function(l,g){try{return l.a}catch(c){console.log("this.a"),console.log(c)}},"81Y":function(l,g){try{return l.bool}catch(c){console.log("this.bool"),console.log(c)}},"84C":function(l,g){try{return{bool:l.bool,inline1:0==l.a}}catch(c){console.log("{bool: this.bool, inline1: this.a == 0}"),console.log(c)}},"84W":function(l,g){try{return l.myForm.$invalid}catch(c){console.log("this.myForm.$invalid"),
console.log(c)}},"84Z":function(l,g){try{return{error:l.myForm.field1.$invalid}}catch(c){console.log("{error: this.myForm.field1.$invalid}"),console.log(c)}},"85C":function(l,g){try{l.dynamicList=[]}catch(c){console.log("this.dynamicList = []"),console.log(c)}},"85P":function(l,g){try{return l.item}catch(c){console.log("this.item"),console.log(c)}},"86D":function(l,g){try{l.tpl=l.tpl1}catch(c){console.log("this.tpl = this.tpl1"),console.log(c)}},"86F":function(l,g){try{l.tpl=l.tpl2}catch(c){console.log("this.tpl = this.tpl2"),
console.log(c)}},"86R":function(l,g){try{return l.viewCmp}catch(c){console.log("this.viewCmp"),console.log(c)}},"86U":function(l,g){try{l.$parent.viewCmp="Test.ViewComponent1"}catch(c){console.log("this.$parent.viewCmp = 'Test.ViewComponent1'"),console.log(c)}},"86W":function(l,g){try{l.$parent.viewCmp="Test.ViewComponent2"}catch(c){console.log("this.$parent.viewCmp = 'Test.ViewComponent2'"),console.log(c)}},"86Z":function(l,g){try{l.newItem="",l.listFilter="",l.sortBy="asc"}catch(c){console.log("this.newItem = ''; this.listFilter = ''; this.sortBy = 'asc'"),
console.log(c)}},"87C":function(l,g){try{l.$parent.list.splice(l.$getRawIndex(l.$trackId),1)}catch(c){console.log("this.$parent.list.splice(this.$getRawIndex(this.$trackId),1);"),console.log(c)}},"87F":function(l,g){try{l.sortBy="asc"}catch(c){console.log("this.sortBy='asc'"),console.log(c)}},"87H":function(l,g){try{l.sortBy="desc"}catch(c){console.log("this.sortBy='desc'"),console.log(c)}},"87U":function(l,g){try{l.ctrl.reverse()}catch(c){console.log("this.ctrl.reverse()"),console.log(c)}},"87W":function(l,
g){try{l.ctrl.createNew()}catch(c){console.log("this.ctrl.createNew()"),console.log(c)}},"87Y":function(l,g){try{l.ctrl.createRender()}catch(c){console.log("this.ctrl.createRender()"),console.log(c)}},"88E":function(l,g){try{return l.a+l.b}catch(c){console.log("this.a + this.b"),console.log(c)}},"88F":function(l,g){try{return l.bool?"true":"false"}catch(c){console.log('this.bool ? "true": "false"'),console.log(c)}},"88G":function(l,g){try{return l.title}catch(c){console.log("this.title"),console.log(c)}},
"88H":function(l,g){try{return l.$root.a}catch(c){console.log("this.$root.a"),console.log(c)}},"88I":function(l,g){try{return l.$index}catch(c){console.log("this.$index"),console.log(c)}},"88J":function(l,g){try{return l.item.txt}catch(c){console.log("this.item.txt"),console.log(c)}},"88K":function(l,g){try{return l.$first?"first":""}catch(c){console.log('this.$first ? "first" : ""'),console.log(c)}},"88L":function(l,g){try{return l.$last?"last":""}catch(c){console.log('this.$last ? "last" : ""'),
console.log(c)}},"88M":function(l,g){try{return l.$even?"even":""}catch(c){console.log('this.$even ? "even" : ""'),console.log(c)}},"88N":function(l,g){try{return l.$odd?"odd":""}catch(c){console.log('this.$odd ? "odd" : ""'),console.log(c)}},"88O":function(l,g){try{return l.item.name}catch(c){console.log("this.item.name"),console.log(c)}},"88P":function(l,g){try{return l.deferred}catch(c){console.log("this.deferred"),console.log(c)}},"88X":function(l,g){try{l.changeLevel2()}catch(c){console.log("this.changeLevel2()"),
console.log(c)}},"89A":function(l,g){try{l.increaseB()}catch(c){console.log("this.increaseB()"),console.log(c)}},"89H":function(l,g){try{return l.resolved}catch(c){console.log("this.resolved"),console.log(c)}},"89I":function(l,g){try{return l.b}catch(c){console.log("this.b"),console.log(c)}},"89N":function(l,g){try{l.field.onSelfClick(l.$event)}catch(c){console.log("this.field.onSelfClick(this.$event)"),console.log(c)}},"89O":function(l,g){try{return l.loading}catch(c){console.log("this.loading"),
console.log(c)}},"89P":function(l,g){try{return l.field.disabled}catch(c){console.log("this.field.disabled"),console.log(c)}},"89Q":function(l,g){try{return l.field.searchable}catch(c){console.log("this.field.searchable"),console.log(c)}},"89R":function(l,g){try{return l.field.multiple}catch(c){console.log("this.field.multiple"),console.log(c)}},"89S":function(l,g){try{return l.field.black}catch(c){console.log("this.field.black"),console.log(c)}},"89V":function(l,g){try{l.field.onDropdownIconClick(l.$event)}catch(c){console.log("this.field.onDropdownIconClick(this.$event)"),
console.log(c)}},"89Y":function(l,g){try{l.$parent.field.onItemDeleteClick(l.item,l.$event)}catch(c){console.log("this.$parent.field.onItemDeleteClick(this.item, this.$event)"),console.log(c)}},"8A0":function(l,g){try{l.field.onSearchFocus(l.$event)}catch(c){console.log("this.field.onSearchFocus(this.$event)"),console.log(c)}},"8A1":function(l,g){try{l.field.onSearchBlur(l.$event)}catch(c){console.log("this.field.onSearchBlur(this.$event)"),console.log(c)}},"8A2":function(l,g){try{l.field.onSearchBackspace(l.$event)}catch(c){console.log("this.field.onSearchBackspace(this.$event)"),
console.log(c)}},"8A4":function(l,g){try{return l.field.multiple&&l.field.searchable}catch(c){console.log("this.field.multiple && this.field.searchable"),console.log(c)}},"8A5":function(l,g){try{return l.searchQuery}catch(c){console.log("this.searchQuery"),console.log(c)}},"8A7":function(l,g){try{l.field.onValueTextClick(l.$event)}catch(c){console.log("this.field.onValueTextClick(this.$event)"),console.log(c)}},"8A8":function(l,g){try{return!l.searchQuery&&!l.field.hasSelection()&&!!l.field.emptyText}catch(c){console.log("!this.searchQuery && !this.field.hasSelection() && !!this.field.emptyText"),
console.log(c)}},"8A9":function(l,g){try{return l.emptyShown}catch(c){console.log("this.emptyShown"),console.log(c)}},"8AA":function(l,g){try{return l.field.emptyText}catch(c){console.log("this.field.emptyText"),console.log(c)}},"8AC":function(l,g){try{return l.focused&&""==l.searchQuery}catch(c){console.log("this.focused && this.searchQuery == ''"),console.log(c)}},"8AD":function(l,g){try{return!l.searchQuery&&!l.field.multiple&&l.field.hasSelection()}catch(c){console.log("!this.searchQuery && !this.field.multiple && this.field.hasSelection()"),
console.log(c)}},"8AE":function(l,g){try{return l.selectedShown}catch(c){console.log("this.selectedShown"),console.log(c)}},"8AF":function(l,g){try{return l.field.getSelectedName()}catch(c){console.log("this.field.getSelectedName()"),console.log(c)}},"8AH":function(l,g){try{return!l.emptyShown&&!l.selectedShown&&!l.field.searchable}catch(c){console.log("!this.emptyShown && !this.selectedShown && !this.field.searchable"),console.log(c)}},"8AJ":function(l,g){try{l.field.onHiddenSelectClick(l.$event)}catch(c){console.log("this.field.onHiddenSelectClick(this.$event)"),
console.log(c)}},"8AK":function(l,g){try{l.field.onHiddenSelectChange(l.$event)}catch(c){console.log("this.field.onHiddenSelectChange(this.$event)"),console.log(c)}},"8AL":function(l,g){try{return l.field.useHiddenSelect}catch(c){console.log("this.field.useHiddenSelect"),console.log(c)}},"8AP":function(l,g){try{return l.field.showNotFound&&l.field.store.isEmpty()}catch(c){console.log("this.field.showNotFound && this.field.store.isEmpty()"),console.log(c)}},"8AQ":function(l,g){try{l.field.onNotFoundClick(null,
l.$event)}catch(c){console.log("this.field.onNotFoundClick(null, this.$event)"),console.log(c)}},"8AR":function(l,g){try{return l.field.notFoundText}catch(c){console.log("this.field.notFoundText"),console.log(c)}},"8AT":function(l,g){try{return l.field.showEmptyItem&&!l.field.store.isEmpty()}catch(c){console.log("this.field.showEmptyItem && !this.field.store.isEmpty()"),console.log(c)}},"8AU":function(l,g){try{l.field.onItemClick(null,l.$event)}catch(c){console.log("this.field.onItemClick(null, this.$event)"),
console.log(c)}},"8AV":function(l,g){try{return l.field.emptyItemText}catch(c){console.log("this.field.emptyItemText"),console.log(c)}},"8AX":function(l,g){try{l.$parent.field.onItemClick(l.item,l.$event)}catch(c){console.log("this.$parent.field.onItemClick(this.item, this.$event)"),console.log(c)}},"8AY":function(l,g){try{return l.$parent.field.getItemName(l.item)}catch(c){console.log("this.$parent.field.getItemName(this.item)"),console.log(c)}},"8B0":function(l,g){try{return l.pagination.hasPages()}catch(c){console.log("this.pagination.hasPages()"),
console.log(c)}},"8B1":function(l,g){try{l.$parent.field.onPaginationClick(l.$event)}catch(c){console.log("this.$parent.field.onPaginationClick(this.$event)"),console.log(c)}},"8B7":function(l,g){try{return l.ctrl.config.get("test")}catch(c){console.log("this.ctrl.config.get('test')"),console.log(c)}},"8BB":function(l,g){try{return l.$root.text}catch(c){console.log("this.$root.text"),console.log(c)}}}},n={plugin:{},mixin:{},lib:{},dom:{},regexp:{},browser:{},app:{},prebuilt:"undefined"!==typeof vb?
vb:null},T=function(){var l=[],g=function(c){var a;var b=0;for(a=l.length;b<a;b++)l[b][0].call(l[b][1],c);"undefined"!=typeof console&&console.error&&console.error(c)};g.on=function(c,a){g.un(c,a);l.push([c,a])};g.un=function(c,a){var b;var e=0;for(b=l.length;e<b;e++)if(l[e][0]===c&&l[e][1]===a){l.splice(e,1);break}};return g}(),Pb=Object.prototype.toString,ha=function(){var l={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,
"[object RegExp]":9,"[object Date]":10};return function(g){if(!g){if(null===g)return 6;if(void 0===g)return 7}var c=l[Pb.call(g)];return void 0===c?-1:1===c&&isNaN(g)?8:c}}(),Ea=function(l,g,c){var a=l.length,b=g.length,e=0,d=0,f=!1,k=!1,h=[];if(!b)return[l];for(;e<a;e++){var m=l.charAt(e);if("\\"==m)e++;else if('"'==m)f=!f;else if("'"==m)k=!k;else if(!f&&!k&&(1==b&&m==g||1<b&&l.substring(e,e+b)==g)){if(l.substr(e-1,b)!=g&&l.substr(e+1,b)!=g||c)h.push(l.substring(d,e).replace("\\"+g,g)),d=e+b;e+=
b-1}}h.push(l.substring(d).replace("\\"+g,g));return h};n.filter=n.filter||{};var G=n.lib.Expression=function(){var l=/((^|[^a-z0-9_$\]\)'"])|(this))(\.)([^0-9])/ig,g={},c={},a=[],b=n.prebuilt?n.prebuilt.funcs:{},e=function(a){return d(a)?(a=a.substring(2),b[a]||null):null},d=function(a){return"string"===typeof a&&"--"===a.substring(0,2)},f=function(a){return!a.trim().match(/[^a-zA-Z0-9_$'"\(\)\[\]\.;]/)},k=function(a){if(!w(a))return{value:a};var b=a.substr(0,1),d=a.length-1;if('"'===b||"'"===b){if(a.indexOf(b,
1)===d)return{value:a.substring(1,d)}}else{if("true"===a||"false"===a)return{value:"true"===a};if((b=parseFloat(a))==a)return{value:b}}return!1},h=function(a,b){b=b||{};"string"===typeof b&&"setter"===b&&(b={setter:!0});var d=!0===b.asCode,e=!0===b.setter,c=!0===b.noReturn,h;if(h=k(a)){var m=a+"_static";if(g[m])return g[m];if(e)throw Error("Static value cannot work as setter");return b.asCode?"".concat("function() {","return ",a,"}"):g[m]=function(){return h.value}}try{var p=f(a);m=a+"_"+(e?"setter":
c?"func":"getter");if(!p&&e)throw Error("Complex expression cannot work as setter");if(!g[m]||d){var r=a.replace(l,"$2____.$5"),F=p&&e?"".concat("try {",r," = $$$$",';} catch (thrownError) { /*DEBUG-START*/console.log("expr");console.log(thrownError);/*DEBUG-END*/return undefined; }'):"".concat("try {",c?"":"return ",r,';} catch (thrownError) { /*DEBUG-START*/console.log("expr");console.log(thrownError);/*DEBUG-END*/return undefined; }'),t=a.replace(/\n/g,"\\n");t=t.replace(/\r/g,"\\r");t=t.replace(/'/g,
"\\'");t=t.replace(/"/g,'\\"');F=F.replace('"expr"','"'+t+'"');if(d)return"function(____, $$$$) {"+F+"}";g[m]=new Function("____","$$$$",F)}return g[m]}catch(Rb){return T(Error("Error parsing expression: "+a+"; \n\n\n"+F)),T(Rb),J}},m=function(b,d,e){var c=d?">>":"|";if(-1===b.indexOf(c))return b;b=Ea(b,c);d=d?b.pop():b.shift();c=[];var f;var h=0;for(f=b.length;h<f;h++){var m=Ea(b[h].trim(),":");var p=e;var g=m.shift();var l=B(g)?g:null,F=[],t=[],v=l?null:g.substr(0,1),A={neg:!1,dblneg:!1,undeterm:!1,
name:g};l?A.name=l.name:("!!"===g.substr(0,2)?(g=g.substr(2),A.dblneg=!0):"!"===v?(g=g.substr(1),A.neg=!0):"?"===v&&(g=g.substr(1),A.undeterm=!0),A.name=g);if(!l)b:{l=g;if(p)if(I(p))p.concat(a);else if(p.hasOwnProperty(l)){l=p[l];break b}g=a.length;for(p=0;p<g;p++)if(a[p]&&a[p].hasOwnProperty(l)){l=a[p][l];break b}l=null}if(B(l)){g=-1;for(p=m.length;++g<p;F.push(r(m[g])))k(m[g])||t.push(m[g]);l.$undeterministic&&(A.undeterm=!0);m={fn:l,origArgs:m,params:F,expressions:t,opt:A}}else m=null;m&&c.push(m)}return{expr:d.trim(),
pipes:c}},p=function(a,b){b=b||{};var d=-1!==a.indexOf("|"),e=-1!==a.indexOf(">>");a={fn:null,getterFn:null,setterFn:null,expr:a,pipes:[],inputPipes:[]};if(!d&&!e)return a.fn=r(a.expr,b),a;d&&(d=m(a.expr,!1,b.filters),a.expr=d.expr,a.pipes=d.pipes);e&&(d=m(a.expr,!0,b.filters),a.expr=d.expr,a.inputPipes=d.pipes,b.setter=!0);a.fn=r(a.expr,b);e?(b.setter=!1,a.getterFn=r(a.expr,b),a.setterFn=a.fn):a.getterFn=a.fn;return a},F=function(a,b,d){var e,c=b.length,f;for(e=0;e<c;e++){var h=b[e];var k=[];var m=
-1;for(f=h.params.length;++m<f;k.push(h.params[m](d)));k.unshift(d);k.unshift(a);a=h.fn.apply(d,k);h.opt.neg?a=!a:h.opt.dblneg&&(a=!!a)}return a},t=function(a,b){b=b||{};return 0===a.pipes.length&&0===a.inputPipes.length?b.setterOnly?(a.setterFn||(a.setterFn=r(a.expr,{setter:!0})),a.setterFn):a.fn:function(d,e){if(a.inputPipes.length&&!b.getterOnly){var c=F(e,a.inputPipes,d);a.setterFn||(a.setterFn=r(a.expr,{setter:!0}));a.setterFn(d,c)}a.pipes&&!b.setterOnly&&(b.getterOnly?c=a.getterFn(d):a.inputPipes.length||
(c=a.fn(d)),c=F(c,a.pipes,d));return c}},r,v,A,E,u=function(a,b){return E(A(a,b),b)},x=function(){v=u;A=p;E=t;r=h};"undefined"!==typeof window&&a.push(window);n.filter&&a.push(n.filter);x();return{setExpressionFn:function(a){r=a},getExpressionFn:function(){return r},setDeconstructorFn:function(a){A=a},getDeconstructorFn:function(){return A},setConstructorFn:function(a){E=a},getConstructorFn:function(){return E},setParserFn:function(a){v=a},getParserFn:function(){return v},addFilterSource:function(b){a.push(b)},
reset:x,expression:function(a,b){return e(a)||r(a,b)},deconstruct:function(a,b){return A(a,b)},construct:function(a,b){return E(a,b)},parse:function(a,b){return v(a,b)},func:function(a,b){b=b||{};b.noReturn=!0;b.getterOnly=!0;return e(a)||v(a,b)},setter:function(a,b){b=b||{};b.setter=!0;b.setterOnly=!0;return e(a)||v(a,b)},getter:function(a,b){b=b||{};b.setter=!1;b.getterOnly=!0;return e(a)||v(a,b)},run:function(a,b,c,f){d(a)?e(a)(b):(f=f||{},f.noReturn=!0,v(a,f)(b,c))},get:function(a,b,c,f){if(d(a))return e(a)(b);
f=f||{};f.getterOnly=!0;return v(a,f)(b,c)},set:function(a,b,d,e){e=e||{};e.setter=!0;e.setterOnly=!0;return v(a,e)(b,d)},isStatic:k,isAtom:f,isProperty:function(a){return(a=a.match(/^this\.([a-zA-Z0-9_$]+)$/))?a[1]:!1},isPrebuiltKey:d,expressionHasPipes:function(a){return 1<Ea(a,"|").length||1<Ea(a,">>").length},describeExpression:function(a){if(!a||"string"!==typeof a)return"";if(d(a))return a=a.substring(2),n.prebuilt.expressionOpts[a]||"";if(c[a])return c[a];var b=(-1!==a.indexOf("$parent")?"p":
"")+(-1!==a.indexOf("$root")?"r":"")+(1<Ea(a,"|").length?"o":"")+(1<Ea(a,">>").length?"i":"");return c[a]=b},clearCache:function(){g={}}}}(),W=function(){var l=["0","0","0"];return function(){for(var g=l.length,c;g;){g--;c=l[g].charCodeAt(0);if(57==c)return l[g]="A",l.join("");if(90==c)l[g]="0";else return l[g]=String.fromCharCode(c+1),l.join("")}l.unshift("0");return l.join("")}}(),wb=n.lib.ObservableEvent=function(){var l=function(g,c){this.name=g;this.listeners=[];this.map={};this.hash=W();this.uni=
"$$"+g+"_"+this.hash;this.suspended=!1;this.lid=0;"object"===typeof c&&null!==c?q(this,c,!0,!1):this.returnResult=c};q(l.prototype,{name:null,listeners:null,map:null,hash:null,uni:null,suspended:!1,lid:null,returnResult:null,autoTrigger:null,lastTrigger:null,triggerFilter:null,filterContext:null,expectPromises:!1,resolvePromises:!1,getName:function(){return this.name},$destroy:function(){for(var g in this)this[g]=null},on:function(g,c,a){if(!g)return null;c=c||null;a=a||{};var b=this.uni,e=g[b]||
++this.lid,d=b+"_"+e,f=a.first||!1;if(g[b]&&(!c||c[d])&&!a.allowDupes)return null;g[b]||(g[b]=e);c&&!c[d]&&(c[d]=!0);g={fn:g,context:c,id:e,async:!1,called:0,limit:0,start:1,count:0,append:null,prepend:null};q(g,a,!0,!1);!0===g.async&&(g.async=1);f?this.listeners.unshift(g):this.listeners.push(g);this.map[e]=g;if(this.autoTrigger&&this.lastTrigger&&!this.suspended){var k=this.triggerFilter;this.triggerFilter=function(a){return a.id===e?k?!1!==k(a):!0:!1};this.trigger.apply(this,this.lastTrigger);
this.triggerFilter=k}return e},once:function(g,c,a){a=a||{};a.limit=1;return this.on(g,c,a)},un:function(g,c){var a=-1,b=this.uni,e=this.listeners;var d=g==parseInt(g)?parseInt(g):g[b];if(!d)return!1;var f=b+"_"+d;c=c||null;for(var k=0,h=e.length;k<h;k++)if(e[k].id===d&&e[k].context===c){a=k;delete g[b];c&&delete c[f];break}if(-1===a)return!1;e.splice(a,1);delete this.map[d];return!0},hasListener:function(g,c){var a=this.listeners;if(g){g=B(g)?g[this.uni]:parseInt(g);if(!g)return!1;for(var b=this.uni+
"_"+g,e=0,d=a.length;e<d;e++)if(a[e].id===g&&(!c||c[b]))return!0;return!1}return 0<a.length},removeAllListeners:function(){var g=this.listeners,c=this.uni,a;var b=0;for(a=g.length;b<a;b++){var e=c+"_"+g[b].fn[c];delete g[b].fn[c];g[b].context&&delete g[b].context[e]}this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(g,c){if(g.append||g.prepend)c=c.slice(),g.prepend&&(c=g.prepend.concat(c)),g.append&&(c=c.concat(g.append));
return c},trigger:function(){var g=this,c=g.listeners,a=g.returnResult,b=g.triggerFilter,e=g.filterContext,d=g.expectPromises,f=g.keepPromiseOrder,k=[],h=X(arguments),m;if(g.suspended)return null;g.autoTrigger&&(g.lastTrigger=h.slice());if(0===c.length)return null;var p="all"===a||"concat"===a?[]:"merge"===a?{}:null,l;var t="first"===a?[c[0]]:c.slice();for(d&&"last"===a&&(f=!0);l=t.shift();)if(!(!l||!g.map[l.id]||(c=g._prepareArgs(l,h),b&&!1===b.call(e,l,c,g))||l.filter&&!1===l.filter.apply(l.filterContext||
l.context,c)||(l.count++,l.count<l.start))){if(l.async&&!d){var r=null;V(l.fn,l.context,c,l.async)}else d?(r=function(a,b,d){return function(e){"pipe"===b&&(d[0]=e,d=g._prepareArgs(a,d));return a.fn.apply(a.context,d)}}(l,a,h.slice()),r=m?m.then(r):l.fn.apply(l.context,c),r.catch(T)):r=l.fn.apply(l.context,c);l.called++;l.called===l.limit&&g.un(l.id);if("first"===a)return r;if(d)k.push(r),("pipe"===a||f)&&r&&(m=r);else if(null!==a)if("all"===a)p.push(r);else if("concat"===a&&r)p=p.concat(r);else if("merge"===
a)q(p,r,!0,!1);else{if("nonempty"===a&&r)return r;if("pipe"===a)p=r,h[0]=r;else if("last"===a)p=r;else{if(!1===a&&!1===r)return!1;if(!0===a&&!0===r)return!0}}}if(d){if("pipe"===a)return m;b=Promise.all(k);g.resolvePromises&&null!==a&&"all"!==a&&(b=b.then(function(b){var d,e=b.length;for(d=0;d<e;d++){var c=b[d];if("concat"===a&&c)p=p.concat(c);else if("merge"===a)q(p,c,!0,!1);else{if("nonempty"===a&&c)return c;if("last"===a)p=c;else{if(!1===a&&!1===c)return!1;if(!0===a&&!0===c)return!0}}}return p}));
return b}return p}},!0,!1);return l}(),la=n.lib.Observable=function(){var l=function(){this.events={}};q(l.prototype,{createEvent:function(g,c){g=g.toLowerCase();var a=this.events;a[g]||(a[g]=new wb(g,c));return a[g]},getEvent:function(g){g=g.toLowerCase();return this.events[g]},on:function(g,c,a,b){g=g.toLowerCase();var e=this.events;e[g]||(e[g]=new wb(g));return e[g].on(c,a,b)},once:function(g,c,a,b){b=b||{};b.limit=1;return this.on(g,c,a,b)},un:function(g,c,a){g=g.toLowerCase();var b=this.events;
b[g]&&b[g].un(c,a)},relayEvent:function(g,c){g.on(c,this.trigger,this,{prepend:"*"===c?null:[c]})},unrelayEvent:function(g,c){g.un(c,this.trigger,this)},hasListener:function(g,c,a){var b=this.events;if(g)return g=g.toLowerCase(),b[g]?b[g].hasListener(c,a):!1;for(g in b)if(b[g].hasListener())return!0;return!1},hasEvent:function(g){return!!this.events[g]},removeAllListeners:function(g){var c=this.events;if(g)c[g]&&c[g].removeAllListeners();else for(g in c)c[g].removeAllListeners()},trigger:function(){var g=
arguments[0],c=this.events,a=null;g=g.toLowerCase();if(c[g]){var b=c[g];a=b.trigger.apply(b,X(arguments).slice(1))}(b=c["*"])&&b.trigger.apply(b,arguments);return a},suspendEvent:function(g){g=g.toLowerCase();var c=this.events;c[g]&&c[g].suspend()},suspendAllEvents:function(){var g=this.events,c;for(c in g)g[c].suspend()},resumeEvent:function(g){g=g.toLowerCase();var c=this.events;c[g]&&c[g].resume()},resumeAllEvents:function(){var g=this.events,c;for(c in g)g[c].resume()},destroyEvent:function(g){var c=
this.events;c[g]&&(c[g].removeAllListeners(),c[g].$destroy(),delete c[g])},$destroy:function(){var g=this.events,c;for(c in g)this.destroyEvent(c);for(c in this)this[c]=null},getApi:function(){if(!this.api){for(var g="createEvent getEvent on un once hasListener removeAllListeners trigger suspendEvent suspendAllEvents resumeEvent resumeAllEvents destroyEvent relayEvent unrelayEvent".split(" "),c={},a,b=-1,e=g.length;++b<e;a=g[b],c[a]=this[a].bind(this));this.api=c}return this.api}},!0,!1);return l}(),
ja=n.lib.MutationObserver=function(){var l=new la,g=function(){var a,b=0;for(a in this)this.hasOwnProperty(a)&&"$checkAll"!==a&&this[a].check()&&b++;return b},c=function(a,b,e,d,c){var f=W(),h="expr";c=c||{};if(e)l.on(f,e,d,{allowDupes:!0});this.id=f;this.origExpr=b;this.staticValue=this.propertyName=null;this.dataObj=a;this.exprStruct=this.getterFn=this.setterFn=this.rawInput=this.prevValue=this.currentValue=null;this.sub=[];G.isPrebuiltKey(b)?this.getterFn=G.getter(b):B(b)?this.getterFn=b:(e=G.isStatic(b))?
(h="static",this.staticValue=e.value,this.getterFn=this._staticGetter.bind(this)):a&&(e=b,a.hasOwnProperty(e)||(e=G.isProperty(b))&&a.hasOwnProperty(e))&&(h="attr",this.propertyName=e,this.getterFn=this._propertyGetter.bind(this));this.getterFn||"expr"!==h||(c.filters?I(c.filters)?c.filters.push(a):c.filters=[c.filters]:c.filters=a,this.exprStruct=e=G.deconstruct(b,{filters:c.filters}),this.getterFn=G.construct(e,{getterOnly:!0}),(e.inputPipes.length||c.setter)&&this._initSetter());a&&(a.$$mo||(a.$$mo=
{$checkAll:g}),a.$$mo[b]||(a.$$mo[b]=this));this.currentValue=this._getValue();this.currentValueCopy=Ca(this.currentValue);this.type=h};q(c.prototype,{_propertyGetter:function(){return this.dataObj[this.propertyName]},_propertySetter:function(a,b){this.dataObj[this.propertyName]=b},_staticGetter:function(){return this.staticValue},check:function(){var a=this.currentValueCopy,b=this._getValue();return Ra(b,a)?!1:(this.prevValue=a,this.currentValue=b,this.currentValueCopy=Ca(b),l.trigger(this.id,this.currentValue,
this.prevValue),!0)},_initSetter:function(){var a=this.exprStruct;if("attr"===this.type)this.setterFn=this._propertySetter.bind(this);else{if(!a)throw Error("Unable to make setter out of "+this.expr);this.setterFn=G.construct(a,{setterOnly:!0});var b,e;var d=0;for(b=a.inputPipes.length;d<b;d++){var c=a.inputPipes[d];var k=0;for(e=c.expressions.length;k<e;k++)this.sub.push(n.lib.MutationObserver.get(this.dataObj,c.expressions[k],this._onSubChange,this))}}},_getValue:function(){return this.getterFn(this.dataObj)},
_onSubChange:function(){this.setValue(this.rawInput)},getValue:function(){return this.currentValue},getCopy:function(){return this.currentValueCopy},setValue:function(a){this.rawInput=a;this.setterFn||this._initSetter();this.setterFn(this.dataObj,a)},getPrevValue:function(){return this.prevValue},subscribe:function(a,b,e){e=e||{};e.allowDupes=!0;l.on(this.id,a,b,e);return this},unsubscribe:function(a,b){l.un(this.id,a,b);return this},hasInputPipes:function(){return this.exprStruct&&0<this.exprStruct.inputPipes.length},
hasOutputPipes:function(){return this.exprStruct&&0<this.exprStruct.pipes.length},$destroy:function(a){var b;if(a&&l.hasListener(this.id))return!1;a=0;for(b=this.sub.length;a<b;a++){var e=this.sub[a];e.unsubscribe(this._onSubChange,this);e.$destroy(!0)}l.destroyEvent(this.id);this.dataObj&&this.dataObj.$$mo&&this.dataObj.$$mo[this.origExpr]===this&&delete this.dataObj.$$mo[this.origExpr];for(var d in this)this.hasOwnProperty(d)&&(this[d]=null);return!0}});c.check=function(a,b){if(b){a=c.exists(a,
b);if(!a)throw Error("MutationObserver not found for expression: "+b);return a.check()}return a.$$mo?a.$$mo.$checkAll():!1};c.get=function(a,b,e,d,f){b=b.trim();var k=c.exists(a,b);return k?(e&&k.subscribe(e,d),k):new c(a,b,e,d,f)};c.exists=function(a,b){b=b.trim();return a&&a.$$mo&&a.$$mo[b]?a.$$mo[b]:!1};c.$destroy=function(a,b,e){var d,c=!0;if(a&&a.$$mo){for(d in a.$$mo)!a.$$mo.hasOwnProperty(d)||b&&d!==b||"$"===d[0]||(a.$$mo[d].$destroy(e)?delete a.$$mo[d]:c=!1);c&&delete a.$$mo}};return c}(),
cb=n.dom.commentWrap=function(l,g){g=g||"";var c=window.document.createComment(g+" - start");g=window.document.createComment(g+" - end");var a=l.parentNode;a.insertBefore(c,l);l.nextSibling?a.insertBefore(g,l.nextSibling):a.appendChild(g);return[c,g]},Da=n.lib.Cache=function(){var l,g=function(c){var a={},b=[];0==arguments.length&&(c=!0);return{addFinder:function(a,d,c){b[c?"unshift":"push"]({fn:a,context:d})},add:function(b,d,f){if(a[b]&&!1===a[b].rewritable)return a[b];a[b]={rewritable:"undefined"!=
typeof f?f:c,value:d};return d},get:function(e,d){if(!a[e]){if(b.length){var c;var k=0;for(c=b.length;k<c;k++){var h=b[k].fn.call(b[k].context,e,this);if(void 0!==h)return this.add(e,h,!0)}}return void 0!==d?this.add(e,d):void 0}return a[e].value},remove:function(b){var d=a[b];d&&!0===d.rewritable&&delete a[b];return d?d.value:void 0},exists:function(b){return!!a[b]},eachEntry:function(b,d){for(var e in a)b.call(d,a[e].value,e)},clear:function(){a={}},$destroy:function(){this===l&&(l=null);this.remove=
this.exists=this.destroy=this.get=this.add=c=a=null}}};g.global=function(){l||(l=new g(!0));return l};return g}(),db=n.lib.Namespace=function(l){l=l||{};var g=new Da(!1),c=function(a,b){var e=g.get(a);if(void 0!==e||b)return e;b=a.split(".");var d=b.length,c=l;for(e=0;e<d;e++){var k=b[e];if(void 0===c[k])return;c=c[k]}c&&g.add(a,c);return c};this.register=function(a,b){var e=a.split("."),d=e.pop();var c=e.join(".");var k=e.length,h=l;if(g[c])a=[g[c],d,a];else{if(0<k)for(c=0;c<k;c++){var m=e[c];void 0===
h[m]&&(h[m]={});h=h[m]}a=[h,d,a]}e=a[0];d=a[1];La(e)&&void 0===e[d]&&(e[d]=b,g.add(a[2],b));return b};this.exists=function(a){return void 0!==c(na,!0)};this.get=c;this.add=function(a,b){return g.add(a,b)};this.remove=function(a){return g.remove(a)};this.makeAlias=function(a,b){a=g.get(a);void 0!==a&&g.add(b,a);return a};this.$destroy=function(){var a;g.eachEntry(function(a){a&&a.$destroy&&a.$destroy()});g.$destroy();g=null;for(a in this)this[a]=null}},Sb=function(){var l=function(){this.$super&&this.$super!==
J&&this.$super.apply(this,arguments)},g=function(a,e,d){var $super=a.prototype[e]||("$constructor"===e?a:J)||J;return function(){var a=this.$super;if(this.$destroyed)return this.$super=null;this.$super=$super;var b=d.apply(this,arguments);this.$super=a;return b}},c=function(a,e,d,c){var b,h=d.prototype;for(b in e)if(e.hasOwnProperty(b)){var f=h[b];var p=e[b];a[b]=!B(p)||f&&!B(f)?p:g(d,b,p)}c||(a.$plugins=null,a.$pluginMap=null,h.$beforeInit?(a.$beforeInit=h.$beforeInit.slice(),a.$afterInit=h.$afterInit.slice(),
a.$beforeDestroy=h.$beforeDestroy.slice(),a.$afterDestroy=h.$afterDestroy.slice()):(a.$beforeInit=[],a.$afterInit=[],a.$beforeDestroy=[],a.$afterDestroy=[]))},a=function(b){b||(b=new db);var e=function(a){return function(){var d=[],e=[],c=arguments,h,f;if(!this)throw Error("Must instantiate via new: "+a);this.$plugins=[];(h=this.$constructor.apply(this,arguments))&&I(h)&&(c=h);var k=this.$plugins;var g=this.$pluginMap={};h=-1;for(f=this.$beforeInit.length;++h<f;d.push([this.$beforeInit[h],this]));
h=-1;for(f=this.$afterInit.length;++h<f;e.push([this.$afterInit[h],this]));if(k&&k.length)for(h=0,f=k.length;h<f;h++){var l=k[h];if(w(l)){var n=l;l=b?b.get(l,!0):null;if(!l)throw n+" not found";}l=new l(this,c);g[l.$class]=l;l.$beforeHostInit&&d.push([l.$beforeHostInit,l]);l.$afterHostInit&&e.push([l.$afterHostInit,l]);k[h]=l}h=-1;for(f=d.length;++h<f;d[h][0].apply(d[h][1],c));this.$init&&this.$init.apply(this,c);h=-1;for(f=e.length;++h<f;e[h][0].apply(e[h][1],c));}},d=function(){};q(d.prototype,
{$class:null,$extends:null,$plugins:null,$pluginMap:null,$mixins:null,$destroyed:!1,$destroying:!1,$constructor:J,$init:J,$beforeInit:[],$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$getClass:function(){return this.$class},$is:function(a){return k(this,a)},$getParentClass:function(){return this.$extends},$intercept:function(a,b,d,e,c){var h=this[a];this[a]=Nb(h||J,b,d||this,this,e,c);return h||J},$implement:function(a){var b=this.constructor;b&&b.$parent&&c(this,a,b.$parent,!0)},$hasPlugin:function(a){return a?
!!this.$pluginMap[a]:!1},$getPlugin:function(a){return a?this.$pluginMap[a]||null:null},$bind:function(a){var b=this;return function(){if(!b.$isDestroyed())return a.apply(b,arguments)}},$isDestroyed:function(){return self.$destroying||self.$destroyed},$destroy:function(){var a=this.$beforeDestroy,b=this.$afterDestroy,d=this.$plugins,e;if(!this.$destroying&&!this.$destroyed){this.$destroying=!0;var c=-1;for(e=a.length;++c<e;a[c].apply(this,arguments));c=0;for(e=d.length;c<e;c++)d[c].$beforeHostDestroy&&
d[c].$beforeHostDestroy.call(d[c],arguments);a=this.onDestroy.apply(this,arguments);c=-1;for(e=b.length;++c<e;b[c].apply(this,arguments));c=0;for(e=d.length;c<e;c++)d[c].$destroy.apply(d[c],arguments);if(!1!==a)for(c in this)this.hasOwnProperty(c)&&(this[c]=null);this.$destroying=!1;this.$destroyed=!0}},onDestroy:function(){}});d.$self=d;d.$instantiate=function(){var a=arguments;switch(a.length){case 0:return new this;case 1:return new this(a[0]);case 2:return new this(a[0],a[1]);case 3:return new this(a[0],
a[1],a[2]);case 4:return new this(a[0],a[1],a[2],a[3]);default:return sb(this,a)}};d.$override=function(a){var b=this.$self,d=this.$parent;b&&d&&c(b.prototype,a,d)};d.$extend=function(a,b){return f(a,b,this)};d.$destroy=function(){for(var a in this)this[a]=null};var f=function(a,f,k){a=a||{};var h=a.$class,m=k||a.$extends,g=a.$mixins;k=a.$alias;var p,A;if(m)if(w(m))var n=b.get(m);else n=m,m=n.$class||"";else n=d,m="";if(m&&!n)throw m+" not found";a.$class=h;a.$extends=m;a.$mixins=null;m=Object.create(n.prototype);
a.$constructor=a.$constructor||l;c(m,a,n);if(g)for(a=0,p=g.length;a<p;a++){var u=g[a];if(w(u)){if(!b)throw Error("Mixin "+u+" not found");u=b.get(u,!0)}var x=void 0,K=m;for(x in u)u.hasOwnProperty(x)&&("$beforeInit"===x?K.$beforeInit.push(u[x]):"$afterInit"===x?K.$afterInit.push(u[x]):"$beforeDestroy"===x?K.$beforeDestroy.push(u[x]):"$afterDestroy"===x?K.$afterDestroy.push(u[x]):K[x]||(K[x]=u[x]))}g=e(h);m.constructor=g;m.$self=g;g.prototype=m;for(A in d)"prototype"!==A&&d.hasOwnProperty(A)&&(g[A]=
d[A]);for(A in n)"prototype"!==A&&n.hasOwnProperty(A)&&(g[A]=n[A]);if(f)for(A in f)"prototype"!==A&&f.hasOwnProperty(A)&&(g[A]=f[A]);g.$parent=n;g.$self=g;b&&(h&&b.register(h,g),k&&b.register(k,g));return g},k=function(a,d){return(d=w(d)&&b?b.get(d):d)?a instanceof d:!1};f.classManagerFactory=a;f.factory=function(a){var d=b?b.get(a):null,e=X(arguments).slice(1);if(!d)throw a+" not found";return d.$instantiate.apply(d,e)};f.isSubclassOf=function(a,d){var e=a,c=b?b.get:function(){};w(d)||(d=d.prototype.$class);
for(w(a)&&(e=c(a));e&&e.prototype;){if(e.prototype.$class===d)return!0;e=e.$parent}return!1};f.isInstanceOf=k;f.define=f;f.Namespace=db;f.BaseClass=d;f.ns=b;f.$destroy=function(){d.$destroy();d=null;b&&(b.$destroy(),b=null)};return f};return a}(),na=function(){var l=new db;l.register("MetaphorJs",n);l.register("mjs",n);return l}(),C=Sb(na),y=n.app.Directive=function(){var l={},g={},c={},a=[],b=!1,e=function(a,b){return a.priority-b.priority};n.directive=n.directive||{attr:l,tag:g,component:c};return C({watcher:null,
stateFn:null,scope:null,node:null,mods:null,wrapperOpen:null,wrapperClose:null,autoOnChange:!0,$init:function(a,b,e,c,m){this.config=e;this.node=b;this.scope=a;if(this.saveState=e.saveState)this.stateFn=G.parse(this.saveState,{setter:!0,setterOnly:!0});a.$on("destroy",this.onScopeDestroy,this);a.$on("reset",this.onScopeReset,this);this.initialSet()},initialSet:function(){var a;this.config.on("value",this.onChange,this);if(this.autoOnChange&&void 0!==(a=this.config.get("value")))this.onChange(a,void 0)},
getChildren:function(){return null},createCommentWrap:function(a,b){a=cb(a,b||this.$class);this.wrapperOpen=a[0];this.wrapperClose=a[1]},onScopeDestroy:function(){this.$destroy()},onScopeReset:function(){},onChange:function(a){this.saveStateOnChange(a)},saveStateOnChange:function(a){this.stateFn&&this.stateFn(this.scope,a)},onDestroy:function(){this.scope&&(this.scope.$un("destroy",this.onScopeDestroy,this),this.scope.$un("reset",this.onScopeReset,this));this.watcher&&(this.watcher.unsubscribe(this.onChange,
this),this.watcher.$destroy(!0));this.wrapperOpen&&this.wrapperOpen.parentNode.removeChild(this.wrapperOpen);this.wrapperClose&&this.wrapperClose.parentNode.removeChild(this.wrapperClose);this.$super()}},{attr:{},tag:{},getDirective:function(a,b){return na.get("MetaphorJs.directive."+a+"."+b)},registerAttribute:function(d,e,c){l[d]||(a.push({priority:e,name:d,handler:l[d]=c}),b=!1)},getAttributes:function(){b||(a.sort(e),b=!0);return a},registerTag:function(a,b){g[a]||(g[a]=b)},registerComponent:function(a,
b){b||(b=a);w(b)&&(b=na.get(b,!0));c[a]||(c[a]=b)}})}(),D=n.lib.Config=function(){var l=new la,g=function(c,a){var b;this.id=W();this.values={};this.properties={};this.cfg=a||{};this.keys=[];if(c)for(b in c)this.setProperty(b,"string"===typeof c[b]?{expression:c[b]}:c[b])};q(g.prototype,{id:null,properties:null,values:null,keys:null,cfg:null,_initMo:function(c){var a=this.properties[c];a.mo=ja.get(this.cfg.scope,a.expression);a.mo.subscribe(this._onPropMutated,this,{append:[c]})},_unsetMo:function(c){c=
this.properties[c];c.mo&&(c.mo.unsubscribe(this._onPropMutated,this),c.mo.$destroy(!0),c.mo=null)},_calcProperty:function(c){var a=this.getProperty(c);if(!a||a.disabled)return null;if(a.expression)if(a.mode||(a.mode=2),1===a.mode)var b=a.expression;else 3===a.mode?b=G.get(a.expression,this.cfg.scope):2===a.mode?(!a.mo&&this._initMo(c),b=a.mo.getValue()):4===a.mode||5===a.mode?b=G.parse(a.expression,{setter:5===a.mode,setterOnly:5===a.mode,getterOnly:4===a.mode}):7===a.mode?b={getter:G.getter(a.expression),
setter:G.setter(a.expression)}:6===a.mode&&(b=G.func(a.expression));void 0===b&&(b=a.defaultValue);b=this._prepareValue(b,a);this.values[c]=b;(a=this.cfg.setTo||a.setTo)&&(a[c]=b);return b},_prepareValue:function(c,a){if(!a.type)return c;switch(a.type){case "int":return parseInt(c);case "float":case "number":return parseFloat(c);case "bool":case "boolean":return Ob(c);case "array":case "list":return I(c)?c:[c];case "string":case "str":return""+c}return c},_onPropMutated:function(c,a,b){var e=this.properties[b],
d=e.setTo||this.cfg.setTo;c=this._prepareValue(c,e);this.values[b]=c;d&&(d[b]=c);l.trigger(this.id,b,c,a);l.trigger(this.id+"-"+b,c,a)},setProperty:function(c,a,b){var e=this.properties,d=!1;e[c]||(e[c]={},this.keys.push(c),d=!0);e=e[c];if(void 0===b)for(var f in a)a[f]!==e[f]&&(d=!0,e[f]=a[f]);else b!==e[a]&&(d=!0,e[a]=b);e.mode||(e.defaultMode?(e.mode=e.defaultMode,d=!0):!0===e.expression&&(e.mode=1,d=!0));2!==e.mode||!e.expression||e.mo||e.disabled||(this._initMo(c),d=!0);d&&void 0!==this.values[c]&&
delete this.values[c];return d},getProperty:function(c){return this.properties[c]||null},getExpression:function(c){return(c=this.getProperty(c))?c.expression||null:null},getAll:function(){var c,a={};for(c in this.properties)a[c]=void 0===this.values[c]?this._calcProperty(c):this.values[c];return a},eachProperty:function(c,a){for(var b in this.properties)c.call(a,b,this.properties[b],this)},hasProperty:function(c){return!!this.properties[c]},hasExpression:function(c){return!(!this.properties[c]||!this.properties[c].expression)},
_toggleProperty:function(c,a){var b=this.properties[c],e=b?b.disabled||!1:!1;b?e!==a&&(2===b.mode&&this[a?"_initMo":"_unsetMo"](c),b.disabled=a):this.setProperty(c,{disabled:a})},disableProperty:function(c){this._toggleProperty(c,!0)},enableProperty:function(c){this._toggleProperty(c,!1)},setMode:function(c,a){this.setProperty(c,"mode",a)},setType:function(c,a,b){this.setProperty(c,"type",a);b&&this.setProperty(c,"defaultMode",b)},setDefaultMode:function(c,a){this.setProperty(c,"defaultMode",a)},
setDefaultValue:function(c,a){this.setProperty(c,"defaultValue",a)},getKeys:function(){return this.keys},getAllValues:function(){var c,a={};var b=0;for(c=this.keys.length;b<c;b++){var e=this.keys[b];if("value"===e)var d="";else if(0===e.indexOf("value."))d=e.replace("value.","");else continue;a[d]=this.get(e)}return a},get:function(c){void 0===this.values[c]&&this._calcProperty(c);return this.values[c]},on:function(c,a,b,e){if("string"===typeof c)l.on(this.id+"-"+c,a,b,e);else l.on(this.id,c,a,b)},
un:function(c,a,b){if("string"===typeof c)l.on(this.id+"-"+c,a,b);else l.on(this.id,c,a)},setTo:function(c){this.cfg.setTo=c},check:function(c){var a=c?[c]:this.keys,b,e=c?0:!1;var d=0;for(b=a.length;d<b;d++){var f=a[d];f=this.properties[f];if(f.mo){if(c)return f.mo.check();e+=f.mo.check()?1:0}}return e},checkScope:function(c){var a=this.cfg.scope;c=G.describeExpression(this.getExpression(c));return-1!==c.indexOf("r")?a.$root.$check():-1!==c.indexOf("p")?a.$parent?a.$parent.$check():a.$root.$check():
a.$check()},clear:function(){var c=this.id,a;if(null!==this.properties){for(a in this.properties)this._unsetMo(a),l.destroyEvent(c+"-"+a);l.destroyEvent(c);this.unsubscribe=this.subscribe=J}},$destroy:function(){null!==this.properties&&this.clear();this.cfg=this.values=this.properties=null}});g.MODE_STATIC=1;g.MODE_DYNAMIC=2;g.MODE_SINGLE=3;g.MODE_GETTER=4;g.MODE_SETTER=5;g.MODE_FUNC=6;g.MODE_FNSET=7;return g}();(function(){var l=function(){return!1};l.$prebuild={defaultMode:D.MODE_STATIC,ignore:!0};
y.registerAttribute("app",100,l)})();n.lib.Scope=function(l){this.$$observable=new la;this.$$historyWatchers={};q(this,l,!0,!1);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,this),this.$parent.$on("freeze",this.$freeze,this),this.$parent.$on("unfreeze",this.$unfreeze,this)):(this.$root=this,this.$isRoot=!0)};q(n.lib.Scope.prototype,{$app:null,$parent:null,$root:null,$isRoot:!1,$level:0,$static:!1,$$frozen:!1,$$observable:null,$$watchers:null,
$$historyWatchers:null,$$checking:!1,$$destroyed:!1,$$changing:!1,$$tmt:null,$new:function(l){return new n.lib.Scope(q({},l,{$parent:this,$root:this.$root,$app:this.$app,$level:this.$level+1,$static:this.$static},!0,!1))},$newIsolated:function(l){return new n.lib.Scope(q({},l,{$app:this.$app,$level:self.$level+1,$static:this.$static},!0,!1))},$freeze:function(){this.$$frozen||(this.$$frozen=!0,this.$$observable.trigger("freeze",this))},$unfreeze:function(){this.$$frozen&&(this.$$frozen=!1,this.$$observable.trigger("unfreeze",
this))},$on:function(l,g,c){return this.$$observable.on(l,g,c)},$un:function(l,g,c){return this.$$observable.un(l,g,c)},$parseExpression:function(l,g){var c=this,a=G.parse(l,g);return function(b){return a(c,b)}},$watch:function(l,g,c){return ja.get(this,l,g,c)},$unwatch:function(l,g,c){if(l=ja.exists(this,l))l.unsubscribe(g,c),l.$destroy(!0)},$watchHistory:function(l,g){this.$$historyWatchers[g]||(this.$$historyWatchers[g]=l,n.lib.History.on("change-"+g,this.$$onHistoryChange,this))},$unwatchHistory:function(l){this.$$historyWatchers[l]||
(delete this.$$historyWatchers[l],n.lib.History.un("change-"+l,this.$$onHistoryChange,this))},$set:function(l,g){if("string"===typeof l)this[l]=g;else for(var c in l)this[c]=l[c];this.$check()},$$onParentDestroy:function(){this.$destroy()},$$onParentCheck:function(){this.$check()},$$onHistoryChange:function(l,g,c){this.$$historyWatchers[c]&&(g=this.$$historyWatchers[c],this[g]=l,this.$check())},$scheduleCheck:function(l){this.$$tmt||(this.$tmt=V(this.$check,this,null,l))},$check:function(){var l;
this.$$checking||this.$static||this.$$frozen||(this.$$checking=!0,this.$$tmt&&(clearTimeout(this.$$tmt),this.$$tmt=null),this.$$mo&&(l=this.$$mo.$checkAll()),this.$$checking=!1,this.$$destroyed||this.$$observable.trigger("check",l),0<l?(this.$$changing=!0,this.$check()):this.$$changing&&(this.$$changing=!1,this.$$observable.trigger("changed")))},$destroy:function(){var l,g;if(!this.$$destroyed){this.$$destroyed=!0;this.$$observable.trigger("destroy");this.$$observable.$destroy();this.$parent&&this.$parent.$un&&
(this.$parent.$un("check",this.$$onParentCheck,this),this.$parent.$un("destroy",this.$$onParentDestroy,this),this.$parent.$un("freeze",this.$freeze,this),this.$parent.$un("unfreeze",this.$unfreeze,this));this.$$mo&&ja.$destroy(this);for(l in this.$$historyWatchers)this.$unwatchHistory(l);for(g in this)this.hasOwnProperty(g)&&(this[g]=null);this.$$destroyed=!0}}},!0,!1);var ta=n.lib.Scope,Na=n.lib.Text=function(){var l=new la,g=function(a,b,c){return c?(a=ja.get(b,a),c.push(a),a.getValue()):G.get(a,
b)},c=function(a,b){for(var d=0,e=a.length,c,m,g="";d<e;)if(-1!==(c=a.indexOf("{{",d))&&-1!==(m=a.indexOf("}}",c+2))&&"\\"!==a.substr(c-1,1))g+=a.substring(d,c),m!==c+2&&(d=a.substring(c+2,m),d=d.trim(),g+=b(d)),d=m+2;else{d!==e&&(g+=a.substring(d));break}return g},a=function(a,b,f,k,h){for(var d,e=a,l=0;;){if(100<l)throw Error("Got more than 100 iterations on template: "+self.origin);h?(d=g(a,b,f),h=!1):d=c(e,function(a){return g(a,b,f)});if(!k||d===e)return d;e=d;l++}},b=function(a,b,c){c=c||{};
this.id=W();this.origin=b;this.text="";this.scope=a;this.once=this.recursive=this.fullExpr=this.destroyed=!1;if(!0===c.recursive||!1===c.recursive)this.recursive=c.recursive;if(!0===c.fullExpr||!1===c.fullExpr)this.fullExpr=c.fullExpr;if(!0===c.once||!1===c.once)this.once=c.once;this._processDelegate=this._process.bind(this);this.observers=[];this._process(!0)};q(b.prototype,{_process:function(b){if(!this.destroyed){var d=this.observers.slice();this._observeData(d,"unsubscribe");this.observers=[];
this.text=a(this.origin,this.scope,this.observers,this.recursive,this.fullExpr);this._observeData(this.observers,"subscribe");this._destroyObservers(d);b||l.trigger(this.id,this)}},_onDataChange:function(){V(this._processDelegate)},_observeData:function(a,b){var d;var c=0;for(d=a.length;c<d;c++)a[c][b](this._onDataChange,this)},_destroyObservers:function(a){var b;var c=0;for(b=a.length;c<b;c++)a[c].$destroy(!0)},getString:function(){return this.text},subscribe:function(a,b,c){return l.on(this.id,
a,b,c)},unsubscribe:function(a,b){return l.un(this.id,a,b)},check:function(){return ja.check(this.scope)},$destroy:function(){this.destroyed=!0;l.destroyEvent(this.id);this._observeData(this.observers,"unsubscribe");this._destroyObservers(this.observers)}});b.render=a;b.eachText=c;b.applicable=function(a){return a&&a.indexOf&&-1!==a.indexOf("{{")?!0:!1};return b}();n.dom=n.dom||{};var eb=n.dom.isField=function(l){var g=l.nodeName.toLowerCase();l=l.type;return"input"!=g&&"textarea"!=g&&"select"!=g||
"submit"==l||"reset"==l||"button"==l?!1:!0},ua=n.dom.getInputValue=function(){var l=/\r/,g={option:function(c){var a=c.getAttribute("value")||c.value;return void 0!==a?a:(c.innerText||c.textContent).trim()},select:function(c){for(var a,b=c.options,e=c.selectedIndex,d=(c="select-one"===c.type||0>e)?null:[],f=c?e+1:b.length,k,h=0>e?f:c?e:0;h<f;h++)if(a=b[h],k=a.disabled||a.parentNode.disabled,(a.selected||h===e)&&!k){a=n.dom.getInputValue(a);if(c)return a;d.push(a)}return d},radio:function(c){return null===
c.getAttribute("value")?"on":c.value},checkbox:function(c){return null===c.getAttribute("value")?"on":c.value}};return function(c){var a,b;if((a=g[c.type]||g[c.nodeName.toLowerCase()])&&void 0!==(b=a(c,"value")))return b;b=c.value;return w(b)?b.replace(l,""):null==b?"":b}}(),z=n.dom.getAttr=function(l,g){return l.getAttribute?l.getAttribute(g):null},M=n.dom.setAttr=function(l,g,c){return l.setAttribute(g,c)},ka=n.dom.removeAttr=function(l,g){return l.removeAttribute(g)},fb=n.dom.setInputValue=function(){var l=
{select:function(g,c){for(var a,b=g.options,e=X(c),d=b.length,f,k=-1;d--;)c=b[d],(f=-1!==e.indexOf(c.value))?(M(c,"selected","selected"),a=c.selected=!0):ka(c,"selected"),f||null===z(c,"default-option")||(k=d);a||(g.selectedIndex=k);return e}};l.radio=l.checkbox=function(g,c){if(I(c))return g.checked=-1!==c.indexOf(ua(g))};return function(g,c){if(1===g.nodeType){null===c?c="":1===ha(c)&&(c+="");var a=l[g.type]||l[g.nodeName.toLowerCase()];a&&void 0!==a(g,c,"value")||(g.value=c)}}}(),gb=n.lib.DomEvent=
function(){var l=function a(c){if(c instanceof a)return c;if(!(this instanceof a))return new a(c);for(var b in c)if(!this[b])try{this[b]=c[b]}catch(f){}this.originalEvent=c;this.type=c.type;!this.target&&c.srcElement&&(this.target=c.srcElement);var e=c.button;if(void 0===this.pageX&&null!==c.clientX){var d=this.target?this.target.ownerDocument||window.document:window.document;b=d.documentElement;d=d.body;this.pageX=c.clientX+(b&&b.scrollLeft||d&&d.scrollLeft||0)-(b&&b.clientLeft||d&&d.clientLeft||
0);this.pageY=c.clientY+(b&&b.scrollTop||d&&d.scrollTop||0)-(b&&b.clientTop||d&&d.clientTop||0)}this.which||void 0===e||(this.which=e&1?1:e&2?3:e&4?2:0);this.isDefaultPrevented=c.defaultPrevented||void 0===c.defaultPrevented&&!1===c.returnValue?Sa:Ma;this.timeStamp=c&&c.timeStamp||(new Date).getTime()};q(l.prototype,{isDefaultPrevented:Ma,isPropagationStopped:Ma,isImmediatePropagationStopped:Ma,preventDefault:function(){var c=this.originalEvent;this.isDefaultPrevented=Sa;c.returnValue=!1;c&&c.preventDefault&&
c.preventDefault()},stopPropagation:function(){var c=this.originalEvent;this.isPropagationStopped=Sa;c.cancelBubble=!0;c&&c.stopPropagation&&c.stopPropagation()},stopImmediatePropagation:function(){var c=this.originalEvent;this.isImmediatePropagationStopped=Sa;c&&c.stopImmediatePropagation&&c.stopImmediatePropagation();this.stopPropagation()}},!0,!1);return l}(),Z=n.dom.normalizeEvent=function(l){return new gb(l)},xb=function(l){function g(){a=null}var c,a;l=function(b){return function(e){var d=Z(e||
window.event),f=slice.call(arguments,1),k=0,h=0,m=0,l=0;d.type="mousewheel";"detail"in d&&(h=-1*d.detail);"wheelDelta"in d&&(h=d.wheelDelta);"wheelDeltaY"in d&&(h=d.wheelDeltaY);"wheelDeltaX"in d&&(k=-1*d.wheelDeltaX);"axis"in d&&d.axis===d.HORIZONTAL_AXIS&&(k=-1*h,h=0);var F=0===h?k:h;"deltaY"in d&&(F=h=-1*d.deltaY);"deltaX"in d&&(k=d.deltaX,0===h&&(F=-1*k));if(0!==h||0!==k){var t=Math.max(Math.abs(h),Math.abs(k));if(!a||t<a)a=t,"mousewheel"===d.type&&0===t%120&&(a/=40);"mousewheel"===d.type&&0===
t%120&&(F/=40,k/=40,h/=40);F=Math[1<=F?"floor":"ceil"](F/a);k=Math[1<=k?"floor":"ceil"](k/a);h=Math[1<=h?"floor":"ceil"](h/a);this.getBoundingClientRect&&(t=this.getBoundingClientRect(),m=d.clientX-t.left,l=d.clientY-t.top);d.deltaX=k;d.deltaY=h;d.deltaFactor=a;d.offsetX=m;d.offsetY=l;d.deltaMode=0;f.unshift(d,F,k,h);c&&clearTimeout(c);c=setTimeout(g,200);return b.apply(this,f)}}};l.events=function(){var a=window.document;return"onwheel"in a||9<=a.documentMode?["wheel"]:["mousewheel","DomMouseScroll",
"MozMousePixelScroll"]};return l}(),O=n.dom.addListener=function(){var l=null,g=null;return function(c,a,b){null===l&&(c.addEventListener?(l="addEventListener",g=""):(l="attachEvent",g="on"));if("mousewheel"==a){b=xb(b);a=xb.events();var e;var d=0;for(e=a.length;d<e;d++)c[l](g+a[d],b,!1)}else c[l](g+a,b,!1);return b}}(),ca=n.dom.removeListener=function(){var l=null,g=null;return function(c,a,b){null===l&&(c.removeEventListener?(l="removeEventListener",g=""):(l="detachEvent",g="on"));c[l](g+a,b)}}(),
Oa=n.dom.isAttached=function c(g){if(g===window)return!0;if(3==g.nodeType)return g.parentElement?c(g.parentElement):!0;var a=window.document.documentElement;return g===a?!0:a.contains(g)};n.browser=n.browser||{};var Tb=n.browser.isAndroid=function(){var g=null;return function(){null===g&&(g=parseInt((/android (\d+)/i.exec(navigator.userAgent)||[])[1],10)||!1);return g}}(),Ua=n.browser.isIE=function(){var g;return function(){if(null===g){var c=navigator.userAgent;g=parseInt((/msie (\d+)/i.exec(c)||
[])[1],10);isNaN(g)&&(g=parseInt((/trident\/.*; rv:(\d+)/i.exec(c)||[])[1],10)||!1)}return g}}(),yb=n.browser.hasEvent=function(){var g={},c;return function(a){if(void 0===g[a]){if("input"===a&&9==Ua())return g[a]=!1;c||(c=window.document.createElement("div"));g[a]=!!("on"+a in c)}return g[a]}}(),L=n.dom.select=function(){var g=/^[\w[:#.][\w\]*^|=!]*$/,c=/=([^\]]+)/,a=/ *, */,b=/(\([^)]*)\+/,e=/(\[[^\]]+)~/,d=/(~|>|\+)/,f=/ +/,k=/([^[:.#]+)?(?:#([^[:.#]+))?(?:\.([^[:.]+))?(?:\[([^!&^*|$[:=]+)([!$^*|&]?=)?([^:\]]+)?\])?(?::([^(]+)(?:\(([^)]+)\))?)?/,
h=/(?:(-?\d*)n)?(?:(%|-)(\d*))?/,m=/\D/,p=/[^(]*\(([^)]*)\)/,F=/\(.*/,t=/\[([^!~^*|$ [:=]+)([$^*|]?=)?([^ :\]]+)?\]/,r=window.document,v=!!r.getElementsByClassName,A=!!r.querySelectorAll,n={"first-child":function(a){return a.parentNode.getElementsByTagName("*")[0]!==a},"last-child":function(a){for(;(a=a.nextSibling)&&1!==a.nodeType;);return!!a},root:function(a){return"html"!==a.nodeName.toLowerCase()},"nth-child":function(a,b){var d=a.nodeIndex||0,c=b[3]=b[3]?("%"===b[2]?-1:1)*b[3]:0;b=b[1];if(d)return!((d+
c)%b);var e=a.parentNode.firstChild;d++;do if(1===e.nodeType&&(e.nodeIndex=++d)&&a===e&&(d+c)%b)return 0;while(e=e.nextSibling);return 1},"nth-last-child":function(a,b){var d=a.nodeIndexLast||0,c=b[3]?("%"===b[2]?-1:1)*b[3]:0;b=b[1];if(d)return!((d+c)%b);var e=a.parentNode.lastChild;d++;do if(1===e.nodeType&&(e.nodeLastIndex=d++)&&a===e&&(d+c)%b)return 0;while(e=e.previousSibling);return 1},empty:function(a){return!!a.firstChild},parent:function(a){return!a.firstChild},"only-child":function(a){return 1!==
a.parentNode.getElementsByTagName("*").length},checked:function(a){return!a.checked},lang:function(a,b){return a.lang!==b&&r.documentElement.lang!==b},enabled:function(a){return a.disabled||"hidden"===a.type},disabled:function(a){return!a.disabled},selected:function(a){return!a.selected}},u={},x=function(a){return u[a]||(u[a]=new RegExp("(^| +)"+a+"($| +)"))},K={"":function(a,b){return null!==z(a,b)},"=":function(a,b,d){var c;return(c=z(a,b))&&c===d},"&=":function(a,b,d){var c;return(c=z(a,b))&&x(d).test(c)},
"^=":function(a,b,d){var c;return(c=z(a,b)+"")&&!c.indexOf(d)},"$=":function(a,b,d){var c;return(c=z(a,b)+"")&&c.indexOf(d)===c.length-d.length},"*=":function(a,b,d){var c;return(c=z(a,b)+"")&&-1!==c.indexOf(d)},"|=":function(a,b,d){var c;return(c=z(a,b)+"")&&(c===d||!!c.indexOf(d+"-"))},"!=":function(a,b,d){var c;return!(c=z(a,b))||!x(d).test(c)}};return function(u,E,x){E=E||r;var q=[],ba=null,z,y;if(A&&E.querySelectorAll&&!x)try{q=X(E.querySelectorAll(u.replace(c,'="$1"')))}catch(Ub){T(Ub),ba=!0}if(!A||
ba||x)if(g.test(u))switch(x=0,u.charAt(0)){case "#":x=u.slice(1);q=r.getElementById(x);q.id!==x&&(q=r.all[x]);q=q?[q]:[];break;case ".":var w=u.slice(1);if(v)q=X((q=E.getElementsByClassName(w)).length?q:[]);else{w=" "+w+" ";ba=E.getElementsByTagName("*");for(z=0;E=ba[z++];)-1!==(" "+E.className+" ").indexOf(w)&&(q[x++]=E);q=x?q:[]}break;case ":":ba=E.getElementsByTagName("*");z=0;var B=u.replace(p,"$1");for(y=u.replace(F,"");E=ba[z++];)n[y]&&!n[y](E,B)&&(q[x++]=E);q=x?q:[];break;case "[":ba=E.getElementsByTagName("*");
z=0;E=t.exec(u);u=E[1];var da=E[2]||"";for(w=E[3];E=ba[z++];)K[da]&&(K[da](E,u,w)||"class"===u&&K[da](E,"className",w))&&(q[x++]=E);q=x?q:[];break;default:q=X((q=E.getElementsByTagName(u)).length?q:[])}else{for(var D=u.split(a),C=D.length-1,Qb=!!C,H,M,R,O,J,I,G,L,P,Q,N,S;x=D[C--];){M=(H=x.replace(b,"$1%").replace(e,"$1&").replace(d," $1 ").split(f)).length;z=0;O=" ";for(ba=E instanceof DocumentFragment?E.children:[E];R=H[z++];)if(" "!==R&&">"!==R&&"~"!==R&&"+"!==R&&ba){R=R.match(k);J=R[1]||"*";I=
R[2];G=R[3]?" "+R[3]+" ":"";u=R[4];da=R[5]||"";y=R[7];B="nth-child"===y||"nth-last-child"===y?h.exec("even"===R[8]&&"2n"||"odd"===R[8]&&"2n%1"||!m.test(R[8])&&"0n%"+R[8]||R[8]):R[8];L=[];x=P=0;for(N=z===M;Q=ba[P++];)switch(O){case " ":if(Q.getElementsByTagName)for(S=Q.getElementsByTagName(J),Q=0;w=S[Q++];)I&&w.id!==I||G&&-1==(" "+w.className+" ").indexOf(G)||!(!u||K[da]&&(K[da](w,u,R[6])||"class"===u&&K[da](w,"className",R[6])))||w.yeasss||(n[y]?n[y](w,B):y)||(N&&(w.yeasss=1),L[x++]=w);break;case "~":for(J=
J.toLowerCase();(Q=Q.nextSibling)&&!Q.yeasss;)1!==Q.nodeType||"*"!==J&&Q.nodeName.toLowerCase()!==J||I&&Q.id!==I||G&&-1===(" "+Q.className+" ").indexOf(G)||!(!u||K[da]&&(K[da](w,u,R[6])||"class"===u&&K[da](w,"className",R[6])))||Q.yeasss||(n[y]?n[y](Q,B):y)||(N&&(Q.yeasss=1),L[x++]=Q);break;case "+":for(;(Q=Q.nextSibling)&&1!==Q.nodeType;);!Q||Q.nodeName.toLowerCase()!==J.toLowerCase()&&"*"!==J||I&&Q.id!==I||G&&-1===(" "+w.className+" ").indexOf(G)||!(!u||K[da]&&(K[da](w,u,R[6])||"class"===u&&K[da](w,
"className",R[6])))||Q.yeasss||(n[y]?n[y](Q,B):y)||(N&&(Q.yeasss=1),L[x++]=Q);break;case ">":if(Q.getElementsByTagName)for(S=Q.getElementsByTagName(J),z=0;w=S[z++];)w.parentNode!==Q||I&&w.id!==I||G&&-1==(" "+w.className+" ").indexOf(G)||!(!u||K[da]&&(K[da](w,u,R[6])||"class"===u&&K[da](w,"className",R[6])))||w.yeasss||(n[y]?n[y](w,B):y)||(N&&(w.yeasss=1),L[x++]=w)}ba=L}else O=R;if(Qb){if(!ba.concat){L=[];for(Q=0;w=ba[Q];)L[Q++]=w;ba=L}q=ba.concat(1===q.length?q[0]:q)}else q=ba}for(x=q.length;x--;)q[x].yeasss=
q[x].nodeIndex=q[x].nodeIndexLast=null}return q}}(),va=n.lib.Input=function(){var g=function(c,a,b,e){if(c.$$input){if(a)c.$$input.on("change",a,b);return c.$$input}e=e||{};this.observable=new la;this.el=c;this.inputType=c.type.toLowerCase();this.dataType=e.type||z(c,"data-type")||this.inputType;this.listeners=[];if(a)this.onChange(a,b)};q(g.prototype,{el:null,inputType:null,dataType:null,listeners:null,radio:null,keydownDelegate:null,changeInitialized:!1,$destroy:function(){var c;this.observable.$destroy();
this._addOrRemoveListeners(ca,!0);this.el.$$input=null;for(c in this)this.hasOwnProperty(c)&&(this[c]=null)},_addOrRemoveListeners:function(c,a){var b=this.inputType,e=this.listeners,d=this.radio,f=this.el,k,h;var m=0;for(k=e.length;m<k;m++){var g=!!e[m][2];if(g===a){if("radio"===b)for(g=0,h=d.length;g<h;g++)c(d[g],e[m][0],e[m][1]);else c(f,e[m][0],e[m][1]);e[m][2]=!a}}},initInputChange:function(){var c=this.inputType;"radio"===c?this.initRadioInput():"checkbox"===c?this.initCheckboxInput():this.initTextInput();
this._addOrRemoveListeners(O,!1);this.changeInitialized=!0},initRadioInput:function(){var c=this.el,a=c.name;if(Oa(c))c=c.ownerDocument;else for(;c.parentNode;)c=c.parentNode;this.radio=L("input[name="+a+"]",c);this.onRadioInputChangeDelegate=this.onRadioInputChange.bind(this);this.listeners.push(["click",this.onRadioInputChangeDelegate,!1])},initCheckboxInput:function(){this.clicked=!1;this.onCheckboxInputChangeDelegate=this.onCheckboxInputChange.bind(this);this.onCheckboxInputClickDelegate=this.onCheckboxInputClick.bind(this);
this.listeners.push(["click",this.onCheckboxInputClickDelegate,!1]);this.listeners.push(["change",this.onCheckboxInputChangeDelegate,!1])},initTextInput:function(){var c=!1,a=this,b=a.listeners,e;Tb()||(b.push(["compositionstart",function(){c=!0},!1]),b.push(["compositionend",function(){c=!1;d()},!1]));var d=a.onTextInputChangeDelegate=function(b){if(!c)a.onTextInputChange(b)},f=function(a){e||(e=setTimeout(function(){d(a);e=null},0))},k=function(a){a=a||window.event;var b=a.keyCode;91===b||15<b&&
19>b||37<=b&&40>=b||f(a)};yb("input")?b.push(["input",d,!1]):(b.push(["keydown",k,!1]),yb("paste")&&(b.push(["paste",f,!1]),b.push(["cut",f,!1])));b.push(["change",d,!1])},processValue:function(c){switch(this.dataType){case "number":case "float":case "double":if(""===c||isNaN(c=parseFloat(c)))c=void 0;break;case "int":case "integer":if(""===c||isNaN(c=parseInt(c,10)))c=void 0;break;case "bool":case "boolean":return!("false"===c||"0"===c||0===c||"off"===c||!1===c||""===c)}return c},onTextInputChange:function(c){c=
this.getValue();this.observable.trigger("change",this.processValue(c))},_checkboxChange:function(){var c=this.el;this.observable.trigger("change",this.processValue(c.checked?z(c,"value")||!0:!1))},onCheckboxInputChange:function(){this.clicked||this._checkboxChange();this.clicked=!1},onCheckboxInputClick:function(){this._checkboxChange();this.clicked=!0},onRadioInputChange:function(c){c=c||window.event;this.observable.trigger("change",this.processValue((c.target||c.srcElement).value))},setValue:function(c){var a=
this.inputType,b;c=this.processValue(c);if("radio"===a){a=this.radio;var e=0;for(b=a.length;e<b;e++)a[e].checked=this.processValue(a[e].value)==c}else"checkbox"===a?(a=this.el,a.checked=!0===c||c==this.processValue(a.value)):(void 0===c&&(c=""),fb(this.el,c));this.triggerChange()},getValue:function(){var c=this.inputType,a;if("radio"===c){c=this.radio;var b=0;for(a=c.length;b<a;b++)if(c[b].checked)return this.processValue(c[b].value);return null}return"checkbox"===c?this.processValue(this.el.checked?
z(this.el,"value")||!0:!1):this.processValue(ua(this.el))},onChange:function(c,a){this.changeInitialized||this.initInputChange();this.observable.on("change",c,a)},unChange:function(c,a){this.observable.un("change",c,a)},onKey:function(c,a,b,e){this.keydownDelegate||(this.keydownDelegate=this.keyHandler.bind(this),this.listeners.push(["keydown",this.keydownDelegate,!1]),O(this.el,"keydown",this.keydownDelegate),this.observable.createEvent("key",{returnResult:!1,triggerFilter:this.keyEventFilter}));
this.observable.on("key",a,b,{key:c,prepend:e})},unKey:function(c,a,b){this.observable.un("key",a,b)},keyEventFilter:function(c,a){c=c.key;a=a[0];return"object"!==typeof c?c===a.keyCode:void 0!==c.ctrlKey&&c.ctrlKey!==a.ctrlKey||void 0!==c.shiftKey&&c.shiftKey!==a.shiftKey?!1:!(void 0!==c.keyCode&&c.keyCode!==a.keyCode)},keyHandler:function(c){c=Z(c||window.event);this.observable.trigger("key",c)},triggerChange:function(){if("createEvent"in document){var c=document.createEvent("HTMLEvents");c.initEvent("change",
!1,!0);this.el.dispatchEvent(c)}else this.el.fireEvent("onchange")}},!0,!1);g.get=function(c,a){return c.$$input?c.$$input:a&&!c.type&&(a=a.$app.getParentCmp(c,!0))&&a.getInputInterface?a.getInputInterface():new g(c)};g.getValue=ua;g.setValue=fb;return g}();y.registerAttribute("bind",1E3,y.$extend({$class:"MetaphorJs.app.Directive.attr.Bind",isInput:!1,input:null,textRenderer:null,observers:null,$init:function(g,c,a,b){a.setType("recursive","bool");a.setType("once","bool",D.MODE_STATIC);this.scope=
g;this.node=c;this.config=a;if(this.isInput=eb(c))this.input=va.get(c),this.input.onChange(this.onInputChange,this);a.setType("locked","bool");a.get("recursive")?(a.disableProperty("value"),a.disableProperty("recursive"),this.textRenderer=new Na(g,a.getExpression("value"),{recursive:!0,fullExpr:!0,once:a.get("once")}),this.textRenderer.subscribe(this.onTextRendererChange,this),this.onTextRendererChange(),g instanceof ta&&g.$on("destroy",this.onScopeDestroy,this)):this.$super(g,c,a)},onInputChange:function(g){var c=
this.config.get("value");if(this.config.get("locked")&&g!=c)this.onChange(c)},onTextRendererChange:function(){this.onChange(this.textRenderer.getString())},onChange:function(g){this.updateElement(g)},updateElement:function(g){this.isInput?this.input.setValue(g):this.node["string"===typeof this.node.textContent?"textContent":"innerText"]=g},onDestroy:function(){this.textRenderer&&(this.textRenderer.$destroy(),this.textRenderer=null);this.input&&(this.input.$destroy(),this.input=null);this.$super()}}));
y.registerAttribute("bind-html",1E3,y.attr.Bind.$extend({$class:"MetaphorJs.app.Directive.attr.BindHtml",updateElement:function(g){this.node.innerHTML=g}}));n.animate=n.animate||{};var Fa=n.animate.getPrefixes=function(){var g=["Moz","Webkit","ms","O","Khtml"],c="animationDelay",a="animationDuration",b="transitionDelay",e="transitionDuration",d="transform",f=null,k=null,h=!1;return function(){if(!h){var m=window.document.createElement("div"),p=!1,F;if(void 0!==m.style.animationName)p=!0;else{var t=
0;for(F=g.length;t<F;t++){var r=g[t];if(void 0!==m.style[r+"AnimationName"]){p=!0;c=r+"AnimationDelay";a=r+"AnimationDuration";b=r+"TransitionDelay";e=r+"TransitionDuration";d=r+"Transform";break}}}p&&("ontransitionend"in window?f="transitionend":"onwebkittransitionend"in window&&(f="webkitTransitionEnd"));k=p?{animationDelay:c,animationDuration:a,transitionDelay:b,transitionDuration:e,transform:d,transitionend:f}:{};h=!0}return k}}(),Vb=n.animate.getDuration=function(){var g=function(a){if(!a)return 0;
var b=parseFloat(a);-1===a.indexOf("ms")&&(b*=1E3);return b},c=function(a,b,d){var c,e=b.length;for(c=0;c<e;c++){var f=g(b[c])+g(d[c]);a=Math.max(f,a)}return a},a=!1,b=null,e=null,d=null,f=null;return function(k){!1===a&&(b=(a=Fa())?a.animationDuration:null,e=a?a.animationDelay:null,d=a?a.transitionDuration:null,f=a?a.transitionDelay:null);if(!a)return 0;var h=window.getComputedStyle?window.getComputedStyle(k,null):k.style;k=0;var m=(h[b]||"").split(","),g=(h[e]||"").split(","),F=(h[d]||"").split(",");
h=(h[f]||"").split(",");k=Math.max(k,c(k,m,g));return k=Math.max(k,c(k,F,h))}}(),zb=n.animate.isCssSupported=function(){var g=null;return function(){null===g&&(g=!!Fa());return g}}(),H=n.lib.Promise=function(){var g=[],c=!1,a="undefined"!==typeof process?process.nextTick:function(a){setTimeout(a,0)},b=function(){c=!0;var d=g.shift();a(function(){d[0].apply(d[1],d[2]);g.length?b():c=!1},0)},e=function(a,d,e){e=e||[];g.push([a,d,e]);c||b()},d=function(a,b){return function(d){try{b.resolve(a(d))}catch(p){b.reject(p)}}},
f=function(a,b){if(a instanceof f)return a;if(!(this instanceof f))return new f(a,b);var d;this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(0<arguments.length)if(d=Y(a))a instanceof f?a.then(this.resolve.bind(this),this.reject.bind(this)):(new f(d,a)).then(this.resolve.bind(this),this.reject.bind(this));else if(B(a))try{a.call(b,this.resolve.bind(this),this.reject.bind(this))}catch(p){this.reject(p)}else this.resolve(a)};q(f.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,
_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0===this._state},isFulfilled:function(){return 1===this._state},isResolved:function(){return 1===this._state},isRejected:function(){return 2===this._state},hasListeners:function(){var a=[this._fulfills,this._rejects,this._dones,this._fails],b;var d=0;for(b=a.length;d<b;d++)if(a[d]&&a[d].length)return!0;return!1},_cleanup:function(){this._fails=this._dones=this._rejects=this._fulfills=null},_processValue:function(a,
b,d){var c;if(0===this._state)if(a===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{if(d)try{if(c=Y(a)){a instanceof f?a.then(this._processResolveValue.bind(this),this._processRejectReason.bind(this)):(new f(c,a)).then(this._processResolveValue.bind(this),this._processRejectReason.bind(this));return}}catch(F){0===this._state&&this._doReject(F);return}b.call(this,a)}},_callResolveHandlers:function(){this._done();for(var a=this._fulfills,b;b=a.shift();)e(b[0],b[1],[this._value]);
this._cleanup()},_doResolve:function(a){this._value=a;this._state=1;0===this._wait&&this._callResolveHandlers()},_processResolveValue:function(a){this._processValue(a,this._doResolve,!0)},resolve:function(a){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(a);return this},_callRejectHandlers:function(){this._fail();for(var a=this._rejects,b;b=a.shift();)e(b[0],b[1],[this._reason]);this._cleanup()},_doReject:function(a){this._state=2;this._reason=a;0===this._wait&&this._callRejectHandlers()},
_processRejectReason:function(a){this._processValue(a,this._doReject,!1)},reject:function(a){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(a);return this},then:function(a,b,c){var h=new f,k=this._state;c&&(a&&(a=a.bind(c)),b&&(b=b.bind(c)));0===k||0!==this._wait?(a&&B(a)?this._fulfills.push([d(a,h),null]):this._fulfills.push([h.resolve,h]),b&&B(b)?this._rejects.push([d(b,h),null]):this._rejects.push([h.reject,h])):1===k?a&&B(a)?e(d(a,h),null,[this._value]):h.resolve(this._value):
2===k&&(b&&B(b)?e(d(b,h),null,[this._reason]):h.reject(this._reason));return h},"catch":function(a){return this.then(null,a)},_done:function(){for(var a=this._dones,b;b=a.shift();)try{b[0].call(b[1]||null,this._value)}catch(m){T(m)}},done:function(a,b){var d=this._state;if(1===d&&0===this._wait)try{a.call(b||null,this._value)}catch(p){T(p)}else 0===d&&this._dones.push([a,b]);return this},_fail:function(){for(var a=this._fails,b;b=a.shift();)try{b[0].call(b[1]||null,this._reason)}catch(m){T(m)}},fail:function(a,
b){var d=this._state;if(2===d&&0===this._wait)try{a.call(b||null,this._reason)}catch(p){T(p)}else 0===d&&this._fails.push([a,b]);return this},always:function(a,b){this.done(a,b);this.fail(a,b);return this},promise:function(){return{then:this.then.bind(this),done:this.done.bind(this),fail:this.fail.bind(this),always:this.always.bind(this),"catch":this["catch"].bind(this)}},after:function(a){var b=this;if(Y(a)){b._wait++;var d=function(){b._wait--;0===b._wait&&0!==b._state&&(1===b._state?b._callResolveHandlers():
b._callRejectHandlers())};B(a.done)?a.done(d):a.then(d)}return b}},!0,!1);f.fcall=function(a,b,d){return f.resolve(a.apply(b,d||[]))};f.resolve=function(a){var b=new f;b.resolve(a);return b};f.reject=function(a){var b=new f;b.reject(a);return b};f.all=function(a){if(!a.length)return f.resolve(null);var b=new f,d=a.length,c=Array(d),e=d,k,g,v=function(a,d){c[d]=a;e--;0===e&&b.resolve(c)};for(k=0;k<d;k++)(function(d){g=a[k];g instanceof f?g.done(function(a){v(a,d)}).fail(b.reject,b):Y(g)||B(g)?(new f(g)).done(function(a){v(a,
d)}).fail(b.reject,b):v(g,d)})(k);return b};f.when=function(){return f.all(arguments)};f.allResolved=function(a){if(!a.length)return f.resolve(null);var b=new f,d=a.length,c=[],e=d,k,g=function(a){c.push(a);v()},v=function(){e--;0===e&&b.resolve(c)};for(k=0;k<d;k++){var A=a[k];A instanceof f?A.done(g).fail(v):Y(A)||B(A)?(new f(A)).done(g).fail(v):g(A)}return b};f.race=function(a){if(!a.length)return f.resolve(null);var b=new f,d=a.length,c;for(c=0;c<d;c++){var e=a[c];e instanceof f?e.done(b.resolve,
b).fail(b.reject,b):Y(e)||B(e)?(new f(e)).done(b.resolve,b).fail(b.reject,b):b.resolve(e);if(!b.isPending())break}return b};f.waterfall=function(a){if(!a.length)return f.resolve(null);var b=a.shift();b=B(b)?f.fcall(b):f.resolve(d);for(var d;d=a.shift();)Y(d)?b=b.then(function(a){return function(){return a}}(d)):B(d)?b=b.then(d):b.resolve(d);return b};f.forEach=function(a,b,d,c){var e=a.slice(),h=new f,k=[],m=0,g=function(){if(e.length){var a=e.shift(),p=m;m++;f.fcall(b,d,[a,p]).done(function(a){k.push(a);
g()}).fail(function(a){c?h.reject(a):(k.push(null),g())})}else h.resolve(k)};g();return h};f.counter=function(a){var b=new f;b.countdown=function(){a--;0===a&&b.resolve()};return b};return f}(),P=n.dom.data=function(){var g={};return function(c,a,b,e){c=c._mjsid||(c._mjsid=W());var d=g[c];if("remove"===e)a?d&&delete d[a]:delete g[c];else return void 0!==b?(d||(d=g[c]={}),d[a]=b):d?d[a]:void 0}}(),Ab=n.dom.getClsReg=function(g){return Ta("(?:^|\\s)"+g+"(?!\\S)")},Va=n.dom.hasClass=function(g,c){return c?
Ab(c).test(g.className):!1},N=n.dom.addClass=function(g,c){c&&!Va(g,c)&&(g.className+=" "+c)},S=n.dom.removeClass=function(g,c){c&&(g.className=g.className.replace(Ab(c),""))},U=function(){if("undefined"!==typeof window){var g=window;var c=g.requestAnimationFrame||g.webkitRequestAnimationFrame||g.mozRequestAnimationFrame;var a=g.cancelAnimationFrame||g.webkitCancelAnimationFrame||g.mozCancelAnimationFrame||g.webkitCancelRequestAnimationFrame;if(c)return function(b,e,d){var f=c(e||d?function(){b.apply(e,
d||[])}:b);return function(){a(f)}}}return function(a,c,d){var b=V(a,c,d,0);return function(){clearTimeout(b)}}}(),fa=n.animate.animate=function(){var g={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},c=0,a=function(a,b,c){var d=function(){(new Date).getTime()-b>=c?a():U(d)};U(d)},b=function v(c,e,h,m,g,F,t,r){var f=function(){var a=P(c,"mjsAnimationQueue");return a&&a.length&&a[0].id==t?!1:(g.reject(c),!0)},k=function(){if(!f()){var a=h;h++;if(h===
e.length){g.resolve(c);P(c,"mjsAnimationQueue").shift();var k=P(c,"mjsAnimationQueue");k.length?(k=k[0],b(k.el,k.stages,0,k.start,k.deferred,!1,k.id,k.step)):P(c,"mjsAnimationQueue",null)}else P(c,"mjsAnimationQueue")[0].position=h,v(c,e,h,null,g,!1,t,r);S(c,e[a]);S(c,e[a]+"-active")}},p=function(){f()||(N(c,e[h]+"-active"),H.resolve(r&&r(c,h,"active")).done(function(){if(!f()){var b=Vb(c);b?a(k,(new Date).getTime(),b):U(k)}}))},n=function(){f()||(N(c,e[h]),H.waterfall([r&&r(c,h,"start"),function(){return m?
m(c):null}]).done(function(){!f()&&U(p)}))};F?U(n):n()},e=function(a,e,h,m){var f=new H,k=P(a,"mjsAnimationQueue")||[],t=++c;if(e){if(w(e))var r=g[e];else if(B(e))var v=e;else if(I(e))if(w(e[0]))r=e;else{var n=e[0];var E=e[1]}if(ia(e)){r=e.stages;v=e.fn;n=e.before;E=e.after;var u=e.options?q({},e.options):{};var x=e.context||null;var K=e.duration||null;h=h||u.start}if(zb()&&r)return k.push({el:a,stages:r,start:h,step:m,deferred:f,position:0,id:t}),P(a,"mjsAnimationQueue",k),1===k.length&&b(a,r,0,
h,f,!0,t,m),f;u=u||{};h&&(u.start=function(){h(a)});u.complete=function(){f.resolve(a)};K&&(u.duration=K);if(v&&B(v))return n&&q(a.style,n,!0,!1),h&&h(a),P(a,"mjsAnimationQueue",v.call(x,a,function(){f.resolve(a)})),f;if(window.jQuery){e=$(a);n&&e.css(n);P(a,"mjsAnimationQueue","stop");if(v&&w(v))return e[v](u),f;if(E)return e.animate(E,u),f}}h?(v=h(a),Y(v)?v.done(function(){f.resolve(a)}):f.resolve(a)):f.resolve(a);return f};e.addAnimationType=function(a,b){g[a]=b};return e}(),wa=n.animate.stop=
function(g){var c=P(g,"mjsAnimationQueue");if(I(c)&&c.length){if(c=c[0]){if(c.stages){var a=c.position;var b=c.stages;S(g,b[a]);S(g,b[a]+"-active")}c.deferred&&c.deferred.reject(c.el)}}else B(c)?c(g):"stop"===c&&$(g).stop(!0,!0);P(g,"mjsAnimationQueue",null)};(function(){var g=function(c,a,b,e){if(null!==b){if(b===Va(c,a))return;b=!b}else b=Va(c,a);b?e?fa(c,[a+"-remove"]).done(function(){S(c,a)}):S(c,a):e?fa(c,[a+"-add"]).done(function(){N(c,a)}):N(c,a)};y.registerAttribute("class",1E3,y.$extend({$class:"MetaphorJs.app.Directive.attr.Class",
initial:!0,prev:null,$init:function(c,a,b,e,d){b.setType("animate","bool");b.eachProperty(function(a){if("value"===a||0===a.indexOf("value."))b.on(a,self.onChange,self)});this.$super(c,a,b,e,d)},getCurrentValue:function(){var c=this.config.getAllValues(),a=[];c[""]&&(a.push(c[""]),delete c[""]);a.push(c);c={};var b,e;var d=0;for(b=a.length;d<b;d++){var f=a[d];if("string"===typeof f)c[f]=!0;else{if(I(f)){var k=-1;for(e=f.length;++k<e;c[f[k]]=!0);}for(k in f)if("_"===k)for(k=-1,e=f._.length;++k<e;c[f._[k]]=
!0);else c[k]=f[k]}}return c},onChange:function(){var c=this.node,a=this.getCurrentValue(),b=this.prev,e;wa(c);if(b)for(e in b)b.hasOwnProperty(e)&&void 0===a[e]&&g(c,e,!1,!1);for(e in a)a.hasOwnProperty(e)&&g(c,e,!!a[e],!this.initial&&this.config.get("animate"));this.prev=a;this.initial=!1}}))})();n.app=n.app||{};var Bb=n.lib.Provider=function(){var g=function(){this.store={}};q(g.prototype,{store:null,instantiate:function(a,b,c,d){return a.$instantiate?a.$instantiate.apply(a,c):d?sb(a,c):a.apply(b,
c)},inject:function(a,b,c,d,f){c=c||{};d=d||[];var e=this;if(B(a))if(a.inject)d=a.inject.slice(),d.push(a),a=d;else return e.instantiate(a,b,d,f);else{if(w(a))return e.resolve(a,c);a=a.slice()}d=[];var h=a.pop(),m;var g=-1;for(m=a.length;++g<m;d.push(e.resolve(a[g],c)));return H.all(d).then(function(a){return e.instantiate(h,b,a,f)})},value:function(a,b){this.store[a]={type:1,value:b}},constant:function(a,b){var c=this.store;c[a]||(c[a]={type:2,value:b})},factory:function(a,b,c,d){sa(c)&&(d=c,c=null);
this.store[a]={type:3,singleton:d,fn:b,context:c}},service:function(a,b,c){this.store[a]={type:4,singleton:c,fn:b}},provider:function(a,b){this.store[a+"Provider"]={name:a,type:5,fn:b,instance:null}},resolve:function(a,b,e){var d=this.store,f;b=b||{};e=e||[];if(void 0!==b[a])return b[a];if(f=d[a]){var k=f.type;if(1===k||2===k)return f.value;if(3===k)var h=this.inject(f.fn,f.context,b,e);else if(4===k)h=this.inject(f.fn,null,b,e,!0);else if(5===k)return f.instance||(f.instance=H.resolve(this.inject(f.fn,
null,b)).done(function(a){f.instance=a;d[f.name]={type:3,fn:a.$get,context:a}})),f.instance;f.singleton&&(f.type=1,f.value=h,3===k&&Y(h)&&h.done(function(a){f.value=a}));return b[a]=h}if(d[a+"Provider"])return this.resolve(a+"Provider",b),this.resolve(a,b);if(this===c)throw Error("Could not provide value for "+a);return c.resolve(a)},$destroy:function(){this.store=null}},!0,!1);g.global=function(){return c};var c=new g;return g}(),ea=n.dom.toFragment=function(g,c){c=(c||window.document).createDocumentFragment();
var a;if(w(g)){var b=window.document.createElement("div");b.innerHTML=g;g=b.childNodes}if(!g)return c;if(g.nodeType)c.appendChild(g);else{if(g.item){var e=g;g=[];b=-1;for(a=e.length>>>0;++b!==a;g.push(e[b]));}b=-1;for(a=g.length;++b!==a;c.appendChild(g[b]));}return c},Pa=n.dom.clone=function a(c){var b;if(I(c)){var e=[];var d=0;for(b=c.length;d<b;d++)e.push(a(c[d]));return e}if(c)switch(c.nodeType){case 1:return c.cloneNode(!0);case 3:return window.document.createTextNode(c.innerText||c.textContent);
case 11:return c.cloneNode(!0)}return null},Cb=n.dom.getAttrSet=function(){var c=/^([\[({#$])([^)\]}"':\*]+)[\])}]?([:\*!]?)$/,a=function(a,b){if(this.inflated)delete this.directive[b];else{this.directive[b]&&this.directive[b].original&&ka(a,this.directive[b].original);var d,c=this.names[b];if(c){var e=0;for(d=c.length;e<d;e++)ka(a,c[e]);delete this.names[b]}}},b={"*":D.MODE_DYNAMIC,":":D.MODE_STATIC,"!":D.MODE_SINGLE,"":null},e={"{":"dir","(":"event","[":"attr",$:"cfg"},d=function(){return{directive:{},
attribute:{},config:{},rest:{},reference:null,names:{},removeDirective:a}};return function(a){var f=d(),h,m,p=I(a)?a:a.attributes;if(a.nodeType&&a.hasAttribute&&a.hasAttribute("mjs"))return a=f=n.prebuilt.configs[a.getAttribute("mjs")],q(a,d(),!1,!1),a.inflated=!0,f;var F=0;for(h=p.length;F<h;F++){var t=p[F].name;var r=p[F].value;var v=null;if(m=t.match(c)){t=m[2];var A=m[1];v=b[m[3]];if("#"===A){f.reference=t;continue}}else if("mjs-"===t.substr(0,4))t=t.substr(4),A="{";else{f.rest[t]=r;continue}var E=
t.split(".");t=E.shift();if("$"===A)""===r&&(r=!0),m=a.tagName.toLowerCase(),f.config[ab(t)]={expression:r,mode:v,dtype:e[A]},f.names[m]||(f.names[m]=[]),f.names[m].push(p[F].name);else if("("===A||"{"===A){m=f.directive;var u=E.length?E[0]:null;m[t]||(m[t]={original:null,config:{},dtype:e[A]});u||(m[t].original=p[F].name);u&&!f.names[t]&&(f.names[t]=[]);u&&"$"===u[0]?(""===r&&(r=!0),A=ab(u.substr(1)),m[t].config[A]={mode:v,expression:r,original:p[F].name},f.names[t].push(p[F].name)):u?(A="value."+
E.join("."),m[t].config[A]={mode:v,expression:r,original:p[F].name},f.names[t].push(p[F].name)):m[t].config.value={mode:v,expression:r,original:p[F].name}}else"["===A&&(f.attribute[t]={value:r,original:p[F].name})}return f}}(),hb=n.app.Renderer=function(){var c=null,a=n.directive,b=function(a,b,d,c,e,h){var k=[];if(a&&!0!==a){if(a.nodeType){h.countdown+=1;f(a,d,c,e,h);return}k=a.slice()}k.length||(k=X(b.childNodes||b));b=k.length;h.countdown+=b;for(a=-1;++a<b;f(k[a],d,c,e,h));},e=function(a,b){if(b)if(b.nodeType)a.push(b);
else if(I(b))for(var d=-1,c=b.length;++d<c;e(a,b[d]));},d={script:!0,template:!0,"mjs-template":!0,style:!0,link:!0},f=function(a,c,e,f,h){if(a){var k=a.nodeName;h||(h={countdown:1});if(!k||!d[k.toLowerCase()])if(k=c.call(e,a),!1!==k){if(Y(k)){k.done(function(d){!1!==d&&b(d,a,c,e,f,h);0===--h.countdown&&f&&f.call(e)});return}b(k,a,c,e,f,h)}0===--h.countdown&&f&&f.call(e)}},k=new la,h=function(a,b,d,c){this.id=W();this.el=a;this.scope=b;this.texts=[];this.parent=d;this.passedAttrs=c;b instanceof ta&&
b.$on("destroy",this.$destroy,this);if(d)d.on("destroy",this.$destroy,this)};q(h.prototype,{id:null,el:null,scope:null,texts:null,parent:null,passedAttrs:null,reportFirstNode:!0,on:function(a,b,d){return k.on(a+"-"+this.id,b,d)},once:function(a,b,d){return k.once(a+"-"+this.id,b,d)},un:function(a,b,d){return k.un(a+"-"+this.id,b,d)},createChild:function(a){return new h(a,this.scope,this)},getEl:function(){return this.el},runHandler:function(a,b,d,c,e){var f=a.$isolateScope?b.$newIsolated():a.$breakScope?
b.$new():b,h=b.$app,k={$scope:f,$node:d,$nodeConfig:c,$attrSet:e,$renderer:this};c=[f,d,c,this,e];e.reference&&(f[e.reference]=d);d=h?h.inject(a,null,k,c):a.$instantiate?a.$instantiate.apply(a,c):a.apply(null,c);h&&a.$registerBy&&d&&(Y(d)?d.done(function(d){h.registerCmp(d,b,a.$registerBy)}):h.registerCmp(d,b,a.$registerBy));if(d&&d.$destroy)this.on("destroy",d.$destroy,d);else if("function"===typeof d)this.on("destroy",d);return a.$stopRenderer?!1:d&&d.getChildren?d.getChildren():d},processNode:function(b){var d=
b.nodeType,f=this.texts,h=this.scope;if(3===d)h=b.textContent||b.nodeValue,Na.applicable(h)&&(h=new Na(this.scope,h),h.subscribe(this.onTextChange,this,{append:[f.length]}),f.push({node:b,tr:h}),this.renderText(f.length-1));else if(1===d){this.reportFirstNode&&(k.trigger("first-node-"+this.id,b),this.reportFirstNode=!1);c||(c=y.getAttributes());var m=b.tagName.toLowerCase();d=[];var v=[],n,E;var u=!1;"mjs-"===m.substr(0,4)&&(m=m.substr(4));var x=Cb(b);if(x.config.ignore)return!1;var K=new D(x.config,
{scope:this.scope});this.passedAttrs&&(x.directive=q({},x.directive,this.passedAttrs.directive,!0,!0),this.passedAttrs=null);if(K=a.component[m])if(m=(x.config.as?x.config.as.expression:null)||K.tag){x.directive.cmp={name:"cmp",original:"{cmp}",config:q({},x.config,{value:{mode:D.MODE_STATIC,expression:K.prototype.$class}})};m=window.document.createElement(m);for(b.parentNode.replaceChild(m,b);b.firstChild;)m.appendChild(b.firstChild);b=m;for(w in x.rest)M(b,w,x.rest[w])}else{var w=a.attr.cmp;u=q({},
x);delete u.directive.cmp;x.config.passAttrs=u;K=new D(q({},x.config,{value:{mode:D.MODE_STATIC,expression:K}},!0,!1),{scope:this.scope,deferInit:!0});this.on("destroy",K.$destroy,K);w=this.runHandler(w,h,b,K,x);u=!0;if(!1===w)return!1;Y(w)?d.push(w):e(v,w)}else if(w=a.tag[m]){K=new D(x.config,{scope:this.scope,deferInit:!0});this.on("destroy",K.$destroy,K);w=this.runHandler(w,h,b,K,x);u=!0;x.removeDirective(b,m);if(!1===w)return!1;Y(w)?d.push(w):e(v,w)}m=0;for(n=c.length;m<n;m++)if(w=c[m].name,void 0!==
(E=x.directive[w])&&!E.handled){u=c[m].handler;u.$keepAttribute||ka(b,E.original);x.removeDirective(b,w);K=new D(E.config,{scope:this.scope});this.on("destroy",K.$destroy,K);w=this.runHandler(u,h,b,K,x);u=!0;E.handled=!0;if(!1===w)return!1;Y(w)?d.push(w):e(v,w)}!u&&x.reference&&(h[x.reference]=b);if(d.length&&!x.config.ignoreInside){var z=new H;H.all(d).done(function(a){e(v,a);z.resolve(v)});return z}for(m in x.attribute)h=x.attribute[m].value,h=new Na(this.scope,h,{recursive:!!x.config.recursive,
fullExpr:!Na.applicable(h)}),ka(b,x.attribute[m].original),h.subscribe(this.onTextChange,this,{append:[f.length]}),f.push({node:b,attr:m,tr:h}),this.renderText(f.length-1);return x.config.ignoreInside?d.length?(z=new H,H.all(d).done(function(){return z.resolve(!1)}),z):!1:v.length?v:!0}return!0},process:function(){this.el.nodeType?f(this.el,this.processNode,this,this.onProcessingFinished,{countdown:1}):b(null,this.el,this.processNode,this,this.onProcessingFinished,{countdown:0})},onProcessingFinished:function(){k.trigger("rendered-"+
this.id,this)},onTextChange:function(a,b){this.renderText(b)},renderText:function(a){a=this.texts[a];var b=a.tr.getString(),d=a.attr;d?("value"===d?a.node.value=b:"class"===d?a.node.className=b:"src"===d&&(a.node.src=b),M(a.node,d,b)):a.node.nodeValue=b},$destroy:function(){var a=this.texts,b;var d=-1;for(b=a.length;++d<b;a[d].tr.$destroy());this.parent&&this.parent.un("destroy",this.$destroy,this);k.trigger("destroy-"+this.id)}});h.skip=function(a,b){d[a]=b};return h}(),Wb=n.mixin.Promise={$$promise:null,
$beforeInit:function(){this.$$promise=new H},then:function(){return this.$$promise.then.apply(this.$$promise,arguments)},done:function(){this.$$promise.done.apply(this.$$promise,arguments);return this},always:function(){this.$$promise.always.apply(this.$$promise,arguments);return this},fail:function(){this.$$promise.fail.apply(this.$$promise,arguments);return this}};n.ajax=n.ajax||{transport:{}};var Db=n.ajax.serializeParam=function(){function c(a,d,f){var e;if(I(d)){var h=0;for(e=d.length;h<e;h++){var m=
d[h];b.test(a)?f(a,m):c(a+"["+("object"===typeof m?h:"")+"]",m,f)}}else if(ia(d))for(h in d)c(a+"["+h+"]",d[h],f);else f(a,d)}var a=/%20/g,b=/\[\]$/;return function(b){var d,e=[],k=function(a,b){b=B(b)?b():null==b?"":b;e[e.length]=encodeURIComponent(a)+"="+encodeURIComponent(b)};for(d in b)c(d,b[d],k);return e.join("&").replace(a,"+")}}(),Xb=n.ajax.transport.XHR=function(){var c={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",
text:"text/plain",_default:"*/*"};return C({type:"xhr",_xhr:null,_deferred:null,_ajax:null,$init:function(a,b,c){var d;window.XMLHttpRequest&&(d=new XMLHttpRequest)||(d=new ActiveXObject("Msxml2.XMLHTTP"));this._xhr=d;this._deferred=b;this._opt=a;this._ajax=c;a.progress&&(d.onprogress=a.progress.bind(a.context));a.uploadProgress&&d.upload&&(d.upload.onprogress=a.uploadProgress.bind(a.context));d.onreadystatechange=this.onReadyStateChange.bind(this)},setHeaders:function(){var a=this._opt,b=this._xhr,
e;if(a.xhrFields)for(e in a.xhrFields)b[e]=a.xhrFields[e];a.data&&a.contentType&&b.setRequestHeader("Content-Type",a.contentTypeHeader||a.contentType);b.setRequestHeader("X-Requested-With","XMLHttpRequest");b.setRequestHeader("Accept",a.dataType&&c[a.dataType]?c[a.dataType]+", */*; q=0.01":c._default);for(e in a.headers)b.setRequestHeader(e,a.headers[e])},onReadyStateChange:function(){var a=this._xhr,b=this._deferred;if(0===a.readyState)a.onreadystatechange=J,b.resolve(a);else if(4===a.readyState){a.onreadystatechange=
J;a:{try{var c=!a.status&&location&&"file:"===location.protocol||200<=a.status&&300>a.status||304===a.status||1223===a.status;break a}catch(d){T(d)}c=!1}if(c)this._ajax.processResponse(w(a.responseText)?a.responseText:void 0,a.getResponseHeader("content-type")||"");else{a.responseData=null;try{a.responseData=this._ajax.returnResponse(w(a.responseText)?a.responseText:void 0,a.getResponseHeader("content-type")||"")}catch(d){T(thrownError)}b.reject(a)}}},abort:function(){this._xhr.onreadystatechange=
J;this._xhr.abort()},send:function(){var a=this._opt;try{this._xhr.open(a.method,a.url,!0,a.username,a.password),this.setHeaders(),this._xhr.send(a.data)}catch(b){T(b),this._deferred&&this._deferred.reject(b)}}})}(),Yb=n.ajax.transport.Script=C({type:"script",_opt:null,_deferred:null,_ajax:null,_el:null,$init:function(c,a,b){this._opt=c;this._ajax=b;this._deferred=a},send:function(){var c=document.createElement("script");M(c,"async","async");M(c,"charset","utf-8");M(c,"src",this._opt.url);O(c,"load",
this.onLoad.bind(this));O(c,"error",this.onError.bind(this));document.head.appendChild(c);this._el=c},onLoad:function(c){this._deferred&&this._deferred.resolve(c)},onError:function(c){this._deferred.reject(c)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},onDestroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)}}),Zb=n.ajax.transport.IFrame=C({type:"iframe",_opt:null,_deferred:null,_ajax:null,_el:null,_sent:!1,$init:function(c,a,b){this._opt=
c;this._ajax=b;this._deferred=a},send:function(){var c=this,a=document.createElement("iframe"),b="frame-"+W(),e=c._opt.form;M(a,"id",b);M(a,"name",b);a.style.display="none";document.body.appendChild(a);M(e,"action",c._opt.url);M(e,"target",b);O(a,"load",c.onLoad.bind(c));O(a,"error",c.onError.bind(c));c._el=a;var d=0,f=function(){d++;try{e.submit(),c._sent=!0}catch(k){T(k),2<d?c._deferred.reject(k):V(f,null,[],1E3)}};f()},onLoad:function(){var c=this._el;if(this._sent&&this._opt&&!this._opt.jsonp)try{var a=
c.contentDocument||c.contentWindow.document;var b=a.body.innerHTML;this._ajax.processResponse(b)}catch(e){T(e),this._deferred.reject(e)}},onError:function(c){this._sent&&this._deferred.reject(c)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},onDestroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)}}),Ga=n.ajax.Ajax=function(){var c=/\?/,a=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,b=/#.*$/,e=/([?&])_=[^&]*/,d=new la,f=
!(!window||!window.FormData),k=function(a,b,d){var c=b?b.dataType:null;b=b?b.selector:null;if(!w(a))return a;d=d||"";if("xml"===c||!c&&0<=d.indexOf("xml"))return a=tb(a.trim()),b?L(b,a):a;if("html"===c)return a=tb(a,"text/html"),b?L(b,a):a;if("fragment"==c){d=document.createDocumentFragment();c=document.createElement("div");for(c.innerHTML=a;c.firstChild;)d.appendChild(c.firstChild);return d}if("json"===c||!c&&0<=d.indexOf("json"))return JSON.parse(a.trim());("script"===c||!c&&0<=d.indexOf("javascript"))&&
t(a);return a+""},h=function(a){return"/"==a.substr(0,1)?location.protocol+"//"+location.host+a:a},m=function(a,d){a.replace(b,"");if(!d.allowCache){var h=(new Date).getTime();a=e.test(a)?a.replace(e,"$1_="+h):a+(c.test(a)?"&":"?")+"_="+h}!d.data||"POST"==d.method||d.contentType||f&&d.data instanceof window.FormData||(d.data=w(d.data)?d.data:Db(d.data),a+=(c.test(a)?"&":"?")+d.data,d.data=null);return a},p=function(a,b,d){var c;if(!La(a)&&!B(a)&&d){var e=document.createElement("input");M(e,"type",
"hidden");M(e,"name",d);M(e,"value",a);b.appendChild(e)}else if(I(a)&&d)for(e=0,c=a.length;e<c;e++)p(a[e],b,d+"["+e+"]");else if(La(a))for(e in a)a.hasOwnProperty(e)&&p(a[e],b,d?d+"["+e+"]":e)},F=function(a){for(var b,d,c={},e=0;e<a.elements.length;e++)if(b=a.elements[e],null!==z(b,"name"))if(d="INPUT"===b.nodeName.toUpperCase()?z(b,"type").toUpperCase():"TEXT","FILE"===d)for(d=0;d<b.files.length;c[b.name]=b.files[d++].name);else if("RADIO"!==d&&"CHECKBOX"!==d||b.checked)c[b.name]=b.value;return Db(c)},
t=function(a){var b=eval;a&&(/^[^\S]*use strict/.test(a)?(b=document.createElement("script"),b.text=a,document.head.appendChild(b).parentNode.removeChild(b)):b(a))};return C({$mixins:[Wb],_jsonpName:null,_transport:null,_opt:null,_deferred:null,_promise:null,_timeout:null,_form:null,_removeForm:!1,$init:function(b){b.url&&(b.url=h(b.url));var c=a.exec((window?window.location.href:"").toLowerCase())||[],e=a.exec(b.url.toLowerCase());this._opt=b;!0!==b.crossDomain&&!0!==b.ignoreCrossDomain&&(b.crossDomain=
!(!e||e[1]===c[1]&&e[2]===c[2]&&(e[3]||("http:"===e[1]?"80":"443"))===(c[3]||("http:"===c[1]?"80":"443"))));var k;b.files&&!f&&(b.transport="iframe");"iframe"!=b.transport||b.form?b.form&&(this._form=b.form,"POST"!=b.method||f||(b.transport="iframe")):(this.createForm(),b.form=this._form);if(b.form&&"iframe"!=b.transport&&"POST"==b.method)f?b.data=new FormData(b.form):(b.contentType="application/x-www-form-urlencoded",b.data=F(b.form));else if("json"===b.contentType)b.contentType=b.contentTypeHeader||
"text/plain",b.data=w(b.data)?b.data:JSON.stringify(b.data);else if(ia(b.data)&&"POST"==b.method&&f)for(k in c=b.data,b.data=new FormData,c)b.data.append(k,c[k]);b.files&&this.importFiles();b.url=m(b.url,b);this._transport=k=!b.crossDomain&&"script"!=b.transport||b.form?"iframe"==b.transport?new Zb(b,this.$$promise,this):new Xb(b,this.$$promise,this):new Yb(b,this.$$promise,this);this.$$promise.done(function(a){d.trigger("success",a)});this.$$promise.fail(function(a){d.trigger("error",a)});this.$$promise.always(function(){d.trigger("end")});
d.trigger("start");b.timeout&&(this._timeout=setTimeout(this.onTimeout.bind(this),b.timeout));b.jsonp&&this.createJsonp();!1===d.trigger("before-send",b,k)&&this.$$promise.reject();b.beforeSend&&!1===b.beforeSend.call(b.context,b,k)&&this.$$promise.reject();this.$$promise.isPending()?(V(k.send,k),this.$$promise.always(this.asyncDestroy,this)):V(this.asyncDestroy,this,[],1E3)},asyncDestroy:function(){this.$isDestroyed()||(this.$$promise.hasListeners()?V(this.asyncDestroy,this,[],1E3):this.$destroy())},
abort:function(a){this.$$promise.reject(a||"abort");this._transport.abort();return this},onTimeout:function(){this.abort("timeout")},getTransport:function(){return this._transport},createForm:function(){var a=document.createElement("form");a.style.display="none";M(a,"method",this._opt.method);M(a,"enctype","multipart/form-data");p(this._opt.data,a,null);document.body.appendChild(a);this._form=a;this._removeForm=!0},importFiles:function(){var a=this._opt,b=a.files,d=this._form;a=a.data;var c,e;var f=
0;for(c=b.length;f<c;f++){var h=b[f];if(I(h)){var k=h[0];h=h[1]}else k=window.File&&h instanceof File?h.uploadName||"upload"+(1<c?"[]":""):h.name||"upload"+(1<c?"[]":"");if(!(window.File&&h instanceof File)){var m=h;h=null}if(d)m&&d.appendChild(m);else if(h)a.append(k,h);else if(m.files&&m.files.length)for(h=0,e=m.files.length;h<e;h++)a.append(k,m.files[h])}},createJsonp:function(){var a=this._opt,b=a.jsonpParam||"callback",d=a.jsonpCallback||"jsonp_"+W();a.url+=(c.test(a.url)?"&":"?")+b+"="+d;this._jsonpName=
d;"undefined"!=typeof window&&(window[d]=this.jsonpCallback.bind(this));"undefined"!=typeof global&&(global[d]=this.jsonpCallback.bind(this));return d},jsonpCallback:function(a){try{var b=this.processResponseData(a)}catch(A){T(A);this.$$promise&&this.$$promise.reject(A);return}this.$$promise&&this.$$promise.resolve(b)},processResponseData:function(a,b){var c=this._opt;a=k(a,c,b);d.hasListener("process-response")&&d.trigger("process-response",a,this.$$promise);c.processResponse&&(a=c.processResponse.call(c.context,
a,this.$$promise));return a},returnResponse:function(a,b){return this._opt.jsonp?null:this.processResponseData(a,b)},processResponse:function(a,b){var d=this.$$promise;if(this._opt.jsonp)if(a){try{t(a)}catch(u){T(u),d.reject(u)}d.isPending()&&d.reject(Error("jsonp script didn't invoke callback"))}else d.reject(Error("jsonp script is empty"));else{try{var c=this.processResponseData(a,b)}catch(u){T(u);d.reject(u);return}d.resolve(c)}},onDestroy:function(){this._timeout&&clearTimeout(this._timeout);
this._form&&this._form.parentNode&&this._removeForm&&this._form.parentNode.removeChild(this._form);this._transport.$destroy();this._jsonpName&&("undefined"!=typeof window&&delete window[this._jsonpName],"undefined"!=typeof global&&delete global[this._jsonpName])}},{prepareUrl:m,global:d})}(),Ha=function(){var c={url:null,data:null,method:"GET",headers:null,username:null,password:null,dataType:null,timeout:0,contentType:null,contentTypeHeader:null,xhrFields:null,jsonp:!1,jsonpParam:null,jsonpCallback:null,
transport:null,replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,context:null,files:null},a={},b=function(b,d){d=d||{};b&&!w(b)?d=b:d.url=b;if(!d.url&&(d.form&&(d.url=z(d.form,"action")),!d.url))throw Error("Must provide url");q(d,a,!1,!0);q(d,c,!1,!0);d.method=d.method?d.method.toUpperCase():d.form?z(d.form,"method").toUpperCase()||"GET":"GET";return new Ga(d)};b.setup=function(b){q(a,b,!0,!0)};b.on=function(){Ga.global.on.apply(Ga.global,arguments)};
b.un=function(){Ga.global.un.apply(Ga.global,arguments)};b.get=function(a,d){d=d||{};d.method="GET";return b(a,d)};b.post=function(a,d){d=d||{};d.method="POST";return b(a,d)};b.load=function(a,d,c){c=c||{};w(d)||(c=d);c.dataType="fragment";return b(d,c).done(function(b){if(c.replace)for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(b)})};b.loadScript=function(a){return b(a,{transport:"script"})};b.submit=function(a,d){d=d||{};d.form=a;return b(null,d)};b.prepareUrl=function(a,b){return Ga.prepareUrl(a,
b||{})};return b}(),Ia=n.app.Template=function(){var c=new la,a=new Da,b={},e=function(a,b){a=d(b.trim());if(!a)return"";if("string"===typeof a)return a;b=window.document.createElement("div");b.appendChild(Pa(a));return b.innerHTML},d=function(d){var c=a.get(d),f=b[d]||{};"function"===typeof c&&(c=c(d));if("string"!==typeof c||f.text)c&&c.nodeType&&11!==c.nodeType&&(c="content"in c?c.content:ea(c.childNodes),a.add(d,c));else{if(!f.processed){if("\x3c!--{"===c.substr(0,5)){var h=c.indexOf("--\x3e");
f=G.get(c.substr(4,h-4),{});b[d]=f;c=c.substr(h+3)}b[d]||(b[d]={});f=b[d];f.processed=!0;f.includes&&(c=c.replace(/\x3c!--\s*include (.+?)--\x3e/ig,e));c=f.text?c:ea(c)}c=ea(c);a.add(d,c)}return c},f=function(a){var d;if(d=n.prebuilt.templates[a])return delete n.prebuilt.templates[a],n.prebuilt.templateOptions[a]&&(b[a]=n.prebuilt.templateOptions[a],delete n.prebuilt.templateOptions[a]),d},k=function(b){return a.exists(b)?a.get(b):a.add(b,Ha(b,{dataType:"fragment"}).then(function(d){return a.add(b,
d)}))};n.prebuilt&&n.prebuilt.templates&&a.addFinder(f);a.addFinder(function(a){a=window.document.getElementById(a);if(a){var b=a.tagName.toLowerCase();return"script"===b?(b=a.innerHTML,a.parentNode.removeChild(a),b):a}});return C({_watcher:null,_tpl:null,_renderer:null,_initial:!0,_fragment:null,_id:null,_originalNode:null,_intendedShadow:!1,_prevEl:null,_nextEl:null,scope:null,node:null,tpl:null,url:null,html:null,ownRenderer:!0,initPromise:null,tplPromise:null,parentRenderer:null,deferRendering:!1,
replace:!1,shadow:!1,animate:!1,passAttrs:null,$init:function(a){q(this,a,!0,!1);window.document.documentElement.createShadowRoot||(this._intendedShadow=this.shadow,this.shadow=!1);this.id=W();this.scope||(this.scope=new ta);c.createEvent("rendered-"+this.id,{returnResult:!1,autoTrigger:!0});this.tpl&&(this.tpl=this.tpl.trim());this.url&&(this.url=this.url.trim());a=this.node;var b=this.tpl||this.url;if(this.replace&&a&&a.parentNode){var d=cb(a,this.id);this._prevEl=d[0];this._nextEl=d[1]}this.shadow&&
(this._originalNode=a,this.node=a=a.createShadowRoot());a||(this.deferRendering=!0);if(b){a&&a.firstChild&&!this.shadow&&P(a,"mjs-transclude",ea(a.childNodes));if("this."===b.substr(0,5)||G.isPrebuiltKey(b))this._watcher=ja.get(this.scope,b,this.onChange,this),a=this._watcher.getValue(),"string"!==typeof a&&q(this,a,!0,!1);this.resolveTemplate();this.deferRendering&&this.ownRenderer||this.tplPromise.done(this.applyTemplate,this)}else this.html?(this._watcher=ja.get(this.scope,this.html,this.onHtmlChange,
this),this.initPromise=new H,this.onHtmlChange()):!this.deferRendering&&this.ownRenderer&&this.doRender();if(this.ownRenderer&&this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,this);this.scope.$on("destroy",this.onScopeDestroy,this)},setAnimation:function(a){this.animate=a},doRender:function(){this._renderer||(this._renderer=new hb(this.node,this.scope,null,this.passAttrs),this._renderer.on("rendered",this.onRendered,this),this._renderer.on("first-node",this.onFirstNodeReported,
this),this._renderer.process())},onFirstNodeReported:function(a){c.trigger("first-node-"+this.id,a)},onRendered:function(){c.trigger("rendered-"+this.id,this)},on:function(a,b,d){return c.on(a+"-"+this.id,b,d)},un:function(a,b,d){return c.un(a+"-"+this.id,b,d)},startRendering:function(){var a=this.tpl||this.url;if(this.deferRendering&&(this.node||!1===this.node)){this.deferRendering=!1;if(this.tplPromise)return this.tplPromise.done(a?this.applyTemplate:this.doRender,this),this.initPromise;a?this.applyTemplate():
this.doRender()}return null},resolveTemplate:function(){var a=this,b=a.url,c=a._watcher?a._watcher.getValue():a.tpl||b;a._watcher&&!c&&(b=null);c&&"string"!==typeof c&&(c=c.tpl||c.url,b=null);a.initPromise=new H;a.tplPromise=new H;a.ownRenderer&&a.initPromise.resolve(!1);return(new H(function(a,e){c||b?b?a(d(c)||k(b)):a(d(c)||ea(c)):e()})).done(function(b){a._fragment=b;a.tplPromise.resolve()}).fail(a.initPromise.reject,a.initPromise).fail(a.tplPromise.reject,a.tplPromise)},onHtmlChange:function(){var a=
this.node;this._renderer&&(this._renderer.$destroy(),this._renderer=null);var b=this._watcher.getValue();if(b)this._fragment=ea(b),this.applyTemplate();else if(a)for(;a.firstChild;)a.removeChild(a.firstChild)},onChange:function(){var a=this.node;this._renderer&&(this._renderer.$destroy(),this._renderer=null);if(this._watcher.getValue())this.resolveTemplate().done(this.applyTemplate,this);else if(a)for(;a.firstChild;)a.removeChild(a.firstChild)},doApplyTemplate:function(){var a=this.node,b;if(a)if(this.replace){var d=
this._nextEl;for(b=this._prevEl;b.parentNode&&b.nextSibling&&b.nextSibling!==d;)b.parentNode.removeChild(b.nextSibling)}else if(a.firstChild)for(;a.firstChild;)a.removeChild(a.firstChild);this._intendedShadow&&this.makeTranscludes();if(this.replace){d=Pa(this._fragment);b=X(d.childNodes);if(a&&a.nodeType){var e=a?P(a,"mjs-transclude"):null;if(e){var f=L("[{transclude}], [mjs-transclude], mjs-transclude",d,!0);f.length&&P(f[0],"mjs-transclude",e)}a.parentNode&&a.parentNode.removeChild(a)}this._nextEl.parentNode.insertBefore(d,
this._nextEl);this.node=b;this.initPromise.resolve(b)}else a?a.appendChild(Pa(this._fragment)):this.node=a=Pa(this._fragment),this.initPromise.resolve(a);c.trigger("before-render-"+this.id,this);this.ownRenderer&&this.doRender()},applyTemplate:function(){var a=this.node,b=new H;!this._initial&&this.animate?(fa(a,"leave").done(this.doApplyTemplate,this).done(b.resolve,b),fa(a,"enter")):(this.doApplyTemplate(),b.resolve());this._initial=!1;return b},makeTranscludes:function(){var a=this._fragment,b=
L("content",a),d,c;var e=0;for(c=b.length;e<c;e++){var f=window.document.createElement("transclude");var k=b[e];var n=k.nextSibling;(d=z(k,"select"))&&M(f,"select",d);a.removeChild(k);a.insertBefore(f,n)}},onParentRendererDestroy:function(){this.$destroyed||!this._renderer||this._renderer.$destroyed||this._renderer.$destroy();this.$destroy()},onScopeDestroy:function(){this.$destroy()},onDestroy:function(){this._nextEl&&this._nextEl.parentNode&&this._nextEl.parentNode.removeChild(this._nextEl);this._prevEl&&
this._prevEl.parentNode&&this._prevEl.parentNode.removeChild(this._prevEl);this.shadow&&this._originalNode.createShadowRoot();this._watcher&&(this.html?this._watcher.unsubscribe(this.onHtmlChange,this):this._watcher.unsubscribe(this.onChange,this),this._watcher.$destroy(!0))}},{cache:a})}(),xa=n.app.resolve=function(c,a,b,e,d){a=a||{};d=d||[];b=b||a.scope;e=e||a.node;var f=a.config||null;a.config=f;a.scope=a.scope||b;a.node=a.node||e;0===d.length&&d.push(a);f&&(f.setType("cloak","bool",D.MODE_STATIC),
f.setType("animate","bool",D.MODE_STATIC));var k=w(c)?na.get(c):c;if(!k)throw Error("Component "+c+" not found");b&&k.$isolateScope&&(a.scope=b=b.$newIsolated());var h,m=[];c=k.template||a.template||null;var p=k.templateUrl||a.templateUrl||null,n=b?b.$app:null,t=Bb.global(),r=n?n.inject:t.inject,v=n?n:t,A=f?f.get("cloak"):null,E={$node:e||null,$scope:b||null,$config:f||null,$args:d||null};if(k.resolve)for(h in k.resolve)(function(c){var p=new H;m.push(p.done(function(b){E[c]=b;a[c]=b;d.push(b)}));
var n=k.resolve[h];B(n)?p.resolve(n(b,e,f)):p.resolve(r.call(v,n,null,q({},E,a,!1,!1)));p.fail(function(a){a instanceof Error&&T(a)})})(h);if(c||p)a.template=new Ia({scope:b,node:e,deferRendering:!0,ownRenderer:!0,shadow:k.$shadow,tpl:c,url:p,animate:f?f.get("animate"):!1}),m.push(a.template.initPromise),e&&e.firstChild&&P(e,"mjs-transclude",ea(e.childNodes));if(m.length){var u=new H;H.all(m).done(function(b){u.resolve(r.call(v,k,null,q({},E,a,!1,!1),d))}).fail(u.reject,u)}else u=H.resolve(r.call(v,
k,null,q({},E,a,!1,!1),d));e&&u.isPending()&&null!==A&&(!0!==A?N(e,A):e.style.visibility="hidden",u.then(function(){!0!==A?S(e,A):e.style.visibility=""}));e&&u.then(function(){S(e,"mjs-cloak")});return u};(function(){var c=function(a,b,c,d,f){c.setDefaultMode("value",D.MODE_STATIC);c.setType("sameScope","bool",D.MODE_STATIC);c.setType("isolateScope","bool",D.MODE_STATIC);c.setDefaultMode("as",D.MODE_STATIC);f=c.get("value");var e="string"===typeof f?na.get(f,!0):f,h=c.getAll();if(!e)throw Error("Component "+
f+" not found");var m=h.sameScope||e.$sameScope;a=h.isolateScope||e.$isolateScope?a.$newIsolated():m?a:a.$new();c={scope:a,node:b,config:c,parentRenderer:d,destroyScope:!m};xa(f,c,a,b,[c]);return e.$resumeRenderer||!!e.$shadow};c.$breakScope=!1;y.registerAttribute("cmp",200,c)})();var ya=n.lib.Queue=function(){var c=function(a){a=a||{};this._queue=[];this._map={};this.id="$$"+W();this._f=this._finish.bind(this);for(var b in a)this[b]=a[b]};c.REPLACE=1;c.ONCE=2;c.MULTIPLE=3;c.ONCE_EVER=4;q(c.prototype,
{_queue:null,_map:null,_nextRequested:!1,_running:!1,length:0,id:null,async:!0,auto:!0,thenable:!1,stack:!1,context:null,mode:c.MULTIPLE,add:function(a,b,e,d,f,k){var h=this.id,m=a[h]||W();b={id:m,fn:a,context:b,args:e,async:k};d=d||this.mode;if(d===c.ONCE_EVER&&a[h])return a[h];a[h]=m;if(this._map[m])if(d===c.REPLACE)this.remove(m);else if(d===c.ONCE)return m;this._queue[f?"unshift":"push"](b);this._map[m]=b;this.length=this._queue.length;this.auto&&this.next();return m},append:function(a,b,c,d,
f){return this.add(a,b,c,d,!1,f)},prepend:function(a,b,c,d,f){return this.add(a,b,c,d,!0,f)},remove:function(a){var b=this._queue,c;var d=0;for(c=b.length;d<c;d++)if(b[d].id===a){b.splice(d,1);break}delete this._map[a]},isEmpty:function(){return 0===this.length},isRunning:function(){return this._running},next:function(){var a=this,b;if(a._running)a._nextRequested=!0;else{a._nextRequested=!1;var c=a._queue[a.stack?"pop":"shift"]();a.length=a._queue.length;if(c){a._running=!0;delete a._map[c.id];var d=
function(){try{b=c.fn.apply(c.context||a.context,c.args||[])}catch(k){T(k)}finally{Y(b)?(b.catch(T),b.then(a._f,a._f)):a._finish()}},f=c.async||a.async||!1;!f&&d();"raf"===f&&U(d);f&&"raf"!==f&&V(d,null,null,1===ha(f)?f:0)}}},_finish:function(){this._running&&(this._running=!1,(this.auto||this._nextRequested)&&this.next())},$destroy:function(){this.context=this._map=this._queue=null;this._running=this._nextRequested=!1;this.next=J}},!0,!1);return c}(),ib=n.app.ListRenderer=C({id:null,cfg:null,model:null,
itemName:null,tpl:null,renderers:null,parentEl:null,prevEl:null,nextEl:null,trackBy:null,trackByWatcher:null,animateMove:!1,animate:!1,trackByFn:null,griDelegate:null,tagMode:!1,queue:null,buffered:!1,bufferPlugin:null,$constructor:function(c,a,b,e,d){b.setDefaultMode("trackBy",D.MODE_STATIC);e=b.getAll();this.cfg=b;this.scope=c;this.tagMode="mjs-each"===a.nodeName.toLowerCase();this.animateMove=!this.tagMode&&!e.buffered&&e.animateMove&&zb();this.animate=!this.tagMode&&!e.buffered&&e.animate;this.id=
e.id||W();this.animate&&this.$plugins.push(e.animatePlugin||"MetaphorJs.plugin.ListAnimated");e.observable&&this.$plugins.push(e.observable||"MetaphorJs.plugin.Observable");e.buffered&&!this.tagMode&&(this.buffered=!0,this.$plugins.push(e.buffered||"MetaphorJs.plugin.ListBuffered"));e.plugin&&this.$plugins.push(e.plugin);!1===b.get("trackby")&&(this.trackBy=!1)},$init:function(c,a,b,e,d){var f=this.tagMode?z(a,"value"):b.getExpression("value");this.parseExpr(f);this.tpl=this.tagMode?ea(a.childNodes):
a;this.renderers=[];f=cb(a,"list -"+this.id);this.prevEl=f[0];this.nextEl=f[1];this.parentEl=a.parentNode;this.node=null;this.queue=new ya({async:!1,auto:!0,thenable:!0,stack:!1,context:this,mode:ya.ONCE});this.parentEl.removeChild(a);this.afterInit(c,a,b,e,d);this.queue.add(this.render,this,[X(this.watcher.getValue())])},afterInit:function(c,a){a=this.cfg;this.watcher=ja.get(c,this.model,this.onChange,this);this.trackBy=a.get("trackBy");!1!==this.trackBy&&(this.trackBy&&"$"!==this.trackBy?this.trackByWatcher=
ja.get(c,this.trackBy,this.onChangeTrackBy,this):"$"===this.trackBy||this.watcher.hasInputPipes()||(this.trackBy="$$"+this.watcher.id));this.griDelegate=this.scopeGetRawIndex.bind(this)},trigger:J,render:function(c){var a=this.renderers,b=this.tpl,e;var d=0;for(e=c.length;d<e;d++)a.push(this.createItem(b.cloneNode(!0),c,d));this.doRender()},doRender:function(){var c=window.document.createDocumentFragment(),a=this.renderers,b=this.tagMode,e;var d=0;for(e=a.length;d<e;d++)a[d].hidden||(b?c.appendChild(ea(a[d].el)):
c.appendChild(a[d].el),a[d].attached=!0);this.parentEl.insertBefore(c,this.nextEl);this.doUpdate();this.trigger("render",this)},doUpdate:function(c,a,b,e){var d=this.renderers;c=c||0;var f=d.length;a=a||f-1;var k=this.watcher.getValue(),h=this.getTrackByFunction();for(a>f-1&&(a=f-1);c<=a;c++)b&&d[c].action!==b||this.renderItem(c,d,k,h,e)},renderItem:function(c,a,b,e,d){b=b||this.watcher.getValue();a=a||this.renderers;e=e||this.getTrackByFunction();var f=a[c],k=f.scope;a=a.length-1;var h=!(c%2);d&&
f.rendered||(k.$index=c,k.$first=0===c,k.$last=c===a,k.$even=h,k.$odd=!h,k.$trackId=e(b[c]),k.$getRawIndex=this.griDelegate,f.renderer?k.$check():(f.renderer=new hb(f.el,k),f.renderer.process(),f.rendered=!0))},createItem:function(c,a,b){var e=this.itemName,d=this.scope.$new(),f=this.tagMode;d.$on("changed",this.scope.$check,this.scope);d[e]=this.getListItem(a,b);c=f?X(c.childNodes):c;return{index:b,action:"enter",el:c,firstEl:f?c[0]:c,lastEl:f?c[c.length-1]:c,scope:d,attached:!1,rendered:!1,hidden:!1}},
onChange:function(c,a){this.queue.prepend(this.applyChanges,this,[a],ya.REPLACE)},applyChanges:function(c){var a=this.renderers,b=this.tpl,e=0,d=X(this.watcher.getValue()),f=null,k=this.animateMove,h=[],m=this.itemName,p=a.slice(),n=!1;if(!1===this.trackBy){a=this.renderers.slice();f=0;n=!1;var t=0;for(c=d.length;t<c;t++){var r=this.createItem(b.cloneNode(!0),d,t);h.push(r)}}else{var v=c.length;r=d.length;var A=Array(v+1);var q=Array(v+1),u,x,w=0;if(v==r&&0===v)v={changes:0,distance:0,prescription:[]};
else{for(u=0;u<=v;u++)A[u]=Array(r+1),q[u]=Array(r+1),A[u][0]=u,q[u][0]="D";for(u=0;u<=r;u++)A[0][u]=u,q[0][u]="I";for(u=1;u<=v;u++)for(x=1;x<=r;x++){var y=Ra(c[u-1],d[x-1])?0:1;A[u][x-1]<A[u-1][x]&&A[u][x-1]<A[u-1][x-1]+y?(A[u][x]=A[u][x-1]+1,q[u][x]="I"):A[u-1][x]<A[u-1][x-1]+y?(A[u][x]=A[u-1][x]+1,q[u][x]="D"):(A[u][x]=A[u-1][x-1]+y,q[u][x]=1===y?"R":"-")}var z=[];u=v;x=r;do y=q[u][x],z.push(y),"-"!==y&&w++,"R"===y||"-"===y?(u--,x--):"D"===y?u--:x--;while(0!==u||0!==x);v={changes:w/z.length,distance:A[v][r],
prescription:z.reverse()}}v=v.prescription;r=this.getTrackByFunction();A=[];x={};w=0;for(q=c.length;w<q;w++)(u=r(c[w]))&&(x[u]=w);y=0;z={};w=0;for(q=v.length;w<q;w++)c=v[w],"D"!==c&&(u=r(d[y]),void 0!==u&&!0!==z[u]&&void 0!==(t=x[u])?(A.push(t),z[u]=!0):A.push(c),y++);v=A;t=0;for(c=v.length;t<c;t++)r=v[t],1===ha(r)?(A=r,r=a[A],A!==e&&null===f&&(f=t),r.action="move",r.scope[m]=this.getListItem(d,t),n=k,h.push(r),a[A]=null,e++):(null===f&&(f=t),r=this.createItem(b.cloneNode(!0),d,t),h.push(r))}this.renderers=
h;this.reflectChanges({oldRenderers:a,updateStart:f,newRenderers:h,origRenderers:p,doesMove:n})},reflectChanges:function(c){this.applyDomPositions(c.oldRenderers);this.doUpdate(c.updateStart||0);this.removeOldElements(c.oldRenderers);this.trigger("change",this)},removeOldElements:function(c){var a,b,e;var d=0;for(a=c.length;d<a;d++){if((b=c[d])&&b.attached)if(b.attached=!1,!this.tagMode&&b.el.parentNode)b.el.parentNode.removeChild(b.el);else{var f=0;for(e=b.el.length;f<e;f++)b.el[f].parentNode&&b.el[f].parentNode.removeChild(b.el[f])}b&&
b.scope&&b.scope.$destroy()}},applyDomPositions:function(c){c=this.renderers;var a=this.parentEl,b=this.tagMode,e=this.nextEl,d,f;var k=0;for(d=c.length;k<d;k++){var h=c[k];var m=h.el;var p=null;if(h.hidden)m.parentNode&&(b?m.parentNode.removeChild(ea(m)):m.parentNode.removeChild(m),h.attached=!1);else{for(f=Math.max(k-1,0);0<=f;f--)if(c[f].attached){p=c[f].lastEl.nextSibling;break}p||(p=e);h.firstEl!==p&&(p&&h.lastEl.nextSibling!==p?a.insertBefore(b?ea(m):m,p):p||a.appendChild(b?ea(m):m));h.attached=
!0}}},getListItem:function(c,a){return c[a]},onChangeTrackBy:function(c){this.trackByFn=null;this.trackBy=c},getTrackByFunction:function(){var c;this.trackByFn||((c=this.trackBy)&&"$"!==c?B(c)?this.trackByFn=c:this.trackByFn=function(a){return a&&!bb(a)?a[c]:void 0}:this.trackByFn=function(a){return bb(a)?a:void 0});return this.trackByFn},scopeGetRawIndex:function(c){if(void 0===c)return-1;var a=this.watcher.getValue(),b=this.getTrackByFunction(),e;var d=0;for(e=a.length;d<e;d++)if(b(a[d])===c)return d;
return-1},parseExpr:function(c){c=c.split(" ");var a;var b=0;for(a=c.length;b<a;b++){var e=c[b];if(""!==e&&"in"!==e)if(f){var d=c.slice(b).join(" ");break}else var f=e}this.model=d;this.itemName=f||"item"},onDestroy:function(){var c=this.renderers,a;var b=0;for(a=c.length;b<a;b++)c[b].renderer&&!c[b].renderer.$destroyed&&c[b].renderer.$destroy();this.trackByWatcher&&(this.trackByWatcher.unsubscribe(this.onChangeTrackBy,this),this.trackByWatcher.$destroy(!0));this.queue.$destroy();this.watcher&&(this.watcher.unsubscribe(this.onChange,
this),this.watcher.$destroy(!0))}},{$stopRenderer:!0,$registerBy:"id"});(function(){var c=[],a=function(a,e,d,f,k){d.disableProperty("value");a:{var b="mjs-each"===e.nodeName.toLowerCase()?z(e,"value"):d.getExpression("value");var m=b.split(" in ");b=G.get(1===m.length?b:m[1],a);m=0;for(var p=c.length;m<p;m++)if(b instanceof c[m][0]){b=c[m][1];break a}b=null}return new (b||ib)(a,e,d,f,k)};a.registerType=function(a,e){c.push([a,e])};a.$stopRenderer=!0;a.$registerBy="id";a.$prebuild={skip:!0};a.registerType(Array,
ib);y.registerAttribute("each",100,a);y.registerTag("each",a)})();var za=n.dom.getStyle=function(c,a,b){if(window.getComputedStyle){if(c===window)return a?b?0:null:{};c=window.getComputedStyle(c,null)}else c=c.currentStyle||c.style||{};a=a?c[a]:c;return b?parseFloat(a)||0:a},$b=function(){var c;return function(){if(void 0===c){var a=window.document,b=a.createElement("div"),e=a.createElement("div");a=a.body;e.style&&window.getComputedStyle?(b.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",
b.appendChild(e),e.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",e.innerHTML="",a.appendChild(b),e="4px"===window.getComputedStyle(e,null).width,a.removeChild(b),c=e):c=!1}return c}}(),Wa=function(c,a){var b=/^([+-]?(?:d*.|)d+(?:[eE][+-]?d+|))(?!px)[a-z%]+$/i,e=["Top","Right","Bottom","Left"],d=c?"inner"===c?"padding":"":"content";return function(c,k){if(c===window)return c.document.documentElement["client"+
a];if(9===c.nodeType)return k=c.documentElement,Math.max(c.body["scroll"+a],k["scroll"+a],c.body["offset"+a],k["offset"+a],k["client"+a]);a:{var f=a.toLowerCase(),m=d||(!0===k?"margin":"border");k=za(c);var p=!0,n="width"===f?c.offsetWidth:c.offsetHeight,t="border-box"===k.boxSizing;if(0>=n||null==n){n=c.style[f];if(b.test(n)){k=n;break a}p=t&&($b()||n===c.style[f]);n=parseFloat(n)||0}c=n;m=m||(t?"border":"content");f=m===(p?"border":"content")?4:"width"===f?1:0;for(t=0;4>f;f+=2)"margin"===m&&(t+=
parseFloat(k[m+e[f]])),p?("content"===m&&(t-=parseFloat(k["padding"+e[f]])),"margin"!==m&&(t-=parseFloat(k["border"+e[f]+"Width"]))):(t+=parseFloat(k["padding"+e[f]]),"padding"!==m&&(t+=parseFloat(k["border"+e[f]+"Width"])));k=c+t}return k}},jb=n.dom.getWidth=Wa("","Width"),kb=n.dom.getHeight=Wa("","Height"),Eb=function(c){var a=c?"pageYOffset":"pageXOffset",b=c?"scrollTop":"scrollLeft";c=window.document;var e=c.body,d=c.documentElement,f=function(a,b){return 0>a&&!1===b?0:a};var k=void 0!==window[a]?
function(){return window[a]}:d.clientHeight?function(){return d[b]}:function(){return e[b]};return function(a,c){return a&&a!==window?a&&1==a.nodeType&&a!==e&&a!==d?f(a[b],c):f(k(),c):f(k(),c)}},Aa=n.dom.getScrollTop=Eb(!0),Ba=n.dom.getScrollLeft=Eb(!1),ac=n.lib.EventBuffer=function(){var c=function(a,b,c){var d="$$"+b+"_"+c;if(a[d])return a[d];a[d]=this;this.id=d;this.breaks={};this.watchers={};this.node=a;this.event=b;this.observable=new la;this.interval=c||0;this.handlerDelegate=this.handler.bind(this);
this.triggerDelegate=this.trigger.bind(this);this.up()};q(c.prototype,{observable:null,handlerDelegate:null,triggerDelegate:null,watchers:null,breaks:null,running:!1,lastEvent:null,currentEvent:null,interval:null,id:null,handler:function(a){this.running?a&&(this.lastEvent=a):this.next(a)},next:function(a){var b=this.interval;if(a=a||this.lastEvent)this.lastEvent=null,this.running=!0,this.currentEvent=a,"raf"===b?U(this.triggerDelegate):setTimeout(this.triggerDelegate,b)},watchWidth:function(){this.addWatcher("width",
jb)},watchHeight:function(){this.addWatcher("width",kb)},watchScrollTop:function(){this.addWatcher("scrollTop",Aa)},watchScrollLeft:function(){this.addWatcher("scrollLeft",Ba)},addWatcher:function(a,b,c){this.watchers[a]||(this.watchers[a]={fn:b,context:c,prev:null,current:parseInt(b.call(c,this.node),10)})},removeWatcher:function(a){delete this.watchers[a]},breakFilter:function(a,b,c){if(!this.watchers[c.watcher])return!1;var d=a.breakValue,e=a.breakLuft||0,k=d-(a.breakLowLuft||e);a=d+(a.breakHighLuft||
e);e=this.watchers[c.watcher];c=e.current;e=e.prev;var h=Math.min(e,c),m=Math.max(e,c);if("!="===d)return e!=c;b[0].breakPosition=c<k?-1:c>=a?1:0;return h<=k&&k<=m||h<=a&&a<=m},onBreak:function(a,b,c,d,f){var e=a+"_"+b;f=f||{};f.breakValue=b;this.breaks[e]||(this.breaks[e]=this.observable.createEvent(e,{watcher:a,triggerFilter:this.breakFilter,filterContext:this}));this.breaks[e].on(c,d,f)},unBreak:function(a,b,c,d,f){a=a+"_"+b;this.breaks[a]&&(this.breaks[a].un(c,d),this.breaks[a].hasListener()||
(this.observable.destroyEvent(a),this.breaks[a]=null,delete this.breaks[a]));f&&this.destroyIfIdle()},on:function(a,b,c){this.observable.on(this.event,a,b,c)},un:function(a,b,c){this.observable.un(this.event,a,b);c&&this.destroyIfIdle()},trigger:function(){var a=this.currentEvent,b=this.watchers,c=this.breaks,d=this.node,f,k;this.observable.trigger(this.event,a);for(f in b)b[f].prev=b[f].current,b[f].current=parseInt(b[f].fn.call(b[f].context,d,a),10);for(k in c)c[k].trigger(a);this.running=!1;this.currentEvent=
null;this.next()},up:function(){O(this.node,this.event,this.handlerDelegate)},down:function(){ca(this.node,this.event,this.handlerDelegate)},destroyIfIdle:function(){if(this.observable&&!this.observable.hasListener())return this.$destroy(),!0},$destroy:function(){delete this.node[this.id];this.down();this.observable.$destroy()}});c.get=function(a,b,e){var d="$$"+b+"_"+e;return a[d]?a[d]:a[d]=new c(a,b,e)};return c}();n.lib.EventHandler=function(c,a,b,e){this.config=e;this.event=c;this.prevEvent={};
this.scope=a;this.node=b;this.buffer=this.handler=null;if(e.hasExpression("if"))e.on("if",this.onIfChange,this);this.up()};q(n.lib.EventHandler.prototype,{onIfChange:function(c){this[c?"up":"down"]()},createHandler:function(){var c=this,a=c.scope,b,e=function(b){if(!c.$destroyed&&!c.$destroying){var d,e=!1,h=void 0,m=!1,p=c.config.getAll(),n=c.config.get("value");void 0!==p.preventDefault&&(e=p.preventDefault);void 0!==p.stopPropagation&&(m=p.stopPropagation);void 0!==p.returnValue&&(h=p.returnValue);
void 0!==p.keyCode&&(d=p.keyCode);b=Z(b||window.event);if(d&&("number"===typeof d&&d!==b.keyCode||-1===d.indexOf(b.keyCode)))return null;a.$event=b;a.$eventNode=c.node;a.$prevEvent=c.prevEvent[b.type];n&&(d=n.call(p.context||null,a))&&ia(d)&&(void 0!==d.preventDefault&&(e=d.preventDefault),void 0!==d.stopPropagation&&(m=d.stopPropagation),void 0!==d.returnValue&&(h=d.returnValue));m&&b.stopPropagation();e&&b.preventDefault();if(c.$destroyed||c.$destroying)return void 0!==h?h:void 0;a.$event=null;
a.$eventNode=null;c.prevEvent[b.type]=b;c.config.checkScope("value");if(void 0!==h)return h}};return(b=c.config.get("async"))?function(a){V(e,null,[a],"number"==typeof b?b:null)}:e},up:function(){var c=this.config,a=c.get("buffer");if(!c.hasExpression("if")||c.get("if"))this.handler=this.createHandler(),a?(this.buffer=ac.get(this.node,this.event,a),this.buffer.on(this.handler)):O(this.node,this.event,this.handler)},down:function(){this.buffer?(this.buffer.un(this.handler),this.buffer.destroyIfIdle(),
this.buffer=null):ca(this.node,this.event,this.handler)},$destroy:function(){this.down();this.config.clear()}});var bc=n.lib.EventHandler;(function(){var c="click dblclick mousedown mouseup mouseover mouseout mousemove keydown keyup keypress change focus blur copy cut paste load mousewheel touchstart touchend touchcancel touchleave touchmove".split(" "),a,b=function(a){a.setProperty("preventDefault",{type:"bool",defaultValue:!0,defaultMode:D.MODE_STATIC});a.setType("stopPropagation","bool",D.MODE_STATIC);
a.setType("if","bool");a.eachProperty(function(b){"value"!==b&&0!==b.indexOf("value.")||a.setMode(b,D.MODE_FUNC)});return a};var e=0;for(a=c.length;e<a;e++)(function(a){y.registerAttribute(a,1E3,function(c,d,e,m,p){var f=new bc(a,c,d,b(e));return function(){f.$destroy();f=null}})})(c[e]);y.registerAttribute("submit",1E3,function(a,c,e){b(e);var d=e.get("value"),f=function(){d(a);e.checkScope("value")};va.get(c).onKey(13,f);return function(){va.get(c).unKey(13,f);d=f=null}});c=null})();y.registerAttribute("show",
500,y.$extend({$class:"MetaphorJs.app.Directive.attr.Show",initial:!0,initialSet:function(){this.config.setType("animate","bool",D.MODE_STATIC);this.$super()},runAnimation:function(c){var a=this,b=a.node.style,e=function(){b.display=c?a.config.get("display")||"":"none"};a.initial||!a.config.get("animate")?e():fa(a.node,c?"show":"hide",function(){if(c)return new H(function(c){U(function(){b.display=a.config.get("display")||"";c()})})}).done(e)},onChange:function(c){this.runAnimation(c);this.initial=
!1;this.$super(c)}}));y.registerAttribute("hide",500,y.attr.Show.$extend({$class:"MetaphorJs.app.Directive.attr.Hide",onChange:function(c){this.runAnimation(!c);this.initial=!1;this.saveStateOnChange(c)}}));y.registerAttribute("if",500,y.$extend({$class:"MetaphorJs.app.Directive.attr.If",parentEl:null,prevEl:null,nextEl:null,el:null,initial:!0,cfg:null,animate:!1,$init:function(c,a,b,e,d){b.setType("value","bool");b.setType("once","bool",D.MODE_STATIC);this.createCommentWrap(a,"if");this.$super(c,
a,b,e,d)},onScopeDestroy:function(){this.wrapperClose=this.wrapperOpen=null;this.$super()},onChange:function(){var c=this,a=c.config.get("value"),b=c.wrapperOpen.parentNode,e=c.node,d=function(){b.insertBefore(e,c.wrapperClose)},f=function(){b.removeChild(e)};a?c.initial||!c.config.get("animate")?d():fa(e,"enter",d):e.parentNode&&(c.initial||!c.config.get("animate")?f():fa(e,"leave").done(f));c.$super(a);c.initial?c.initial=!1:c.config.get("once")&&c.$destroy()}}));y.registerAttribute("in-focus",
500,y.$extend({$class:"MetaphorJs.app.Directive.attr.InFocus",initialSet:function(){this.config.setType("value","bool");this.$super()},onChange:function(c){c&&V(this.node.focus,this.node,[],300)}}));y.registerAttribute("include",1100,function(c,a,b,e,d){b.disableProperty("value");b.setType("asis","bool",D.MODE_STATIC);b.setType("animate","bool",D.MODE_STATIC);d=b.get("html");c={scope:c,node:a,parentRenderer:e,animate:b.get("animate"),ownRenderer:!b.get("asis")};d?c.html=d:c.url=b.getExpression("value");
var f=new Ia(c);e.on("destroy",function(){f.$destroy();f=null});return!1});y.registerAttribute("init",250,function(){var c=function(a,b,c){c.eachProperty(function(b,c){"value"!==b&&0!==b.indexOf("value.")||G.run(c.expression,a,null,{noReturn:!0})});c.clear()};c.$prebuild={noReturn:!0};return c}());(function(){var c={enter:13,esc:27,backspace:8};y.registerAttribute("key",1E3,function(a,b,e,d,f){e.disableProperty("value");e.eachProperty(function(a,b){0===a.indexOf("value.")&&"{"!==b.expression.charAt(0)&&
e.setMode(a,D.MODE_FUNC)});d=function(d,e){"function"===typeof e&&(e={handler:e});var f=e.handler,h=e.context||a;delete e.handler;delete e.context;e.keyCode||(e.keyCode=c[d]||parseInt(d,10));var k=function(b){a.$event=b;f(a);a.$event=null;a.$check()};va.get(b).onKey(e,k,h);return function(){va.get(b).unKey(e,k,h)}};f=e.getAllValues();var k,h=[];for(k in f)f.hasOwnProperty(k)&&f[k]&&h.push(d(k,f[k]));return function(){var a;var b=0;for(a=h.length;b<a;b++)h[b]();h=null}})})();y.registerAttribute("model",
1E3,y.$extend({$class:"MetaphorJs.app.Directive.attr.Model",inProg:!1,input:null,binding:null,updateRoot:!1,changeCb:null,initial:!1,autoOnChange:!1,$init:function(c,a,b,e,d){var f=b.getExpression("value"),k=G.describeExpression(f);b.setMode("value",D.MODE_FNSET);b.setProperty("checkRoot",{type:"bool",defaultValue:-1!==k.indexOf("r")});b.setProperty("checkParent",{type:"bool",defaultValue:-1!==k.indexOf("p")});b.setProperty("binding",{defaultValue:"both",mode:D.MODE_STATIC});b.hasExpression("change")&&
(this.changeFn=G.func(b.get("change")));this.node=a;this.input=va.get(a,c);this.binding=b.get("binding");this.mo=ja.get(c,f,null,null,{setter:!0});this.mo.subscribe(this.onChange,this);this.input.onChange(this.onInputChange,this);this.$super(c,a,b,e,d);c=this.input.getValue();a=this.mo.getValue();this.initial=!0;if(a!==c)if("input"!==this.binding&&void 0!==a)this.onChange(a);else if("scope"!==this.binding&&void 0!==c)this.onInputChange(c);this.initial=!1},initialSet:J,onInputChange:function(c){var a=
this.scope;"scope"!==this.binding&&(c&&w(c)&&-1!==c.indexOf("\\{")&&(c=c.replace(/\\{/g,"{")),this.mo.getValue()!=c&&(this.mo.setValue(c),this.inProg=!0,a instanceof ta?this.config.get("checkRoot")?a.$root.$check():this.config.get("checkParent")?a.$parent?a.$parent.$check():a.$root.$check():a.$check():this.config.check("value"),this.inProg=!1))},onDestroy:function(){this.input.$destroy();this.mo&&(this.mo.unsubscribe(this.onChange,this),this.mo.$destroy(!0));this.$super()},onChange:function(){var c=
this.mo.getValue(),a=this.binding,b;"input"===a||this.inProg||(window.document.activeElement!==this.node&&(this.binding="scope"),(b=Ua())&&8>b?V(this.input.setValue,this.input,[c]):this.input.setValue(c),this.binding=a);this.changeFn&&!this.initial&&this.changeFn(this.scope)}},{$prebuild:{skip:!0}}));y.registerAttribute("options",100,y.$extend({$class:"MetaphorJs.app.Directive.attr.Options",model:null,store:null,getterFn:null,defOption:null,prevGroup:null,groupEl:null,fragment:null,$init:function(c,
a,b){b.disableProperty("value");var e=b.getExpression("value");this.parseExpr(e);this.config=b;this.node=a;this.scope=c;for(this.defOption=a.options.length?a.options[0]:null;a.firstChild;)a.removeChild(a.firstChild);this.defOption&&M(this.defOption,"default-option","");try{var d=G.get(this.model,c);C.isInstanceOf(d,"MetaphorJs.model.Store")?this.bindStore(d,"on"):this.watcher=ja.get(c,this.model,this.onChange,this)}catch(f){T(f)}this.watcher?this.renderAll():this.store&&this.renderStore()},bindStore:function(c,
a){c[a]("update",this.renderStore,this);this.store=c},renderStore:function(){this.render(this.store.current)},renderAll:function(){this.render(X(this.watcher.getValue()))},onChange:function(){this.renderAll()},renderOption:function(c,a,b){var e=this.groupEl||this.fragment,d=Ua();b.item=c;b.$index=a;c=this.defaultOptionTpl&&ia(c)?c:this.getterFn(b);void 0!==c.group&&(c.group=""+c.group);c.group!==this.prevGroup&&(c.group?(this.groupEl=e=window.document.createElement("optgroup"),M(e,"label",c.group),
c.disabledGroup&&M(e,"disabled","disabled"),this.fragment.appendChild(e)):(e=this.fragment,this.groupEl=null));this.prevGroup=c.group;a=window.document.createElement("option");M(a,"value",c.value||"");a.text=c.name;d&&9>d&&(a.innerHTML=c.name);c.disabled&&M(a,"disabled","disabled");e.appendChild(a)},render:function(c){var a=this.node,b=ua(a),e=this.defOption,d=this.scope.$new(),f=Ua(),k;this.fragment=window.document.createDocumentFragment();for(this.groupEl=this.prevGroup=null;a.firstChild;)a.removeChild(a.firstChild);
var h=0;for(k=c.length;h<k;h++)this.renderOption(c[h],h,d);e&&a.insertBefore(e,a.firstChild);d.$destroy();if(f&&8>f){var m=a.nextSibling;var p=a.parentNode;p.removeChild(a)}a.appendChild(this.fragment);this.fragment=null;f&&8>f&&p.insertBefore(a,m);fb(a,b)},parseExpr:function(c){var a=c.indexOf(" in ");if(-1===a){var b=c;c="{name: this.item, value: this.$index}";this.defaultOptionTpl=!0}else b=c.substr(a+4),c=c.substr(0,a),this.defaultOptionTpl=!1;this.model=b;this.getterFn=G.getter(c)},onDestroy:function(){this.store&&
this.bindStore(this.store,"un");this.$super()}},{$prebuild:{skip:!0}}));(function(){var c="selected checked disabled readonly open required".split(" "),a,b=y.$extend({propName:null,$init:function(a,b,c,e){this.propName=e;c.setType("value","bool");this.$super(a,b,c)},onChange:function(a){var b=this.propName;a?M(this.node,b,b):ka(this.node,b)}});var e=0;for(a=c.length;e<a;e++)(function(a){y.registerAttribute(""+a,1E3,function(c,d,e){return new b(c,d,e,a)})})(c[e])})();y.registerAttribute("ref",200,
function(c,a,b){b.setDefaultMode("value",D.MODE_STATIC);c[b.get("value")]=a});y.registerAttribute("router",200,function(c,a,b,e){b.setProperty("scrollOnChange",{type:"bool",defaultMode:D.MODE_STATIC});b.setProperty("value",{defaultMode:D.MODE_STATIC,defaultValue:"MetaphorJs.app.Router"});b.setDefaultMode("defaultCmp",D.MODE_STATIC);e={scope:c,node:a,config:b};xa(b.get("value"),e,c,a,[e]);return!1});y.registerAttribute("source-src",1E3,y.$extend({$class:"MetaphorJs.app.Directive.attr.SourceSrc",usePreload:!0,
attr:null,lastPromise:null,src:null,$constructor:function(c,a,b,e,d){b.setType("deferred","bool",D.MODE_STATIC);b.setType("noCache","bool",D.MODE_STATIC);b.setDefaultMode("plugin",D.MODE_STATIC);b.get("deferred")&&this.$plugins.push("plugin.SrcDeferred");if(b.get("plugin")){e=b.get("plugin").split(",");var f;d=0;for(f=e.length;d<f;d++)this.$plugins.push(e[d].trim())}this.$super(c,a,b)},onChange:function(){this.doChange()},doChange:function(){if(!this.$destroyed&&!this.$destroying){var c=this.config.get("value");
c&&(this.src=c,this.config.get("noCache")&&(c+=(-1!==c.indexOf("?")?"&amp;":"?")+"_"+(new Date).getTime()),this.node&&(this.doChangeSource(c),this.onSrcChanged()))}},doChangeSource:function(c){var a=this.node,b=L("source",a),e=window.document.createElement("source"),d;if(b.length){var f=0;for(d=b.length;f<d;f++)a.removeChild(b[f])}M(e,"src",c);a.appendChild(e)},onSrcChanged:function(){}}));var Fb=n.dom.preloadImage=function(){function c(c){if(void 0!==a[c])return!1===a[c]?H.reject(c):H.resolve(a[c]);
if(b[c])return b[c];1E3<e&&(a={},e=0);var d=window.document,k=d.createElement("img"),h=k.style,m=new H;b[c]=m;m.always(function(){delete b[c]});O(k,"load",function(){a[c]||(a[c]={src:c,width:k?k.width:null,height:k?k.height:null},e++);m&&m.resolve(a[c]);k&&k.parentNode&&k.parentNode.removeChild(k);m=h=k=null});O(k,"error",function(){a[c]=!1;k&&k.parentNode&&k.parentNode.removeChild(k);m&&m.reject(c)});m.abort=function(){k&&k.parentNode&&k.parentNode.removeChild(k);m&&m.reject(c);m=h=k=null};h.position=
"absolute";h.visibility="hidden";h.left="-10000px";h.top="0";d.body.appendChild(k);k.src=c;return m}var a={},b={},e=0;c.check=function(c){return void 0!==a[c]?a[c]:b[c]||null};return c}();y.registerAttribute("src",1E3,y.$extend({$class:"MetaphorJs.app.Directive.attr.Src",queue:null,usePreload:!0,noCache:!1,attr:null,lastPromise:null,src:null,$constructor:function(c,a,b,e,d){b.setType("deferred","bool",D.MODE_STATIC);b.setType("noCache","bool",D.MODE_STATIC);b.setType("noPreload","bool",D.MODE_STATIC);
b.setDefaultMode("preloadSize",D.MODE_STATIC);b.setDefaultMode("plugin",D.MODE_STATIC);b.get("deferred")&&this.$plugins.push("MetaphorJs.plugin.SrcDeferred");b.get("preloadSize")&&this.$plugins.push("MetaphorJs.plugin.SrcSize");if(b.get("plugin")){e=b.get("plugin").split(",");var f;d=0;for(f=e.length;d<f;d++)this.$plugins.push(e[d].trim())}this.$super(c,a,b)},$init:function(c,a,b,e,d){if(this.usePreload=!b.get("noPreload"))a.style.visibility="hidden";this.queue=new ya({auto:!0,async:!0,mode:ya.REPLACE,
thenable:!0});this.$super(c,a,b,e,d)},onChange:function(){this.cancelPrevious();this.usePreload&&(this.node.style.visibility="hidden");this.queue.add(this.doChange,this)},doChange:function(){if(!this.$destroyed&&!this.$destroying){var c=this.config.get("value");c&&(this.src=c,this.config.get("noCache")&&(c+=(-1!==c.indexOf("?")?"&amp;":"?")+"_"+(new Date).getTime()),this.usePreload?(this.lastPromise=Fb(c))&&this.lastPromise.done(this.onImagePreloaded,this):this.node&&(this.node.src=c,M(this.node,
"src",c),this.onSrcChanged()))}},cancelPrevious:function(){this.lastPromise&&(this.lastPromise.isPending()&&this.lastPromise.abort(),this.lastPromise=null)},onImagePreloaded:function(){var c=this,a=c.src;c&&c.node&&U(function(){c.node&&(c.node.src=a,M(c.node,"src",a),c.onSrcChanged(),c.node.style.visibility="",c.scope.$scheduleCheck(50))});c.lastPromise=null},onSrcChanged:function(){},onScopeReset:function(){this.cancelPrevious();this.$super()},onDestroy:function(){this.$destroyed||(this.cancelPrevious(),
this.queue.$destroy(),this.$super())}}));var Qa=n.dom.removeStyle=function(){var c=window.document.createElement("div");return c.style&&c.style.removeProperty?function(a,b){a.style.removeProperty(b)}:function(a,b){a.style.removeAttribute(b)}}();y.registerAttribute("style",1E3,y.$extend({$class:"MetaphorJs.app.Directive.attr.Style",$init:function(c,a,b,e,d){var f=this;b.eachProperty(function(a){if(0===a.indexOf("value."))b.on(a,f.onChange,f)});this.$super(c,a,b)},getCurrentValue:function(){var c=this.config.getAllValues();
c[""]&&(q(c,c[""]),delete c[""]);return c},onChange:function(){var c=this.node,a=c.style,b=this.getCurrentValue(),e=this.prev,d;for(d in e)b&&void 0!==b[d]||Qa(c,d);if(b)for(d in b)e=ab(d),void 0!==b[d]&&null!==b[d]?a[e]=b[d]:Qa(c,d);this.prev=b}}));var Gb=n.dom.transclude=function(c,a){for(var b=c.parentNode,e;b;){e=P(b,"mjs-transclude");if(void 0!==e)break;b=b.parentNode}if(e){c.firstChild&&P(c,"mjs-transclude",ea(c.childNodes));b=c.parentNode;var d=c.nextSibling;e=Pa(e);var f=X(e.childNodes);a?
(b.removeChild(c),b.insertBefore(e,d)):c.appendChild(e);return f}return null};y.registerAttribute("transclude",1E3,function(c,a,b,e,d){return Gb(a)});y.registerAttribute("update-on",1E3,function(c,a,b,e,d){var f=function(a){b.eachProperty(function(d){if(0===d.indexOf("value.")){var e=d.replace("value.","");d=b.get(d);d.$destroyed||d.$destroying||d&&(fn=d[a]||d["$"+a])&&fn.call(d,e,c.$check,c)}})};f("on");return function(){f&&(f("un"),f=cfgs=null)}});var cc=n.app.StoreRenderer=ib.$extend({store:null,
$constructor:function(c,a,b,e,d){var f=b.getAll();f.pullNext&&(f.buffered&&(f.bufferedPullNext=!0,f.buffered=!1),this.$plugins.push("string"===typeof f.pullNext?f.pullNext:"MetaphorJs.plugin.ListPullNext"));this.$super(c,a,b,e,d)},afterInit:function(c,a,b,e,d){this.store=c=G.get(this.model,c);this.watcher=ja.get(c,"this.current",this.onChange,this);!1!==this.trackByFn&&(this.trackByFn=c.getRecordId.bind(c));this.griDelegate=c.indexOfId.bind(c);this.bindStore(c,"on")},bindStore:function(c,a){c[a]("update",
this.onStoreUpdate,this);c[a]("clear",this.onStoreUpdate,this);c[a]("destroy",this.onStoreDestroy,this)},onStoreUpdate:function(){this.watcher.check()},getListItem:function(c,a){return this.store.getRecordData(c[a])},onStoreDestroy:function(){this.watcher&&(this.onStoreUpdate(),this.watcher.unsubscribe(this.onChange,this),this.watcher.$destroy(!0),this.watcher=null)},onDestroy:function(){this.store.$destroyed||this.bindStore(this.store,"un");this.$super()}},{$stopRenderer:!0,$registerBy:"id"}),Hb=
function(){var c=function(a,b,c){if(B(b))return b(a,c);if(""===b||void 0===b)return!0;if(void 0!==a){if(sa(a))return a===b;if(b instanceof RegExp)return b.test(""+a);if("strict"===c)return""+a===""+b;if(!0===c||null===c||void 0===c)return-1!=(""+a).toLowerCase().indexOf((""+b).toLowerCase());if(!1===c)return-1==(""+a).toLowerCase().indexOf((""+b).toLowerCase())}return!1},a=function(a,b,f){if(B(b))return b(a,f);if(bb(a))return void 0===b.$?!0:c(a,b.$,f);var d,e;for(d in b)if("$"===d)for(e in a){if(c(a[e],
b.$,f))return!0}else if(c(a[d],b[d],f))return!0;return!1},b=function(b,c,f){ia(c)||B(c)||(c={$:c});var d=[],e;var m=-1;for(e=b.length;++m<e;)a(b[m],c,f)&&d.push(b[m]);return d};b.compare=a;return b}();n.model=n.model||{};var ma=n.mixin.Observable={$$observable:null,$$callbackContext:null,$$events:null,$beforeInit:function(c){this.$$observable=new la;this.$initObservable(c)},$initObservable:function(c){var a=this.$$observable,b;if(c&&c.callback){var e=c.callback,d=e.context||e.scope||e.$context,f=
q({},this.$$events,e.$events,!0,!1);for(b in f)a.createEvent(b,f[b]);e.context=null;e.scope=null;for(b in e)if(e[b])a.on(b,e[b],d||this);c.callback=null;d&&(this.$$callbackContext=d)}else if(this.$$events)for(b in this.$$events)a.createEvent(b,this.$$events[b])},on:function(){var c=this.$$observable;return c?c.on.apply(c,arguments):null},un:function(){var c=this.$$observable;return c?c.un.apply(c,arguments):null},once:function(){var c=this.$$observable;return c?c.once.apply(c,arguments):null},trigger:function(){var c=
this.$$observable;return c?c.trigger.apply(c,arguments):null},$beforeDestroy:function(){this.$$observable.trigger("before-destroy",this)},$afterDestroy:function(){this.$$observable.trigger("destroy",this);this.$$observable.$destroy();this.$$observable=null}},oa=n.model.Model=function(){var c={},a={};return C({$mixins:[ma],type:null,fields:null,record:null,store:null,plain:!1,lastAjaxResponse:null,$init:function(a){this.fields||(this.fields={});q(this,{record:{load:null,save:null,"delete":null,id:null,
data:null,success:null,extra:{}},store:{load:null,save:null,"delete":null,id:null,data:null,total:null,start:null,limit:null,success:null,extra:{}}},!1,!0);q(this,a,!0,!0);this.plain=!this.type},isPlain:function(){return this.plain},getRecordProp:function(a,c){return this.getProp("record",a,c)},setRecordProp:function(a,c){this.record[a]=c},getStoreProp:function(a,c){return this.getProp("store",a,c)},setStoreProp:function(a,c){this.store[a]=c},getProp:function(a,c,d){a=this[a];return a[c]&&a[c][d]||
a[d]||this[d]||null},setProp:function(a,c){return this[a]=c},_prepareRequestUrl:function(a,c){a=a.replace(/:([a-z0-9_\-]+)/gi,function(a,b){var d=c[b];return void 0!=d?(delete c[b],d):a});return/:([a-z0-9_\-]+)/.test(a)?null:a},_makeRequest:function(a,c,d,f){var b=this,e=b[a],m=q({},w(e[c])||B(e[c])?{url:e[c]}:e[c]),p=b.getProp(a,c,"id"),n=b.getProp(a,c,"root"),t=b.getProp(a,c,"url"),r=b.getProp(a,c,"json"),v={};if(!m)if(t)m={url:t};else throw a+"."+c+" not defined";if(w(m)||B(m))m={url:m};if(!m.url){if(!t)throw a+
"."+c+" url not defined";m.url=t}v.url=m.url;m.ajax&&q(v,m.ajax,!0,!1);if(m.validate&&(t=m.validate.call(b,d,f),!1===t))return H.reject(t);if(m.resolve){if((t=m.resolve.call(b,d,f))&&Y(t))return t;if(t)return H.resolve(t)}v.data=q({},m.data,b.extra,e.extra,e[c]?e[c].extra:null,v.data,f,!0,!0);if(B(m.url)){d=m.url(v.data);var A=new H;d.then(function(d){"record"===a?b._processRecordResponse(c,d,A):"store"===a&&b._processStoreResponse(c,d,A)});return A}d&&p&&(v.data[p]=d);f&&n&&"load"!==c&&(v.data[n]=
f);v.url=b._prepareRequestUrl(v.url,v.data);if(!v.url)return H.reject();v.method||(v.method="controller"!==a?"load"===c?"GET":"POST":"GET");r&&v.data&&"GET"!==v.method&&(v.contentType="text/plain",v.data=JSON.stringify(v.data));v.context=b;if("record"===a){v.processResponse=function(a,d){b.lastAjaxResponse=a;b._processRecordResponse(c,a,d)};var y=b._processRecordRequest(Ha(v),c,d,f)}else"store"===a?(v.processResponse=function(a,d){b.lastAjaxResponse=a;b._processStoreResponse(c,a,d)},y=b._processStoreRequest(Ha(v),
c,d,f)):"controller"===a&&(v.processResponse=function(a,d){b.lastAjaxResponse=a;b._processControllerResponse(c,a,d)},y=b._processControllerRequest(Ha(v),c,d,f));m.processRequest&&m.processRequest.call(b,y,d,f);return y},_processRecordRequest:function(a,c,d,f){return a},_processRecordResponse:function(a,c,d){var b=this.getRecordProp(a,"id"),e=this.getRecordProp(a,"root");b=(e=e?c[e]:c)&&e[b]||c[b];this._getSuccess("record",a,c)?d.resolve({id:b,data:this.extendPlainRecord(e)}):d.reject(c)},_processStoreRequest:function(a,
c,d,f){return a},_processStoreResponse:function(a,c,d){var b=this.getStoreProp(a,"root"),e=this.getStoreProp(a,"total");b=b?c[b]:c;e=e?c[e]:null;this._getSuccess("store",a,c)?d.resolve({data:b,total:e}):d.reject(c)},_processControllerRequest:function(a,c,d,f){return a},_processControllerResponse:function(a,c,d){this._getSuccess("controller",a,c)?d.resolve(c):d.reject(c)},_getSuccess:function(a,c,d){a=this.getProp(a,c,"success");return"function"===typeof a?a(d):a&&void 0!=d[a]?d[a]:!0},runController:function(a,
c,d){return this._makeRequest("controller",a,c,d)},loadRecord:function(a){return this._makeRequest("record","load",a)},saveRecord:function(a,c,d){return this._makeRequest("record",a.getId()?"save":"create",a.getId(),q({},a.storeData(a.getData(c)),d))},deleteRecord:function(a){return this._makeRequest("record","delete",a.getId())},loadStore:function(a,c){return this._makeRequest("store","load",null,c)},saveStore:function(a,c){return this._makeRequest("store","save",null,c)},deleteRecords:function(a,
c){return this._makeRequest("store","delete",c)},extendPlainRecord:function(a){var b=this.getRecordProp(null,"extend");return b?q(a,b,!1,!1):a},getFields:function(){return this.fields},getRecordId:function(a){var b=this.getRecordProp("load","id");return(a.getId?a.getId():a[b])||null},restoreField:function(a,c,d){var b=this.fields[c];if(b){switch(w(b)?b:b.type){case "int":d=parseInt(d);break;case "bool":case "boolean":w(d)?(d=d.toLowerCase(),d=!("off"===d||"no"===d||"0"===d||"false"==d||"null"==d)):
d=d?!0:!1;break;case "double":case "float":d=parseFloat(d);break;case "date":b.parseFn?d=b.parseFn(d,b.format):Date.parse?d=Date.parse(d,b.format):("timestamp"===b.format&&(d=1E3*parseInt(d)),d=new Date(d))}b.restore&&(d=b.restore.call(a,d,c))}return this.onRestoreField(a,c,d)},onRestoreField:function(a,c,d){return d},storeField:function(a,c,d){var b=this.fields[c];if(b){switch(w(b)?b:b.type){case "bool":case "boolean":d=d?"1":"0";break;case "date":d=b.formatFn?b.formatFn(d,b.format):Date.format?
Date.format(d,b.format):"timestamp"===b.format?d.getTime()/1E3:d.format?d.format(b.format):d.toString();break;default:d=d.toString()}b.store&&(d=b.store.call(a,d,c))}return this.onStoreField(a,c,d)},onStoreField:function(a,c,d){return d}},{create:function(a,e){return"MetaphorJs.model.Model"===a?C.factory(a,e):e?C.factory(a,e):c[a]?c[a]:c[a]=C.factory(a)},addToCache:function(b){var c=b.getId(),d=b.$getClass();b instanceof n.model.Record||!d||(a[d]||(a[d]={}),a[d][c]=b)},getFromCache:function(b,c){return a[b]&&
a[b][c]?a[b][c]:null},removeFromCache:function(b,c){a[b]&&a[b][c]&&delete a[b][c]}})}(),Ja=n.model.Record=C({$mixins:[ma],id:null,data:null,orig:null,modified:null,loaded:!1,loading:!1,dirty:!1,model:null,standalone:!0,stores:null,importUponSave:!1,importUponCreate:!1,$init:function(c,a,b){var e=arguments.length;1===e?(b=c,a=c=null):2===e&&(b=a,a=null);this.data={};this.orig={};this.stores=[];this.modified={};b=b||{};this.$super(b);w(this.model)?this.model=oa.create(this.model):this.model instanceof
oa||(this.model=new oa(this.model));this.id=c;a?this.importData(a):!1!==b.autoLoad&&c&&this.load();"MetaphorJs.model.Record"!==this.$getClass()&&oa.addToCache(this)},isLoaded:function(){return this.loaded},isLoading:function(){return this.loading},isStandalone:function(){return this.standalone},isDirty:function(){return this.dirty},getModel:function(){return this.model},attachStore:function(c){c=c.getId();-1==this.stores.indexOf(c)&&this.stores.push(c)},detachStore:function(c){c=c.getId();var a;this.$destroyed||
-1==(a=this.stores.indexOf(c))||(this.stores.splice(a,1),0!=this.stores.length||this.standalone||this.$destroy())},setDirty:function(c){this.dirty!=c&&(this.dirty=!!c,this.trigger("dirty-change",this,c))},importData:function(c){var a={},b;if(c){for(b in c)a[b]=this.model.restoreField(this,b,c[b]);this.data=a}this.orig=q({},this.data);this.modified={};this.loaded=!0;this.setDirty(!1)},storeData:function(c){var a={},b;for(b in c)a[b]=this.model.storeField(this,b,c[b]);return a},getId:function(){return this.id},
getData:function(c){var a={};if(c){var b;c=w(c)?[c]:c;var e=0;for(b=c.length;e<b;e++)a[c[e]]=this.data[c[e]]}else for(e in c=this.data,c)"$"!==e.substr(0,1)&&(a[e]=c[e]);return a},getChanged:function(){return q({},this.modified)},isChanged:function(c){return this.modified[c]||!1},get:function(c){return this.data[c]},setId:function(c){!this.id&&c&&(this.id=c)},set:function(c,a){var b=this.data[c];a=this.model.restoreField(this,c,a);this.data[c]=a;b!=a&&(this.modified[c]=!0,this.setDirty(!0),this.trigger("change",
this,c,a,b),this.trigger("change-"+c,this,c,a,b))},revert:function(){this.dirty&&(this.data=q({},this.orig),this.modified={},this.setDirty(!1))},load:function(){var c=this;c.loading=!0;c.trigger("before-load",c);return c.model.loadRecord(c.id).always(function(){c.loading=!1}).done(function(a){c.setId(a.id);c.importData(a.data);c.trigger("load",c)}).fail(function(){c.trigger("failed-load",c)})},save:function(c,a){var b=this;b.trigger("before-save",b);var e=b.getId()?b.importUponSave:b.importUponCreate;
return b.model.saveRecord(b,c,a).done(function(a){a.id&&b.setId(a.id);e&&b.importData(a.data);b.trigger("save",b)}).fail(function(a){b.trigger("failed-save",b)})},"delete":function(){var c=this;c.trigger("before-delete",c);return c.model.deleteRecord(c).done(function(){c.trigger("delete",c);c.$destroy()}).fail(function(){c.trigger("failed-delete",c)})},reset:function(){this.id=null;this.data={};this.orig={};this.modified={};this.dirty=this.loaded=!1;this.trigger("reset",this)},onDestroy:function(){oa.removeFromCache(this.$getClass(),
this.id);this.$super()}}),Ib=n.model.Store=function(){var c={};return C({$mixins:[ma],id:null,autoLoad:!1,clearOnLoad:!0,model:null,extraParams:null,loaded:!1,loading:!1,local:!1,items:null,current:null,map:null,currentMap:null,length:0,currentLength:0,maxLength:0,totalLength:0,start:0,pageSize:null,pages:null,filtered:!1,sorted:!1,filterBy:null,filterOpt:null,sortBy:null,sortDir:null,publicStore:!1,idProp:null,loadingPromise:null,$init:function(a,b,e){this.items=[];this.current=[];this.map={};this.currentMap=
{};this.loaded=!1;this.extraParams=this.extraParams||{};a&&!w(a)&&(e=b,b=a,a=null);b=b||{};a&&(b.url=a);this.$super(b);q(this,b,!0,!1);this.id=this.id||W();this.publicStore&&(c[this.id]=this);this.initModel(b);this.$$observable.createEvent("beforeload",!1);!this.local&&this.autoLoad?this.load():e&&(I(e)?this._loadArray(e):this._loadAjaxData(e));this.local&&(this.loaded=!0);this.sourceStore&&this.initSourceStore(this.sourceStore,"on")},setModel:function(a){this.model=a;this.initModel({})},initModel:function(a){w(this.model)?
this.model=oa.create(this.model):this.model instanceof oa||(this.model=new oa(this.model));a.url&&(this.model.store.load=a.url);this.idProp=this.model.getStoreProp("load","id")},initSourceStore:function(a,b){a[b]("update",this.onSourceStoreUpdate,this)},onSourceStoreUpdate:function(){this.$$observable.suspendAllEvents();this.clear();this.addMany(this.sourceStore.toArray());this.$$observable.resumeAllEvents();this.trigger("update",this)},getId:function(){return this.id},isLoaded:function(){return this.loaded},
isLocal:function(){return this.local},setLocal:function(a){this.local=!!a},isLoading:function(){return this.loading},isFiltered:function(){return this.filtered},isSorted:function(){return this.sorted},getLength:function(a){return a?this.length:this.currentLength},getTotalLength:function(){return this.totalLength||this.currentLength},isEmpty:function(){return 0===this.length},getPagesCount:function(){return null!==this.pageSize?parseInt(this.totalLength/this.pageSize):1},setParam:function(a,b){null===
b?delete this.extraParams[a]:this.extraParams[a]=b},getParam:function(a){return this.extraParams[a]},getParams:function(){return q({},this.extraParams)},clearParams:function(){this.extraParams={}},setStart:function(a){this.start=a},setPageSize:function(a){this.pageSize=a},getAjaxData:function(){return this.ajaxData},hasDirty:function(a){if(this.model.isPlain())return!1;var b=!1;this.each(function(a){return a.isDirty()?(b=!0,!1):!0},null,a);return b},getDirty:function(a){var b=[];if(this.model.isPlain())return b;
this.each(function(a){a.isDirty()&&b.push(a)},null,a);return b},getModel:function(){return this.model},toArray:function(){return this.current.slice()},_loadAjaxData:function(a,b){var c=this;b=b||{};if(b.silent||!1!==c.trigger("before-load",c))c.ajaxData=a,c.model._processStoreResponse("load",a,{resolve:function(a){c._onModelLoadSuccess(a,b)},reject:function(a){c._onModelLoadFail(a,b)}})},_loadArray:function(a,b){b=b||{};(b.silent||!1!==this.trigger("before-load",this))&&I(a)&&(this._load(a,b),this.totalLength=
this.length)},_load:function(a,b){var c=b.prepend;b=b||{};a=a||[];c?this.insertMany(0,a,!0,!0):this.addMany(a,!0,!0);this.loaded=!0;this.loading=!1;this.trigger("loading-end",this);this.onLoad();b.skipUpdate||this.update();b.silent||this.trigger("load",this)},load:function(a,b){var c=this,d=c.model.store,f=d.start;d=d.limit;var k=c.pageSize;c.loadingPromise&&c.loadingPromise.abort&&c.loadingPromise.abort();b=b||{};if(c.local)return null;a=q({},c.extraParams,a||{});null===k||a[f]||a[d]||(f&&(a[f]=
c.start),d&&(a[d]=k));if(!b.silent&&!1===c.trigger("before-load",c))return null;c.loading=!0;c.trigger("loading-start",c);return c.loadingPromise=c.model.loadStore(c,a).done(function(a){c.$destroyed||(c.loadingPromise=null,c.ajaxData=c.model.lastAjaxResponse,c._onModelLoadSuccess(a,b))}).fail(function(a){c.$destroyed||(c.loadingPromise=null,c.ajaxData=c.model.lastAjaxResponse,c._onModelLoadFail(a,b))})},_onModelLoadSuccess:function(a,b){b=b||{};if(!b.noopOnEmpty||a.data.length)!b.prepend&&!b.append&&
this.clearOnLoad&&0<this.length&&this.clear(!0),this.totalLength=parseInt(a.total),this._load(a.data,b)},_onModelLoadFail:function(a,b){this.onFailedLoad();b.silent||this.trigger("failed-load",this,a)},onLoad:J,onFailedLoad:J,save:function(a){var b=this,c={},d=0;if(b.local)return null;if(b.model.isPlain())throw Error("Cannot save plain store");b.each(function(a){a.isDirty()&&(c[a.getId()]=a.storeData(a.getData()),d++)});return!d||!a&&!1===b.trigger("before-save",b,c)?null:b.model.saveStore(b,c).done(function(c){b._onModelSaveSuccess(c,
a)}).fail(function(c){b._onModelSaveFail(c,a)})},_onModelSaveSuccess:function(a,b){var c,d=a.data;if(d&&d.length)for(a=0,c=d.length;a<c;a++){var f=this.getRecordId(d[a]);(f=this.getById(f))&&f.importData(d[a])}this.onSave();b||this.trigger("save",this)},_onModelSaveFail:function(a,b){this.onFailedSave(a);b||this.trigger("failed-save",this,a)},onSave:J,onFailedSave:J,deleteById:function(a,b,c){var d=this,e;if(d.local)return null;if(!a||I(a)&&!a.length)throw Error("Record id required");I(a)||(a=[a]);
var k=0;for(e=a.length;k<e;k++){var h=d.getById(a[k]);d.remove(h,b,c);h instanceof Ja&&h.$destroy()}return b||!1!==d.trigger("before-delete",d,a)?d.model.deleteRecords(d,a).done(function(){d.totalLength-=a.length;d.onDelete();b||d.trigger("delete",d,a)}).fail(function(){d.onFailedDelete();b||d.trigger("failed-delete",d,a)}):null},onDelete:J,onFailedDelete:J,deleteAt:function(a,b,c){var d=this.getAt(a);if(!d)throw Error("Record not found at "+a);return this["delete"](d,b,c)},"delete":function(a,b,
c){return this.deleteById(this.getRecordId(a),b,c)},deleteRecords:function(a,b,c){var d=[],e;var k=0;for(e=a.length;k<e;k++)d.push(this.getRecordId(a[k]));return this.deleteById(d,b,c)},loadOr:function(a){return this.local||this.isLoading()||this.isLoaded()?n.lib.Promise.resolve(this):this.load(null,a)},addPrevPage:function(a){a=a||{};a.append=!1;a.prepend=!0;a.noopOnEmpty=!0;return this.loadPrevPage(a)},addNextPage:function(a){a=a||{};a.append=!0;a.prepend=!1;a.noopOnEmpty=!0;return this.local||
this.totalLength&&!(this.length<this.totalLength)?n.lib.Promise.resolve():this.load({start:this.length,limit:this.pageSize},a)},loadNextPage:function(a){return this.local||this.totalLength&&!(this.length<this.totalLength)?n.lib.Promise.resolve():(this.start+=this.pageSize,this.load(null,a))},loadPrevPage:function(a){return!this.local&&0<this.start?(this.start-=this.pageSize,0>this.start&&(this.start=0),this.load(null,a)):n.lib.Promise.resolve()},loadPage:function(a,b){return this.local?n.lib.Promise.resolve():
(this.start=parseInt(a,10),0>this.start&&(this.start=0),this.load(null,b))},getRecordId:function(a){return a instanceof Ja?a.getId():this.model?this.model.getRecordId(a)||a[this.idProp]||null:a[this.idProp]||null},getRecordData:function(a){return this.model.isPlain()?a:a.data},processRawDataItem:function(a){if(a instanceof Ja)return a;if(this.model.isPlain())return this.model.extendPlainRecord(a);var b=this.model.type,c=this.getRecordId(a),d;c&&(d=oa.getFromCache(b,c));d||(d=C.factory(b,c,a,{model:this.model,
standalone:!1}));return d},bindRecord:function(a,b){b[a]("change",this.onRecordChange,this);b[a]("destroy",this.onRecordDestroy,this);b[a]("dirty-change",this.onRecordDirtyChange,this);return b},onRecordDirtyChange:function(a){this.trigger("update",this,a)},onRecordChange:function(a,b,c,d){this.trigger("update",this,a)},onRecordDestroy:function(a){this.remove(a)},shift:function(a,b,c){return this.removeAt(0,1,a,b,c)},unshift:function(a,b,c){return this.insert(0,a,b,c)},pop:function(a,b,c){return this.removeAt(this.length-
1,1,a,b,c)},addMany:function(a,b,c){var d,e=this.length;var k=0;for(d=a.length;k<d;k++)this.insert(e+k,a[k],!0,!0);c||this.update();0<d&&!b&&this.trigger("add",a)},add:function(a,b,c){return this.insert(this.length,a,b,c)},onAdd:J,removeAt:function(a,b,c,d,f){var e=0,h=this.length;if(0!==h&&null!==a){for(;0>a;)a=h+a;null==b&&(b=1);for(f||(a=this.items.indexOf(this.current[a]));a<this.length&&0<=a&&e<b;){this.length--;f=this.items[a];this.items.splice(a,1);h=this.getRecordId(f);void 0!==h&&(delete this.map[h],
delete this.currentMap[h]);this.onRemove(f,h);d||this.update();c||this.trigger("remove",f,h);if(f instanceof Ja){if(this.bindRecord("un",f),f.detachStore(this),1===b)return f.$destroyed?void 0:f}else if(1===b)return f;e++}}},removeRange:function(a,b,c,d,f){var e=this.length;if(0!==e){if(null==a&&null==b)return this.clear(c);for(null==a&&(a=0);0>a;)a=e+a;for(null==b&&(b=e-1);0>b;)b=e+a;return this.removeAt(a,b-a+1,c,d,f)}},onRemove:J,insertMany:function(a,b,c,d){var e;var k=0;for(e=b.length;k<e;k++)this.insert(a+
k,b[k],!0,!0);0<e&&!d&&this.update();0<e&&!c&&this.trigger("add",b)},insert:function(a,b,c,d){var e=!1;b=this.processRawDataItem(b);var k=this.getRecordId(b);this.map[k]&&(this.$$observable.suspendAllEvents(),this.removeId(k),this.$$observable.resumeAllEvents());a>=this.length?(this.items.push(b),e=!0):this.items.splice(a,0,b);this.length++;this.maxLength&&this.length>this.maxLength&&(e?this.pop(c,!0):this.shift(c,!0));void 0!==k&&(this.map[k]=b);b instanceof Ja&&(b.attachStore(this),this.bindRecord("on",
b));this.onAdd(a,b);d||this.update();c||this.trigger("add",[b]);return b},replace:function(a,b,c,d){var e=this.items.indexOf(a);this.removeAt(e,1,!0,!0,!0);this.insert(e,b,!0,!0);d||this.update();this.onReplace(a,b);c||this.trigger("replace",a,b);return b},replaceId:function(a,b,c,d){a=this.indexOfId(a);return this.replace(this.getAt(a),b,c,d)},onReplace:J,remove:function(a,b,c){a=this.indexOf(a,!0);return-1!==a?this.removeAt(a,1,b,c,!0):null},removeId:function(a,b,c){a=this.indexOfId(a,!0);if(-1!==
a)return this.removeAt(a,1,b,c,!0)},contains:function(a,b){return-1!==this.indexOf(a,b)},containsId:function(a,b){return b?void 0!==this.map[a]:void 0!==this.currentMap[a]},clear:function(a){var b=this.getRange();this._reset();this.onClear();a||this.trigger("clear",this,b)},onClear:J,reset:function(){this._reset();this.start=0},_reset:function(a){var b;if(!a)for(a=0,b=this.items.length;a<b;a++){var c=this.items[a];c instanceof Ja&&(this.bindRecord("un",c),c.detachStore(this))}this.totalLength=this.currentLength=
this.length=0;this.items=[];this.current=[];this.map={};this.currentMap={};this.loaded=this.local},getAt:function(a,b){return b?this.items[a]||void 0:this.current[a]||void 0},getById:function(a,b){return b?this.map[a]||void 0:this.currentMap[a]||void 0},indexOf:function(a,b){return b?this.items.indexOf(a):this.current.indexOf(a)},indexOfId:function(a,b){return this.indexOf(this.getById(a,b),b)},each:function(a,b,c){c=c?this.items.slice():this.current.slice();for(var d=0,e=c.length;d<e&&!1!==a.call(b,
c[d],d,e);d++);},eachId:function(a,b,c){var d=this;d.each(function(c,e,h){return a.call(b,d.getRecordId(c),e,h)},null,c)},collect:function(a,b){var c=[],d=!this.model.isPlain();this.each(function(b){(b=d?b.get(a):b[a])&&c.push(b)},null,b);return c},first:function(a){return a?this.items[0]:this.current[0]},last:function(a){return a?this.items[this.length-1]:this.current[this.current-1]},getRange:function(a,b,c){c=c?this.items:this.current;var d=[];if(1>c.length)return d;a=a||0;b=Math.min(void 0==b?
this.length-1:b,this.length-1);if(a<=b)for(;a<=b;a++)d.push(c[a]);else for(;a>=b;a--)d.push(c[a]);return d},findBy:function(a,b,c,d){a=this.findIndexBy(a,b,c,d);return-1===a?void 0:this.getAt(a,d)},findIndexBy:function(a,b,c,d){d=d?this.items:this.current;c=c||0;for(var e=d.length;c<e;c++)if(a.call(b,d[c],this.getRecordId(d[c])))return c;return-1},find:function(a,b,c,d){var e=!this.model.isPlain(),k,h=this.findIndexBy(function(d){k=e?d.get(a):d[a];return c?k===b:k==b},this,0,d);return-1!==h?this.getAt(h,
d):null},findExact:function(a,b,c){return this.find(a,b,!0,c)},findBySet:function(a,b){var c=null,d,f;this.each(function(b){d=!0;for(f in a)if(a[f]!=b[f]){d=!1;break}return d?(c=b,!1):!0},null,b);return c},update:function(){var a=this,b=a.filtered,c=a.sorted,d=a.model.isPlain();a.currentLength=a.length;a.currentMap=a.map;a.current=a.items;if(b){var f=a.filterBy,k=a.filterOpt,h,m;a.current=h=[];a.currentMap=m={};a.each(function(b){Hb.compare(d?b:b.data,f,k)&&(h.push(b),m[a.getRecordId(b)]=b)},null,
!0);a.currentLength=a.current.length}if(c){var p=a.sortBy,n=!a.model.isPlain();b=function(a){return n?a.get(p):a[p]};a.current=ub(a.current,B(p)?{fn:p}:b,a.sortDir)}a.trigger("update",a)},filter:function(a,b){this.filtered=!0;this.filterBy=a;this.filterOpt=b;this.update()},clearFilter:function(){this.filtered&&(this.filterOpt=this.filterBy=null,this.update())},sort:function(a,b){this.sorted=!0;this.sortBy=a;this.sortDir=b;this.update()},clearSorting:function(){this.sorted=!1;this.sortDir=this.sortBy=
null;this.update()},onDestroy:function(){delete c[this.id];this.sourceStore&&this.initSourceStore(this.sourceStore,"un");this.clear();this.trigger("destroy",this);this.$super()}},{lookupStore:function(a){return c[a]||null},eachStore:function(a,b){for(var e in c)if(!1===a.call(b,c[e]))break}})}();y.getDirective("attr","each").registerType(Ib,cc);y.registerTag("transclude",function(c,a){return Gb(a,!0)});n.filter.collect=function(c,a,b){a=[];var e;if(!c)return a;var d=0;for(e=c.length;d<e;d++){var f=
c[d][b];void 0!=f&&a.push(f)}return a};n.filter.filter=function(c,a,b,e){return Hb(c,b,e)};n.filter.get=function(c,a,b){for(a=(""+b).split(".");b=a.shift();)if(c=c[b],void 0===c)return;return c};n.filter.join=function(c,a,b){b=b||", ";return c&&c.length?(I(c)||(c=X(c)),c.join(b)):""};n.filter.l=function(c,a){return a.$app.lang.get(c)};n.filter.limitTo=function(c,a,b){a=w(c);if(!I(c)&&!a)return c;b=Infinity===Math.abs(Number(b))?Number(b):parseInt(b,10);if(a)return b?0<=b?c.slice(0,b):c.slice(b,c.length):
"";a=[];b>c.length?b=c.length:b<-c.length&&(b=-c.length);if(0<b)var e=0;else e=c.length+b,b=c.length;for(;e<b;e++)a.push(c[e]);return a};n.filter.linkify=function(c,a,b){return c?c.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,'<a href="$1"'+(b?' target="'+b+'"':"")+">$1</a>"):""};n.filter.lowercase=function(c){return(""+c).toLowerCase()};n.filter.map=function(c,a,b){var e=[],d=na.get(b,!0)||window[b]||G.get(b,a);c=c||[];if(d)for(a=0,b=c.length;a<b;a++)e.push(d(c[a]));
return e};n.filter.moment=function(c,a,b){return c?moment(c).format(Da.global().get(b,b)):""};n.filter.numeral=function(c,a,b){return numeral(c).format(Da.global().get(b,b))};n.filter.offset=function(c,a,b){a=w(c);if(!I(c)&&!a)return c;b=Infinity===Math.abs(Number(b))?Number(b):parseInt(b,10);return a?c.substr(b):c.slice(b)};n.filter.p=function(c,a,b){return a.$app.lang.plural(c,parseInt(b,10)||0)};n.filter.pl=function(c,a,b){return a.$app.lang.plural(b,parseInt(c,10)||0)};(function(){var c=n.filter.preloaded=
function(a,b){if(!a)return!1;a=Fb.check(a);return!0!==a&&a?Y(a)?(a.always(function(){b.$check()}),!1):!0:!!a};c.$undeterministic=!0;return c})();n.filter.r=function(c,a){return a.$app.lang.get(key)};n.filter.sortBy=function(c,a,b,e){return ub(c,b,e)};n.filter.split=function(c,a,b,e){e=e||void 0;b=b||"/\\n|,/";if(!c)return[];c=""+c;"/"===b.substr(0,1)&&"/"===b.substr(b.length-1)&&(b=Ta(b.substring(1,b.length-1)));c=c.split(b,e);a=-1;for(b=c.length;++a<b;c[a]=c[a].trim());return c};n.filter.toArray=
function(c){if(ia(c)){var a=[],b;for(b in c)c.hasOwnProperty(b)&&a.push({key:b,value:c[b]});return a}return X(c)};n.filter.ucfirst=function(c){return c.substr(0,1).toUpperCase()+c.substr(1)};n.filter.uppercase=function(c){return(""+c).toUpperCase()};var Jb=n.app.init=function(c,a,b,e){var d=n.directive.attr,f=Cb(c,function(a){return!!d[a]}),k=f.directive.app?f.directive.app.config:{},h;if(f.names.app){var m=0;for(h=f.names.app.length;m<h;m++)ka(c,f.names[m])}try{var p=xa(a||"MetaphorJs.app.App",q({},
k),b,c,[c,b]);return!1!==e?p.done(function(a){a.run()}):p}catch(F){return T(F),H.reject(F)}},Kb=n.dom.onReady=function(c,a){var b=!1,e=!0,d=a||window,f=function(a){if("readystatechange"!=a.type||"complete"==h.readyState)ca("load"==a.type?d:h,a.type,f),!b&&(b=!0)&&c.call(d,a.type||a)},k=function(){try{m.doScroll("left")}catch(p){setTimeout(k,50);return}f("poll")};var h=d.document;var m=h.documentElement;if("complete"==h.readyState)c.call(d,"lazy");else{if(h.createEventObject&&m.doScroll){try{e=!d.frameElement}catch(p){}e&&
k()}O(h,"DOMContentLoaded",f);O(h,"readystatechange",f);O(d,"load",f)}};(n.app.run=function(c,a){var b=c||window;if(!b)throw Error("Window object neither defined nor provided");Kb(function(){var c=L("[mjs-app]",b.document),d;var f=-1;for(d=c.length;++f<d;){var k=c[f];Jb(k,z(k,"mjs-app"),a,!0)}},b)})();n.validator=n.validator||{};var Lb=n.validator.messages={required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",
date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:"Please enter no more than {0} characters.",minlength:"Please enter at least {0} characters.",rangelength:"Please enter a value between {0} and {1} characters long.",range:"Please enter a value between {0} and {1}.",
max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}."},Mb=n.validator.checkable=function(c){return/radio|checkbox/i.test(c.type)},lb=n.dom.eachNode=function d(a,b,e){var f,k=a.childNodes;if(!1!==b.call(e,a))for(a=-1,f=k.length>>>0;++a!==f;d(k[a],b,e));},Xa=n.validator.getLength=function(a,b){var e=0;switch(b.nodeName.toLowerCase()){case "select":return lb(b,function(a){a.selected&&e++}),e;case "input":if(Mb(b)){if(b.form)lb(b.form,function(a){a.type==
b.type&&a.name==b.name&&a.checked&&e++});else{var d;if(Oa(b))a=b.ownerDocument;else for(a=b;a.parentNode;)a=a.parentNode;a=L("input[name="+b.name+"]",a);var f=0;for(d=a.length;f<d;f++)a[f].checked&&e++}return e}}return a.length},aa=n.validator.empty=function(a,b){if(!b)return void 0==a||""===a;switch(b.nodeName.toLowerCase()){case "select":return a=ua(b),!a||0==a.length;case "input":if(Mb(b))return 0==Xa(a,b)}return 0==a.trim().length},dc=n.regexp.url=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/i,
ec=n.regexp.email=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;
(function(){return n.validator.methods={required:function(a,b,e){return!1===e?!0:!aa(a,b)},regexp:function(a,b,e){e=e instanceof RegExp?e:new RegExp(e);return aa(a,b)||e.test(a)},notregexp:function(a,b,e){e=e instanceof RegExp?e:new RegExp(e);return aa(a,b)||!e.test(a)},minlength:function(a,b,e){return aa(a,b)||(b?Xa(a.trim(),b)>=e:a.toString().length>=e)},maxlength:function(a,b,e){return aa(a,b)||(b?Xa(a.trim(),b)<=e:a.toString().length<=e)},rangelength:function(a,b,e){var d=b?Xa(a.trim(),b):a.toString().length;
return aa(a,b)||d>=e[0]&&d<=e[1]},min:function(a,b,e){return aa(a,b)||parseInt(a,10)>=e},max:function(a,b,e){return aa(a,b)||parseInt(a,10)<=e},range:function(a,b,e){a=parseInt(a,10);return aa(a,b)||a>=e[0]&&a<=e[1]},email:function(a,b){return aa(a,b)||ec.test(a)},url:function(a,b){return aa(a,b)||dc.test(a)},date:function(a,b){return aa(a,b)||!/Invalid|NaN/.test(new Date(a))},dateiso:function(a,b){return aa(a,b)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(a)},number:function(a,b){return aa(a,b)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(a)},
digits:function(a,b){return aa(a,b)||/^\d+$/.test(a)},creditcard:function(a,b){if(aa(a,b))return!0;if(/[^0-9-]+/.test(a))return!1;b=0;var e=!1;a=a.replace(/\D/g,"");for(var d=a.length-1;0<=d;d--){var f=a.charAt(d);f=parseInt(f,10);e&&9<(f*=2)&&(f-=9);b+=f;e=!e}return 0==b%10},accept:function(a,b,e){e=w(e)?e.replace(/,/g,"|"):"png|jpe?g|gif";return aa(a,b)||a.match(new RegExp(".("+e+")$","i"))},equalto:function(a,b,e,d){e=(b=d.getValidator().getField(e))?b.getElem():e;return a==ua(e)},notequalto:function(a,
b,e,d){e=(b=d.getValidator().getField(e))?b.getElem():e;return a!=ua(e)},zxcvbn:function(a,b,e){return zxcvbn(a).score>=parseInt(e)}}})();var Ya=n.validator.format=function(a,b){if(B(b))return a;I(b)||(b=[b]);var e,d=b.length;for(e=-1;++e<d;a=a.replace(new RegExp("\\{"+e+"\\}","g"),b[e]));return a},fc=n.validator.Field=function(){var a={allowSubmit:!0,alwaysCheck:!1,alwaysDisplayState:!1,data:null,ignore:null,disabled:!1,cls:{valid:"",error:"",ajax:""},errorBox:{cls:"",fn:null,tag:"",position:"after",
elem:null,enabled:!0},callback:{scope:null,destroy:null,statechange:null,errorchange:null,submit:null,check:null,beforeAjax:null,afterAjax:null,displaystate:null},rules:{},messages:{}},b=function(a){if(!a)return{};var b=function(b,d,e){var f=a[b],h=!1;if(void 0!==f){switch(e){case "string":h=w(f);break;case "function":h=B(f);break;case "boolean":h=sa(f)}h&&(a[b]={},a[b][d]=f)}};b("errorBox","enabled","boolean");b("errorBox","tag","string");b("errorBox","fn","function");return a},e=n.validator.methods;
return C({$mixins:[ma],vldr:null,elem:null,rules:null,cfg:null,input:null,enabled:!0,valid:null,dirty:!1,id:null,prev:"",error:null,errorRule:null,pending:null,rulesNum:0,displayState:!1,data:null,checking:!1,checkTmt:null,errorBox:null,customError:!1,$init:function(d,e,k){e=e||{};var f;this.cfg=f=q({},a,b(n.validator.Field.defaults),b(e),!0,!0);this.input=va.get(d);this.input.onChange(this.onInputChange,this);this.input.onKey(13,this.onInputSubmit,this);this.elem=d;this.vldr=k;this.enabled=!d.disabled;
this.id=z(d,"name")||z(d,"id");this.data=e.data;this.rules={};f.messages=q({},Lb,f.messages,!0,!0);M(d,"data-validator",k.getVldId());this.input.radio&&this.initRadio();f.rules&&this.setRules(f.rules,!1);this.readRules();this.prev=this.input.getValue();f.disabled&&this.disable()},getValidator:function(){return this.vldr},initRadio:function(){var a=this.input.radio,b=this.vldr.getVldId(),e;var h=0;for(e=a.length;h<e;h++)M(a[h],"data-validator",b)},setRules:function(a,b){b=void 0==b?!0:b;for(var d in a)this.setRule(d,
a[d],!1);b?this.check(!1):this.setValidState(null);return this},setRule:function(a,b,e){var d=this.rules;e=void 0==e?!0:e;null===b?(d[a]&&this.rulesNum--,delete d[a]):(d[a]||this.rulesNum++,d[a]=b,null!==this.valid&&this.setValidState(!1));e?this.check(!1):this.setValidState(null);return this},setMessage:function(a,b){this.cfg.messages[a]=b;return this},setMessages:function(a){for(var b in a)this.setMessage(b,a[b]);return this},getMessages:function(){return q({},this.cfg.messages)},readRules:function(){var a=
this.elem,b=a.className,k={};for(m in e)if(e.hasOwnProperty(m)){var h=z(a,m)||z(a,"data-validate-"+m);void 0!=h&&!1!==h&&("minlength"!==m&&"maxlength"!==m||-1!==parseInt(h,10))&&(k[m]=h,(h=z(a,"data-message-"+m))&&this.setMessage(m,h))}if(h=z(a,"remote"))k.remote=h;if(b){b=b.split(" ");var m=0;for(h=b.length;m<h;m++)if(a=b[m].trim(),e[a]||"remote"===a)k[a]=!0}for(m in k)this.setRule(m,k[m],!1)},getRules:function(){return this.rules},hasRule:function(a){return this.rules[a]?!0:!1},getValue:function(){return this.input.getValue()},
getUserData:function(){return this.data},setUserData:function(a){var b=this.data;this.data=a;return b},isEmpty:function(){return aa(this.getValue(),this.elem)},enable:function(){this.enabled=!0;this.vldr.reset();return this},disable:function(){this.enabled=!1;!1===this.valid&&(this.setValidState(!0),this.doDisplayState());return this},enableDisplayState:function(){this.displayState=!0},disableDisplayState:function(){this.displayState=!1},isDisplayStateEnabled:function(){return this.displayState},
toggleErrorBox:function(a){var b=this.cfg,d=b.errorBox.enabled;b.errorBox.enabled=a;!d&&a&&a.displayState&&!1===this.valid()&&this.doDisplayState()},isEnabled:function(){return this.enabled},getElem:function(){return this.elem},getName:function(){return this.id},getError:function(){return this.error},getErrorRule:function(){return this.errorRule},isValid:function(){return this.isEnabled()?this.customError?!1:!0===this.valid&&!this.pending||0===this.rulesNum:!0},getExactValidState:function(){return this.valid},
setCustomError:function(a,b){this.customError=a?!0:!1;this.setValidState(a?!1:!0);this.setError(!0===a?null:a,b);this.doDisplayState()},reset:function(){this.abort();this.dirty=!1;this.prev="";this.setValidState(null);this.setError(null);this.doDisplayState();return this},abort:function(){this.pending&&(this.pending.abort(),this.pending=null);return this},check:function(a){var b=this.rules,d=this.cfg,h=this.elem;if(!this.isEnabled())return!0;if(this.customError)return!1;if(0==this.rulesNum&&!1!==
this.valid)return!0;if(this.checking)return this.checkTmt||(this.checkTmt=setTimeout(this.checkTimeout.bind(this),100)),!0===this.valid;this.checking=!0;if(!(!0===a||b.equalTo||b.notEqualTo||this.dirty||null===this.valid||d.alwaysCheck))return this.pending||this.doDisplayState(),this.checking=!1,!0===this.valid;var m=!0,p=!1,n=this.getValue(),t,r;for(r in b)if("remote"===r){if(this.dirty||d.alwaysCheck||null===this.valid||!0===a)if(n||b[r].checkEmpty)p=!0}else if(!0!==(t=(B(b[r])?b[r]:e[r]).call(this.$$callbackContext,
n,h,b[r],this))){m=!1;this.setError(Ya(t||d.messages[r]||"",b[r]),r);break}p=p&&m;m&&this.setError(null);p?this.ajaxCheck():(this.setValidState(m),this.doDisplayState());this.checking=this.dirty=!1;this.trigger("check",this,this.valid);return!0===this.valid&&!p},doDisplayState:function(){var a=this.cfg,b=this.isValid(),e=a.cls.error,h=a.cls.valid,m=this.elem;this.displayState||a.alwaysDisplayState||(b=null);null===this.valid&&(b=null);e&&(!1===b?N(m,e):S(m,e));h&&(!0===b?N(m,h):S(m,h));e=this.getErrorBox();
h=this.error;e&&(!1===b&&h&&(e.innerHTML=state.error),e.style.display=!1===b&&h&&a.errorBox.enabled?"block":"none");this.trigger("display-state",this,b,this.error)},getErrorBox:function(){var a=this.cfg.errorBox;return a.tag||a.fn||a.selector?(!this.errorBox&&a.enabled&&this.createErrorBox(),this.errorBox):null},onDestroy:function(){ka(this.elem,"data-validator");this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox);this.input.$destroy()},isPending:function(){return null!==this.pending},
setValidState:function(a){this.valid!==a&&(this.valid=a,this.trigger("state-change",this,a))},setError:function(a,b){if(this.error!=a||this.errorRule!=b)this.error=a,this.errorRule=b,this.trigger("error-change",this,a,b)},checkTimeout:function(){this.checkTmt=null;this.checking||this.check(!1)},onInputChange:function(a){this.prev!==a&&(this.dirty=!0,this.customError=!1,this.abort(),this.pending||this.check(!1),this.prev=this.input.getValue())},onInputSubmit:function(a){a=Z(a);if(!(a.isDefaultPrevented&&
a.isDefaultPrevented()||!1!==this.trigger("submit",this,a)))return a.preventDefault(),!1},createErrorBox:function(){var a=this.cfg.errorBox,b=a.tag,e=a.cls,h=a.fn,m=a.position;a=a.elem;h?this.errorBox=h.call(this.$$callbackContext,this):a?this.errorBox=a:(this.errorBox=window.document.createElement(b),this.errorBox.className=e,b=(b=this.input.radio)?b[b-1]:this.elem,"appendParent"==m?b.parentNode.appendChild(this.errorBox):"before"==m?b.parentNode.insertBefore(this.errorBox,b):b.parentNode.insertBefore(this.errorBox,
b.nextSibling))},ajaxCheck:function(){var a=this.elem,b=this.rules.remote,e=this.getValue(),h=this.cfg;b=q({},w(b)?{url:b}:b,!0);b.data=b.data||{};b.data[b.paramName||z(a,"name")||z(a,"id")]=e;b.handler||(b.dataType="text");b.cache=!1;h.cls.ajax&&N(a,h.cls.ajax);this.trigger("before-ajax",this,b);this.pending=Ha(b);this.pending.done(this.onAjaxSuccess.bind(this));this.pending.fail(this.onAjaxError.bind(this))},onAjaxSuccess:function(a){var b=this.rules,d=this.cfg;this.pending=null;var e=!0;b.remote.handler?
(a=b.remote.handler.call(this.$$callbackContext,this,a),!0!==a&&(this.setError(Ya(a||d.messages.remote||"",b.remote),"remote"),e=!1)):a?(this.setError(a,"remote"),e=!1):this.setError(null);d.cls.ajax&&S(this.elem,d.cls.ajax);this.setValidState(e);this.doDisplayState();this.trigger("after-ajax",this)},onAjaxError:function(a,b){var d=this.cfg,e=a.responseData,f=this.rules;e&&f.remote.handler&&(e=f.remote.handler.call(this.$$callbackContext,this,e),!0!==e&&this.setError(Ya(e||d.messages.remote||"",f.remote),
"remote"));d.cls.ajax&&S(this.elem,d.cls.ajax);this.pending=null;"abort"!=b&&"abort"!=a&&(this.setValidState(!1),this.doDisplayState(),this.trigger("after-ajax",this))}},{defaults:{},messages:{}})}(),gc=n.validator.Group=function(){var a={alwaysCheck:!1,alwaysDisplayState:!1,disabled:!1,value:null,elem:null,errorBox:null,errorField:null,data:null,cls:{valid:"",error:""},fields:[],rules:{},messages:{},callback:{scope:null,destroy:null,statechange:null,errorchange:null,displaystate:null}},b=n.validator.methods;
return C({$mixins:[ma],fields:null,rules:null,cfg:null,vldr:null,enabled:!1,invalid:null,valid:null,displayState:!1,rulesNum:0,error:null,data:null,errorBox:null,el:null,$init:function(b,d){b=b||{};var e;this._vldr=d;this.cfg=e=q({},a,n.validator.Group.defaults,b,!0,!0);this.data=b.data;this.el=b.elem;this.fields={};this.rules={};e.messages=q({},Lb,e.messages,!0,!0);e.rules&&this.setRules(e.rules,!1);if(e.fields){var k=0;for(b=b.fields.length;k<b;k++)this.add(d.getField(e.fields[k]))}this.enabled=
!e.disabled},enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},isValid:function(){return!this.enabled||0===this.invalid&&!0===this.valid},getExactValidState:function(){return this.valid},reset:function(){this.invalid=0;this.setValidState(null);this.setError(null);this.doDisplayState();return this},getUserData:function(){return this.data},getName:function(){return this.cfg.name},setRules:function(a,b){b=void 0==
b?!0:b;for(var d in a)this.setRule(d,a[d],!1);b?this.check():this.setValidState(null);return this},setRule:function(a,b,f){var d=this.rules;f=void 0==f?!0:f;null===b?(d[a]&&this.rulesNum--,delete d[a]):(d[a]||this.rulesNum++,d[a]=b,null!==this.valid&&this.setValidState(!1));f?this.check():this.setValidState(null);return this},getRules:function(){return q({},this.rules)},hasRule:function(a){return this.rules[a]?!0:!1},setError:function(a){var b=this.cfg;this.error!=a&&(b.errorField?(this.vldr.getField(b.errorField).setError(a),
this.error=null):(this.error=a,this.trigger("error-change",this,a)))},getError:function(){return this.error},getFields:function(){return this.fields},enableDisplayState:function(){this.displayState=!0;return this},disableDisplayState:function(){this.displayState=!1;return this},check:function(){var a=this.cfg,d=this.fields,f=this.rules;if(!this.enabled||0==this.rulesNum)return this.setValidState(null),this.doDisplayState(),!0;this.countInvalid();if(0<this.invalid)return this.setValidState(null),this.doDisplayState(),
!0;var k={},h=!0,m=null,p;if(a.value){for(p in d)k[p]=d[p].getValue();m=a.value.call(this.$$callbackContext,k,this)}for(p in f)if(!0!==(d=(B(f[p])?f[p]:b[p]).call(this.$$callbackContext,m,null,f[p],this,k))){h=!1;d||a.messages[p]?this.setError(Ya(d||a.messages[p]||"",f[p])):this.setError(null);break}h&&this.setError(null);this.setValidState(h);this.doDisplayState();return!0===this.valid},doDisplayState:function(){var a=this.valid,b=this.cfg;this.displayState||b.alwaysDisplayState||(a=null);if(b.errorBox){var f=
this.getErrorBox();null!==a?f&&(f.innerHTML=this.error||"",f.style.display=!1===this.valid?"block":"none"):f&&(f.style.display="none")}f=b.cls.error;b=b.cls.valid;a=this.valid;f&&(!1===a?N(this.el,f):S(this.el,f));b&&(!0===a?N(this.el,b):S(this.el,b));this.trigger("display-state",this,this.valid)},getErrorBox:function(){var a=this.cfg,b=this.fields,f=a.errorBox;if(b[f])return b[f].getErrorBox();this.errorBox||(B(a.errorBox)?this.errorBox=a.errorBox.call(this.$$callbackContext,this):this.errorBox=
a.errorBox);return this.errorBox},onDestroy:function(){var a=this.fields,b;for(b in a)a[b]&&this.setFieldEvents(a[b],"un");this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox)},add:function(a){var b=this.fields,e=a.getName();b[e]||(b[e]=a,this.setFieldEvents(a,"on"))},setFieldEvents:function(a,b){a[b]("state-change",this.onFieldStateChange,this)},remove:function(a){var b=this.fields,e=a.getName();b[e]&&(delete b[e],this.setFieldEvents(a,"un"));return this},setValidState:function(a){this.valid!==
a&&(this.valid=a,this.trigger("state-change",this,a))},countInvalid:function(){var a=this.fields;this.invalid=0;for(var b in a)this.invalid+=a[b].isValid()?0:1},onFieldStateChange:function(a,b){this.trigger("field-state-change",this,a,b);this.check()}},{defaults:{}})}(),hc=n.validator.Validator=function(){var a={},b={form:null,all:{},fields:{},rules:{},cls:{valid:"",error:"",checking:""},groups:{},callback:{scope:null,destroy:null,reset:null,beforesubmit:null,submit:null,statechange:null,check:null,
displaystate:null,displaystatechange:null}},e=C({$mixins:[ma],id:null,el:null,cfg:null,enabled:!1,invalid:null,pending:0,grps:0,outside:!0,submitted:!1,displayState:!1,isForm:!1,isField:!1,submitButton:null,hidden:null,preventFormSubmit:!1,fields:null,groups:null,$init:function(d,f,k){var h=d.nodeName.toLowerCase();this.id=W();a[this.id]=this;M(d,"data-validator",this.id);this.el=d;f&&!w(f)&&(k=f,f=null);this.cfg=d=q({},b,e.defaults,e[f],k,!0,!0);this.$initObservable(d);this.isForm="form"===h;this.isField=
/input|select|textarea/.test(h);this.fields={};this.groups={};this.$$observable.createEvent("submit",!1);this.$$observable.createEvent("beforesubmit",!1);this.onRealSubmitClickDelegate=this.onRealSubmitClick.bind(this);this.resetDelegate=this.reset.bind(this);this.onSubmitClickDelegate=this.onSubmitClick.bind(this);this.onFormSubmitDelegate=this.onFormSubmit.bind(this);var m;this.initFields();h=this.fields;for(m in d.rules)h[m]&&h[m].setRules(d.rules[m],!1);d.rules=null;for(m in d.groups)this.addGroup(m,
d.groups[m]);this.initForm("bind");delete d.rules;delete d.fields;delete d.groups;this.enabled=!0},getVldId:function(){return this.id},getElem:function(){return this.el},getGroup:function(a){return this.groups[a]||null},getField:function(a){return this.fields[a]||null},enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},enableDisplayState:function(){var a=this.fields,b=this.groups,e;if(!0!==this.displayState){this.displayState=
!0;for(e in a)a[e].enableDisplayState();for(e in b)b[e].enableDisplayState();this.trigger("display-state-change",this,!0)}return this},disableDisplayState:function(){var a=this.groups,b=this.fields,e;if(!1!==this.displayState){this.displayState=!1;for(e in b)b[e].disableDisplayState();for(e in a)a[e].disableDisplayState();this.trigger("display-state-change",this,!1)}return this},isDisplayStateEnabled:function(){return this.displayState},isValid:function(){return!1===this.enabled?!0:0===this.invalid&&
0===this.pending&&0===this.grps&&!0===this.outside},getErrors:function(a){var b=!0===a?[]:{},d,e,m,p=[this.fields,this.groups];if(!this.isEnabled())return b;for(m=0;2>m;m++){var n=p[m];for(e in n)null===n[e].getExactValidState()&&n[e].check(),n[e].isValid()||(d=n[e].getError())&&(a?b.push(d):b[e]=d)}return b},check:function(){var a=this.fields,b=this.groups;if(!this.isEnabled())return!0;var e=this.isValid(),h;for(h in a)a[h].check();for(h in b)b[h].check();this.outside=!1!==this.trigger("check",this);
a=this.isValid();e!=a&&(this.doDisplayState(),this.trigger("state-change",this,!1));return a},add:function(a,b){if(!eb(a)||null!==z(a,"data-no-validate")||null!==z(a,"data-validator"))return this;var d=z(a,"name")||z(a,"id"),e=this.cfg,f=this.fields;if(!d)return this;d=e.fields&&e.fields[d]?e.fields[d]:b||{};w(d)&&(d={rules:[d]});d=q({},e.all||{},d,!0,!0);if(d.ignore)return this;d.callback||(d.callback={context:this.$$callbackContext});a=new fc(a,d,this);d=a.getName();if(f[d])return this;f[d]=a;this.setFieldEvents(a,
"on");this.displayState&&a.enableDisplayState();this.isEnabled()&&null!==this.invalid&&a.check();return this},addGroup:function(a,b){var d=this.groups;d[a]||(b.name=a,d[a]=new gc(b,this),this.setGroupEvents(d[a],"on"),this.isEnabled()&&null!==this.invalid&&d[a].check());return this},focusInvalid:function(){var a=this.fields,b;for(b in a)if(!a[b].isValid()){a[b].getElem().focus();break}},reset:function(){var a=this.fields,b=this.groups,e;this.submitted=!1;this.disableDisplayState();for(e in b)b[e].reset();
for(e in a)a[e].reset();this.pending=0;this.invalid=null;this.grps=0;this.outside=!1;this.doDisplayState();this.trigger("reset",this);return this},submit:function(){var a=this.el;if(this.isForm)if(B(a.submit))!1!==this.trigger("before-submit",this)&&!1!==this.trigger("submit",this)&&a.submit();else this.onSubmit();else this.onSubmit()},setFieldEvents:function(a,b){a[b]("state-change",this.onFieldStateChange,this);a[b]("before-ajax",this.onBeforeAjax,this);a[b]("after-ajax",this.onAfterAjax,this);
a[b]("submit",this.onFieldSubmit,this);a[b]("destroy",this.onFieldDestroy,this);a[b]("error-change",this.onFieldErrorChange,this)},setGroupEvents:function(a,b){a[b]("state-change",this.onGroupStateChange,this)},initFields:function(){var a=this.el,b;if(this.isField)return this.add(a),this;a=L("input, textarea, select",a);var e=-1;for(b=a.length;++e<b;this.add(a[e]));return this},initForm:function(a){var b=this.el,d=b.getElementsByTagName("input"),e=L(".submit",b),m=L(".reset",b);a="bind"===a?O:ca;
var p;var n=0;for(p=d.length;n<p;n++){var t=d[n];var r=t.type;"submit"===r?a(t,"click",this.onRealSubmitClickDelegate):"reset"===r&&a(t,"click",this.resetDelegate)}n=-1;for(p=e.length;++n<p;"submit"!==e[n].type&&a(e[n],"click",this.onSubmitClickDelegate));n=-1;for(p=m.length;++n<p;"reset"!==m[n].type&&a(m[n],"click",this.resetDelegate));this.isForm&&a(b,"submit",this.onFormSubmitDelegate)},onRealSubmitClick:function(a){a=Z(a||window.event);this.submitButton=a.target||a.srcElement;this.preventFormSubmit=
!1;return this.onSubmit(a)},onSubmitClick:function(a){this.preventFormSubmit=!1;return this.onSubmit(Z(a||window.event))},onFormSubmit:function(a){a=Z(a);if(!this.isValid()||this.preventFormSubmit)return a.preventDefault(),!1},onFieldSubmit:function(a,b){this.preventFormSubmit=!1;this.enableDisplayState();this.submitted=!0;return this.onSubmit(b)},onSubmit:function(a){this.enableDisplayState();this.isForm||(a&&a.preventDefault(),a&&a.stopPropagation());if(this.pending)return a&&a.preventDefault(),
!1;var b=!!this.submitButton;this.isForm&&(this.hidden&&(this.el.removeChild(this.hidden),this.hidden=null),this.submitButton&&/input|button/.test(this.submitButton.nodeName)&&(this.hidden=window.document.createElement("input"),this.hidden.type="hidden",M(this.hidden,"name",this.submitButton.name),this.hidden.value=this.submitButton.value,this.el.appendChild(this.hidden)));this.submitButton=null;if(!this.isValid()&&(this.check(),this.onFieldStateChange(),this.pending))return this.submitted=!0,a&&
a.preventDefault(),!1;if(!1===this.trigger("before-submit",this)||!this.isValid())return a&&(a.preventDefault(),a.stopPropagation()),this.pending||(this.focusInvalid(),this.submitted=!1),this.trigger("failed-submit",this,b),!1;this.pending||(this.submitted=!1);a=this.trigger("submit",this);this.preventFormSubmit=!1===a;return this.isForm?a:!1},onFieldDestroy:function(a){a=a.getElem();a=z(a,"name")||z(a,"id");delete this.fields[a]},onFieldErrorChange:function(a,b){this.trigger("field-error-change",
this,a,b)},onFieldStateChange:function(a,b){var d=this.invalid,e=this.fields;this.invalid=0;for(var f in e)this.invalid+=e[f].isValid()?0:1;a&&this.trigger("field-state-change",this,a,b);if(null===d||null!==d&&this.invalid!==d)this.doDisplayState(),this.trigger("state-change",this,this.isValid())},onGroupStateChange:function(){var a=this.groups,b=this.grps;this.grps=0;for(var e in a)this.grps+=a[e].isValid()?0:1;if(null===b||null!==b&&this.grps!==b)this.doDisplayState(),this.trigger("state-change",
this,this.isValid())},doDisplayState:function(){var a=this.cfg,b=this.isValid(),e=a.cls.error;a=a.cls.valid;var h=this.el;if(this.isField||!this.displayState)b=null;null===this.invalid&&(b=null);e&&(!1===b?N(h,e):S(h,e));a&&(!0===b?N(h,a):S(h,a));this.trigger("display-state",this,b)},onBeforeAjax:function(){this.pending++;this.cfg.cls.ajax&&N(this.el,this.cfg.cls.ajax)},onAfterAjax:function(){var a=this.fields,b=this.cfg;this.pending=0;for(var e in a)this.pending+=a[e].isPending()?1:0;this.doDisplayState();
b.cls.ajax&&S(this.el,b.cls.ajax);this.submitted&&0==this.pending&&(this.submitted=!1,this.isValid()?this.submit():this.focusInvalid())},onDestroy:function(){var b=this.groups,e=this.fields,k;this.reset();delete a[this.id];for(k in b)b.hasOwnProperty(k)&&b[k]&&(this.setGroupEvents(b[k],"un"),b[k].$destroy());for(k in e)e.hasOwnProperty(k)&&e[k]&&(this.setFieldEvents(e[k],"un"),e[k].$destroy());this.initForm("unbind");this.cfg=this.el=this.groups=this.fields=null}},{defaults:{},addMethod:function(a,
b,k){var d=na.get("MetaphorJs.validator.methods");d[a]||(d[a]=b,k&&(e.messages[a]=k))},getValidator:function(b){b=z(b,"data-validator");return a[b]||null}});return e}();n.validator.Component=C({node:null,scope:null,validator:null,scopeState:null,fields:null,formName:null,nodeCfg:null,$init:function(a,b,e,d){this.node=a;this.scope=b;this.scopeState={};this.fields=[];this.nodeCfg=d;this.validator=this.createValidator();this.formName=z(a,"name")||z(a,"id")||"$form";this.initScope();this.initScopeState();
this.initValidatorEvents();e.once("rendered",this.validator.check,this.validator);e.on("destroy",this.$destroy,this);b.$on("destroy",this.$destroy,this)},createValidator:function(){var a=this.node,b={},e;if(e=this.nodeCfg.get("submit"))b.callback=b.callback||{},b.callback.submit=function(a,b){return function(){try{return a(b)}catch(k){T(k)}}}(e,this.scope);return new hc(a,b)},initValidatorEvents:function(){var a=this.validator;a.on("field-state-change",this.onFieldStateChange,this);a.on("state-change",
this.onFormStateChange,this);a.on("display-state-change",this.onDisplayStateChange,this);a.on("field-error-change",this.onFieldErrorChange,this);a.on("reset",this.onFormReset,this)},initScope:function(){this.scope[this.formName]=this.scopeState},initScopeState:function(){var a=this.node,b=this.scopeState,e=this.fields,d;if(a.elements)var f=a.elements;else f=[],lb(a,function(a){eb(a)&&f.push(a)});a=-1;for(d=f.length;++a<d;){var k=f[a];(k=z(k,"name")||z(k,"id"))&&!b[k]&&(e.push(k),b[k]={$error:null,
$invalid:null,$pristine:!0,$errorMessage:null})}b.$$validator=this.validator;b.$invalid=!1;b.$pristine=!0;b.$isDestroyed=this.$isDestroyed.bind(this);b.$submit=this.validator.onSubmit.bind(this.validator);b.$reset=this.validator.reset.bind(this.validator)},onDisplayStateChange:function(a,b){if(b){b=this.scopeState;var e,d=this.fields;var f=0;for(e=d.length;f<e;f++){var k=b[d[f]];k.$real&&(b[d[f]]=k.$real)}b.$invalid=!a.isValid();b.$pristine=!1;this.scope.$check()}else this.onFormReset(a)},onFieldErrorChange:function(a,
b,e){this.onFieldStateChange(a,b,b.isValid())},onFormReset:function(a){a=this.scopeState;var b,e=this.fields;var d=0;for(b=e.length;d<b;d++){var f=a[e[d]];f.$error=null;f.$errorMessage=null;f.$invalid=null;f.$pristine=!0}a.$invalid=!1;a.$pristine=!0;this.scope.$check()},onFormStateChange:function(a,b){var e=this.scopeState;e.$invalid=!1===b&&a.isDisplayStateEnabled();e.$pristine=!1;this.scope.$check()},onFieldStateChange:function(a,b,e){var d=this.scopeState,f=b.getName();a=a.isDisplayStateEnabled();
b={$error:b.getErrorRule(),$errorMessage:b.getError(),$invalid:!1===e,$pristine:null===b.getExactValidState()};a?d[f]=b:d[f].$real=b;this.scope.$check()},onDestroy:function(){this.validator.$destroy();this.scope&&delete this.scope[this.formName]}});y.registerAttribute("validate",250,function(a,b,e,d,f){e.setProperty("value",{mode:D.MODE_STATIC,defaultValue:"MetaphorJs.validator.Component"});e.setMode("submit",D.MODE_FUNC);f=e.get("value");var k=na.get(f);if(k)return new k(b,a,d,e);T(Error("Class '"+
f+"' not found"))});(function(){var a={getNodePositions:function(a,e,d){for(var b=[],k,h,m,p={};a.firstChild;)a.removeChild(a.firstChild);k=0;for(h=e.length;k<h;k++)d&&d[k]&&(m=d[k].el.cloneNode(!0),a.appendChild(m)),m=e[k].el.cloneNode(!0),a.appendChild(m),b.push(m);k=0;for(h=b.length;k<h;k++)a=b[k],(d=e[k].renderer)&&(p[d.id]={left:a.offsetLeft,top:a.offsetTop});return p},calculateTranslates:function(a,e,d){var b=this.parentEl,k=b.parentNode,h=b.cloneNode(!0),m=b.offsetWidth,p=[],n=0,t=0;var r=
h.style;r.position="absolute";r.left="-10000px";r.visibility="hidden";r.width=m+"px";k.insertBefore(h,b);r.width=m-(h.offsetWidth-m)+"px";e=this.getNodePositions(h,e);d=this.getNodePositions(h,a,d);b=this.getNodePositions(h,a);k.removeChild(h);k=0;for(h=a.length;k<h;k++)m=a[k].el,r=a[k].renderer,r=r.id,0===k&&(n=m.offsetLeft,t=m.offsetTop),p.push([{left:b[r].left-n-(d[r].left-n),top:b[r].top-t-(d[r].top-t)},e[r]?{left:e[r].left-n-(d[r].left-n),top:e[r].top-t-(d[r].top-t)}:null]);return p},moveAnimation:function(a,
e,d,f,k){var b=a.style;k.done(function(){if(d){var a=Fa();b[a.transform]="translateX("+d.left+"px) translateY("+d.top+"px)"}});return fa(a,"move",f,function(a,d,h){0===d&&"start"!==h&&e&&(a=Fa(),b[a.transform]="translateX("+e.left+"px) translateY("+e.top+"px)")})},reflectChanges:function(a){var b=this,d=a.oldRenderers,f=a.newRenderers,k,h,m;b.doUpdate(a.updateStart,null,"enter");a.doesMove&&(k=b.calculateTranslates(a.newRenderers,a.origRenderers,a.oldRenderers));var p=[],n=new H,t=new H,r=new H,v=
H.counter(f.length),A=function(){v.countdown();return n};var q=0;for(h=d.length;q<h;q++)if(m=d[q])m.scope.$destroy(),wa(m.el),p.push(fa(m.el,"leave").done(function(a){a.style.visibility="hidden"}));q=0;for(h=f.length;q<h;q++)m=f[q],wa(m.el),"enter"===m.action?p.push(fa(m.el,"enter",A)):p.push(b.moveAnimation(m.el,a.doesMove?k[q][0]:null,a.doesMove?k[q][1]:null,A,t));v.done(function(){U(function(){t.resolve();b.applyDomPositions(d);a.doesMove||b.doUpdate(a.updateStart,null,"move");U(function(){n.resolve()});
b.trigger("change",b)})});H.all(p).always(function(){U(function(){var e=Fa();b.doUpdate(a.updateStart||0);b.removeOldElements(d);if(a.doesMove)for(b.doUpdate(a.updateStart,null,"move"),q=0,h=f.length;q<h;q++)m=f[q],m.el.style[e.transform]=null,m.el.style[e.transform]="";r.resolve()})});return r}};return C({$class:"MetaphorJs.plugin.ListAnimated",$init:function(b){b.$implement(a)}})})();var mb=n.dom.getScrollParent=function(){var a=/(auto|scroll)/,b,e=function(a){return(a=getStyle(a))?a.overflow+a.overflowY+
a.overflowY:""};return function(d){b||(b=window.document.body);for(;d&&d!==b;){if(a.test(e(d)))return d;d=d.parentNode}return window}}(),ic=n.dom.getOffsetParent=function(a){var b=window.document.documentElement;for(a=a.offsetParent||b;a&&a!=b&&"static"===za(a,"position");)a=a.offsetParent;return a||b};n.dom.getOffet=function(a){var b={top:0,left:0},e=window.document.documentElement;if(!Oa(a)||a===window)return b;a.getBoundingClientRect&&(b=a.getBoundingClientRect());return{top:b.top+Aa()-e.clientTop,
left:b.left+Ba()-e.clientLeft}};var nb=n.dom.getPosition=function(a,b){var e={top:0,left:0},d=window.document.documentElement;if(a===window||a===d)return e;if("fixed"==za(a,"position"))var f=a.getBoundingClientRect();else{if(b)return a=n.dom.getOffset(a),e=n.dom.getOffset(b),a={left:a.left-e.left,top:a.top-e.top},0>a.left&&(a.left=0),0>a.top&&(a.top=0),a;b=ic(a);f=n.dom.getOffset(a);b!==d&&(e=n.dom.getOffset(b));e.top+=za(b,"borderTopWidth",!0);e.left+=za(b,"borderLeftWidth",!0)}return{top:f.top-
e.top-za(a,"marginTop",!0),left:f.left-e.left-za(a,"marginLeft",!0)}};C({$class:"MetaphorJs.plugin.ListBuffered",list:null,enabled:!0,itemSize:null,itemsOffsite:5,bufferState:null,scrollOffset:0,horizontal:!1,dynamicOffset:!1,bufferEventDelegate:null,topStub:null,botStub:null,$init:function(a){var b=this;b.list=a;a.$intercept("afterInit",this.afterInit,this,"before");a.$intercept("doRender",this.doRender,this,"instead");a.$implement({scrollTo:b.$bind(b.scrollTo),reflectChanges:function(e){b.enabled?
(b.getScrollOffset(),a.removeOldElements(e.oldRenderers),a.queue.append(b.updateScrollBuffer,b,[!0]),a.trigger("change",a)):b.$super(e)}})},afterInit:function(){var a=this.list.attr;a=a?a.config:{};this.itemSize=a.itemSize;this.itemsOffsite=parseInt(a.itemsOffsite||5,10);this.horizontal=a.horizontal||!1;this.dynamicOffset=a.dynamicOffset||!1;this.initScrollParent(a);this.initScrollStubs(a);this.bufferEventDelegate=this.bufferUpdateEvent.bind(this);this.up();this.list.scope.$on("freeze",this.down,
this);this.list.scope.$on("unfreeze",this.up,this)},doRender:function(){this.getScrollOffset();this.updateScrollBuffer()},up:function(){O(this.scrollEl,"scroll",this.bufferEventDelegate);O(window,"resize",this.bufferEventDelegate)},down:function(){ca(this.scrollEl,"scroll",this.bufferEventDelegate);ca(window,"resize",this.bufferEventDelegate)},initScrollParent:function(a){this.scrollEl=mb(this.list.parentEl)},initScrollStubs:function(a){var b=this.list,e=b.parentEl,d=b.prevEl,f,k,h={fontSize:0,lineHeight:0,
padding:0,paddingTop:0,paddingLeft:0,paddingBottom:0,paddingRight:0,margin:0,marginLeft:0,marginTop:0,marginRight:0,marginBottom:0};this.topStub=f=window.document.createElement(a.stub||"div");this.botStub=a=window.document.createElement(a.stub||"div");N(f,"mjs-buffer-top");N(a,"mjs-buffer-bottom");for(k in h)f.style[k]=h[k],a.style[k]=h[k];e.insertBefore(f,d?d.nextSibling:e.firstChild);e.insertBefore(a,b.nextEl);b.prevEl=f;b.nextEl=a},getItemsPerRow:function(){return 1},getRowHeight:function(){return this.itemSize},
getScrollOffset:function(){var a=nb(this.topStub,this.scrollEl);return this.scrollOffset=this.horizontal?a.left:a.top},getBufferState:function(a){var b=this.scrollEl,e=this.horizontal,d=window.document.documentElement;d=b===window?window[e?"innerWidth":"innerHeight"]||d[e?"clientWidth":"clientHeight"]:b[e?"offsetWidth":"offsetHeight"];e=e?Ba(b):Aa(b);b=b.scrollHeight;var f=this.getItemsPerRow(),k=this.getRowHeight(),h=this.itemsOffsite,m=a?this.getScrollOffset():this.scrollOffset;a=Math.ceil(this.list.renderers.length/
f);var p;var n=Math.ceil((e-m)/k);0>n&&(n=0);m=n;var t=p=n+Math.ceil(d/k);n=n>h?n-h:0;t+=h;t>a-1&&(t=a-1);b&&e+d>=b&&this.bufferState&&this.bufferState.last==t*f&&(t+=h);return n>t?this.bufferState:this.bufferState={first:n*f,viewFirst:m*f,last:t*f,viewLast:p*f,ot:n*k,ob:(a-t-1)*k}},updateStubs:function(a){var b=this.horizontal;this.topStub.style[b?"width":"height"]=a.ot+"px";this.botStub.style[b?"width":"height"]=a.ob+"px"},bufferUpdateEvent:function(){this.list.queue.add(this.updateScrollBuffer,
this)},updateScrollBuffer:function(a){var b=this,e=b.list,d=b.bufferState,f=e.parentEl,k=e.renderers,h=b.botStub,m=b.getBufferState(b.dynamicOffset),p=new H,n=window.document,t,r,v,q;if(!m)return null;d&&m.first==d.first&&m.last==d.last||e.trigger("buffer-change",b,m,d);U(function(){if(!b.$isDestroyed()){if(a||!d||m.last<d.first||m.first>d.last){if(d)for(r=d.first,v=d.last;r<=v;r++)(q=k[r])&&q.attached&&(f.removeChild(q.el),q.attached=!1);t=n.createDocumentFragment();r=m.first;for(v=m.last;r<=v;r++)if(q=
k[r])q.rendered||e.renderItem(r),t.appendChild(q.el),q.attached=!0;f.insertBefore(t,h)}else{if(d.first<m.first)for(r=d.first,v=m.first;r<v;r++)(q=k[r])&&q.attached&&(f.removeChild(q.el),q.attached=!1);else if(d.first>m.first){t=n.createDocumentFragment();r=m.first;for(v=d.first;r<v;r++)if(q=k[r])q.rendered||e.renderItem(r),t.appendChild(q.el),q.attached=!0;f.insertBefore(t,k[d.first].el)}if(d.last<m.last){t=n.createDocumentFragment();r=d.last+1;for(v=m.last;r<=v;r++)if(q=k[r])q.rendered||e.renderItem(r),
t.appendChild(q.el),q.attached=!0;f.insertBefore(t,h)}else if(d.last>m.last)for(r=m.last+1,v=d.last;r<=v;r++)(q=k[r])&&q.attached&&(f.removeChild(q.el),q.attached=!1)}b.updateStubs(m);e.trigger("buffer-update",b);b.onBufferStateChange(m,d);p.resolve()}});return p},scrollTo:function(a){var b=this.list,e=this.itemSize,d=this.scrollEl||mb(b.parentEl),f=this.horizontal,k=f?"scrollLeft":"scrollTop",h=new H,m;b.queue.append(function(){U(function(){m=e*a;d===window?window.scrollTo(f?m:Ba(),f?Aa():m):d[k]=
m;h.resolve()});return h});return h},onBufferStateChange:function(a,b){},$beforeHostDestroy:function(){var a=this.list.parentEl;a.removeChild(this.topStub);a.removeChild(this.botStub);this.down()}});n.plugin.ListBuffered.$extend({$class:"MetaphorJs.plugin.ListPullNext",buffered:!1,$init:function(a,b){var e=a.attr;e=e?e.config:{};e.bufferedPullNext&&(this.buffered=e.bufferedPullNext,a.buffered=!0);this.$super(a,b)},afterInit:function(){this.$super();this.getScrollOffset()},updateScrollBuffer:function(a){if(this.buffered)return this.$super(a);
a=this.bufferState;var b=this.getBufferState(this.dynamicOffset);a&&b.first==a.first&&b.last==a.last||(this.list.trigger("buffer-change",this,b,a),this.onBufferStateChange(b,a))},onBufferStateChange:function(a,b){var e=this.list,d=e.store.getLength();this.$super(a,b);d-a.last<(a.last-a.first)/3&&!e.store.loading&&!e.store.$destroyed&&(e.store.addNextPage(),e.trigger("pull",this))}});C({$class:"MetaphorJs.plugin.SrcDeferred",directive:null,queue:null,scrollEl:null,scrollDelegate:null,resizeDelegate:null,
position:null,sw:null,sh:null,checkVisibility:!0,$init:function(a){this.directive=a;a.$intercept("onChange",this.onChange,this,"instead");this.queue=a.queue||new ya({auto:!0,async:!0,mode:ya.REPLACE,thenable:!0})},$beforeHostInit:function(a,b){this.scrollEl=mb(b);this.scrollDelegate=this.onScroll.bind(this);this.resizeDelegate=this.onResize.bind(this);O(this.scrollEl,"scroll",this.scrollDelegate);O(window,"resize",this.resizeDelegate)},isVisible:function(){if(!this.checkVisibility)return!0;var a=
this.scrollEl,b=Aa(a),e=Ba(a),d=this.sw,f=this.sh;this.position||(this.position=nb(this.directive.node,a));d||(d=this.sw=jb(a),f=this.sh=kb(a));a=this.position.top;var k=this.position.left;return a>b&&a<b+f&&k>e&&k<e+d},onScroll:function(){this.directive.queue.add(this.changeIfVisible,this)},onResize:function(){this.sw=this.position=null;this.directive.queue.add(this.changeIfVisible,this)},onChange:function(){this.directive.queue.add(this.changeIfVisible,this)},changeIfVisible:function(){if(this.isVisible())return this.stopWatching(),
this.directive.doChange()},stopWatching:function(){this.scrollEl&&(ca(this.scrollEl,"scroll",this.scrollDelegate),ca(window,"resize",this.resizeDelegate),this.scrollEl=null,this.checkVisibility=!1)},$beforeHostDestroy:function(){this.stopWatching();this.queue.$destroy()}});C({$class:"MetaphorJs.plugin.SrcSize",directive:null,width:null,height:null,origOnChange:null,$init:function(a){this.directive=a;this.origOnChange=a.$intercept("onSrcChanged",this.onSrcChanged,this,"after")},$afterHostInit:function(a,
b){var e=self.directive.attr,d=(e?e.config:{}).preloadSize;e=b.style;"attr"!==d&&(d=G.parse(d)(a));a="attr"===d?parseInt(z(b,"width"),10):d.width;b="attr"===d?parseInt(z(b,"height"),10):d.height;if(a||b)e.display="block";a&&(e.width=a+"px");b&&(e.height=b+"px")},onSrcChanged:function(){var a=this.directive,b=a.node;a.onSrcChanged=this.origOnChange;Qa(b,"width");Qa(b,"height");Qa(b,"display");this.$destroy()}});y.registerAttribute("break-if",500,function(a,b,e){e.setType("value","bool");(a=e.get("value"))&&
b.parentNode.removeChild(b);return!a});y.registerAttribute("cmp-prop",200,["$parentCmp","$node","$nodeConfig",function(a,b,e){e.setDefaultMode("value",D.MODE_STATIC);a&&(a[e.get("value")]=b)}]);y.registerAttribute("ignore",0,Ma);y.registerAttribute("include-file",900,function(a,b,e){a=require("fs");e=e.get("value");b.innerHTML=a.readFileSync(e).toString()});y.registerTag("bind-html",function(a,b){var e=z(b,"value");a=G.get(e,a);a=ea(a);e=X(a.childNodes);b.parentNode.insertBefore(a,b);b.parentNode.removeChild(b);
return e});y.registerTag("bind",function(a,b){var e=z(b,"value");a=G.get(e,a);a=window.document.createTextNode(a);b.parentNode.insertBefore(a,b);b.parentNode.removeChild(b);return[a]});y.registerTag("if",y.attr.If.$extend({$class:"MetaphorJs.app.Directive.tag.If",autoOnChange:!1,children:null,childrenFrag:null,$init:function(a,b,e,d,f){this.children=X(b.childNodes);this.childrenFrag=ea(this.children);e.setType("once","bool",D.MODE_STATIC);e.setProperty("value",{expression:z(b,"value"),type:"bool"});
this.createCommentWrap();this.$super(a,b,e,d,f);b.parentNode&&b.parentNode.removeChild(b);a=e.get("value");this.onChange(a||!1,void 0)},getChildren:function(){return this.children},onChange:function(){var a=this.config.get("value"),b=this.wrapperOpen,e=this.wrapperClose,d=b.parentNode;if(a)d.insertBefore(this.childrenFrag,e);else if(!this.initial){a=[];for(this.childrenFrag=window.document.createDocumentFragment();b.nextSibling&&b.nextSibling!==e;){var f=b.nextSibling;d.removeChild(f);a.push(f);this.childrenFrag.appendChild(f)}this.children=
a}this.initial?this.initial=!1:this.config.get("once")&&this.$destroy()},onDestroy:function(){this.childrenFrag=this.children=null;this.$super()}}));y.registerTag("include",function(a,b,e,d,f){e.setType("asis","bool",D.MODE_STATIC);var k=new Ia({scope:a,node:b,url:z(b,"src"),parentRenderer:d,replace:!0,ownRenderer:!e.get("asis")});d.on("destroy",function(){k.$destroy();k=null});return!1});y.registerTag("tag",function(a,b){var e=getAttr(b,"value");a=G.get(e,a);if(a){for(var d=window.document.createElement(a),
f=b.nextSibling,k=b.attributes;b.firstChild;)d.appendChild(b.firstChild);a=0;for(e=k.length;a<e;a++){var h=k[a];"value"!==h.name&&M(d,h.name,h.value)}b.parentNode.insertBefore(d,f);b.parentNode.removeChild(b);return[d]}b.parentNode.removeChild(b);return!1});var jc=n.lib.LocalText=function(){var a=function(a,b){"pt_BR"===b&&(b="xbr");3<b.length&&(b=b.substr(0,-b.lastIndexOf("_")));switch(b){case "bo":case "dz":case "id":case "ja":case "jv":case "ka":case "km":case "kn":case "ko":case "ms":case "th":case "tr":case "vi":case "zh":return 0;
case "af":case "az":case "bn":case "bg":case "ca":case "da":case "de":case "el":case "en":case "eo":case "es":case "et":case "eu":case "fa":case "fi":case "fo":case "fur":case "fy":case "gl":case "gu":case "ha":case "he":case "hu":case "is":case "it":case "ku":case "lb":case "ml":case "mn":case "mr":case "nah":case "nb":case "ne":case "nl":case "nn":case "no":case "om":case "or":case "pa":case "pap":case "ps":case "pt":case "so":case "sq":case "sv":case "sw":case "ta":case "te":case "tk":case "ur":case "zu":return 1===
a?0:1;case "am":case "bh":case "fil":case "fr":case "gun":case "hi":case "ln":case "mg":case "nso":case "xbr":case "ti":case "wa":return 0===a||1===a?0:1;case "be":case "bs":case "hr":case "ru":case "sr":case "uk":return 1===a%10&&11!==a%100?0:2<=a%10&&4>=a%10&&(10>a%100||20<=a%100)?1:2;case "cs":case "sk":return 1===a?0:2<=a&&4>=a?1:2;case "ga":return 1===a?0:2===a?1:2;case "lt":return 1===a%10&&11!==a%100?0:2<=a%10&&(10>a%100||20<=a%100)?1:2;case "sl":return 1===a%100?0:2===a%100?1:3===a%100||4===
a%100?2:3;case "mk":return 1===a%10?0:1;case "mt":return 1===a?0:0===a||1<a%100&&11>a%100?1:10<a%100&&20>a%100?2:3;case "lv":return 0===a?0:1===a%10&&11!==a%100?1:2;case "pl":return 1===a?0:2<=a%10&&4>=a%10&&(12>a%100||14<a%100)?1:2;case "cy":return 1===a?0:2===a?1:8===a||11===a?2:3;case "ro":return 1===a?0:0===a||0<a%100&&20>a%100?1:2;case "ar":return 0===a?0:1===a?1:2===a?2:3<=a&&10>=a?3:11<=a&&99>=a?4:5;default:return 0}},b=function(a){this.store={};a&&(this.locale=a)};q(b.prototype,{store:null,
locale:"en",setLocale:function(a){this.locale=a},set:function(a,b){var d=this.store;void 0===d[a]&&(d[a]=b)},load:function(a){q(this.store,a,!1,!1)},get:function(a){return this.store[a]||(this===e?"-- "+a+" --":e.get(a))},plural:function(b,e){b="string"===typeof b?this.get(b):b;var d=a(e,this.locale);return I(b)?b[d]:ia(b)?b[e]?b[e]:1===e&&void 0!==b.one?b.one:0>e&&void 0!==b.negative?b.negative:b.other:b},$destroy:function(){this.store=null}},!0,!1);var e=new b;b.global=function(){return e};return b}(),
kc=n.mixin.Provider={$$provider:null,$beforeInit:function(){this.$$provider=new Bb},value:function(){var a=this.$$provider;return a.value.apply(a,arguments)},constant:function(){var a=this.$$provider;return a.constant.apply(a,arguments)},factory:function(){var a=this.$$provider;return a.factory.apply(a,arguments)},service:function(){var a=this.$$provider;return a.service.apply(a,arguments)},provider:function(){var a=this.$$provider;return a.provider.apply(a,arguments)},resolve:function(){var a=this.$$provider;
return a.resolve.apply(a,arguments)},inject:function(){var a=this.$$provider;return a.inject.apply(a,arguments)},$afterDestroy:function(){this.$$provider.$destroy();this.$$provider=null}};n.app.App=C({$mixins:[ma,kc],lang:null,scope:null,renderer:null,cmpListeners:null,components:null,sourceObs:null,$init:function(a,b){var e=b instanceof ta?b:new ta(b);ka(a,"mjs-app");e.$app=this;this.$super();this.lang=new jc;this.scope=e;this.cmpListeners={};this.components={};this.factory("$parentCmp",["$node",
this.getParentCmp],this);this.value("$app",this);this.value("$rootScope",e.$root);this.value("$lang",this.lang);this.value("$locale",this.lang);this.renderer=new hb(a,e);this.renderer.on("rendered",this.afterRender,this);var d=X(arguments);d[1]=e;this.initApp.apply(this,d)},initApp:J,afterRender:function(){},run:function(){this.renderer.process()},createSource:function(a,b){a="source-"+a;this.$$observable.getEvent(a)||this.$$observable.createEvent(a,b||"nonempty")},registerSource:function(a,b,e){this.on("source-"+
a,b,e)},unregisterSource:function(a,b,e){this.un("source-"+a,b,e)},collect:function(a){arguments[0]="source-"+arguments[0];return this.trigger.apply(this,arguments)},getParentCmp:function(a,b){for(a=b?a:a.parentNode;a;){if(b=z(a,"cmp-id")||a.$$cmpId)return this.getCmp(b);a=a.parentNode}return null},onAvailable:function(a,b,e){var d=this.cmpListeners,f=this.components;d[a]||(d[a]=new H);b&&d[a].done(b,e);f[a]&&d[a].resolve(f[a]);return d[a]},getCmp:function(a){return this.components[a]||null},registerCmp:function(a,
b,e){var d=this,f=a[e];e=function(){delete d.cmpListeners[f];delete d.components[f]};d.components[f]=a;d.cmpListeners[f]&&d.cmpListeners[f].resolve(a);if(a.on)a.on("destroy",e);b.$on("destroy",e)},onDestroy:function(){this.renderer.$destroy();this.scope.$destroy();this.lang.$destroy();this.$super()}});var lc=n.regexp.location=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?::([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?::([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/,
pa=n.browser.parseLocation=function(a){var b=a.match(lc)||[],e=("undefined"!=typeof window?window.location:null)||{};return{protocol:b[4]||e.protocol||"http:",hostname:b[11]||e.hostname||"",host:(b[11]||"")+(b[12]?":"+b[12]:"")||e.host||"",username:b[8]||e.username||"",password:b[9]||e.password||"",port:parseInt(b[12],10)||e.port||"",href:a,path:(b[13]||"/")+(b[16]||""),pathname:b[13]||"/",search:b[16]||"",hash:b[17]&&"#"!=b[17]?b[17]:""}},ob=n.browser.joinLocation=function(a,b){var e="";b=b||{};
b.onlyPath||(e+=a.protocol+"//",a.username&&a.password&&(e+=a.username+":"+a.password+"@"),e+=a.hostname,a.hostname&&a.port&&(e+=":"+a.port));b.onlyHost||(e+=a.pathname||"/",a.search&&"?"!=a.search&&(e+=a.search),a.hash&&"#"!=a.hash&&(e+=a.hash));return e},Ka=n.lib.History=function(){var a,b,e,d=new la,f=W(),k="$$"+f,h=W(),m=new RegExp("#"+f+"=([A-Z0-9]+)"),p,n,t="undefined"==typeof window,r=null,v,w,y;d.createEvent("before-location-change",!1);d.createEvent("void-click",!1);var u=function(a){a=a||
{};a[k]||(a[k]=W());h=a[k];return a},x=function(a){a=a||{};a[k]||(a[k]=h);return a},B=function(a,b){"string"==typeof a&&(a=pa(a));"string"==typeof b&&(b=pa(b));var d=["protocol","host","port"],e;var h=0;for(e=d.length;h<e;h++){var f=d[h];if(a[f]&&b[f]&&a[f]!=b[f])return!0}return!1},D=function(a,b){"string"==typeof a&&(a=pa(a));"string"==typeof b&&(b=pa(b));return B(a,b)||a.pathname!=b.pathname||a.search!=b.search||a.hash!=b.hash},C=function(a){a=pa(a);return!v||y?a.path:ob(a,{onlyPath:!0})},H=function(a){var b=
null;a=a.replace(m,function(a,d){b=d;return""});return{hash:a,id:b}},I=function(a,b){a?("#"!=a.substr(0,1)&&(a=H(a).hash,a="!"+a+"#"+f+"="+h),e.hash=a):e.hash=""},G=function(){if(v)var a=ob(e);else{a=e.hash.substr(1);var b=q({},e,!0,!1);a&&(a=H(a).hash,"!"==a.substr(0,1)&&(a=a.substr(1)),a=decodeURIComponent(a).split("?"),b.pathname=a[0],b.search=a[1]?"?"+a[1]:"");a=ob(b)}return a},M=function(a){r=q({},e,!0,!1);N("location-change",a)},L=function(){if(D(r,e)){var a=G();N("before-location-pop",a);h=
v?b.state?b.state[k]:null:H(e.hash).id;r=q({},e,!0,!1);N("location-change",a)}},N=function(a,b,e){b=b||G();var h=pa(b);return d.trigger(a,h.pathname+h.search+h.hash,e,b)},P=function(){a=window;b=a.history;e=a.location;v=!!b.pushState;w="onhashchange"in a;y=!1;r=q({},e,!0,!1);if(v)O(a,"popstate",L),p=function(a,d,e){if(!1===N("before-location-change",a,d))return!1;b.pushState(u(e),null,C(a));M(a)},n=function(a,d,e){b.replaceState(x(e),null,C(a));M(a)},n(G());else if(w)p=function(a,b,d){if(!1===N("before-location-change",
a,b))return!1;V(I,null,[C(a),u(d)])},n=function(a,b,d){V(I,null,[C(a),x(d)])},O(a,"hashchange",L);else{var h=null,f=!1;a.onIframeHistoryChange=function(a){f||V(function(){I(a);L()})};var m=function(a){var b=h.contentDocument?h.contentDocument:h.contentWindow.document;b.open();b.write("<html><head><title>"+document.title+'</title><script type="text/javascript">var hashValue = "'+a+'";window.top.onIframeHistoryChange(hashValue);\x3c/script></head><body>&nbsp;</body></html>');b.close()};p=function(a,
b,d){if(!1===N("before-location-change",a,b))return!1;m(C(a))};n=function(a,b,d){if(!1===N("before-location-change",a,b))return!1;h.contentWindow.hashValue=C(a)};var k=function(){h=window.document.createElement("iframe");h.src="about:blank";h.style.display="none";window.document.body.appendChild(h);f=!0;m(C(e.hash.substr(1)));f=!1};t?k():O(a,"load",k)}O(window.document.documentElement,"click",function(b){b=Z(b||a.event);for(var h=b.target,f;h&&"a"!=h.nodeName.toLowerCase();)h=h.parentNode;if(h&&!b.isDefaultPrevented()){f=
z(h,"href");if("#"==f&&!d.trigger("void-click",h))return b.preventDefault(),b.stopPropagation(),!1;if(f&&"#"!=f.substr(0,1)&&!z(h,"target")){var m=q({},e,!0,!1),k=pa(f);if(B(m,k))return null;D(m,k)?p(f,h):N("same-location",null,h);b.preventDefault();b.stopPropagation();return!1}}return null});P=J};O(window,"load",function(){t=!0});return q({},d.getApi(),{push:function(a,b){P();var d=q({},e,!0,!1),h=pa(a);if(B(d,h))return null;D(d,h)&&p(a,null,b)},replace:function(a,b){P();n(a,null,b)},saveState:function(a){P();
n(G(),null,a)},mergeState:function(a){this.saveState(q({},b.state,a,!0,!1))},getState:function(){return b.state},getCurrentStateId:function(){return h},current:function(){P();return G()},init:function(){return P()},polyfill:function(){P();window.history.pushState=function(a,b,d){p(d,null,a)};window.history.replaceState=function(a,b,d){n(d,null,a)}}})}(),mc=n.lib.UrlParam=function(){var a={},b=C({$mixins:[ma],id:null,name:null,extractor:null,context:null,regexp:null,valueIndex:1,prev:null,value:null,
enabled:!0,$init:function(a){q(this,a,!0,!1);this.regexp&&w(this.regexp)&&(this.regexp=Ta(this.regexp));!this.name||this.regexp||this.extractor||(this.regexp=Ta(this.name+"=([^&]+)"));if(!this.regexp&&!this.extractor)throw Error("Invalid UrlParam config, missing regexp or extractor");this.enabled&&(this.enabled=!1,this.enable())},enable:function(){if(!this.enabled){this.enabled=!0;Ka.on("location-change",this.onLocationChange,this);var a=currentUrl();a=pa(a);this.onLocationChange(a.pathname+a.search+
a.hash)}},disable:function(){this.enabled&&(this.enabled=!1,Ka.un("location-change",this.onLocationChange,this))},onLocationChange:function(a){a=this.extractValue(a);this.value!=a&&(this.prev=this.value,this.value=a,this.trigger("change",a,this.prev))},extractValue:function(a){if(this.regexp)return(a=a.match(this.regexp))?a[this.valueIndex]:null;if(this.extractor)return this.extractor.call(this.context,a)},getValue:function(){return this.value},getPrev:function(){return this.prev},destroyIfIdle:function(){this.$$observable.hasListener()||
this.$destroy()},onDestroy:function(){this.disable()}},{get:function(e){return e.id&&a[e.id]?a[e.id]:new b(e)}});return b}();n.app.Router=C({route:null,node:null,scope:null,cmp:null,id:null,currentViewId:null,currentComponent:null,cmpCache:null,domCache:null,currentView:null,routeMap:null,currentCls:null,currentHtmlCls:null,scrollOnChange:!0,animate:!1,$init:function(a){q(this,a,!0,!1);this.routeMap={};this.config||(this.config=new D(null,{scope:this.scope}));(a=this.node)&&a.firstChild&&P(a,"mjs-transclude",
ea(a.childNodes));this.id||(this.id=W());this.cmpCache={};this.domCache={};this.initView();this.scope.$app.registerCmp(this,this.scope,"id");this.route?(Ka.init(),Ka.on("location-change",this.onLocationChange,this),this.initRoutes(),this.onLocationChange()):this.config.hasExpression("cmp")&&(this.config.on("cmp",this.onCmpChange,this),this.onCmpChange())},initView:function(){},initRoutes:function(){var a=this.route,b,e;if(a){var d=0;for(b=a.length;d<b;d++){var f=a[d];f.id=f.id||W();if(f.params){var k=
{};var h=0;for(e=f.params.length;h<e;h++){var m=f.params[h];m.name&&(k[m.name]=new mc(q({},m,{enabled:!1},!0,!1)))}f.params=k}this.routeMap[f.id]=f}}},onCmpChange:function(){var a=this.config.get("cmp")||this.config.get("defaultCmp");a&&this.setComponent(a)},onLocationChange:function(){var a=this,b=Ka.current();b=pa(b);var e=b.pathname+b.search+b.hash,d=a.route,f,k,h;if(d){var m=0;for(k=d.length;m<k;m++){var p=d[m];if(p.regexp&&(h=b.pathname.match(p.regexp))){a.resolveRoute(p,h);return}if(p.regexpFull&&
(h=e.match(p.regexp))){a.resolveRoute(p,h);return}p["default"]&&!f&&(f=p)}}(h=a.onNoMatchFound(b))?Y(h)?(h.done(a.resolveRoute,a),h.fail(function(){a.finishOnLocationChange(f)})):a.resolveRoute(h):a.finishOnLocationChange(f)},finishOnLocationChange:function(a){a?this.resolveRoute(a):this.config.hasExpression("defaultCmp")&&this.setComponent(this.config.get("defaultCmp"))},resolveRoute:function(a,b){var e=this;b=b||[];if(a.resolve){var d=a.resolve.call(e,a,b);Y(d)?d.done(function(){e.setRouteComponent(a,
b)}):d&&e.setRouteComponent(a,b)}else e.setRouteComponent(a,b)},onNoMatchFound:function(){},clearComponent:function(){var a=this,b=a.node,e=a.currentView||{};a.currentCls&&S(a.node,a.currentCls);a.currentHtmlCls&&S(window.document.documentElement,a.currentHtmlCls);a.currentComponent&&fa(b,a.config.get("animate")?"leave":null).done(function(){if(e.keepAlive){a.currentComponent.freezeByView(a);for(var d=a.domCache[e.id];b.firstChild;)d.appendChild(b.firstChild);e.ttl&&(e.ttlTmt=V(a.onCmpTtl,a,[e],e.ttl))}else for(!a.currentComponent||
a.currentComponent.$destroyed||a.currentComponent.$destroying||a.currentComponent.$destroy();b.firstChild;)b.removeChild(b.firstChild);a.currentComponent=null})},onCmpTtl:function(a){var b=a.id;a.ttlTmt=null;this.cmpCache[b]&&(this.cmpCache[b].$destroy(),delete this.cmpCache[b],delete this.domCache[b])},toggleRouteParams:function(a,b){if(a.params)for(var e in a.params)a.params[e][b]()},setRouteClasses:function(a){a.cls&&(this.currentCls=a.cls,N(this.node,a.cls));a.htmlCls&&(this.currentHtmlCls=a.htmlCls,
N(window.document.documentElement,a.htmlCls))},onRouteFail:function(a){},setRouteComponent:function(a,b){var e=this,d=e.node,f=a.params,k=e.currentView||{};if(a.id==k.id){if(e.currentComponent&&e.currentComponent.onViewRepeat)e.currentComponent.onViewRepeat()}else a.ttlTmt&&clearTimeout(a.ttlTmt),e.beforeRouteCmpChange(a),e.toggleRouteParams(k,"disable"),e.toggleRouteParams(a,"enable"),wa(e.node),e.clearComponent(),k.teardown&&k.teardown(k,a,b),e.setRouteClasses(a),e.currentView=a,fa(d,e.config.get("animate")?
"enter":null,function(){var h=b||[],m={destroyEl:!1,node:d,destroyScope:!0,scope:a.$isolateScope?e.scope.$newIsolated():e.scope.$new()};a.as&&(m.as=a.as);a.template&&(m.template=a.template);h.shift();f&&q(m,f,!1,!1);h.unshift(m);if(e.cmpCache[a.id])e.currentComponent=e.cmpCache[a.id],d.appendChild(e.domCache[a.id]),e.currentComponent.unfreezeByView(e),e.afterRouteCmpChange(),e.afterCmpChange();else if(a.setup)a.setup(a,b);else return xa(a.cmp||"MetaphorJs.app.Component",m,m.scope,d,h).done(function(b){e.currentComponent=
b;a.keepAlive&&(b[e.id]=a.id,e.cmpCache[a.id]=b,e.domCache[a.id]=window.document.createDocumentFragment(),b.on("destroy",e.onCmpDestroy,e));e.afterRouteCmpChange();e.afterCmpChange()}).fail(function(){if(a.onFail)a.onFail.call(e);else e.onRouteFail(a)})})},onCmpDestroy:function(a){(a=a[this.id])&&this.cmpCache[a]&&(delete this.cmpCache[a],delete this.domCache[a])},setComponent:function(a){var b=this,e=b.node;b.beforeCmpChange(a);wa(b.node);b.clearComponent();b.currentView=null;fa(e,b.config.get("animate")?
"enter":null,function(){var d=La(a)?a:{},f=(w(a)?a:null)||"MetaphorJs.app.Component",k=d.scope||b.scope.$new();d.destroyEl=!1;return xa(f,d,k,e,[d]).done(function(a){b.currentComponent=a;b.afterCmpChange()})})},beforeRouteCmpChange:function(a){},afterRouteCmpChange:function(){},beforeCmpChange:function(a){},afterCmpChange:function(){var a=this;a.config.get("scrollOnChange")&&U(function(){a.node.scrollTop=0})},onDestroy:function(){this.clearComponent();if(this.route){Ka.un("location-change",this.onLocationChange,
this);var a,b;var e=0;for(a=this.route.length;e<a;e++)if(this.route[e].params)for(b in this.route[e].params)this.route[e].params[b].$destroy();this.route=null}this.watchable&&(this.watchable.unsubscribe(this.onCmpChange,this),this.watchable.$destroy(!0),this.watchable=null);this.node&&P(this.node,"mjs-transclude",null,"remove");this.currentComponent=this.scope=null;this.$super()}});var nc=n.dom.htmlTags="a abbr address area article aside audio b base bdi bdo blockquote body br button canvas caption cite code col colgroup data datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i iframe img input ins kbd keygen label legend li link main map mark math menu menuitem meta meter nav noscript object ol optgroup option output p param picture pre progress q rb rp rt rtc ruby s samp script section select slot small source span strong style sub summary sup svg table tbody td template textarea tfoot th thead time title tr track u ul var video wbr".split(" "),
oc=n.app.Component=C({$mixins:[ma],id:null,originalId:!1,node:null,_nodeReplaced:!1,cls:null,renderTo:null,autoRender:!0,rendered:!1,hidden:!1,destroyEl:!0,destroyScope:!1,scope:null,template:null,templateUrl:null,tag:null,as:null,$init:function(a){a=a||{};this.$super(a);q(this,a,!0,!1);this.scope||(this.scope=new ta);this.config?this.config instanceof D||(this.config=new D(this.config,{scope:this.scope})):this.config=new D(null,{scope:this.scope});this._initConfig();this.config.hasExpression("as")&&
(this.scope[this.config.get("as")]=this);if(this.node){var b=z(this.node,"id");b&&(this.originalId=!0,this.id||(this.id=b))}this.id=this.id||"cmp-"+W();this.node||!1===this.node||this._createNode();this.beforeInitComponent.apply(this,arguments);this.initComponent.apply(this,arguments);this.scope.$app&&this.scope.$app.registerCmp(this,this.scope,"id");b=this.template;var e=this.templateUrl;this._nodeReplaced=-1===nc.indexOf(this.node.tagName.toLowerCase());b&&b instanceof Ia?b instanceof Ia&&(this.template.node=
this.node):(this.template=b=new Ia({scope:this.scope,node:this.node,deferRendering:!b||this._nodeReplaced,ownRenderer:!0,replace:this._nodeReplaced,tpl:b,url:e,shadow:this.constructor.$shadow,animate:!this.hidden&&!!this.animate,passAttrs:this.passAttrs}),this.template.on("first-node",this.onFirstNodeReported,this));this.afterInitComponent.apply(this,arguments);this.template.on("rendered",this.onRenderingFinished,this);if(this.parentRenderer)this.parentRenderer.on("destroy",this.onParentRendererDestroy,
this);this.node&&this._initElement();this.autoRender&&(b.initPromise?b.initPromise.done(this.render,this):this.render())},_initConfig:function(){this.config.setDefaultMode("as",D.MODE_STATIC)},_createNode:function(){this.node=window.document.createElement(this.tag||"div")},_initElement:function(){var a=this.node;this.originalId||M(a,"id",this.id);this.initNode()},releaseNode:function(){var a=this.node;ka(a,"cmp-id");this.cls&&S(a,this.cls)},onFirstNodeReported:function(a){this._nodeReplaced&&(M(a,
"cmp-id",this.id),a.$$cmpId=this.id)},initNode:function(){var a=this.node;M(a,"cmp-id",this.id);a.$$cmpId=this.id;this.cls&&N(a,this.cls);this.hidden&&(a.style.display="none")},replaceNodeWithTemplate:function(){this._nodeReplaced&&this.node.parentNode&&ka(this.node,"id");this.node=this.template.node;if(11===this.node.nodeType||I(this.node)){var a=11===this.node.nodeType?this.node.childNodes:this.node,b;var e=0;for(b=a.length;e<b;e++)if(1===a[e].nodeType){this.node=a[e];break}}this._initElement()},
render:function(){this.rendered||((this._nodeReplaced&&this.node!==this.template.node||!this.node)&&this.replaceNodeWithTemplate(),this.trigger("render",this),this.template.startRendering())},onRenderingFinished:function(){(this._nodeReplaced&&this.node!==this.template.node||!this.node)&&this.replaceNodeWithTemplate();this.renderTo?this.renderTo.appendChild(this.node):Oa(this.node)||window.document.body.appendChild(this.node);this.rendered=!0;this.afterRender();this.trigger("after-render",this)},
show:function(){if(this.hidden){if(!1===this.trigger("before-show",this))return!1;this.rendered||this.render();this.template.setAnimation(!0);this.showApply();this.hidden=!1;this.onShow();this.trigger("show",this)}},showApply:function(){this.node&&(this.node.style.display="block")},hide:function(){if(!this.hidden){if(!1===this.trigger("before-hide",this))return!1;this.template.setAnimation(!1);this.hideApply();this.hidden=!0;this.onHide();this.trigger("hide",this)}},hideApply:function(){this.node&&
(this.node.style.display="none")},freezeByView:function(a){this.releaseNode();this.scope.$freeze();this.trigger("view-freeze",this,a)},unfreezeByView:function(a){this.initNode();this.scope.$unfreeze();this.trigger("view-unfreeze",this,a);this.scope.$check()},isHidden:function(){return this.hidden},isRendered:function(){return this.rendered},isDestroyed:function(){return this.destroyed},getEl:function(){return this.node},beforeInitComponent:J,initComponent:J,afterInitComponent:J,afterRender:J,onShow:J,
onHide:J,onParentRendererDestroy:function(){this.$destroy()},onDestroy:function(){this.template&&this.template.$destroy();this.destroyEl?this.node&&Oa(this.node)&&this.node.parentNode.removeChild(this.node):this.node&&(this.originalId||ka(this.node,"id"),this.releaseNode());this.destroyScope&&this.scope&&this.scope.$destroy();this.$super()}},{registerDirective:function(a){"string"===typeof a?y.registerComponent(a):y.registerComponent(a.prototype.$class,a)}});n.dialog=n.dialog||{pointer:{},position:{}};
var qa=n.dom.setStyle=function(a,b,e){if(a&&a.style){var d=a.style,f;"string"===typeof b?(a={},a[b]=e):a=b;for(f in a)d[f]=a[f]}},pc=n.dom.isVisible=function(a){return a&&!(0>=a.offsetWidth||0>=a.offsetHeight)},pb=n.dom.is=function(a,b){b=L(b,a.parentNode);var e;var d=-1;for(e=b.length;++d<e;)if(b[d]===a)return!0;return!1},Za=n.dom.getOuterWidth=Wa("outer","Width"),$a=n.dom.getOuterHeight=Wa("outer","Height"),qc=n.dom.delegate=function(a,b,e,d){var f=Da.global().get("dom/delegates",[]),k=b+"-"+e,
h=function(a){a=Z(a);for(var e=a.target;e;){if(pb(e,b))return d(a);e=e.parentNode}return null};f[k]||(f[k]=[]);f[k].push({el:a,ls:h,fn:d});O(a,e,h)},qb=n.dialog.position.Abstract=C({dialog:null,positionBase:null,correct:"solid",$init:function(a){this.dialog=a;q(this,a.getCfg().position,!0,!1);this.onWindowResizeDelegate=this.onWindowResize.bind(this);this.onWindowScrollDelegate=this.onWindowScroll.bind(this);var b=this.preferredType||this.type;if("string"==typeof b){var e=this.getAllPositions(),d;
-1!=(d=e.indexOf(b))&&(e.splice(d,1),e.unshift(b));this.preferredType=e}else b||(this.preferredType=this.getAllPositions());a.on("reposition",this.onReposition,this);a.on("show-after-delay",this.onShowAfterDelay,this);a.on("hide-after-delay",this.onHideAfterDelay,this);if(a.isVisible())this.onShowAfterDelay()},getPositionBase:function(){if(this.positionBase)return this.positionBase;var a;return(a=this.dialog.getCfg().position.base)?this.positionBase="string"==typeof a?L(a).shift():a:null},getBoundary:function(){var a=
this.getPositionBase(),b=this.screenX||0,e=this.screenY||0;if(a){var d=n.dom.getOffset(a);var f=Za(a);a=$a(a);return{x:d.left+b,y:d.top+e,x1:d.left+f-b,y1:d.top+a-e,w:f,h:a}}f=jb(window);a=kb(window);d=Aa(window);var k=Ba(window);return{x:k+b,y:d+e,x1:k+f-b,y1:d+a-e,w:f,h:a}},getPrimaryPosition:function(a){return!1},getSecondaryPosition:function(a){return!1},getAllPositions:function(){return[]},correctPosition:function(a){var b=this.getPrimaryPosition(),e=this.correct;if(b&&e){var d=this.dialog;b=
this.getBoundary();d=d.getDialogSize();var f=this.preferredType,k=f[0];if(e&&"solid"!=e){if(this.type!=k&&this.checkIfFits(a,k,b,d,!1))return this.changeType(k),this.fitToBoundary(this.getCoords(a),b,d);if(this.checkIfFits(a,this.type,b,d,!1))return this.fitToBoundary(this.getCoords(a),b,d)}if(e&&"position-only"!=e)for(e=0,k=f.length;e<k;e++)if(this.checkIfFits(a,f[e],b,d,!0)){this.changeType(f[e]);break}return this.getCoords(a)}},checkIfFits:function(a,b,e,d,f){a=this.getCoords(a,b,!0);if(!f&&this.getSecondaryPosition(b))return!1;
if(f)return!(a.x<e.x||a.y<e.y||a.x+d.width>e.x1||a.y+d.height>e.y1);switch(this.getPrimaryPosition(b)){case "t":return a.y>=e.y;case "r":return a.x+d.width<=e.x1;case "b":return a.y+d.height<=e.y1;case "l":return a.x>=e.x}},fitToBoundary:function(a,b,e){var d=this.getPositionBase(),f=d?0:b.x,k=d?0:b.y,h=d?b.w:b.x1;b=d?b.h:b.y1;var m=d=0,p=this.dialog.getPointer();a.x<f&&(d=a.x-f,a.x=f);a.y<k&&(m=a.y-k,a.y=k);a.x+e.width>h&&(d=a.x+e.width-h,a.x-=d);a.y+e.height>b&&(m=a.y+e.height-b,a.y-=m);p.setCorrectionOffset(d,
m);p.reposition();return a},changeType:function(a){var b=this.dialog.getPointer();this.type=a;b.setType(null,null)},onReposition:function(a,b){a=!1!==this.screenX||!1!==this.screenY?this.correctPosition(b):this.getCoords(b);this.apply(a)},getCoords:function(a){return{left:0,top:0}},apply:function(a){if(a&&!isNaN(a.x)&&!isNaN(a.y)){var b=this.dialog,e=b.getCfg().position.axis,d={};"y"!=e&&(d.left=a.x+"px");"x"!=e&&(d.top=a.y+"px");qa(b.getElem(),d)}},onWindowResize:function(a){this.dialog.reposition(Z(a))},
onWindowScroll:function(a){this.dialog.reposition(Z(a))},onShowAfterDelay:function(){(this.resize||this.screenX||this.screenY)&&O(window,"resize",this.onWindowResizeDelegate);(this.scroll||this.screenX||this.screenY)&&O(this.dialog.getScrollEl(this.scroll),"scroll",this.onWindowScrollDelegate)},onHideAfterDelay:function(){(this.resize||this.screenX||this.screenY)&&ca(window,"resize",this.onWindowResizeDelegate);(this.scroll||this.screenX||this.screenY)&&ca(this.dialog.getScrollEl(this.scroll),"scroll",
this.onWindowScrollDelegate)},onDestroy:function(){var a=this.dialog;ca(window,"resize",this.onWindowResizeDelegate);ca(a.getScrollEl(this.scroll),"scroll",this.onWindowScrollDelegate);a.un("reposition",this.onReposition,this);a.un("show-after-delay",this.onShowAfterDelay,this);a.un("hide-after-delay",this.onHideAfterDelay,this);if(a.isVisible())this.onHideAfterDelay()}}),rc=n.dialog.position.Target=qb.$extend({getCoords:function(a,b,e){var d=this.dialog,f=d.getCfg(),k=d.getTarget();if(!k)return null;
b=b||this.type;var h=this.getPositionBase();a=d.getDialogSize();e=h&&!e?nb(k,h):n.dom.getOffset(k);k=d.getTargetSize();h={};var m=b.substr(0,1),p=b.substr(1),q=f.position.offsetX;f=f.position.offsetY;b=d.pointer.getDialogPositionOffset(b);switch(m){case "t":h.y=e.top-a.height-f;break;case "r":h.x=e.left+k.width+q;break;case "b":h.y=e.top+k.height+f;break;case "l":h.x=e.left-a.width-q}switch(p){case "t":h.y=e.top+f;break;case "r":h.x=e.left+k.width-a.width-q;break;case "b":h.y=e.top+k.height-a.height-
f;break;case "l":h.x=e.left+q;break;case "rc":h.x=e.left+k.width+q;break;case "lc":h.x=e.left-a.width-q;break;case "":switch(m){case "t":case "b":h.x=e.left+k.width/2-a.width/2;break;case "r":case "l":h.y=e.top+k.height/2-a.height/2}}b&&(h.x+=b.x,h.y+=b.y);return h},getPrimaryPosition:function(a){return(a||this.type).substr(0,1)},getSecondaryPosition:function(a){return(a||this.type).substr(1)},getAllPositions:function(){return"t r b l tl tr rt rb br bl lb lt tlc trc brc blc".split(" ")}});n.dialog.position.Mouse=
rc.$extend({correct:"position",$init:function(a){this.onMouseMoveDelegate=this.onMouseMove.bind(this);this.$super(a)},getCoords:function(a,b,e){if(!a)return null;var d=b||this.type,f=this.dialog,k=f.getCfg(),h=f.getDialogSize(),m=this.getPositionBase(),p={};b=(b||this.type).substr(1);var q=k.position.offsetX,t=k.position.offsetY;k=k.position.axis;d=f.getPointer().getDialogPositionOffset(d);var r=0,v=0;!e&&m&&(m=n.dom.getOffset(m),r=m.left,v=m.top);switch(b){case "":p=this.get.call(f.$$callbackContext,
f,a,b,e);break;case "c":p.y=a.pageY-v-h.height/2;p.x=a.pageX-r-h.width/2;break;case "t":p.y=a.pageY-v-h.height-t;p.x=a.pageX-r-h.width/2;break;case "r":p.y=a.pageY-v-h.height/2;p.x=a.pageX-r+q;break;case "b":p.y=a.pageY-v+t;p.x=a.pageX-r-h.width/2;break;case "l":p.y=a.pageY-v-h.height/2;p.x=a.pageX-r-h.width-q;break;case "rt":p.y=a.pageY-v-h.height-t;p.x=a.pageX-r+q;break;case "rb":p.y=a.pageY-v+t;p.x=a.pageX-r+q;break;case "lt":p.y=a.pageY-v-h.height-t;p.x=a.pageX-r-h.width-q;break;case "lb":p.y=
a.pageY-v+t,p.x=a.pageX-r-h.width-q}d&&(p.x+=d.x,p.y+=d.y);k&&(a=this.$super(a,b))&&("x"==k?p.y=a.y:p.x=a.x);return p},onShowAfterDelay:function(){this.$super();O(window.document.documentElement,"mousemove",this.onMouseMoveDelegate)},onHideAfterDelay:function(){this.$super();ca(window.document.documentElement,"mousemove",this.onMouseMoveDelegate)},onMouseMove:function(a){this.dialog.reposition(Z(a))},getPrimaryPosition:function(a){return(a||this.type).substr(1,1)},getSecondaryPosition:function(a){return(a||
this.type).substr(2)},getAllPositions:function(){return"mt mr mb ml mrt mrb mlb mlt".split(" ")}});n.dialog.position.Window=qb.$extend({getCoords:function(a,b){var e=this.dialog;a=this.getPositionBase()||window;e=e.getDialogSize();var d={};b=(b||this.type).substr(1);var f=this.offsetX,k=this.offsetY,h=Aa(a),m=Ba(a),p=Za(a);a=$a(a);switch(b){case "c":d.y=a/2-e.height/2+h;d.x=p/2-e.width/2+m;break;case "t":d.y=h+k;d.x=p/2-e.width/2+m;break;case "r":d.y=a/2-e.height/2+h;d.x=p-e.width+m-f;break;case "b":d.y=
a-e.height+h-k;d.x=p/2-e.width/2+m;break;case "l":d.y=a/2-e.height/2+h;d.x=m+f;break;case "rt":d.y=h+k;d.x=p-e.width+m-f;break;case "rb":d.y=a-e.height+h-k;d.x=p-e.width+m-f;break;case "lt":d.y=h+k;d.x=m+f;break;case "lb":d.y=a-e.height+h-k,d.x=m+f}return d},getPrimaryPosition:function(a){return(a||this.type).substr(1,1)},getSecondaryPosition:function(a){return(a||this.type).substr(2)},getAllPositions:function(){return"wt wr wb wl wrt wrb wlb wlt wc".split(" ")},correctPosition:function(a){return this.getCoords(a)}});
n.dialog.position.Custom=qb.$extend({getCoords:function(a){var b=this.dialog;return this.get.call(b.$$callbackContext,b,a)}});var sc=n.dialog.pointer.Abstract=C({enabled:null,node:null,correctX:0,correctY:0,$init:function(a,b){q(this,b,!0,!1);this.origCfg=b;this.dialog=a;this.opposite={t:"b",r:"l",b:"t",l:"r"};this.names={t:"top",r:"right",b:"bottom",l:"left"};this.sides={t:["l","r"],r:["t","b"],b:["r","l"],l:["b","t"]};this.enabled=!1!==this.enabled&&b.size?!0:!1},enable:function(){this.enabled||
(this.enabled=!0,this.render(),this.dialog.isVisible()&&this.dialog.reposition())},disable:function(){this.enabled&&(this.remove(),this.enabled=!1,this.dialog.isVisible()&&this.dialog.reposition())},getElem:function(){return this.node},getSize:function(){return this.enabled?this.size:0},setCorrectionOffset:function(a,b){this.correctX=a;this.correctY=b},getCorrectionValue:function(a,b,e){if(!b)return 0;var d=e.substr(0,1);e=e.substr(1,1);var f=this.dialog.getDialogSize(),k=this.width,h="t"==d||"b"==
d?"width":"height";switch(e){case "":var m=f[h]/2-k/2;var p=-m;break;case "l":p=0;m=f[h]-k/2;break;case "r":p=-(f[h]-k/2),m=0}b=0>b?Math.max(p,b):Math.min(m,b);return("t"==d||"b"==d)&&"x"==a||("l"==d||"r"==d)&&"y"==a?b:0},getDialogPositionOffset:function(a){var b=(this.detectPointerPosition(a)||"").substr(0,1);a=this.dialog.getPosition().getPrimaryPosition(a);var e={x:0,y:0};if(!this.enabled)return e;b==this.opposite[a]&&(e["t"==b||"b"==b?"y":"x"]="b"==b||"r"==b?-this.size:this.size);return e},detectPointerPosition:function(a){if(this.position&&
!a)return B(this.position)?this.position.call(this.dialog.$$callbackContext,this.dialog,this.origCfg):this.position;var b=this.dialog.getPosition().getPrimaryPosition(a);a=this.dialog.getPosition().getSecondaryPosition(a);var e=a.substr(1,1);if(!b)return null;b=this.opposite[b];a&&(a=a.substr(0,1),b="c"==e?b+this.opposite[a]:b+a);return b},detectPointerDirection:function(a){return this.direction?B(this.direction)?this.direction.call(this.dialog.$$callbackContext,this.dialog,a,this.origCfg):this.direction:
a},update:function(){this.remove();this.render();this.append();this.dialog.isVisible()&&this.dialog.reposition()},setType:function(a,b){this.position=a;this.direction=b;this.update();this.reposition()},render:function(){},onDestroy:function(){this.remove()},reposition:function(){},append:function(){if(this.enabled&&(this.node||this.render(),this.node)){this.reposition();var a=this.dialog.getElem();a&&a.appendChild(this.node)}},remove:function(){var a=this.node;a&&(a.parentNode&&a.parentNode.removeChild(a),
this.node=null)}});n.dialog.pointer.Html=function(){var a=null,b={backgroundColor:"transparent",width:"0px",height:"0px",position:"absolute",fontSize:"0px",lineHeight:"0px"};return sc.$extend({node:null,sub:null,$init:function(b,d){null===a&&(a=window.document.all&&!window.XMLHttpRequest);this.$super(b,d);this.width=this.width||2*this.size;this.inner&&(this.enabled=!0)},createInner:function(){var a=q({},this.origCfg);a.size=this.size-2*this.border;a.width=this.width-4*this.border;a.border=0;a.borderColor=
null;a.borderCls=null;a.offset=0;a.inner=this.border;this.sub=new n.dialog.pointer.Html(this.dialog,a)},getBorders:function(b,d,f){var e={},h=b.substr(0,1);b=d.substr(0,1);var m=d.substr(1);d=a?"dotted":"solid";var p=this.names,n=this.sides,t=this.opposite;e["border"+ra(p[t[h]])]=this.size+"px solid "+f;e["border"+ra(p[h])]="0 "+d+" transparent";m?(e["border"+ra(p[m])]="0 solid transparent",e["border"+ra(p[t[m]])]=this.width+"px "+d+" transparent"):(f=Math.floor(this.width/2),e["border"+ra(p[n[b][0]])]=
f+"px "+d+" transparent",e["border"+ra(p[n[b][1]])]=f+"px "+d+" transparent");return e},getOffsets:function(a,b){var d={},e=this.names,h=this.opposite,m=a.substr(0,1),p="t"==m||"b"==m?"r":"b";d[e[m]]=this.inner?"auto":-this.size+"px";d[e[p]]="auto";if(this.inner)a=b.substr(0,1),b=b.substr(1),d[e[h[p]]]=b?"l"==b||"t"==b?this.inner+"px":-this.width-this.inner+"px":Math.floor(-this.width/2)+"px",d[e[h[a]]]=-(this.size+2*this.inner)+"px";else{switch(a){case "t":case "r":case "b":case "l":b=b!=a?"l"==
b||"t"==b?this.offset:-this.width+this.offset:-this.width/2+this.offset;break;case "bl":case "tl":case "lt":case "rt":b=this.offset;break;default:b=-this.width-this.offset}d["margin"+ra(e[h[p]])]=b+"px";switch(a){case "t":case "r":case "b":case "l":b="50%";break;case "tr":case "rb":case "br":case "lb":b="100%";break;default:b=0}d[e[h[p]]]=b;e=Fa().transform;h="";p=this.correctX;b=this.correctY;e&&(p&&(h+=" translateX("+this.getCorrectionValue("x",p,a)+"px)"),b&&(h+=" translateY("+this.getCorrectionValue("y",
b,a)+"px)"),d[e]=h)}return d},render:function(){if(this.enabled&&!this.node&&this.detectPointerPosition()){this.border&&!this.sub&&this.createInner();this.node=window.document.createElement("div");var a=window.document.createComment(" ");this.node.appendChild(a);setStyle(this.node,b);N(this.node,this.borderCls||this.cls);this.sub&&(this.sub.render(),this.node.appendChild(this.sub.getElem()))}},reposition:function(){var a=this.detectPointerPosition(),b=this.detectPointerDirection(a);this.node&&(qa(this.node,
this.getBorders(a,b,this.borderColor||this.color)),qa(this.node,this.getOffsets(a,b)),this.sub&&this.sub.reposition())},update:function(){this.sub&&(this.sub.$destroy(),this.sub=null);this.remove();this.node=null;this.render();this.append();this.dialog.isVisible()&&this.dialog.reposition()},onDestroy:function(){this.sub&&(this.sub.$destroy(),this.sub=null);this.$super()},remove:function(){this.sub&&this.sub.remove();this.$super()}})}();var tc=n.dialog.Overlay=C({dialog:null,enabled:!1,color:"#000",
opacity:.5,cls:null,animateShow:!1,animateHide:!1,$mixins:[ma],$init:function(a){this.dialog=a;this.onClickDelegate=this.onClick.bind(this);q(this,a.getCfg().overlay,!0,!1);this.$$observable.createEvent("click",!1);this.enabled&&(this.enabled=!1,this.enable())},getElem:function(){this.enabled&&!this.node&&this.render();return this.node},enable:function(){this.enabled||(this.enabled=!0)},disable:function(){this.enabled&&(this.remove(),this.enabled=!1)},show:function(a){this.enabled&&(this.animateShow?
this.animate("show",a):this.node.style.display="block")},hide:function(a){this.node&&(this.animateHide?this.animate("hide",a):this.node.style.display="none")},render:function(){if(this.enabled){var a=window.document.createElement("div"),b=this.dialog.getCfg();qa(a,{display:"none",position:"fixed",left:0,top:0,right:0,bottom:0,opacity:this.opacity,backgroundColor:this.color});O(a,"click",this.onClickDelegate);b.render.zIndex&&qa(a,"zIndex",b.render.zIndex);this.cls&&n.dom.addClass(a,this.cls);this.node=
a}},remove:function(){var a=this.node;a&&U(function(){a.parentNode&&a.parentNode.removeChild(a)})},append:function(){var a=this.dialog.getCfg().render.appendTo||window.document.body;this.enabled&&(this.node||this.render(),a.appendChild(this.node))},animate:function(a,b){var e=this.node;var d="show"==a?this.animateShow:this.animateHide;B(d)&&(d=d(this,b));sa(d)?d=a:w(d)&&(d=[d]);return fa(e,d,function(){if("show"==a)return new H(function(a,b){U(function(){e.style.display="";a()})})},!1)},onClick:function(a){return!1===
this.trigger("click",this.dialog,this,a)?null:this.modal?(a=Z(a),a.preventDefault(),a.stopPropagation(),!1):null},onDestroy:function(){this.remove()}}),uc=n.dialog.Manager=C({all:null,groups:null,$init:function(){this.all={};this.groups={}},register:function(a){var b=a.getInstanceId(),e=a.getGroup(),d=this.groups,f;this.all[b]=a;var k=0;for(f=e.length;k<f;k++){var h=e[k];d[h]||(d[h]={});d[h][b]=!0}a.on("destroy",this.unregister,this)},unregister:function(a){a=a.getInstanceId();delete this.all[a]},
hideAll:function(a){var b=a.getInstanceId();a=a.getGroup();var e=this.all,d=this.groups,f,k;var h=0;for(f=a.length;h<f;h++){var m=a[h];m=d[m];for(k in m)e[k]?k==b||e[k].isHideAllIgnored()||e[k].hide(null,!0,!0):delete m[k]}}}),vc=n.dialog.Dialog=function(){var a=new uc,b=function(a,b,d,e){if("show"===d||!e)return b.preventDefault(),b.stopPropagation(),!1},e=function(a,b,d,e){var h=a[b],f=!1;if(void 0!==h){switch(e){case "string":f=w(h);break;case "function":f=B(h);break;case "number":f=1===ha(h)||
h==parseInt(h);break;case "dom":f=h&&(h.tagName||h.nodeName)?!0:!1;break;case "jquery":(f=h&&h.jquery?!0:!1)&&(h=h.get(0));break;case "boolean":if(!0===h||!1===h)f=!0;break;default:!0===e&&!0===h&&(f=!0),!1===e&&!1===h&&(f=!0)}f&&(a[b]={},a[b][d]=h)}},d=function(a){if(!a)return{};e(a,"content","value","string");e(a,"content","value","boolean");e(a,"content","fn","function");e(a,"ajax","url","string");e(a,"cls","dialog","string");e(a,"render","tpl","string");e(a,"render","fn","function");e(a,"render",
"el","dom");e(a,"render","el","jquery");e(a,"show","events",!1);e(a,"show","events","string");e(a,"hide","events",!1);e(a,"hide","events","string");e(a,"toggle","events",!1);e(a,"toggle","events","string");e(a,"position","type","string");e(a,"position","type",!1);e(a,"position","get","function");e(a,"overlay","enabled","boolean");e(a,"pointer","position","string");e(a,"pointer","size","number");return a},f={target:null,group:null,modal:!1,useHref:!1,content:{value:"",fn:null,prepare:null,attr:null},
ajax:{url:null,data:null,dataType:"text",method:"GET"},cls:{dialog:null,visible:null,hidden:null,loading:null},selector:{content:null},buttons:null,render:{tpl:"<div></div>",fn:null,el:null,zIndex:null,lazy:!0,style:null,appendTo:null,id:null,keepVisible:!1,keepInDOM:!1,lifetime:null},events:{show:{"*":{preventDefault:!1,stopPropagation:!1,returnValue:null,process:b}},hide:{"*":{preventDefault:!1,stopPropagation:!1,returnValue:null,process:b}}},show:{delay:null,single:!1,events:null,animate:!1,ignoreHideAll:!1,
focus:!1,preventScroll:!1,display:"block"},hide:{delay:null,timeout:null,events:null,destroy:!1,remove:!1,animate:!1,cancelShowDelay:!0},toggle:{events:null},position:{type:"t",preferredType:null,offsetX:0,offsetY:0,axis:null,get:null,screenX:!1,screenY:!1,base:null,scroll:!1,resize:!0},pointer:{position:null,direction:null,size:0,width:null,color:null,offset:0,border:0,borderColor:null,el:null,cls:null,borderCls:null},overlay:{enabled:!1,color:"#000",opacity:.5,cls:null,animateShow:!1,animateHide:!1},
callback:{context:null,"content-change":null,"before-show":null,show:null,"before-hide":null,hide:null,render:null,lifetime:null,"target-change":null,button:null}},k=C({$mixins:[ma],id:null,node:null,overlay:null,pointer:null,cfg:null,position:null,target:null,dynamicTarget:!1,dynamicTargetEl:null,visible:!1,enabled:!0,frozen:!1,rendered:!1,bindSelfOnRender:!1,hideTimeout:null,hideDelay:null,showDelay:null,destroyDelay:null,images:0,positionGetType:null,positionClass:null,positionAttempt:0,$constructor:function(){this.$$events=
{"before-show":{returnResult:!1},"before-hide":{returnResult:!1}};this.$super.apply(this,arguments)},$init:function(b){b=b||{};var e=b.preset;b.preset=null;this.cfg=b=q({},f,d(k.defaults),d(k[e]),d(b),!0,!0);this.id=W();this.onPreventScrollDelegate=this.onPreventScroll.bind(this);this.onButtonClickDelegate=this.onButtonClick.bind(this);this.onButtonKeyupDelegate=this.onButtonKeyup.bind(this);this.showDelegate=this.show.bind(this);this.hideDelegate=this.hide.bind(this);this.toggleDelegate=this.toggle.bind(this);
this.onImageLoadDelegate=this.onImageLoad.bind(this);a.register(this);b.modal&&(b.overlay.enabled=!0);this.overlay=new tc(this);e=ra(b.pointer.$class||"Html");this.pointer=C.factory("MetaphorJs.dialog.pointer."+e,this,b.pointer);B(b.position.type)&&(this.positionGetType=b.position.type);this.setTarget(b.target);b.target&&b.useHref&&(e=z(this.getTarget(),"href"),"#"===e.substr(0,1)?b.render.el=e:b.ajax.url=e);b.render.lazy||this.render();this.trigger("init",this);this.setHandlers("bind")},getElem:function(){return this.node},
getInstanceId:function(){return this.id},getCfg:function(){return this.cfg},getPointer:function(){return this.pointer},getOverlay:function(){return this.overlay},isEnabled:function(){return this.enabled},isVisible:function(){return this.visible},isHideAllIgnored:function(){return this.cfg.show.ignoreHideAll},isFrozen:function(){return this.frozen},isRendered:function(){return this.rendered},enable:function(){this.enabled=!0},disable:function(){this.hide();this.enabled=!1},freeze:function(){this.frozen=
!0},unfreeze:function(){this.frozen=!1},getGroup:function(){var a=this.cfg;return a.group?w(a.group)?[a.group]:a.group:[""]},toggle:function(a,b){return a&&a.stopPropagation&&this.dynamicTarget&&this.visible&&this.isDynamicTargetChanged(a)?this.show(a):this[this.visible?"hide":"show"](a,b)},resetHandlers:function(a,b){this.setHandlers("unbind");this.bindSelfOnRender=!1;a&&a.call(b,this,this.getCfg());this.setHandlers("bind")},setHandlers:function(a,b){var d=this.cfg,e=["show","hide","toggle"],h="bind"===
a?O:ca;a="bind"===a?qc:n.dom.undelegate;for(var f,m,k,q,u,x,y,z,B,C;f=e.shift();)if(m=d[f].events,!1!==m){if(w(m)||I(m))this.dynamicTarget?(u={},u[m]=d.target,m={_html:u}):m={_target:m};for(k in m){if(b)if("_self"===b){if("_self"!==k&&"_overlay"!==k&&">"!==k.substr(0,1))continue}else if(k!==b)continue;if("_self"!==k&&"_overlay"!==k&&">"!==k.substr(0,1)||this.node){if(y=m[k]){switch(k){case "_target":z=[this.getTarget()];break;case "_self":z=[this.node];break;case "_window":z=[window];break;case "_document":z=
[window.document];break;case "_html":z=[window.document.documentElement];break;case "_overlay":z=[this.overlay.getElem()];break;default:z=">"===k.substr(0,1)?L(k.substr(1),this.node):L(k)}if(z&&z.length)if(w(y)&&(y=[y]),I(y))for(u=0,x=y.length;u<x;u++)for(B=-1,C=z.length;++B<C;h(z[B],y[u],this[f+"Delegate"]));else for(q in y)for(B=-1,C=z.length;++B<C;a(z[B],y[q],q,this[f+"Delegate"]));}}else this.bindSelfOnRender=!0}}},onPreventScroll:function(a){Z(a).preventDefault()},onButtonClick:function(a){var b=
Z(a).target;(b=P(b,"metaphorjsTooltip-button-id"))&&this.trigger("button",this,b,a)},onButtonKeyup:function(a){if(13===a.keyCode||32===a.keyCode){var b=P(a.target,"metaphorjsTooltip-button-id");b&&this.trigger("button",this,b,Z(a))}},getEventConfig:function(a,b){var d=this.node;for(var e=a.type,f=a.target,h=null,k;f&&f!==d;){if(k=z(f,"data-"+b+"-"+e)){h=G.parse(k)({});break}f=f.parentNode}d=h;e=this.cfg;!d&&e.events[b]&&(d=e.events[b][a.type]||e.events[b]["*"]);return d},show:function(b,d){var e=
this.cfg,f=null,h=e.show,k=null;b&&(b=Z(b));this.isEnabled()||(k="disabled");!k&&this.visible&&this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=V(this.hide,this,null,e.hide.timeout),k="hidetimeout");!k&&this.hideDelay&&(window.clearTimeout(this.hideDelay),this.hideDelay=null,this.visible=!0,k="hidedelay");!k&&this.frozen&&(k="frozen");this.destroyDelay&&(window.clearTimeout(this.destroyDelay),this.destroyDelay=null);e=!1;b&&this.dynamicTarget&&(e=this.changeDynamicTarget(b));
this.visible&&(e?(this.reposition(b),k="reposition"):k=k||"visible");if(!k||e)this.node?e&&this.changeDynamicContent():this.render();k||!1!==this.trigger("before-show",this,b)||(k="beforeshow");var m;b&&(m=this.getEventConfig(b,"show"))&&(m.process?f=m.process(this,b,"show",k):(m.stopPropagation&&b.stopPropagation(),m.preventDefault&&b.preventDefault(),f=m.returnValue));if(k)return f;wa(this.node);this.visible=!0;h.single&&a.hideAll(this);this.toggleTitleAttribute(!1);h.delay&&!d?this.showDelay=V(this.showAfterDelay,
this,[b],h.delay):this.showAfterDelay(b,d);return f},showAfterDelay:function(a,b){var d=this,e=d.cfg;d.showDelay=null;if(d.visible){d.trigger("show-after-delay",d,a);e.hide.remove&&d.appendElem();d.reposition(a);if(e.show.preventScroll){var f=e.show.preventScroll,h;!0===f&&(f="body");f=L(f);var k=-1;for(h=f.length;++k<h;O(f[k],"mousewheel",d.onPreventScrollDelegate)&&O(f[k],"touchmove",d.onPreventScrollDelegate));}d.overlay.show();e.show.animate&&!b?d.animate("show").done(function(){d.showAfterAnimation(a)}):
U(function(){d.showAfterAnimation(a)})}},showAfterAnimation:function(a){var b=this.cfg,d=this.node;this.visible&&(S(d,b.cls.hidden),N(d,b.cls.visible),b.render.keepVisible||(d.style.display=b.show.display||"block"),b.hide.timeout&&(this.hideTimeout=V(this.hide,this,null,b.hide.timeout)),b.show.focus&&V(this.setFocus,this,null,20),this.trigger("show",this,a))},hide:function(a,b,d){var e=null,f=null,h=this.cfg;this.hideTimeout=null;!this.visible&&this.hideDelay&&b&&(window.clearTimeout(this.hideDelay),
this.hideDelay=null,this.visible=!0);this.node&&this.visible&&this.isEnabled()||(f=this.node?this.visible?"disabled":"hidden":"noelem");this.showDelay&&!f&&(h.hide.cancelShowDelay||d?(window.clearTimeout(this.showDelay),this.showDelay=null,this.visible=!1,f="cancel"):f="delay");this.frozen&&!f&&(f="frozen");f||!1!==this.trigger("before-hide",this,a)||(f="beforehide");var k;a&&a.stopPropagation&&(k=this.getEventConfig(a,"hide"))&&(k.process?e=k.process(this,a,"hide",f):(k.stopPropagation&&a.stopPropagation(),
k.preventDefault&&a.preventDefault(),e=k.returnValue));if(f)return e;wa(this.node);this.visible=!1;this.toggleTitleAttribute(!0);this.dynamicTarget&&this.resetDynamicTarget();h.hide.delay&&!b?this.hideDelay=V(this.hideAfterDelay,this,[a],h.hide.delay):this.hideAfterDelay(a,b);return e},hideAfterDelay:function(a,b){var d=this,e=d.cfg;d.hideDelay=null;if(!d.visible){d.trigger("hide-after-delay",d,a);if(e.show.preventScroll){var f=e.show.preventScroll,h;!0===f&&(f="body");f=L(f);var k=-1;for(h=f.length;++k<
h;ca(f[k],"mousewheel",d.onPreventScrollDelegate)&&ca(f[k],"touchmove",d.onPreventScrollDelegate));}d.overlay.hide();e.hide.animate&&!b?d.animate("hide").done(function(){d.hideAfterAnimation(a)}):U(function(){d.hideAfterAnimation(a)})}},hideAfterAnimation:function(a){var b=this,d=b.cfg,e=b.node;b.visible||(S(e,d.cls.visible),N(e,d.cls.hidden),d.render.keepVisible||(e.style.display="none"),b.trigger("hide",b,a),a=d.render.lifetime,null!==a&&(0===a?b.destroyElem():b.destroyDelay=V(b.destroyElem,b,null,
a)),e&&d.hide.destroy?U(function(){P(e,d.instanceName,null);b.$destroy()}):e&&d.hide.remove&&U(function(){b.removeElem()}))},render:function(){var a=this.cfg;if(!this.node){var b=a.render,d=a.cls;if(b.fn){var e=b.fn.call(this.$$callbackContext,this);b[w(e)?"tpl":"el"]=e}b.el?w(b.el)?(e=L(b.el).shift(),b.keepInDOM=!0):e=b.el:(e=window.document.createElement("div"),e.innerHTML=b.tpl,e=e.firstChild);e||(e=window.document.createElement("div"));this.node=e;b.id&&M(e,"id",b.id);a.render.keepVisible||(e.style.display=
"none");N(e,d.dialog);N(e,d.hidden);b.style&&qa(e,b.style);this.overlay.render();a.hide.remove?e.parentNode&&e.parentNode.removeChild(e):this.appendElem();b.zIndex&&qa(e,{zIndex:b.zIndex});b=a.content;if(!1!==b.value)if(b.value)this.setContent(b.value);else if(b.fn)this.setContent(b.fn.call(this.$$callbackContext,this));else this[a.ajax.url?"loadContent":"readContent"]();this.pointer.render();this.pointer.append();if(a.buttons)for(var f in a.buttons)if(b=L(a.buttons[f],e).shift())P(b,"metaphorjsTooltip-button-id",
f),O(b,"click",this.onButtonClickDelegate),O(b,"keyup",this.onButtonKeyupDelegate);this.bindSelfOnRender&&(this.setHandlers("bind","_self"),this.bindSelfOnRender=!1);this.rendered=!0;this.trigger("render",this)}},setPositionType:function(a){var b=this.getPositionClass(a);this.cfg.position.type=a;this.positionClass===b&&this.position?this.position.type=a:(this.position&&(this.position.$destroy(),this.position=null),b&&(this.position=C.factory(b,this)));this.isVisible()&&this.reposition()},getPosition:function(a){var b=
this.cfg.position;if(!this.position){!this.positionGetType&&"custom"!==b.type&&B(b.get)&&"m"!==b.type&&(b.type="custom");a=this.positionGetType?this.positionGetType.call(this.$$callbackContext,this,a):b.type;var d=this.getPositionClass(a);b.type=a;if(!1===d)return;this.positionClass!==d?this.position=C.factory(d,this):this.position.type=a}return this.position},getPositionClass:function(a){return a?B(a)||"custom"===a?"MetaphorJs.dialog.position.Custom":(a=a.substr(0,1))?"w"===a?"MetaphorJs.dialog.position.Window":
"m"===a?"MetaphorJs.dialog.position.Mouse":"MetaphorJs.dialog.position.Target":!1:!1},reposition:function(a){this.repositioning||(this.repositioning=!0,a&&(a=Z(a)),this.getPosition(a),this.trigger("before-reposition",this,a),this.getPosition(a),this.trigger("reposition",this,a),this.repositioning=!1)},getTarget:function(){return this.dynamicTarget?this.dynamicTargetEl:this.target},setTarget:function(a){if(a){var b=!1,d=this.target;this.target?(this.setHandlers("unbind","_target"),b=!0):this.dynamicTarget&&
(b=!0);var e=w(a);e&&"#"!==a.substr(0,1)?(this.dynamicTarget=!0,this.target=null):(e&&(a=L(a).shift()),this.dynamicTarget=!1,this.target=a);b&&(this.setHandlers("bind","_target"),this.trigger("target-change",this,a,d))}},resetDynamicTarget:function(){var a=this.dynamicTargetEl;a&&(this.setHandlers("unbind","_target"),this.trigger("target-change",this,null,a))},isDynamicTargetChanged:function(a){var b=this.cfg.target;a=a.target;for(var d=this.dynamicTargetEl;a&&!pb(a,b);)a=a.parentNode;return a?!d||
d!==a:!1},changeDynamicTarget:function(a){var b=this.cfg.target;a=a.target;for(var d=this.dynamicTargetEl;a&&!pb(a,b);)a=a.parentNode;if(!a||d&&d===a)return!1;d&&this.setHandlers("unbind","_target");this.dynamicTargetEl=a;this.setHandlers("bind","_target");this.trigger("target-change",this,a,d);return!0},getContentElem:function(){var a=this.node;return a?this.cfg.selector.content?L(this.cfg.selector.content,a).shift()||a:a:null},setContent:function(a,b){b=b||"";var d=this.node,e=this.cfg,f=this.pointer;
if(!d)return e.content.value=a,this;e.content.prepare&&(a=e.content.prepare.call(this.$$callbackContext,this,b,a));var h=this.getContentElem(),k=this.rendered&&!e.selector.content&&f;f=k&&f.getElem();if(k&&f)try{d.removeChild(f)}catch(u){T(u)}if(w(a))h.innerHTML=a;else for(var m in a){var n=e.selector[m];n&&(n=L(n,h).shift())&&(n.innerHTML=a[m])}if(k&&f)try{d.appendChild(f)}catch(u){T(u)}d=L("img",h);this.images=d.length;m=-1;for(e=d.length;++m<e;O(d[m],"load",this.onImageLoadDelegate));this.trigger("content-change",
this,a,b);this.onContentChange()},readContent:function(){var a=this.cfg,b=this.getTarget(),d;b&&(d=a.content.attr?z(b,a.content.attr):z(b,"tooltip")||z(b,"title")||z(b,"alt"));d&&this.setContent(d,"attribute")},loadContent:function(a){var b=this.cfg;N(this.node,b.cls.loading);a=q({},b.ajax,a,!0,!0);this.trigger("before-ajax",this,a);return Ha(a).done(this.onAjaxLoad,this)},onAjaxLoad:function(a){S(this.node,this.cfg.cls.loading);this.setContent(a,"ajax")},onImageLoad:function(){this.images--;this.onContentChange()},
onContentChange:function(){this.visible&&this.reposition()},changeDynamicContent:function(){var a=this.cfg;a.content.fn?this.setContent(a.content.fn.call(this.$$callbackContext,this)):a.content.attr&&this.readContent()},toggleTitleAttribute:function(a){var b=this.getTarget(),d;b&&(!1===a?(P(b,"tmp-title",z(b,"title")),ka(b,"title")):(d=P(b,"tmp-title"))&&M(b,"title",d))},getDialogSize:function(){this.rendered||this.render();var a=this.cfg,b=this.node,d=a.cls.hidden?Va(b,a.cls.hidden):!pc(b),e=b.style.left;
d&&(qa(b,{left:"-1000px"}),b.style.display=a.show.display);a={width:Za(b),height:$a(b)};d&&(qa(b,{left:e}),b.style.display="none");return a},getTargetSize:function(){var a=this.getTarget();return a?{width:Za(a),height:$a(a)}:null},setFocus:function(){var a=this.cfg,b=a.show.focus,d=this.node,e;if(!0===b)if(b=L("input",d).concat(L("textarea",d)),0<b.length)b[0].focus();else{if(a.buttons)for(e in a.buttons){(a=L(a.buttons[e],d).shift())&&a.focus();break}}else(a=L(b,d).shift())&&a.focus()},getScrollEl:function(a){return!0===
a||!1===a?window:"string"===typeof a?L(a).shift():a},animate:function(a,b){var d=this.cfg,e=this.node;var f=d[a].animate;B(f)&&(f=f(this,b));var h=f.skipDisplayChange||!1;sa(f)?f=a:w(f)&&(f=[f]);return fa(e,f,function(){if("show"===a&&!h)return new H(function(a,b){U(function(){e.style.display=d.show.display||"block";a()})})},!1)},removeElem:function(){var a=this,b=a.node;a.overlay.remove();b&&b.parentNode&&U(function(){a.visible||b.parentNode.removeChild(b)})},appendElem:function(){var a=this.cfg,
b=window.document.body;b=a.render.appendTo||b;this.overlay.append();this.node&&!1!==a.render.appendTo&&b.appendChild(this.node)},destroyElem:function(){var a=this.node;this.setHandlers("unbind","_self");this.bindSelfOnRender=!0;this.pointer.remove();this.overlay.remove();a&&(this.cfg.render.keepInDOM||a.parentNode&&a.parentNode.removeChild(a),this.node=null);this.trigger("lifetime",this)},onDestroy:function(){this.setHandlers("unbind");this.trigger("destroy",this);this.destroyElem();this.overlay&&
this.overlay.$destroy();this.pointer&&this.pointer.$destroy();this.position&&this.position.$destroy()}},{defaults:null});return k}(),wc=n.dialog.Component=oc.$extend({dialog:null,dialogPreset:null,dialogCfg:null,dialogNode:null,hidden:!0,target:null,isTooltip:!1,$init:function(a){this.isTooltip&&(this.target=a.node,a.node=null);this.$super(a)},initComponent:function(){this.$super();this._createDialog()},_getDialogCfg:function(){return q({},this.dialogCfg,{preset:this.dialogPreset,render:{el:this.dialogNode||
this.node,keepInDOM:!0}},!0,!0)},_createDialog:function(){this.dialog=new vc(this._getDialogCfg());this.dialog.on("show",this.onDialogShow,this);this.dialog.on("hide",this.onDialogHide,this);this.dialog.on("before-show",this.onBeforeDialogShow,this);this.dialog.on("before-hide",this.onBeforeDialogHide,this);this.dialog.on("destroy",this.onDialogDestroy,this)},getDialog:function(){return this.dialog},onRenderingFinished:function(){this.rendered=!0;this.afterRender();this.trigger("after-render",this)},
show:function(a){!a||a instanceof gb||(a=null);this.dialog.show(a)},hide:function(a){!a||a instanceof gb||(a=null);this.dialog.hide(a)},onBeforeDialogShow:function(){this.rendered||this.render();this.template.setAnimation(!0);this.hidden=!1},onDialogShow:function(){this.onShow();this.trigger("show",this)},onBeforeDialogHide:function(){},onDialogHide:function(){this.$destroyed||(this.template.setAnimation(!1),this.hidden=!0,this.onHide(),this.trigger("hide",this))},onDialogDestroy:function(){this.$destroying||
(this.dialog=null,this.$destroy())},onDestroy:function(){this.dialog&&this.dialog.$destroy();this.$super()}});na.register("Test",{});C({$class:"Test.MyApp2",$extends:"MetaphorJs.app.App",initApp:function(a,b,e){var d=this,f=0,k=["(level 3 value: {{.b}})","(level 3 value: {{.c}})"];d.scope.resolved=e;d.scope.level1="[ and here comes level 2: {{.level2}} ]";d.scope.level2=k[f];d.scope.b=1;d.scope.c="variable c";d.scope.changeLevel2=function(a){f=0==f?1:0;d.scope.level2=k[f]};d.scope.increaseB=function(){d.scope.b++};
d.scope.people=0;d.lang.setLocale("ru");d.lang.set("key","text value");d.lang.set("plr",["\u043a\u043e\u0442\u0438\u043a","\u043a\u043e\u0442\u0438\u043a\u0430","\u043a\u043e\u0442\u0438\u043a\u043e\u0432"]);d.lang.set("subkey1","subkey: {{'subkey2' | l}}");d.lang.set("subkey2","text value");d.lang.set("viewing",{0:"Nobody is viewing",1:"One person is viewing",2:"Two people are viewing",other:"{{.people}} people are viewing",negative:""})}},{inject:["$node","$scope","someValue"],resolve:{someValue:function(){var a=
new H;setTimeout(function(){a.resolve((new Date).getTime())},100);return a}}});C({$class:"Test.MyView",$extends:"MetaphorJs.app.Router",route:[{template:"test-template","default":!0},{regexp:/^\/1$/,cmp:"Test.MyComponent"},{regexp:/^\/2\/(\d+)$/,params:["param"],cmp:"Test.MyComponent2"},{regexp:/^\/2$/,cmp:"Test.MyComponent2"},{regexp:/^\/3$/,template:"a+b"}]});C({$class:"Test.MyRecord",$extends:"MetaphorJs.model.Record"});C({$class:"Test.MyComponent",$extends:"MetaphorJs.app.Component",initComponent:function(){this.scope.title=
"My Component"+(new Date).getTime();var a=new oa({type:"Test.MyRecord",id:"id",root:"record",total:"total",store:{load:"data.json"}});this.scope.store=new Ib({model:a});this.scope.deferred=this.deferred},afterRender:function(){this.para&&window.console&&window.console.log&&console.log("got child property 'para': ",this.para)},reverse:function(){this.scope.title=this.scope.title.split("").reverse().join("")},createNew:function(){var a=document.getElementById("newComponent");xa("Test.DynamicComponent",
{},this.scope,a)},createRender:function(){var a=document.getElementById("renderToComponent");xa("Test.DynamicComponent",{renderTo:a},this.scope)},createDialog:function(){(new wc({dialogCfg:{cls:{dialog:"dialog"},position:"wc",show:{animate:!0},hide:{destroy:!0}},config:{as:"dlg"},scope:this.scope,template:'<p>This is a dialog. <a href="#" (click)="this.dlg.hide()">close</a></p>'})).show()},loadStore:function(){this.scope.store.load().done(function(){this.scope.$check()},this).fail(function(a){console.log("failed",
a)})}},{template:"cmp1-template",resolve:{deferred:["$node","$scope","test",function(a,b,e){return new H(function(a,b){setTimeout(function(){a((new Date).getTime())},1E3)})}]}});C({$class:"Test.MyComponent2",$extends:"MetaphorJs.app.Component",template:"cmp1-template",initComponent:function(a,b){a.param&&alert("received param: "+a.param);this.scope.title="My Component2 "+(new Date).getTime()}});C({$class:"Test.TplComponent",$extends:"MetaphorJs.app.Component",initComponent:function(){this.scope.title=
"Tpl Component";this.scope.tpl="a+b";this.scope.$app.onAvailable("myComponent1").done(function(a){window.console&&window.console.log&&console.log("on available myComponent1")})}});C({$class:"Test.StringTemplate",$extends:"MetaphorJs.app.Component"},{template:"<p>This template is inlined in components definition ({{this.$root.a}})</p>"});C({$class:"Test.DynamicComponent",$extends:"MetaphorJs.app.Component"},{template:"<p>This component was created dynamically</p><div {transclude}></div>"});C({$class:"Test.ChangeTemplate",
$extends:"MetaphorJs.app.Component",template:"this.tpl",initComponent:function(){var a=this.scope;a.tpl1="<p>Template 1</p><div {transclude}></div>";a.tpl2="<p>Template 2</p><div {transclude}></div>";a.tpl=a.tpl1}});C({$class:"Test.ViewComponent1",$extends:"MetaphorJs.app.Component",template:"<p>View template 1</p><div {transclude}></div>"});C({$class:"Test.ViewComponent2",$extends:"MetaphorJs.app.Component",template:"<p>View template 2</p><div {transclude}></div>"});C({$class:"Test.TagComponent",
$extends:"MetaphorJs.app.Component",$alias:"MetaphorJs.directive.component.tagc",template:"tagc"});Kb(function(){var a={linkified:"Linkified text aaa http://www.kuindji.com bbb",newItem:"",date:new Date,num:1E4,list:[{bool:!0,txt:"item 1"},{bool:!1,txt:"item 2"},{bool:!1,txt:"item 3"}]},b=(new Date).getTime(),e=document.getElementById("render");e&&(Jb(e,null,a,!1).done(function(a){a.value("test","123");a.run();window.mainApp=a;window.MetaphorJs=n}),a=(new Date).getTime(),window.console&&console.log("render time: ",
a-b))})})();
