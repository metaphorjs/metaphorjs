(function(__wpcc){'use strict';var k=k||{};k.scope={};k.arrayIteratorImpl=function(a){var c=0;return function(){return c<a.length?{done:!1,value:a[c++]}:{done:!0}}};k.arrayIterator=function(a){return{next:k.arrayIteratorImpl(a)}};k.makeIterator=function(a){var c="undefined"!=typeof Symbol&&Symbol.iterator&&a[Symbol.iterator];return c?c.call(a):k.arrayIterator(a)};
k.getGlobal=function(a){a=["object"==typeof globalThis&&globalThis,a,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var c=0;c<a.length;++c){var b=a[c];if(b&&b.Math==Math)return b}throw Error("Cannot find global object");};k.global=k.getGlobal(this);k.ASSUME_ES5=!1;k.ASSUME_NO_NATIVE_MAP=!1;k.ASSUME_NO_NATIVE_SET=!1;k.SIMPLE_FROUND_POLYFILL=!1;k.ISOLATE_POLYFILLS=!1;
k.defineProperty=k.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,c,b){if(a==Array.prototype||a==Object.prototype)return a;a[c]=b.value;return a};k.IS_SYMBOL_NATIVE="function"===typeof Symbol&&"symbol"===typeof Symbol("x");k.TRUST_ES6_POLYFILLS=!k.ISOLATE_POLYFILLS||k.IS_SYMBOL_NATIVE;k.polyfills={};k.propertyToPolyfillSymbol={};k.POLYFILL_PREFIX="$jscp$";
k.polyfill=function(a,c,b,d){c&&(k.ISOLATE_POLYFILLS?k.polyfillIsolated(a,c,b,d):k.polyfillUnisolated(a,c,b,d))};k.polyfillUnisolated=function(a,c){var b=k.global;a=a.split(".");for(var d=0;d<a.length-1;d++){var e=a[d];if(!(e in b))return;b=b[e]}a=a[a.length-1];d=b[a];c=c(d);c!=d&&null!=c&&k.defineProperty(b,a,{configurable:!0,writable:!0,value:c})};
k.polyfillIsolated=function(a,c,b){var d=a.split(".");a=1===d.length;var e=d[0];e=!a&&e in k.polyfills?k.polyfills:k.global;for(var g=0;g<d.length-1;g++){var f=d[g];if(!(f in e))return;e=e[f]}d=d[d.length-1];b=k.IS_SYMBOL_NATIVE&&"es6"===b?e[d]:null;c=c(b);null!=c&&(a?k.defineProperty(k.polyfills,d,{configurable:!0,writable:!0,value:c}):c!==b&&(k.propertyToPolyfillSymbol[d]=k.IS_SYMBOL_NATIVE?k.global.Symbol(d):k.POLYFILL_PREFIX+d,d=k.propertyToPolyfillSymbol[d],k.defineProperty(e,d,{configurable:!0,
writable:!0,value:c})))};k.FORCE_POLYFILL_PROMISE=!1;
k.polyfill("Promise",function(a){function c(f){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var h=this.createResolveAndReject_();try{f(h.resolve,h.reject)}catch(l){h.reject(l)}}function b(){this.batch_=null}function d(f){return f instanceof c?f:new c(function(h){h(f)})}if(a&&!k.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(f){if(null==this.batch_){this.batch_=[];var h=this;this.asyncExecuteFunction(function(){h.executeBatch_()})}this.batch_.push(f)};var e=k.global.setTimeout;
b.prototype.asyncExecuteFunction=function(f){e(f,0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var f=this.batch_;this.batch_=[];for(var h=0;h<f.length;++h){var l=f[h];f[h]=null;try{l()}catch(n){this.asyncThrow_(n)}}}this.batch_=null};b.prototype.asyncThrow_=function(f){this.asyncExecuteFunction(function(){throw f;})};c.prototype.createResolveAndReject_=function(){function f(n){return function(m){l||(l=!0,n.call(h,m))}}var h=this,l=!1;return{resolve:f(this.resolveTo_),
reject:f(this.reject_)}};c.prototype.resolveTo_=function(f){if(f===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(f instanceof c)this.settleSameAsPromise_(f);else{a:switch(typeof f){case "object":var h=null!=f;break a;case "function":h=!0;break a;default:h=!1}h?this.resolveToNonPromiseObj_(f):this.fulfill_(f)}};c.prototype.resolveToNonPromiseObj_=function(f){var h=void 0;try{h=f.then}catch(l){this.reject_(l);return}"function"==typeof h?this.settleSameAsThenable_(h,
f):this.fulfill_(f)};c.prototype.reject_=function(f){this.settle_(2,f)};c.prototype.fulfill_=function(f){this.settle_(1,f)};c.prototype.settle_=function(f,h){if(0!=this.state_)throw Error("Cannot settle("+f+", "+h+"): Promise already settled in state"+this.state_);this.state_=f;this.result_=h;this.executeOnSettledCallbacks_()};c.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var f=0;f<this.onSettledCallbacks_.length;++f)g.asyncExecute(this.onSettledCallbacks_[f]);
this.onSettledCallbacks_=null}};var g=new b;c.prototype.settleSameAsPromise_=function(f){var h=this.createResolveAndReject_();f.callWhenSettled_(h.resolve,h.reject)};c.prototype.settleSameAsThenable_=function(f,h){var l=this.createResolveAndReject_();try{f.call(h,l.resolve,l.reject)}catch(n){l.reject(n)}};c.prototype.then=function(f,h){function l(r,q){return"function"==typeof r?function(t){try{n(r(t))}catch(u){m(u)}}:q}var n,m,p=new c(function(r,q){n=r;m=q});this.callWhenSettled_(l(f,n),l(h,m));return p};
c.prototype.catch=function(f){return this.then(void 0,f)};c.prototype.callWhenSettled_=function(f,h){function l(){switch(n.state_){case 1:f(n.result_);break;case 2:h(n.result_);break;default:throw Error("Unexpected state: "+n.state_);}}var n=this;null==this.onSettledCallbacks_?g.asyncExecute(l):this.onSettledCallbacks_.push(l)};c.resolve=d;c.reject=function(f){return new c(function(h,l){l(f)})};c.race=function(f){return new c(function(h,l){for(var n=k.makeIterator(f),m=n.next();!m.done;m=n.next())d(m.value).callWhenSettled_(h,
l)})};c.all=function(f){var h=k.makeIterator(f),l=h.next();return l.done?d([]):new c(function(n,m){function p(t){return function(u){r[t]=u;q--;0==q&&n(r)}}var r=[],q=0;do r.push(void 0),q++,d(l.value).callWhenSettled_(p(r.length-1),m),l=h.next();while(!l.done)})};return c},"es6","es3");k.initSymbol=function(){};
k.polyfill("Symbol",function(a){function c(e){if(this instanceof c)throw new TypeError("Symbol is not a constructor");return new b("jscomp_symbol_"+(e||"")+"_"+d++,e)}function b(e,g){this.$jscomp$symbol$id_=e;k.defineProperty(this,"description",{configurable:!0,writable:!0,value:g})}if(a)return a;b.prototype.toString=function(){return this.$jscomp$symbol$id_};var d=0;return c},"es6","es3");k.initSymbolIterator=function(){};
k.polyfill("Symbol.iterator",function(a){if(a)return a;a=Symbol("Symbol.iterator");for(var c="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),b=0;b<c.length;b++){var d=k.global[c[b]];"function"===typeof d&&"function"!=typeof d.prototype[a]&&k.defineProperty(d.prototype,a,{configurable:!0,writable:!0,value:function(){return k.iteratorPrototype(k.arrayIteratorImpl(this))}})}return a},"es6","es3");
k.initSymbolAsyncIterator=function(){};k.iteratorPrototype=function(a){a={next:a};a[Symbol.iterator]=function(){return this};return a};k.iteratorFromArray=function(a,c){a instanceof String&&(a+="");var b=0,d={next:function(){if(b<a.length){var e=b++;return{value:c(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};
k.polyfill("Array.prototype.values",function(a){return a?a:function(){return k.iteratorFromArray(this,function(c,b){return b})}},"es8","es3");k.polyfill("Array.prototype.keys",function(a){return a?a:function(){return k.iteratorFromArray(this,function(c){return c})}},"es6","es3");k.findInternal=function(a,c,b){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var g=a[e];if(c.call(b,g,e,a))return{i:e,v:g}}return{i:-1,v:void 0}};
k.polyfill("Array.prototype.find",function(a){return a?a:function(c,b){return k.findInternal(this,c,b).v}},"es6","es3");var aa;"undefined"===typeof aa&&(aa=function(){});aa.p="";}).call(this || window, (window.__wpcc = window.__wpcc || {}));

(function(__wpcc){'use strict';var B=function(a){if(a&&void 0!=!a.length&&a!==""+a){for(var c=[],b=-1,d=a.length>>>0;++b!==d;c[b]=a[b]);return c}return a?[a]:[]},ea=function(a){return"object"==typeof a&&3===ca(a)&&!a.nodeType&&a.constructor===Object},fa=function(a){return!0===a||!1===a},D=function(){var a=!1,c=!1,b=B(arguments),d=b.shift(),e,g,f;fa(b[b.length-1])&&(a=b.pop());fa(b[b.length-1])&&(c=a,a=b.pop());for(;b.length;)if(e=b.shift())for(g in e)if(e.hasOwnProperty(g)&&void 0!==(f=e[g]))if(c)if(d[g]&&ea(d[g])&&
ea(f))D(d[g],f,a,c);else{if(!0===a||void 0==d[g])ea(f)?(d[g]={},D(d[g],f,a,!0)):d[g]=f}else if(!0===a||void 0==d[g])d[g]=f;return d},E=function(){for(var a=ha.length,c;a;){a--;c=ha[a].charCodeAt(0);if(57==c)return ha[a]="A",ha.join("");if(90==c)ha[a]="0";else return ha[a]=String.fromCharCode(c+1),ha.join("")}ha.unshift("0");return ha.join("")},F=function(a,c,b,d){return setTimeout(function(){a.apply(c,b||[])},d||0)},G=function(a){return"function"==typeof a},H=function(a){return"object"===typeof a&&
5===ca(a)},ia=function(a){return"undefined"===typeof window?!1:a===window||a&&a.document&&a.location&&a.alert&&a.setInterval},ja=function(a,c){if(a===c)return!0;if(null===a||null===c)return!1;if(a!==a&&c!==c)return!0;var b=typeof a,d;if(b===typeof c&&"object"===b)if(H(a)){if(!H(c))return!1;if((b=a.length)===c.length){for(d=0;d<b;d++)if(!ja(a[d],c[d]))return!1;return!0}}else{if(10===ca(a))return 10===ca(c)&&a.getTime()===c.getTime();if(9===ca(a)&&9===ca(c))return a.toString()===c.toString();if(ia(a)||
ia(c)||H(c))return!1;b={};for(d in a)if("$"!==d.charAt(0)&&!G(a[d])){if(!ja(a[d],c[d]))return!1;b[d]=!0}for(d in c)if(!b.hasOwnProperty(d)&&"$"!==d.charAt(0)&&void 0!==c[d]&&!G(c[d]))return!1;return!0}return!1},I=function(a){return"string"===typeof a||a===""+a},M=function(){},ka=function(a,c,b){var d=a.length,e=c.length,g=0,f=0,h=!1,l=!1,n=[];if(!e)return[a];for(;g<d;g++){var m=a.charAt(g);if("\\"==m)g++;else if('"'==m)h=!h;else if("'"==m)l=!l;else if(!h&&!l&&(1==e&&m==c||1<e&&a.substring(g,g+e)==
c)){if(a.substr(g-1,e)!=c&&a.substr(g+1,e)!=c||b)n.push(a.substring(f,g).replace("\\"+c,c)),f=g+e;g+=e-1}}n.push(a.substring(f).replace("\\"+c,c));return n},Q=function(a){if(!a)return!1;var c;if("object"!=(c=typeof a)&&"function"!=c)return!1;a=a.then;return G(a)?a:!1},la=function(){throw Error("setTimeout has not been defined");},ma=function(){throw Error("clearTimeout has not been defined");},oa=function(a){if(na===setTimeout)return setTimeout(a,0);if((na===la||!na)&&setTimeout)return na=setTimeout,
setTimeout(a,0);try{return na(a,0)}catch(c){try{return na.call(null,a,0)}catch(b){return na.call(this,a,0)}}},qa=function(a){if(pa===clearTimeout)return clearTimeout(a);if((pa===ma||!pa)&&clearTimeout)return pa=clearTimeout,clearTimeout(a);try{return pa(a)}catch(c){try{return pa.call(null,a)}catch(b){return pa.call(this,a)}}},wa=function(){ra&&sa&&(ra=!1,sa.length?ta=sa.concat(ta):ua=-1,ta.length&&va())},va=function(){if(!ra){var a=oa(wa);ra=!0;for(var c=ta.length;c;){sa=ta;for(ta=[];++ua<c;)sa&&
sa[ua].run();ua=-1;c=ta.length}sa=null;ra=!1;qa(a)}},xa=function(a,c){this.fun=a;this.array=c},ya=function(){},za=function(a){return!a||"string"===typeof a&&(a=a.toLowerCase(),"false"===a||"no"===a||"0"===a)?!1:!0},Aa=function(a){a=ca(a);return 3>a&&-1<a},Ba=function(){return!1},Ca=function(){return!0},Da=function(a){if(null===a||"object"!=typeof a)return!1;a=ca(a);return 2<a||-1==a},Ea=function(a,c){function b(){}b.prototype=a.prototype;var d=new b;a=a.apply(d,c);return Da(a)||!1===a?a:d},Fa=function(a,
c,b,d,e,g){e=e||"before";return function(){if("instead"==e)return c.apply(b||d,arguments);if("before"==e){var f=c.apply(b||d,arguments);var h=!1!==f?a.apply(d||b,arguments):null}else h=a.apply(d||b,arguments),f=c.apply(b||d,arguments);return g?f:h}},Ga=function(a){return a.replace(/-./g,function(c){return c.charAt(1).toUpperCase()})},Ha=function(a){var c=R.lib.Cache.global(),b="regex_"+a;return c.get(b)||c.add(b,new RegExp(a))},Ia=function(a,c){if(!a||!I(a))return null;try{var b=new DOMParser;var d=
b.parseFromString(a,c||"text/xml")}catch(e){S(e),d=void 0}if(!d||d.getElementsByTagName("parsererror").length)throw Error("Invalid XML: "+a);return d},Ja=function(a,c){var b=a.length,d=c.length,e=Array(b+1),g=Array(b+1),f,h,l=0;if(b==d&&0===b)return{changes:0,distance:0,prescription:[]};for(f=0;f<=b;f++)e[f]=Array(d+1),g[f]=Array(d+1),e[f][0]=f,g[f][0]="D";for(f=0;f<=d;f++)e[0][f]=f,g[0][f]="I";for(f=1;f<=b;f++)for(h=1;h<=d;h++){var n=ja(a[f-1],c[h-1])?0:1;e[f][h-1]<e[f-1][h]&&e[f][h-1]<e[f-1][h-
1]+n?(e[f][h]=e[f][h-1]+1,g[f][h]="I"):e[f-1][h]<e[f-1][h-1]+n?(e[f][h]=e[f-1][h]+1,g[f][h]="D"):(e[f][h]=e[f-1][h-1]+n,g[f][h]=1===n?"R":"-")}c=[];f=b;h=d;do a=g[f][h],c.push(a),"-"!==a&&l++,"R"===a||"-"===a?(f--,h--):"D"===a?f--:h--;while(0!==f||0!==h);return{changes:l/c.length,distance:e[b][d],prescription:c.reverse()}},Ka=function(a,c,b,d){var e=[],g,f,h={},l;var n=0;for(g=a.length;n<g;n++)(f=d(a[n],n))&&(h[f]=n);var m=0;var p={};n=0;for(g=b.length;n<g;n++)a=b[n],"D"!==a&&(f=d(c[m],m),void 0!==
f&&!0!==p[f]&&void 0!==(l=h[f])?(e.push(l),p[f]=!0):e.push(a),m++);return e},La=function(a,c,b,d){d&&d.flowControl("stop",!0)},Na=function(a,c){var b=/^([+-]?(?:d*.|)d+(?:[eE][+-]?d+|))(?!px)[a-z%]+$/i,d=["Top","Right","Bottom","Left"],e=a?"inner"===a?"padding":"":"content";return function(g,f){if(g===window)return g.document.documentElement["client"+c];if(g.nodeType===window.document.DOCUMENT_NODE)return f=g.documentElement,Math.max(g.body["scroll"+c],f["scroll"+c],g.body["offset"+c],f["offset"+
c],f["client"+c]);a:{var h=c.toLowerCase(),l=e||(!0===f?"margin":"border");f=R.dom.getStyle(g);var n=!0,m="width"===h?g.offsetWidth:g.offsetHeight,p="border-box"===f.boxSizing;if(0>=m||null==m){m=g.style[h];if(b.test(m)){f=m;break a}n=p&&(Ma()||m===g.style[h]);m=parseFloat(m)||0}g=m;l=l||(p?"border":"content");h=l===(n?"border":"content")?4:"width"===h?1:0;for(p=0;4>h;h+=2)"margin"===l&&(p+=parseFloat(f[l+d[h]])),n?("content"===l&&(p-=parseFloat(f["padding"+d[h]])),"margin"!==l&&(p-=parseFloat(f["border"+
d[h]+"Width"]))):(p+=parseFloat(f["padding"+d[h]]),"padding"!==l&&(p+=parseFloat(f["border"+d[h]+"Width"])));f=g+p}return f}},Oa=function(a){function c(h,l){return 0>h&&!1===l?0:h}var b=a?"pageYOffset":"pageXOffset",d=a?"scrollTop":"scrollLeft";a=window.document;var e=a.body,g=a.documentElement;var f=void 0!==window[b]?function(){return window[b]}:g.clientHeight?function(){return g[d]}:function(){return e[d]};return function(h,l){return h&&h!==window?h&&h.nodeType==window.document.ELEMENT_NODE&&h!==
e&&h!==g?c(h[d],l):c(f(),l):c(f(),l)}},Pa=function(a,c,b){b||(b="asc");a=a.slice();if(ea(c)&&c.fn){var d=c.fn;var e=c.context}a.sort(function(g,f){if(d)return d.call(e,g,f);var h=typeof g,l=g,n=f;if(h!=typeof f)return 0;"object"===h&&(G(c)?(l=c(g),n=c(f)):(l=g[c],n=f[c]));if("number"===typeof l)return l-n;l=(""+l).toLowerCase();n=(""+n).toLowerCase();return l===n?0:l>n?1:-1});return"desc"==b?a.reverse():a},Qa=function(a){return a.substr(0,1).toUpperCase()+a.substr(1)},R={plugin:{},mixin:{},lib:{},
dom:{},regexp:{},browser:{},app:{},prebuilt:null};R.prebuilt={config:{"~1N5~":"~1N6~","~1N9~":"~1NA~","~1NK~":"~1NL~","~1NP~":"~1NQ~","~1NZ~":"~1O0~","~1O5~":"~1O0~","~1OA~":"~1OB~","~1OG~":"~1OH~","~1OQ~":"~1O0~","~1OZ~":"~1OH~","~1PC~":{getterFn:"~1NL~",pipes:[{origArgs:[],params:[],expressions:[],opt:{neg:!1,dblneg:!1,undeterm:!1,name:"uppercase"}}],descr:"o"},"~1PO~":{getterFn:"~1PP~",pipes:[{origArgs:[],params:[],expressions:[],opt:{neg:!1,dblneg:!1,undeterm:!1,name:"linkify"}}],descr:"o"},"~1Q2~":{getterFn:"~1O0~",setterFn:"~1Q3~"},"~1Q8~":{getterFn:"~1OB~",
setterFn:"~1Q9~"},"~1QE~":{getterFn:"~1OH~",setterFn:"~1QF~"},"~1QN~":{getterFn:"~1O0~",setterFn:"~1Q3~"},"~1QY~":{getterFn:"~1NL~",setterFn:"~1QZ~"},"~1R4~":{getterFn:"~1NL~",setterFn:"~1QZ~"},"~1RA~":"~1OH~","~1RF~":"~1OH~","~1RK~":"~1RL~","~1RP~":"~1OB~","~1RQ~":"~1RR~","~1RW~":"~1OB~","~1RZ~":"~1OB~","~1S2~":"~1OB~","~1SL~":"~1SM~","~1SQ~":"~1SR~","~1SU~":"~1SV~","~1T7~":{fn:"~1T8~"},"~1TD~":{getterFn:"~1TE~",setterFn:"~1TF~"},"~1TO~":{getterFn:"~1TP~",setterFn:"~1TQ~",inputPipes:[{origArgs:["this.sep"],
params:["~1TE~"],expressions:["this.sep"],opt:{neg:!1,dblneg:!1,undeterm:!1,name:"split"}}],descr:"i"},"~1TU~":{getterFn:"~1TP~",inflate:{itemName:"item"}},"~1TW~":"~1TX~","~1U4~":"~1O0~","~1U6~":{getterFn:"~1U7~",inflate:{item:"~1U8~"}},"~1UE~":{getterFn:"~1TP~",inflate:{item:"~1UF~"}},"~1UN~":{fn:"~1UO~"},"~1UQ~":{fn:"~1UR~"},"~1UU~":{fn:"~1UV~"},"~1V0~":"~1V1~","~1V9~":{fn:"~1VA~"},"~1VD~":{fn:"~1VE~"},"~1VS~":"~1VT~","~1VX~":{fn:"~1VY~",descr:"p"},"~1W1~":{fn:"~1W2~",descr:"p"},"~1W6~":{fn:"~1W7~"},
"~1WB~":{getterFn:"~1WC~",setterFn:"~1WD~"},"~1WF~":{fn:"~1WG~"},"~1WJ~":"~1WK~","~1WM~":{fn:"~1WN~"},"~1WQ~":"~1OB~","~1WT~":{getterFn:"~1WU~",pipes:[{origArgs:["this.listFilter"],params:["~1WV~"],expressions:["this.listFilter"],opt:{neg:!1,dblneg:!1,undeterm:!1,name:"filter"}},{origArgs:["'txt'","this.sortBy"],params:["~1WW~","~1WX~"],expressions:["this.sortBy"],opt:{neg:!1,dblneg:!1,undeterm:!1,name:"sortBy"}}],inflate:{itemName:"item"},descr:"o"},"~1X0~":"~1X1~","~1X4~":{getterFn:"~1X5~",setterFn:"~1X6~"},
"~1X9~":{fn:"~1XA~",descr:"p"},"~1XD~":{getterFn:"~1WV~",setterFn:"~1XE~"},"~1XH~":{fn:"~1XI~"},"~1XJ~":{fn:"~1XK~"},"~1XN~":{fn:"~1XO~"},"~1XP~":{fn:"~1XK~"},"~1XW~":"~1X1~","~1XZ~":{getterFn:"~1X5~",setterFn:"~1X6~"},"~1Y2~":{fn:"~1XA~",descr:"p"},"~1Y7~":{fn:"~1Y8~"},"~1YC~":{fn:"~1YD~"},"~1YG~":{fn:"~1YH~"},"~1YK~":{fn:"~1YL~"},"~1YO~":{fn:"~1YP~"},"~1YU~":{fn:"~1YV~"},"~1YY~":{fn:"~1YZ~"},"~1Z4~":{getterFn:"~1Z5~",setterFn:"~1Z6~"},"~1ZE~":{getterFn:"~1ZF~",inflate:{item:"~1ZG~"}},"~1ZK~":{getterFn:"~1ZL~",
setterFn:"~1ZM~",descr:"p"},"~1ZN~":"~1Z5~","~1ZS~":{getterFn:"~1ZF~",inflate:{itemName:"item"}},"~1ZZ~":"~1OH~","~200~":"~1OH~","~201~":"~1NL~","~202~":"~1OH~","~203~":"~1OH~","~204~":"~1NL~","~205~":"~1NQ~","~206~":{getterFn:"~1NL~",pipes:[{origArgs:[],params:[],expressions:[],opt:{neg:!1,dblneg:!1,undeterm:!1,name:"uppercase"}}]},"~207~":{getterFn:"~1NL~",pipes:[{origArgs:[],params:[],expressions:[],opt:{neg:!1,dblneg:!1,undeterm:!1,name:"lowercase"}}]},"~208~":{getterFn:"~1NL~",pipes:[{origArgs:["this.a"],
params:["~1O0~"],expressions:["this.a"],opt:{neg:!1,dblneg:!1,undeterm:!1,name:"limitTo"}}]},"~209~":"~20A~","~20B~":"~20C~","~20D~":"~20E~","~20F~":"~20G~","~20H~":"~20I~","~20J~":"~20K~","~20L~":"~20M~","~20N~":"~20O~","~20P~":"~20Q~","~20R~":"~20S~","~20T~":"~20I~","~20U~":"~20K~","~20V~":"~20M~","~20W~":"~20O~","~20X~":"~20Q~","~20Y~":"~20S~","~20Z~":"~20G~","~210~":"~211~","~212~":"~213~","~21C~":{fn:"~21D~"},"~21H~":"~21I~","~21P~":{getterFn:"~21Q~",pipes:[{origArgs:[],params:[],expressions:[],
opt:{neg:!1,dblneg:!1,undeterm:!1,name:"l"}}],descr:"o"},"~21W~":{fn:"~21X~"},"~223~":{getterFn:"~224~",setterFn:"~225~"},"~228~":{getterFn:"~229~",pipes:[{origArgs:["this.people"],params:["~224~"],expressions:["this.people"],opt:{neg:!1,dblneg:!1,undeterm:!1,name:"p"}}],descr:"o"},"~22B~":"~22C~","~22D~":{getterFn:"~22E~",pipes:[{origArgs:[],params:[],expressions:[],opt:{neg:!1,dblneg:!1,undeterm:!1,name:"l"}}]},"~22F~":"~22G~","~22H~":{getterFn:"~22I~",pipes:[{origArgs:["this.b"],params:["~22G~"],
expressions:["this.b"],opt:{neg:!1,dblneg:!1,undeterm:!1,name:"p"}}]},"~22N~":"~20E~","~22Q~":{fn:"~22R~"},"~22T~":"~22U~","~22V~":"~22W~","~22X~":"~22Y~","~22Z~":"~230~","~231~":"~232~","~234~":"~235~","~236~":{getterFn:"~237~",pipes:[{origArgs:["','"],params:["~238~"],expressions:[],opt:{neg:!1,dblneg:!1,undeterm:!1,name:"join"}}]},"~23B~":{fn:"~23C~"},"~23F~":{getterFn:"~23G~",inflate:{itemName:"item"}},"~23J~":{fn:"~23K~",descr:"p"},"~23N~":"~22Y~","~23P~":{fn:"~23Q~"},"~23S~":{fn:"~23T~"},"~23V~":{fn:"~23W~"},
"~23Y~":{getterFn:"~23Z~",setterFn:"~240~"},"~241~":"~22W~","~244~":"~245~","~247~":"~23Z~","~24A~":{fn:"~24B~"},"~24D~":"~24E~","~24F~":"~24G~","~24I~":"~24J~","~24M~":{fn:"~24B~"},"~24O~":"~24P~","~24R~":"~24S~","~24T~":"~24U~","~24W~":"~24X~","~250~":"~251~","~254~":{fn:"~255~"},"~257~":{fn:"~258~"},"~25A~":"~25B~","~25D~":{getterFn:"~25E~",inflate:{item:"~1U8~"}},"~25H~":"~232~","~25L~":"~25M~","~25O~":{fn:"~25P~"},"~25R~":"~25S~","~25V~":"~25W~","~25Y~":{fn:"~25Z~"},"~261~":"~262~","~265~":{getterFn:"~266~",
inflate:{itemName:"item"}},"~268~":{fn:"~269~",descr:"p"},"~26B~":{getterFn:"~26C~",descr:"p"},"~26F~":"~26G~","~26I~":"~26J~","~26L~":{fn:"~26M~",descr:"p"},"~26O~":"~26C~","~26T~":"~26U~","~26Z~":"~270~"},func:{"~1N6~":function(a){return a.$root.a*a.$root.b},"~1NA~":function(a){return a.$root.a+a.$root.b},"~1NL~":function(a){return a.text},"~1NQ~":function(a){return a.html},"~1O0~":function(a){return a.a},"~1OB~":function(a){return a.bool},"~1OH~":function(a){return a.inline},"~1PP~":function(a){return a.linkified},
"~1Q3~":function(a,c){a.a=c},"~1Q9~":function(a,c){a.bool=c},"~1QF~":function(a,c){a.inline=c},"~1QZ~":function(a,c){a.text=c},"~1RL~":function(a){return{bool:a.bool,inline1:0==a.a}},"~1RR~":function(a){return 0==a.a},"~1SM~":function(a){return a.myForm.$invalid},"~1SR~":function(a){return{error:a.myForm.field1.$invalid}},"~1SV~":function(a){return{error:a.myForm.radio1.$invalid}},"~1T8~":function(a){a.dynamicList=[]},"~1TE~":function(a){return a.sep},"~1TF~":function(a,c){a.sep=c},"~1TP~":function(a){return a.dynamicList},
"~1TQ~":function(a,c){a.dynamicList=c},"~1TX~":function(a){return a.item},"~1U7~":function(a){return a.alist},"~1U8~":function(a){return{name:a.item,value:a.$index}},"~1UF~":function(a){return{name:a.item,value:a.$index,group:a.$index-a.$index%2,disabledGroup:0==a.$index,disabled:4==a.$index}},"~1UO~":function(a){a.tpl="a+b.html"},"~1UR~":function(){console.log("multiple click handlers!")},"~1UV~":function(a){a.tpl="a*b.html"},"~1V1~":function(a){return a.tpl},"~1VA~":function(a){a.tpl=a.tpl1},"~1VE~":function(a){a.tpl=
a.tpl2},"~1VT~":function(a){return a.viewCmp},"~1VY~":function(a){a.$parent.viewCmp="Test.ViewComponent1"},"~1W2~":function(a){a.$parent.viewCmp="Test.ViewComponent2"},"~1W7~":function(a){a.newItem="";a.listFilter="";a.sortBy="asc"},"~1WC~":function(a){return a.newItem},"~1WD~":function(a,c){a.newItem=c},"~1WG~":function(a){a.newItem&&(a.list.push({bool:!1,txt:a.newItem}),a.newItem="")},"~1WK~":function(a){return!a.newItem},"~1WN~":function(a){a.list.push({bool:!1,txt:a.newItem});a.newItem=""},"~1WU~":function(a){return a.list},
"~1WV~":function(a){return a.listFilter},"~1WW~":function(){return"txt"},"~1WX~":function(a){return a.sortBy},"~1X1~":function(a){return{cls3:a.item.bool}},"~1X5~":function(a){return a.item.bool},"~1X6~":function(a,c){a.item.bool=c},"~1XA~":function(a){a.$parent.list.splice(a.$getRawIndex(a.$trackId),1)},"~1XE~":function(a,c){a.listFilter=c},"~1XI~":function(a){a.sortBy="asc"},"~1XK~":function(a){console.log(a.sortBy)},"~1XO~":function(a){a.sortBy="desc"},"~1Y8~":function(a){a.selectBinding="scope"},
"~1YD~":function(a){a.ctrl.reverse()},"~1YH~":function(a){a.ctrl.createNew()},"~1YL~":function(a){a.ctrl.createRender()},"~1YP~":function(a){a.ctrl.createDialog()},"~1YV~":function(a){a.store.load()},"~1YZ~":function(a){a.store.clear()},"~1Z5~":function(a){return a.selectBinding},"~1Z6~":function(a,c){a.selectBinding=c},"~1ZF~":function(a){return a.store},"~1ZG~":function(a){return{name:a.item.data.name,value:a.item.data.id}},"~1ZL~":function(a){return a.$parent.a},"~1ZM~":function(a,c){a.$parent.a=
c},"~20A~":function(a){return a.a+a.b},"~20C~":function(a){return a.bool?"true":"false"},"~20E~":function(a){return a.title},"~20G~":function(a){return a.$root.a},"~20I~":function(a){return a.$index},"~20K~":function(a){return a.item.txt},"~20M~":function(a){return a.$first?"first":""},"~20O~":function(a){return a.$last?"last":""},"~20Q~":function(a){return a.$even?"even":""},"~20S~":function(a){return a.$odd?"odd":""},"~211~":function(a){return a.item.name},"~213~":function(a){return a.deferred},
"~21D~":function(a){a.changeLevel2()},"~21I~":function(a){return a.level1},"~21Q~":function(){return"subkey1"},"~21X~":function(a){a.increaseB()},"~224~":function(a){return a.people},"~225~":function(a,c){a.people=c},"~229~":function(){return"viewing"},"~22C~":function(a){return a.resolved},"~22E~":function(){return"key"},"~22G~":function(a){return a.b},"~22I~":function(){return"plr"},"~22R~":function(a){a.field.onSelfClick(a.$event)},"~22U~":function(a){return a.loading},"~22W~":function(a){return a.field.disabled},
"~22Y~":function(a){return a.field.searchable},"~230~":function(a){return a.field.multiple},"~232~":function(a){return a.field.black},"~235~":function(a){return a.field.hiddenInputName},"~237~":function(a){return a.field.$selection},"~238~":function(){return","},"~23C~":function(a){a.field.onDropdownIconClick(a.$event)},"~23G~":function(a){return a.field.getMultiSelection()},"~23K~":function(a){a.$parent.field.onItemDeleteClick(a.item,a.$event)},"~23Q~":function(a){a.field.onSearchFocus(a.$event)},
"~23T~":function(a){a.field.onSearchBlur(a.$event)},"~23W~":function(a){a.field.onSearchBackspace(a.$event)},"~23Z~":function(a){return a.searchQuery},"~240~":function(a,c){a.searchQuery=c},"~245~":function(a){return a.field.multiple&&a.field.searchable},"~24B~":function(a){a.field.onValueTextClick(a.$event)},"~24E~":function(a){return!a.searchQuery&&!a.field.hasSelection()&&!!a.field.emptyText},"~24G~":function(a){a.emptyShown=a.$1},"~24J~":function(a){return a.field.emptyText},"~24P~":function(a){return a.focused&&
""==a.searchQuery},"~24S~":function(a){return!a.searchQuery&&!a.field.multiple&&a.field.hasSelection()},"~24U~":function(a){a.selectedShown=a.$1},"~24X~":function(a){return a.field.getSelectedName()},"~251~":function(a){return!a.emptyShown&&!a.selectedShown&&!a.field.searchable},"~255~":function(a){a.field.onHiddenSelectClick(a.$event)},"~258~":function(a){a.field.onHiddenSelectChange(a.$event)},"~25B~":function(a){return a.field.useHiddenSelect},"~25E~":function(a){return a.field._getSelectOptions()},
"~25M~":function(a){return a.field.showNotFound&&a.field.store.isEmpty()},"~25P~":function(a){a.field.onNotFoundClick(null,a.$event)},"~25S~":function(a){return a.field.notFoundText},"~25W~":function(a){return a.field.showEmptyItem&&!a.field.store.isEmpty()},"~25Z~":function(a){a.field.onItemClick(null,a.$event)},"~262~":function(a){return a.field.emptyItemText},"~266~":function(a){return a.field.store},"~269~":function(a){a.$parent.field.onItemClick(a.item,a.$event)},"~26C~":function(a){return a.$parent.field.getItemName(a.item)},
"~26G~":function(){return!1},"~26J~":function(a){return a.pagination.hasPages()},"~26M~":function(a){a.$parent.field.onPaginationClick(a.$event)},"~26U~":function(a){return a.ctrl.config.get("test")},"~270~":function(a){return a.$root.text}},funcDescr:{"~1N6~":"r","~1NA~":"r","~1VY~":"p","~1W2~":"p","~1XA~":"p","~1ZL~":"p","~1ZM~":"p","~20G~":"r","~23K~":"p","~269~":"p","~26C~":"p","~26M~":"p","~270~":"r"},templates:{"a*b.html":"<p>a * b = {{~1N5~}}</p>","a+b.html":"<p>a + b = {{~1N9~}}</p>","app1.html":'<h1>MetaphorJs Feature test</h1><div class="cases"><div class="case"><h4>Bindings (read only)</h4><label class="case-label">Inline</label><div id="inline-binding" class="test">{{~1ZZ~}}</div><label class="case-label">mjs-bind</label><div id="binding" {bind}="~1NK~" class="test"></div><label class="case-label">mjs-bind-html</label><div id="html-binding" {bind-html}="~1NP~" class="test"></div><label class="case-label">Plain attribute (href)</label><p class="test"><a id="attr-binding-href" [href]="http://{{~200~}}.com">{{~201~}}</a></p></div><div class="case"><h4>Bindings (read only)</h4><label class="case-label">Input field (value)</label><p class="test"><input id="binding-input-value" type="text" [value]="~1NZ~"></p><label class="case-label">Input field (mjs-bind) (locked)</label><p class="test"><input id="binding-input-bind" type="text" {bind}="~1O5~" {bind.$locked}></p><label class="case-label">Checkbox (mjs-bind)</label><p class="test"><input id="binding-checkbox" type="checkbox" {bind}="~1OA~"></p><label class="case-label">Radio (mjs-bind) (locked)</label><p class="test"><input id="radio-bind-1" checked="checked" type="radio" value="inline1" name="radio-bind" {bind}="~1OG~" {bind.$locked}> <input id="radio-bind-2" type="radio" value="inline2" name="radio-bind"> <input id="radio-bind-3" type="radio" value="inline3" name="radio-bind"></p></div><div class="case"><h4>Bindings (read only)</h4><label class="case-label">Select (mjs-bind)</label><p class="test"><select id="select-bind" {bind}="~1OQ~"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select></p><label class="case-label">Textarea (mjs-bind)</label><p class="test"><textarea id="textarea-bind-attr" {bind}="~1OZ~"></textarea></p><label class="case-label">Textarea (inline)</label><p class="test"><textarea id="textarea-bind-inline">{{~202~}}</textarea></p></div><div class="case"><h4>Muplitple inline binding</h4><div id="multiple-inline-binding" class="test">{{~203~}} <b>{{~204~}}</b> {{~205~}}</div></div><div class="case"><h4>Filters</h4><label class="case-label">Uppercase (mjs-bind)</label><div id="filter-uppercase-binding" class="test" {bind}="~1PC~"></div><label class="case-label">Uppercase (inline)</label><div id="filter-uppercase-inline" class="test">{{~206~}}</div><label class="case-label">Lowercase (inline)</label><div id="filter-lowercase-inline" class="test">{{~207~}}</div><label class="case-label">Limit to (string)</label><div id="filter-limit-string" class="test">{{~208~}}</div></div><div class="case"><h4>Filters</h4><label class="case-label">Linkify</label><p id="filter-linkify" class="test" {bind-html}="~1PO~"></p></div><div class="case"><h4>Expressions</h4><label class="case-label">.a + .b</label><div id="expr-a-plus-b" class="test">{{~209~}}</div><label class="case-label">.bool ? "true" : "false"</label><div id="expr-bool" class="test">{{~20B~}}</div></div><div class="case"><h4>Model</h4><label class="case-label">Input (number) (.a)</label><p class="test"><input {model}="~1Q2~" type="number" data-type="number" id="model-input-a"></p><label class="case-label">Checkbox (.bool)</label><p class="test"><input id="model-checkbox-bool" type="checkbox" {model}="~1Q8~"></p><label class="case-label">Radio (.inline)</label><p class="test"><input id="model-radio-1" checked="checked" type="radio" name="r" value="inline1" {model}="~1QE~">1 <label><input id="model-radio-2" type="radio" name="r" value="inline2">2</label> <input id="model-radio-3" type="radio" name="r" value="inline3">3</p><label class="case-label">Select (.a)</label><p class="test"><select id="model-select-a" {model}="~1QN~" data-type="number"><option value="1">1</option><option value="2">2</option><option value="3">3</option><option value="4">4</option></select></p></div><div class="case"><h4>Model</h4><label class="case-label">Textarea (.text)</label><p class="test"><textarea id="model-textarea" {model}="~1QY~"></textarea></p><label class="case-label">Input (string .text)</label><p class="test"><input type="text" id="model-input" {model}="~1R4~"></p></div><div class="case"><h4>mjs-class</h4><label class="case-label">Plain attribute</label><div class="test"><p id="class-inline" [class]="~1RA~">---</p></div><label class="case-label">mjs-class (string)</label><div class="test"><p id="class-string" {class}="~1RF~">---</p></div><label class="case-label">mjs-class ({bool: .bool, inline1: .a == 0})</label><div class="test"><p id="class-object" {class}="~1RK~">---</p></div><div class="test"><p id="class-object" {class.bool}="~1RP~" {class.inline1}="~1RQ~">---</p></div></div><div class="case"><h4>mjs-if, mjs-show, mjs-hide</h4><div id="if-bool" {if}="~1RW~" class="test" {if.$animate}>this should appear if .bool = true</div><div id="show-bool" {show}="~1RZ~" class="test" {show.$animate}>this should show if .bool = true</div><div id="hide-bool" {hide}="~1S2~" class="test" {hide.$animate}>this should hide if .bool = true</div></div><div class="case"><h4>mjs-include</h4><label class="case-label">immediate</label><div {include}="test-template.html"><p>transcluded text</p></div><label class="case-label">immediate (via tag)</label><mjs-include $name="test-template.html"><p>transcluded text</p></mjs-include><label class="case-label">ajax</label><div {include}="template.html" id="ajax-template"><p>Transcluded text</p></div></div><div class="case"><h4>mjs-validate</h4><form name="myForm" {form} {class.error}="~1SL~" {class.$animate}><div><input name="field1" data-validate-required {class}="~1SQ~"></div><div {class}="~1SU~"><label><input type="radio" name="radio1" value="1" data-validate-required> -- 1</label> <label><input type="radio" name="radio1" value="2"> -- 2</label> <label><input type="radio" name="radio1" value="3"> -- 3</label></div><div><input type="submit" value="Submit"> <input type="reset" value="Reset"></div></form></div><div class="case" {init}="~1T7~"><h4>dynamic list</h4><label><input id="radio-sep-1" type="radio" name="sep" value="/\\n|,/" {model}="~1TD~"> /\\n|,/</label> <label><input type="radio" name="sep" value="/\\n/"> /\\n/</label> <label><input type="radio" name="sep" value=","> ,</label><br><br><textarea {model}="~1TO~" {model.$binding}="input"></textarea><ul><li {each}="~1TU~" {bind}="~1TW~" {bind.$recursive}></li></ul></div><div class="case"><h4>mjs-options</h4><label class="case-label">Generated from .alist</label><p class="test"><select {bind}="~1U4~" {options}="~1U6~"><option>not selected</option></select></p><label class="case-label">Generated from .dynamicList</label><p class="test"><select {options}="~1UE~"><option>default value</option></select></p></div><div class="case" {cmp}="Test.TplComponent" id="tplComponentTest"><h2>{{~20D~}}</h2>mjs-include change template:<br><a href="#" (1|click)="~1UN~" (2|click)="~1UQ~">a + b</a> | <a href="#" (click)="~1UU~">a * b</a><div {include}*="~1V0~" id="tplComponetInc"></div></div><div class="case" {cmp}="Test.StringTemplate"></div><div class="case" {cmp}="Test.ChangeTemplate">mjs-cmp change template:<br><a href="#" (click)="~1V9~">tpl1</a> | <a href="#" (click)="~1VD~">tpl2</a></div><div class="case"><h4>Router</h4><div {router}="Test.MyView" {router.$animate}></div>pushUrl: <a href="/1">/1</a> | <a href="/2">/2</a> | <a href="/3">/3</a> | <a href="http://www.kuindji.com">outside</a><br><br></div><div class="case" {ignore}>This element is ignored by renderer: {{~20F~}}</div><div class="case" {view}="~1VS~" {view.$default-cmp}:="Test.ViewComponent1"><p>change cmp: <a href="#" (click)="~1VX~">Cmp1</a> | <a href="#" (click)="~1W1~">Cmp2</a></p></div></div><div class="cases"><div class="case double" {init}="~1W6~"><h4>mjs-each (attr)</h4><input {model}="~1WB~" (key.enter)="~1WF~"> <input type="button" {disabled}="~1WJ~" (click)="~1WM~" value="Add item"><ul {show}="~1WQ~"><li {each}="~1WT~" {each.$animate} {each.$animate-move}><label {class}="~1X0~"><input type="checkbox" {model}="~1X4~"> {{~20H~}} - {{~20J~}} - {{~20L~}} - {{~20N~}} - {{~20P~}} - {{~20R~}}</label> <a href="#" (click)="~1X9~">x</a></li></ul><input {model}="~1XD~" placeholder="Search"> <a href="#" (click)="~1XH~" (click.log)="~1XJ~">asc</a> <a href="#" (click)="~1XN~" (click.log)="~1XP~">desc</a></div><div class="case double"><h4>mjs-each (tag)</h4><mjs-each value="item in this.list | filter:this.listFilter | sortBy:\'txt\':this.sortBy"><div><label {class}="~1XW~"><input type="checkbox" {model}="~1XZ~"> {{~20T~}} - {{~20U~}} - {{~20V~}} - {{~20W~}} - {{~20X~}} - {{~20Y~}}</label> <a href="#" (click)="~1Y2~">x</a></div></mjs-each></div><div class="case" id="newComponent">Dynamically created component on existing element will go here</div><div class="case" id="renderToComponent">Dynamically created component with renderTo will go here</div><div class="case double" {cmp}="Test.MyComponent" {cmp.$as}="ctrl" {cmp.$init}="~1Y7~"><p ##para>Component\'s transcluded text + {{~20Z~}}</p><a href="#" (click)="~1YC~">reverse</a> | <a href="#" (click)="~1YG~">create new component on existing element</a> | <a href="#" (click)="~1YK~">create new component and render to</a> | <a href="#" (click)="~1YO~">create new dialog</a><br><br><button (click)="~1YU~">Load store</button> <button (click)="~1YY~">Clear store</button><br><br>this.selectBinding: <select {model}="~1Z4~"><option value="input">Input</option><option value="scope">Scope</option><option value="both">Both</option></select><br><br>this.a: <select {options}="~1ZE~" {model}="~1ZK~" {model.$binding}*="~1ZN~"><option>Nothing selected</option></select><ul><li {each}="~1ZS~" {each.$animate}>{{~210~}}</li></ul></div><div class="case double" id="myComponent1" {cmp}="Test.MyComponent"><p>This is another instance with deferred value: {{~212~}}</p></div><div class="case double"><tagc $as:="ctrl" $test:="Value from config"></tagc></div></div>',
"app2.html":'<div class="case"><h4>app\'s resolved value</h4><p class="test">{{~22B~}}</p></div><div class="case"><h4>recursive rendering</h4><p><a href="#" (click)="~21C~">Change level 2</a></p><p class="test">This is level 1: <span {bind}="~21H~" {bind.$recursive}></span></p></div><div class="case"><h4>lang substitution</h4><label class="case-label">using normal expression with filter: \'key\' | l</label><p class="test">{{~22D~}}</p><p class="test" {bind}="~21P~" {bind.$recursive}></p></div><div class="case"><h4>pluralization</h4><p><a href="#" (click)="~21W~">Increase B</a></p><label class="case-label">using normal expression:</label><p class="test">{{~22F~}} {{~22H~}}</p><p><input type="number" data-type="number" {model}="~223~"></p><p class="test" {bind}="~228~" {bind.$recursive}></p></div>',
"cmp1-template.html":"<h2>{{~22N~}}</h2><div {transclude}></div>","dirs.html":'\x3c!--{includes: true}--\x3e<div class="form_select" (click)="~22Q~" {class.loading}="~22T~" {class.disabled}="~22V~" {class.search}="~22X~" {class.multiple}="~22Z~" {class.black}="~231~"><input type="hidden" #el_hidden_field [name]="~234~" [value]="~236~"> <i #el_icon_down (click)="~23B~">\x3c!-- include icons/down.html --\x3e </i><a class="form_select__label" {each}="~23F~" style="display: inline-block !important;">{{~26O~}} <i class="delete icon" (click)="~23J~"></i> </a><input type="text" #el_search class="search" [disabled]="~241~" {show}="~23N~" {show.$display}="inline-block" (focus)="~23P~" (blur)="~23S~" (key.backspace)="~23V~" {model}="~23Y~"> <span class="sizer" #el_sizer {if}="~244~" {bind}="~247~"></span><div class="default text" #el_default_text (click)="~24A~" {show}="~24D~" {show.$display}="inline-block" {show.$on--change}="~24F~" {bind}="~24I~"></div><div class="text" #el_text (click)="~24M~" {class.default}="~24O~" {show}="~24R~" {show.$on--chage}="~24T~" {show.$display}="inline-block" {bind}="~24W~"></div>\x3c!-- replaces two previous text blocks with invisible placeholder --\x3e<div style="display: none" class="default text" {show}="~250~" {show.$display}="inline-block">&nbsp;</div><select class="form-select_hidden-select" #el_hidden_select (click)="~254~" (change)="~257~" {show}="~25A~" {show.$display}="block" {options}="~25D~"></select><div class="form-select-menu" #el_menu {class.black}="~25H~"><div class="items" #el_menu_items><div class="disabled item" #el_menu_disabled {if}="~25L~" (click)="~25O~" {bind-html}="~25R~"></div><div class="empty item" #el_menu_empty style="color: #999;" {if}="~25V~" (click)="~25Y~" {bind-html}="~261~"></div><div class="item" {each}="~265~" (click)="~268~" {bind}="~26B~"></div></div><div class="pagination_container" {cmp}="Pagination" {cmp.$autoscroll}="~26F~" {show}="~26I~" (click)="~26L~"></div></div></div>',
"tagc.html":'<div class="component"><p>This is a tag component.</p><p>{{~26T~}}</p></div>',"test-template.html":"<p>{{~26Z~}}</p><div {transclude}></div>"}};R.app.view=R.app.view||{};R.app.component=R.app.component||{};var Ta=Object.prototype.toString;var ca=function(){var a={"[object String]":0,"[object Number]":1,"[object Boolean]":2,"[object Object]":3,"[object Function]":4,"[object Array]":5,"[object RegExp]":9,"[object Date]":10};return function(c){if(!c){if(null===c)return 6;if(void 0===c)return 7}var b=a[Ta.call(c)];return void 0===b?-1:1===b&&isNaN(c)?8:b}}();var ha=["0","0","0"];var S=function(){function a(b){var d;var e=0;for(d=c.length;e<d;e++)c[e][0].call(c[e][1],b);"undefined"!=typeof console&&console.error&&console.error(b)}var c=[];a.on=function(b,d){a.un(b,d);c.push([b,d])};a.un=function(b,d){var e;var g=0;for(e=c.length;g<e;g++)if(c[g][0]===b&&c[g][1]===d){c.splice(g,1);break}};return a}();R.lib.ObservableEvent=function(){function a(c,b){this.name=c;this.listeners=[];this.map={};this.hash=E();this.uni="$$"+c+"_"+this.hash;this.suspended=!1;this.fid=this.lid=0;"object"===typeof b&&null!==b?D(this,b,!0,!1):this.returnResult=b;this.triggered=0}D(a.prototype,{name:null,listeners:null,map:null,hash:null,uni:null,suspended:!1,lid:null,fid:null,limit:0,triggered:0,returnResult:null,autoTrigger:null,lastTrigger:null,triggerFilter:null,filterContext:null,expectPromises:!1,resolvePromises:!1,
getName:function(){return this.name},$destroy:function(){for(var c in this)this[c]=null},on:function(c,b,d){if(!c)return null;b=b||null;d=d||{};var e=this.uni,g=++this.lid,f=c[e]||++this.fid,h=e+"_"+f,l=d.first||!1;if(c[e]&&(!b||b[h])&&!d.allowDupes)return null;c[e]||(c[e]=f);b&&!b[h]&&(b[h]=!0);c={fn:c,context:b,id:g,fid:f,async:!1,called:0,limit:0,start:1,count:0,append:null,prepend:null,replaceArgs:null};D(c,d,!0,!1);!0===c.async&&(c.async=1);d.once&&(c.limit=1);l?this.listeners.unshift(c):this.listeners.push(c);
this.map[g]=c;if(this.autoTrigger&&this.lastTrigger&&!this.suspended){var n=this.triggerFilter;this.triggerFilter=function(m){return m.id===g?n?!1!==n(m):!0:!1};this.trigger.apply(this,this.lastTrigger);this.triggerFilter=n}return g},once:function(c,b,d){d=d||{};d.limit=1;return this.on(c,b,d)},un:function(c,b){var d=-1,e=this.uni,g=this.listeners;if(c==parseInt(c)){var f=parseInt(c);if(!this.map[f])return!1;var h=this.map[f].fid}else h=c[e];if(!h)return!1;var l=e+"_"+h;b=b||null;for(var n=0,m=g.length;n<
m;n++)if(g[n].fid===h&&g[n].context===b){d=n;f=g[n].id;delete c[e];b&&delete b[l];break}if(-1===d)return!1;g.splice(d,1);delete this.map[f];return!0},hasListener:function(c,b){var d=this.listeners;if(c){c=G(c)?c[this.uni]:parseInt(c);if(!c)return!1;for(var e=this.uni+"_"+c,g=0,f=d.length;g<f;g++)if(d[g].fid===c&&(!b||b[e]))return!0;return!1}return 0<d.length},removeAllListeners:function(){var c=this.listeners,b=this.uni,d;var e=0;for(d=c.length;e<d;e++){var g=b+"_"+c[e].fn[b];delete c[e].fn[b];c[e].context&&
delete c[e].context[g]}this.listeners=[];this.map={}},suspend:function(){this.suspended=!0},resume:function(){this.suspended=!1},_prepareArgs:function(c,b){if(c.append||c.prepend){var d=c.prepend;var e=c.append;var g=b.slice();d&&("function"===typeof d&&(d=d(c,b)),g=d.concat(g));e&&("function"===typeof e&&(e=e(c,b)),g=g.concat(e))}else c.replaceArgs?(g=c.replaceArgs,"function"===typeof g&&(g=g(c,b)),g=[].concat(g)):g=b;return g},trigger:function(){var c=this,b=c.listeners,d=c.returnResult,e=c.triggerFilter,
g=c.filterContext,f=c.expectPromises,h=c.keepPromiseOrder,l=[],n=B(arguments),m;if(c.suspended||0<c.limit&&c.triggered>=c.limit)return null;c.triggered++;c.autoTrigger&&(c.lastTrigger=n.slice());if(0===b.length)return"pipe"===d?n[0]:null;var p="all"===d||"concat"===d?[]:"merge"===d?{}:null,r;var q="first"===d?[b[0]]:b.slice();for(f&&"last"===d&&(h=!0);r=q.shift();)if(!(!r||!c.map[r.id]||(b=c._prepareArgs(r,n),e&&!1===e.call(g,r,b,c))||r.filter&&!1===r.filter.apply(r.filterContext||r.context,b)||(r.count++,
r.count<r.start))){if(r.async&&!f){var t=null;F(r.fn,r.context,b,r.async)}else f?(t=function(u,y,w){return function(v){"pipe"===y&&(w[0]=v,w=c._prepareArgs(u,w));return u.fn.apply(u.context,w)}}(r,d,n.slice()),t=m?m.then(t):r.fn.apply(r.context,b),t.catch(S)):t=r.fn.apply(r.context,b);r.called++;r.called===r.limit&&c.un(r.id);if("first"===d)return t;if(f)l.push(t),("pipe"===d||h)&&t&&(m=t);else if(null!==d)if("all"===d)p.push(t);else if("concat"===d&&t)p=p.concat(t);else if("merge"===d)D(p,t,!0,!1);
else{if("nonempty"===d&&t)return t;if("pipe"===d)p=t,n[0]=t;else if("last"===d)p=t;else{if(!1===d&&!1===t)return!1;if(!0===d&&!0===t)return!0}}}if(f){if("pipe"===d)return m;e=Promise.all(l);c.resolvePromises&&null!==d&&"all"!==d&&(e=e.then(function(u){var y,w=u.length;for(y=0;y<w;y++){var v=u[y];if("concat"===d&&v)p=p.concat(v);else if("merge"===d)D(p,v,!0,!1);else{if("nonempty"===d&&v)return v;if("last"===d)p=v;else{if(!1===d&&!1===v)return!1;if(!0===d&&!0===v)return!0}}}return p}));return e}return p}},
!0,!1);return a}();R.lib.Observable=function(){function a(b,d,e){for(var g in e)b.createEvent?b.createEvent(g,e[g]):d.createEvent(g,e[g])}function c(){this.events={}}D(c.prototype,{createEvent:function(b,d){b=b.toLowerCase();var e=this.events;e[b]||(e[b]=new R.lib.ObservableEvent(b,d));return e[b]},getEvent:function(b){b=b.toLowerCase();return this.events[b]},on:function(b,d,e,g){b=b.toLowerCase();var f=this.events;f[b]||(f[b]=new R.lib.ObservableEvent(b));return f[b].on(d,e,g)},once:function(b,d,e,g){g=g||{};g.limit=
1;return this.on(b,d,e,g)},un:function(b,d,e){b=b.toLowerCase();var g=this.events;g[b]&&g[b].un(d,e)},relayEvent:function(b,d,e,g){b.on(d,this.trigger,this,{prepend:"*"===d?null:[e||d],replaceArgs:"*"===d&&g?function(f,h){h[0]=g+h[0];return h}:null})},unrelayEvent:function(b,d){b.un(d,this.trigger,this)},hasListener:function(b,d,e){var g=this.events;if(b)return b=b.toLowerCase(),g[b]?g[b].hasListener(d,e):!1;for(b in g)if(g[b].hasListener())return!0;return!1},hasEvent:function(b){return!!this.events[b]},
removeAllListeners:function(b){var d=this.events;if(b)d[b]&&d[b].removeAllListeners();else for(b in d)d[b].removeAllListeners()},trigger:function(){var b=arguments[0],d=this.events,e=null;b=b.toLowerCase();if(d[b]){var g=d[b];e=g.trigger.apply(g,B(arguments).slice(1))}(g=d["*"])&&g.trigger.apply(g,arguments);return e},suspendEvent:function(b){b=b.toLowerCase();var d=this.events;d[b]&&d[b].suspend()},suspendAllEvents:function(){var b=this.events,d;for(d in b)b[d].suspend()},resumeEvent:function(b){b=
b.toLowerCase();var d=this.events;d[b]&&d[b].resume()},resumeAllEvents:function(){var b=this.events,d;for(d in b)b[d].resume()},destroyEvent:function(b){var d=this.events;d[b]&&(d[b].removeAllListeners(),d[b].$destroy(),delete d[b])},$destroy:function(){var b=this.events,d;for(d in b)this.destroyEvent(d);for(d in this)this[d]=null}},!0,!1);c.$initHost=function(b,d,e){var g;b.$$events&&a(b,e,b.$$events);if(d&&d.callback){var f=d.callback,h=f.context||f.scope||f.$context;f.$events&&a(b,e,f.$events);
f.context=null;f.scope=null;for(g in f)if(f[g]){var l=b,n=e,m=g,p=f[g],r=h;l.on?l.on(m,p,r||l):n.on(m,p,r||l)}d.callback=null;h&&(b.$$callbackContext=h)}};c.$initHostConfig=function(b,d,e,g){var f=R.lib.Config.MODE_LISTENER,h;d.setDefaultMode("callbackContext",R.lib.Config.MODE_SINGLE);d.eachProperty(function(l){"on--"===l.substring(0,4)&&(d.setMode(l,f),h||(h=e.$app?d.get("callbackContext")||(g?e.$app.getParentCmp(g):null)||e.$app||e:d.get("callbackContext")||e),b.on(l.substring(4),d.get(l),h))})};
return c}();var Ua=function(){return this}();try{Ua=Ua||(new Function("return this"))()}catch(a){"object"===typeof window&&(Ua=window)};var Va;
(function(a){Va=function e(b,d){if("undefined"!=typeof window&&b===window)throw Error("Cannot copy window object");if("undefined"!=typeof a&&b===a)throw Error("Cannot copy global object");if(d){if(b===d)throw Error("Objects are identical");if(H(b))for(var g=d.length=0,f=b.length;g<f;g++)d.push(e(b[g]));else{for(g in d)delete d[g];for(g in b)b.hasOwnProperty(g)&&("$"==g.charAt(0)||G(b[g])?d[g]=b[g]:d[g]=e(b[g]))}}else(d=b)&&(H(b)?d=e(b,[]):10===ca(b)?d=new Date(b.getTime()):9===ca(b)?d=new RegExp(b.source):ea(b)&&
(d=e(b,{})));return d}}).call(this,Ua);R.filter=R.filter||{};R.lib.Expression=function(){function a(){u=c;y=e;w=b;t=f}function c(v,x){return w("string"===typeof v?y(v,x):v,x)}function b(v,x){x=x||{};return 0===v.pipes.length&&0===v.inputPipes.length?x.setterOnly?(v.setterFn||(v.setterFn=t(v.expr,{setter:!0})),v.setterFn):v.getterFn||v.fn:function(A,C){if(v.inputPipes.length&&!x.getterOnly){var J=d(C,v.inputPipes,A);v.setterFn||(v.setterFn=t(v.expr,{setter:!0}));v.setterFn(A,J)}v.pipes&&!x.setterOnly&&(J=v.getterFn(A),J=d(J,v.pipes,A));return J}}function d(v,
x,A){var C,J=x.length,ba;for(C=0;C<J;C++){var O=x[C];!O.fn&&O.opt.name&&(O.fn=h(O.opt.name));var Z=[];var N=-1;for(ba=O.params.length;++N<ba;Z.push(O.params[N](A)));Z.unshift(A);Z.unshift(v);v=O.fn.apply(A,Z);O.opt.neg?v=!v:O.opt.dblneg&&(v=!!v)}return v}function e(v,x){x=x||{};var A=-1!==v.indexOf("|"),C=-1!==v.indexOf(">>"),J={fn:null,getterFn:null,setterFn:null,expr:v,pipes:[],inputPipes:[]};if(!A&&!C&&!0!==x.setter)return J[x.noReturn?"fn":"getterFn"]=t(v,x),J;A&&(A=g(v,!1,x.filters),v=A.expr,
J.pipes=A.pipes);C&&(A=g(v,!0,x.filters),v=A.expr,J.inputPipes=A.pipes,x.setter=!0);!0===x.setter&&(J.setterFn=t(v,x),x.setter=!1);J[x.noReturn?"fn":"getterFn"]=t(v,x);return J}function g(v,x,A){var C=x?">>":"|";if(-1===v.indexOf(C))return v;v=ka(v,C);x=x?v.pop():v.shift();C=[];var J;var ba=0;for(J=v.length;ba<J;ba++){var O=ka(v[ba].trim(),":");var Z=A;var N=O.shift();var z=G(N)?N:null,L=[],W=[],Y=z?null:N.substr(0,1),K={neg:!1,dblneg:!1,undeterm:!1,name:N};z?K.name=z.name:("!!"===N.substr(0,2)?(N=
N.substr(2),K.dblneg=!0):"!"===Y?(N=N.substr(1),K.neg=!0):"?"===Y&&(N=N.substr(1),K.undeterm=!0),K.name=N);!z&&(z=h(N,Z));if(G(z)){N=-1;for(Z=O.length;++N<Z;L.push(t(O[N])))l(O[N])||W.push(O[N]);z.$undeterministic&&(K.undeterm=!0);O={fn:z,origArgs:O,params:L,expressions:W,opt:K}}else O=null;O&&C.push(O)}return{expr:x.trim(),pipes:C}}function f(v,x){x=x||{};"string"===typeof x&&"setter"===x&&(x={setter:!0});var A=!0===x.asCode,C=!0===x.setter;x=!0===x.noReturn;if(l(v)){var J=v+"_static";x&&(J+="_noret");
if(p[J]&&!A)return p[J];if(C)throw Error("Static value cannot work as setter");return A?"".concat("function() {","return ",v,"}"):p[J]=new Function("","return "+v)}try{var ba=n(v);J=v+"_"+(C?"setter":x?"func":"getter");x&&(J+="_noret");if(!ba&&C)throw Error("Complex expression cannot work as setter");if(!p[J]||A){var O=v.replace(m,"$2____.$5"),Z=ba&&C?"".concat("",O," = $$$$",""):"".concat("",x?"":"return ",O,""),N=v.replace(/\n/g,"\\n");N=N.replace(/\r/g,"\\r");N=N.replace(/'/g,"\\'");N=N.replace(/"/g,
'\\"');Z=Z.replace('"expr"','"'+N+'"');if(A)return"function(____, $$$$) {"+Z+"}";p[J]=new Function("____","$$$$",Z)}return p[J]}catch(z){return S(Error("Error parsing expression: "+v+"; \n\n\n"+Z)),S(z),M}}function h(v,x){if(x)if(H(x))x=x.concat(q);else{if(x.hasOwnProperty(v)&&"function"===typeof x[v])return x[v];x=q}else x=q;var A,C=x.length;for(A=0;A<C;A++)if(x[A]&&x[A].hasOwnProperty(v))return x[A][v];return null}function l(v){if(!I(v))return{value:v};var x=v.substr(0,1),A=v.length-1;if('"'===
x||"'"===x){if(v.indexOf(x,1)===A)return{value:v.substring(1,A)}}else{if("true"===v||"false"===v)return{value:"true"===v};if((x=parseFloat(v))==v)return{value:x}}return!1}function n(v){return!v.trim().match(/[^a-zA-Z0-9_$'"\(\)\[\]\.;]/)}var m=/((^|[^a-z0-9_$\]\)'"])|(this))(\.)([^0-9])/ig,p={},r={},q=[],t,u,y,w;R.filter&&q.push(R.filter);"undefined"!==typeof window&&q.push(window);a();return{setExpressionFn:function(v){t=v},getExpressionFn:function(){return t},setDeconstructorFn:function(v){y=v},
getDeconstructorFn:function(){return y},setConstructorFn:function(v){w=v},getConstructorFn:function(){return w},setParserFn:function(v){u=v},getParserFn:function(){return u},addFilterSource:function(v){q.push(v)},reset:a,expression:function(v,x){return t(v,x)},deconstruct:function(v,x){return y(v,x)},construct:function(v,x){return w(v,x)},parse:function(v,x){return u(v,x)},func:function(v,x){x=x||{};x.noReturn=!0;x.getterOnly=!0;return u(v,x)},setter:function(v,x){x=x||{};x.setter=!0;x.setterOnly=
!0;return u(v,x)},getter:function(v,x){x=x||{};x.setter=!1;x.getterOnly=!0;return u(v,x)},run:function(v,x,A,C){C=C||{};C.noReturn=!0;u(v,C)(x,A)},get:function(v,x,A,C){C=C||{};C.getterOnly=!0;return u(v,C)(x,A)},set:function(v,x,A,C){C=C||{};C.setter=!0;C.setterOnly=!0;return u(v,C)(x,A)},isStatic:l,isAtom:n,isProperty:function(v){return(v=v.match(/^this\.([a-zA-Z0-9_$]+)$/))?v[1]:!1},isPrebuiltKey:function(v){return"string"===typeof v&&"--"===v.substring(0,2)},expressionHasPipes:function(v){return 1<
ka(v,"|").length||1<ka(v,">>").length},describeExpression:function(v){if(!v||"string"!==typeof v)return"";if(r[v])return r[v];var x=(-1!==v.indexOf("$parent")?"p":"")+(-1!==v.indexOf("$root")?"r":"")+(1<ka(v,"|").length?"o":"")+(1<ka(v,">>").length?"i":"");return r[v]=x},clearCache:function(){p={}},disableCache:function(){},enableCache:function(){}}}();R.lib.MutationObserver=function(){function a(d,e,g,f,h){var l=E(),n="expr",m=typeof e;if(R.app.prebuilt.isKey(e))var p=R.app.prebuilt.get("config",e);else"string"!==m&&"function"!==m&&(p=e,e=p.id||E());h=h||{};if(g)b.on(l,g,f,{allowDupes:!0});this.id=l;this.origExpr=e;this.staticValue=this.propertyName=null;this.dataObj=d;this.exprStruct=this.getterFn=this.setterFn=this.rawInput=this.prevValue=this.currentValue=null;this.sub=[];this.localFilter=h.localFilter||null;p?(n="prebuilt",this.exprStruct=
p,this.getterFn=R.lib.Expression.construct(p,{getterOnly:!0}),p.setterFn&&(this.setterFn=R.lib.Expression.construct(p,{setterOnly:!0}),this._initSetter())):G(e)?this.getterFn=e:(g=R.lib.Expression.isStatic(e))?(n="static",this.staticValue=g.value,this.getterFn=this._staticGetter.bind(this)):d&&(g=e,d.hasOwnProperty(g)||(g=R.lib.Expression.isProperty(e))&&d.hasOwnProperty(g))&&(n="attr",this.propertyName=g,this.getterFn=this._propertyGetter.bind(this));this.getterFn||"expr"!==n||(h.filters?H(h.filters)?
h.filters.push(d):h.filters=[h.filters]:h.filters=d,this.exprStruct=g=R.lib.Expression.deconstruct(e,{filters:h.filters}),this.getterFn=R.lib.Expression.construct(g,{getterOnly:!0}),(g.inputPipes.length||h.setter)&&this._initSetter());d&&(d.$$mo||(d.$$mo={$checkAll:c}),d.$$mo[e]||(d.$$mo[e]=this));this.currentValue=this._getValue();this.currentValueCopy=Va(this.currentValue);this.type=n}function c(){var d,e=0;for(d in this)this.hasOwnProperty(d)&&"$checkAll"!==d&&this[d].check()&&e++;return e}var b=
new R.lib.Observable;D(a.prototype,{_propertyGetter:function(){return this.dataObj[this.propertyName]},_propertySetter:function(d,e){this.dataObj[this.propertyName]=e},_staticGetter:function(){return this.staticValue},check:function(){var d=this.currentValueCopy,e=this._getValue();return ja(e,d)?!1:(this.prevValue=d,this.currentValue=e,this.currentValueCopy=Va(e),b.trigger(this.id,this.currentValue,this.prevValue),!0)},_initSetter:function(){var d=this.exprStruct;if("attr"===this.type)this.setterFn=
this._propertySetter.bind(this);else{if(!d)throw Error("Unable to make setter out of "+this.expr);this.setterFn||(this.setterFn=R.lib.Expression.construct(d,{setterOnly:!0}));this._initInputPipes()}},_initInputPipes:function(){var d=this.exprStruct,e,g;if(d.inputPipes){var f=0;for(e=d.inputPipes.length;f<e;f++){var h=d.inputPipes[f];var l=0;for(g=h.expressions.length;l<g;l++)this.sub.push(R.lib.MutationObserver.get(this.dataObj,h.expressions[l],this._onSubChange,this))}}},_getValue:function(){var d=
this.getterFn(this.dataObj);return this.localFilter?this.localFilter(d,this):d},_onSubChange:function(){this.setValue(this.rawInput)},getValue:function(){return this.currentValue},getCopy:function(){return this.currentValueCopy},setValue:function(d){this.rawInput=d;this.setterFn||this._initSetter();this.setterFn(this.dataObj,d)},getPrevValue:function(){return this.prevValue},subscribe:function(d,e,g){g=g||{};g.allowDupes=!0;b.on(this.id,d,e,g);return this},unsubscribe:function(d,e){b.un(this.id,d,
e);return this},hasInputPipes:function(){return this.exprStruct&&0<this.exprStruct.inputPipes.length},hasOutputPipes:function(){return this.exprStruct&&0<this.exprStruct.pipes.length},$destroy:function(d){var e;if(d&&b.hasListener(this.id))return!1;d=0;for(e=this.sub.length;d<e;d++){var g=this.sub[d];g.unsubscribe(this._onSubChange,this);g.$destroy(!0)}b.destroyEvent(this.id);this.dataObj&&this.dataObj.$$mo&&this.dataObj.$$mo[this.origExpr]===this&&delete this.dataObj.$$mo[this.origExpr];for(var f in this)this.hasOwnProperty(f)&&
(this[f]=null);return!0}});a.check=function(d,e){if(e){d=a.exists(d,e);if(!d)throw Error("MutationObserver not found for expression: "+e);return d.check()}return d.$$mo?d.$$mo.$checkAll():!1};a.get=function(d,e,g,f,h){var l=e;"string"!==typeof e&&(e=l.expr);return e&&(e=e.trim(),e=a.exists(d,e))?(g&&e.subscribe(g,f),e):new a(d,l,g,f,h)};a.exists=function(d,e){e=e.trim();return d&&d.$$mo&&d.$$mo[e]?d.$$mo[e]:!1};a.$destroy=function(d,e,g){var f,h=!0;if(d&&d.$$mo){for(f in d.$$mo)!d.$$mo.hasOwnProperty(f)||
e&&f!==e||"$"===f[0]||(d.$$mo[f].$destroy(g)?delete d.$$mo[f]:h=!1);h&&delete d.$$mo}};return a}();R.lib.Scope=function(){function a(b){this.$$observable=new R.lib.Observable;this.$$historyWatchers={};D(this,b,!0,!1);this.$parent?(this.$parent.$on("check",this.$$onParentCheck,this),this.$parent.$on("destroy",this.$$onParentDestroy,this),this.$parent.$on("freeze",this.$freeze,this),this.$parent.$on("unfreeze",this.$unfreeze,this)):(this.$root=this,this.$isRoot=!0);this.$$publicName&&(c[this.$$publicName]&&(this.$$publicName=null),c[this.$$publicName]=this)}var c={};D(a.prototype,{$app:null,$parent:null,
$root:null,$isRoot:!1,$level:0,$static:!1,$$frozen:!1,$$observable:null,$$watchers:null,$$historyWatchers:null,$$checking:!1,$$destroyed:!1,$$changing:!1,$$publicName:null,$$tmt:null,$new:function(b){return new a(D({},b,{$parent:this,$root:this.$root,$app:this.$app,$level:this.$level+1,$static:this.$static},!0,!1))},$newIsolated:function(b){return new a(D({},b,{$app:this.$app,$level:self.$level+1,$static:this.$static},!0,!1))},$freeze:function(){this.$$frozen||(this.$$frozen=!0,this.$$observable.trigger("freeze",
this))},$unfreeze:function(){this.$$frozen&&(this.$$frozen=!1,this.$$observable.trigger("unfreeze",this))},$on:function(b,d,e){return this.$$observable.on(b,d,e)},$un:function(b,d,e){return this.$$observable.un(b,d,e)},$watch:function(b,d,e){return R.lib.MutationObserver.get(this,b,d,e)},$unwatch:function(b,d,e){if(b=R.lib.MutationObserver.exists(this,b))b.unsubscribe(d,e),b.$destroy(!0)},$watchHistory:function(b,d){this.$$historyWatchers[d]||(this.$$historyWatchers[d]=b,R.lib.History.on("change-"+
d,this.$$onHistoryChange,this))},$unwatchHistory:function(b){this.$$historyWatchers[b]||(delete this.$$historyWatchers[b],R.lib.History.un("change-"+b,this.$$onHistoryChange,this))},$set:function(b,d){if("string"===typeof b)this[b]=d;else for(var e in b)this[e]=b[e];this.$check()},$$onParentDestroy:function(){this.$destroy()},$$onParentCheck:function(){this.$check()},$$onHistoryChange:function(b,d,e){this.$$historyWatchers[e]&&(d=this.$$historyWatchers[e],this[d]=b,this.$check())},$scheduleCheck:function(b){this.$$tmt||
(this.$tmt=F(this.$check,this,null,b))},$check:function(){var b;this.$$checking||this.$static||this.$$frozen||(this.$$checking=!0,this.$$tmt&&(clearTimeout(this.$$tmt),this.$$tmt=null),this.$$mo&&(b=this.$$mo.$checkAll()),this.$$checking=!1,this.$$destroyed||this.$$observable.trigger("check",b),0<b?(this.$$changing=!0,this.$check()):this.$$changing&&(this.$$changing=!1,this.$$observable.trigger("changed")))},$registerPublic:function(b){this.$$publicName||c[b]||(this.$$publicName=b,c[b]=this)},$makePublicDefault:function(){this.$registerPublic("__default")},
$unregisterPublic:function(){var b=this.$$publicName;b&&c[b]&&(delete c[b],this.$$publicName=null)},$destroy:function(){var b,d;if(!this.$$destroyed){this.$$destroyed=!0;this.$$observable.trigger("destroy");this.$$observable.$destroy();this.$parent&&this.$parent.$un&&(this.$parent.$un("check",this.$$onParentCheck,this),this.$parent.$un("destroy",this.$$onParentDestroy,this),this.$parent.$un("freeze",this.$freeze,this),this.$parent.$un("unfreeze",this.$unfreeze,this));this.$$mo&&R.lib.MutationObserver.$destroy(this);
for(b in this.$$historyWatchers)this.$unwatchHistory(b);this.$unregisterPublic();for(d in this)this.hasOwnProperty(d)&&(this[d]=null);this.$$destroyed=!0}}},!0,!1);a.$exists=function(b){return!!c[b]};a.$get=function(b){return c[b||"__default"]};a.$produce=function(b,d){if(b instanceof a)return b;if(b){var e="self";-1!==b.indexOf(":")&&(e=b.split(":"),b=e[0],e=e[1]||"self");if(b&&(d=this.$get(b),!d))throw Error("Scope with name "+b+" not found");switch(e){case "self":return d;case "new":return d.$new();
case "parent":return d.$parent||d.$root;case "root":return d.$root;case "app":if(!d.$app)throw Error("App not found in scope");return d.$app.scope;default:throw Error("Unknown scope action: "+e);}}else return d?d:(b=c.__default)?b.$new():new a};return a}();var Wa={},T=Wa={},na,pa;try{na="function"===typeof setTimeout?setTimeout:la}catch(a){na=la}try{pa="function"===typeof clearTimeout?clearTimeout:ma}catch(a){pa=ma}var ta=[],ra=!1,sa,ua=-1;T.nextTick=function(a){var c=Array(arguments.length-1);if(1<arguments.length)for(var b=1;b<arguments.length;b++)c[b-1]=arguments[b];ta.push(new xa(a,c));1!==ta.length||ra||oa(va)};xa.prototype.run=function(){this.fun.apply(null,this.array)};T.title="browser";T.browser=!0;T.env={};T.argv=[];T.version="";
T.versions={};T.on=ya;T.addListener=ya;T.once=ya;T.off=ya;T.removeListener=ya;T.removeAllListeners=ya;T.emit=ya;T.prependListener=ya;T.prependOnceListener=ya;T.listeners=function(){return[]};T.binding=function(){throw Error("process.binding is not supported");};T.cwd=function(){return"/"};T.chdir=function(){throw Error("process.chdir is not supported");};T.umask=function(){return 0};(function(a){R.lib.Promise=function(){function c(l,n){if(l instanceof c)return l;if(!(this instanceof c))return new c(l,n);var m;this._fulfills=[];this._rejects=[];this._dones=[];this._fails=[];if(0<arguments.length)if(m=Q(l))l instanceof c?l.then(this.resolve.bind(this),this.reject.bind(this)):(new c(m,l)).then(this.resolve.bind(this),this.reject.bind(this));else if(G(l))try{l.call(n,this.resolve.bind(this),this.reject.bind(this))}catch(p){this.reject(p)}else this.resolve(l)}function b(l,n){return function(m){try{n.resolve(l(m))}catch(p){n.reject(p)}}}
function d(l,n,m){m=m||[];g.push([l,n,m]);f||e()}function e(){f=!0;var l=g.shift();h(function(){l[0].apply(l[1],l[2]);g.length?e():f=!1},0)}var g=[],f=!1,h="undefined"!==typeof a?a.nextTick:function(l){setTimeout(l,0)};D(c.prototype,{_state:0,_fulfills:null,_rejects:null,_dones:null,_fails:null,_wait:0,_value:null,_reason:null,_triggered:!1,isPending:function(){return 0===this._state},isFulfilled:function(){return 1===this._state},isResolved:function(){return 1===this._state},isRejected:function(){return 2===
this._state},isCancelled:function(){return 3===this._state},hasListeners:function(){var l=[this._fulfills,this._rejects,this._dones,this._fails],n;var m=0;for(n=l.length;m<n;m++)if(l[m]&&l[m].length)return!0;return!1},_cleanup:function(){this._fails=this._dones=this._rejects=this._fulfills=null},_processValue:function(l,n,m){var p;if(0===this._state)if(l===this)this._doReject(new TypeError("cannot resolve promise with itself"));else{if(m)try{if(p=Q(l)){l instanceof c?l.then(this._processResolveValue.bind(this),
this._processRejectReason.bind(this)):(new c(p,l)).then(this._processResolveValue.bind(this),this._processRejectReason.bind(this));return}}catch(r){0===this._state&&this._doReject(r);return}n.call(this,l)}},_callResolveHandlers:function(){this._done();for(var l=this._fulfills,n;n=l.shift();)d(n[0],n[1],[this._value]);this._cleanup()},_doResolve:function(l){this._value=l;this._state=1;0===this._wait&&this._callResolveHandlers()},_processResolveValue:function(l){this._processValue(l,this._doResolve,
!0)},resolve:function(l){if(this._triggered)return this;this._triggered=!0;this._processResolveValue(l);return this},_callRejectHandlers:function(){this._fail();for(var l=this._rejects,n;n=l.shift();)d(n[0],n[1],[this._reason]);this._cleanup()},_doReject:function(l){this._state=2;this._reason=l;0===this._wait&&this._callRejectHandlers()},_processRejectReason:function(l){this._processValue(l,this._doReject,!1)},reject:function(l){if(this._triggered)return this;this._triggered=!0;this._processRejectReason(l);
return this},then:function(l,n,m){var p=new c,r=this._state;m&&(l&&(l=l.bind(m)),n&&(n=n.bind(m)));0===r||0!==this._wait?(l&&G(l)?this._fulfills.push([b(l,p),null]):this._fulfills.push([p.resolve,p]),n&&G(n)?this._rejects.push([b(n,p),null]):this._rejects.push([p.reject,p])):1===r?l&&G(l)?d(b(l,p),null,[this._value]):p.resolve(this._value):2===r&&(n&&G(n)?d(b(n,p),null,[this._reason]):p.reject(this._reason));return p},"catch":function(l){return this.then(null,l)},_done:function(){for(var l=this._dones,
n;n=l.shift();)try{n[0].call(n[1]||null,this._value)}catch(m){S(m)}},done:function(l,n){var m=this._state;if(1===m&&0===this._wait)try{l.call(n||null,this._value)}catch(p){S(p)}else(0===m||0<this._wait)&&this._dones.push([l,n]);return this},_fail:function(){for(var l=this._fails,n;n=l.shift();)try{n[0].call(n[1]||null,this._reason)}catch(m){S(m)}},fail:function(l,n){var m=this._state;if(2===m&&0===this._wait)try{l.call(n||null,this._reason)}catch(p){S(p)}else(0===m||0<this._wait)&&this._fails.push([l,
n]);return this},always:function(l,n){this.done(l,n);this.fail(l,n);return this},promise:function(){return{then:this.then.bind(this),done:this.done.bind(this),fail:this.fail.bind(this),always:this.always.bind(this),"catch":this["catch"].bind(this)}},after:function(l){var n=this;if(Q(l)){n._wait++;var m=function(){n._wait--;0===n._wait&&0!==n._state&&3!==n._state&&(1===n._state?n._callResolveHandlers():n._callRejectHandlers())};G(l.done)?l.done(m):l.then(m)}return n},$destroy:function(){this._cleanup();
0===this._state&&(this._state=3)}},!0,!1);c.fcall=function(l,n,m){return c.resolve(l.apply(n,m||[]))};c.resolve=function(l){var n=new c;n.resolve(l);return n};c.reject=function(l){var n=new c;n.reject(l);return n};c.all=function(l){function n(y,w){r[w]=y;q--;0===q&&m.resolve(r)}if(!l.length)return c.resolve(null);var m=new c,p=l.length,r=Array(p),q=p,t,u;for(t=0;t<p;t++)(function(y){u=l[t];u instanceof c?u.done(function(w){n(w,y)}).fail(m.reject,m):Q(u)||G(u)?(new c(u)).done(function(w){n(w,y)}).fail(m.reject,
m):n(u,y)})(t);return m};c.when=function(){return c.all(arguments)};c.allResolved=function(l){function n(){t--;0===t&&p.resolve(q)}function m(w){q.push(w);n()}if(!l.length)return c.resolve(null);var p=new c,r=l.length,q=[],t=r,u;for(u=0;u<r;u++){var y=l[u];y instanceof c?y.done(m).fail(n):Q(y)||G(y)?(new c(y)).done(m).fail(n):m(y)}return p};c.race=function(l){if(!l.length)return c.resolve(null);var n=new c,m=l.length,p;for(p=0;p<m;p++){var r=l[p];r instanceof c?r.done(n.resolve,n).fail(n.reject,n):
Q(r)||G(r)?(new c(r)).done(n.resolve,n).fail(n.reject,n):n.resolve(r);if(!n.isPending())break}return n};c.waterfall=function(l){if(!l.length)return c.resolve(null);var n=l.shift();n=G(n)?c.fcall(n):c.resolve(m);for(var m;m=l.shift();)Q(m)?n=n.then(function(p){return function(){return p}}(m)):G(m)?n=n.then(m):n.resolve(m);return n};c.forEach=function(l,n,m,p){function r(){if(q.length){var w=q.shift(),v=y;y++;c.fcall(n,m,[w,v]).done(function(x){u.push(x);r()}).fail(function(x){p?t.reject(x):(u.push(null),
r())})}else t.resolve(u)}var q=l.slice(),t=new c,u=[],y=0;r();return t};c.counter=function(l){var n=new c;n.countdown=function(){l--;0===l&&n.resolve()};return n};return c}()}).call(this,Wa);R.app.prebuilt=function(){function a(l){l=e(l,b);"function"===typeof l&&(l={getterFn:l});!l.inputPipes&&(l.inputPipes=[]);!l.pipes&&(l.pipes=[]);l.inflated=!0;return l}function c(l){var n,m=0;for(n in l)l[n]&&"expr"!==n?H(l[n])&&0===l[n].length?delete l[n]:m++:delete l[n];1===m&&l.getterFn&&(l=l.getterFn);return l}function b(l){return h.isKey(l)?g.func[l]:l}function d(l){if("function"===typeof l){var n=l.toString();n=n.replace(/[\n\r]/g,"");n=n.replace(/\s+/g," ");n=n.replace(" anonymous","");f[n]||
(f[n]=h.add("func",l),(l=R.lib.Expression.describeExpression(n))&&h.add("funcDescr",l,f[n]));l=f[n]}return l}function e(l,n){if(H(l)){var m;var p=0;for(m=l.length;p<m;p++)l[p]=e(l[p],n)}else if(ea(l))for(p in l)l[p]=e(l[p],n);return n(l)}var g=R.prebuilt||{},f={},h={deflate:function(l){return c(l)},inflate:function(l){return a(l)},get:function(l,n){(l=g[l]?g[l][n]:void 0)&&!l.inflated&&(l=a(l));return l},add:function(l,n,m){m=m||"~"+E()+"~";!g[l]&&(g[l]={});"func"!==l&&(n=e(n,d));g[l][m]=c(n);return m},
isKey:function(l){return"string"===typeof l&&"~"===l[0]&&"~"===l[l.length-1]},getStorage:function(){return g},setStorage:function(l){g=l}};return h}();R.lib.Text=function(){function a(g,f,h){h=h||{};this.id=E();this.origin=f;this.text="";this.scope=g;this.once=this.recursive=this.fullExpr=this.$destroyed=!1;if(!0===h.recursive||!1===h.recursive)this.recursive=h.recursive;if(!0===h.fullExpr||!1===h.fullExpr)this.fullExpr=h.fullExpr;if(!0===h.once||!1===h.once)this.once=h.once;this._processDelegate=this._process.bind(this);this.observers=[];this._process(!0)}function c(g,f,h,l,n){var m=g,p=0;if(!1===g)return!1;for(;;){if(100<p)throw Error("Got more than 100 iterations on template: "+
self.origin);if(n){var r=d(g,f,h);n=!1}else r=b(m,function(q){return d(q,f,h)});if(!l||r===m)return r;m=r;p++}}function b(g,f){for(var h=0,l=g.length,n,m,p="";h<l;)if(-1!==(n=g.indexOf("{{",h))&&-1!==(m=g.indexOf("}}",n+2))&&"\\"!==g.substr(n-1,1))p+=g.substring(h,n),m!==n+2&&(h=g.substring(n+2,m),h=h.trim(),p+=f(h)),h=m+2;else{h!==l&&(p+=g.substring(h));break}return p}function d(g,f,h){if(h)return g=R.lib.MutationObserver.get(f,g),h.push(g),g.getValue();R.app.prebuilt.isKey(g)&&(g=R.app.prebuilt.get("config",
g));return R.lib.Expression.get(g,f)}var e=new R.lib.Observable;D(a.prototype,{_process:function(g){if(!this.$destroyed){var f=this.observers.slice();this._observeData(f,"unsubscribe");this.observers=[];this.text=c(this.origin,this.scope,this.observers,this.recursive,this.fullExpr);this._observeData(this.observers,"subscribe");this._destroyObservers(f);g||e.trigger(this.id,this)}},_onDataChange:function(){F(this._processDelegate)},_observeData:function(g,f){var h;var l=0;for(h=g.length;l<h;l++)g[l][f](this._onDataChange,
this)},_destroyObservers:function(g){var f;var h=0;for(f=g.length;h<f;h++)g[h].$destroy(!0)},getString:function(){return this.text},subscribe:function(g,f,h){return e.on(this.id,g,f,h)},unsubscribe:function(g,f){return e.un(this.id,g,f)},check:function(){return R.lib.MutationObserver.check(this.scope)},$destroy:function(){this.$destroyed=!0;e.destroyEvent(this.id);this._observeData(this.observers,"unsubscribe");this._destroyObservers(this.observers)}});a.render=c;a.eachText=b;a.applicable=function(g){return!R.app.prebuilt.isKey(g)&&
g&&g.indexOf&&-1!==g.indexOf("{{")?!0:!1};return a}();R.dom=R.dom||{};R.dom.setAttr=function(a,c,b){return a.setAttribute(c,b)};R.dom.commentWrap=function(a,c){c=c||"";var b=window.document.createComment("<"+c);c=window.document.createComment(c+">");var d=a.parentNode;d.insertBefore(b,a);a.nextSibling?d.insertBefore(c,a.nextSibling):d.appendChild(c);return[b,c]};R.lib.Config=function(){function a(b,d,e){this.id=E();this.values={};this.properties={};this.cfg=d||{};this.keys=[];b&&this.addProperties(b,e)}var c=new R.lib.Observable;D(a.prototype,{id:null,properties:null,values:null,keys:null,cfg:null,_initMo:function(b,d){var e=this.properties[b];e.mo=R.lib.MutationObserver.get(e.scope||this.cfg.scope,d||e.expression);e.mo.subscribe(this._onPropMutated,this,{append:[b]})},_unsetMo:function(b){b=this.properties[b];b.mo&&(b.mo.unsubscribe(this._onPropMutated,
this),b.mo.$destroy(!0),b.mo=null)},storeAsCode:function(b){b=this.getProperty(b);var d;if(!b||!b.expression)return null;var e=b.mode||b.defaultMode||2;var g=b.expression;1!==e&&(d=R.lib.Expression.describeExpression(g));switch(e){case 1:"string"===typeof g&&(g=g.replace(/\\([\s\S])|(")/g,"\\$1$2"));var f={getterFn:new Function("",'return "'+g+'"'),mode:1};break;case 3:case 2:case 6:case 4:case 5:case 7:f=R.lib.Expression.deconstruct(g,{noReturn:6===e||5===e,setter:5===e||7===e});break;case 8:e=-1===
g.indexOf("(")&&-1===g.indexOf("="),f=R.lib.Expression.expression(g,{noReturn:!1===e}),f.delegate=e}b.inflate&&(f.inflate=b.inflate);f.descr=d;return f},_calcProperty:function(b){var d=this.getProperty(b);if(!d||d.disabled)return null;if(d.expression||d.prebuilt){var e=d.prebuilt;!e&&R.app.prebuilt.isKey(d.expression)&&(d.prebuilt=e=R.app.prebuilt.get("config",d.expression));d.mode||(d.mode=this.cfg.defaultMode||2);if(1===d.mode)var g=e?e.getterFn():d.expression;else 3===d.mode?g=e?(e.getterFn||e.fn)(d.scope||
this.cfg.scope):R.lib.Expression.get(d.expression,d.scope||this.cfg.scope):2===d.mode?(!d.mo&&this._initMo(b,e),g=d.mo.getValue()):4===d.mode||5===d.mode?g=e?R.lib.Expression.construct(e,{setterOnly:5===d.mode,getterOnly:4===d.mode}):R.lib.Expression.parse(d.expression,{setter:5===d.mode,setterOnly:5===d.mode,getterOnly:4===d.mode}):7===d.mode?g=e?{getter:R.lib.Expression.construct(e,{getterOnly:!0}),setter:R.lib.Expression.construct(e,{setterOnly:!0})}:{getter:R.lib.Expression.getter(d.expression),
setter:R.lib.Expression.setter(d.expression)}:6===d.mode?g=e?e.fn||e.getterFn:R.lib.Expression.func(d.expression):8===d.mode&&(e?g=e.delegate?e.getterFn(d.scope||this.cfg.scope):this._wrapListener(e.fn||e.getterFn,d.scope||this.cfg.scope,d):-1===d.expression.indexOf("(")&&-1===d.expression.indexOf("=")?g=R.lib.Expression.get(d.expression,d.scope||this.cfg.scope):(g=R.lib.Expression.func(d.expression))&&"function"===typeof g&&(g=this._wrapListener(g,d.scope||this.cfg.scope,d)))}void 0===g&&(g=d.defaultValue);
e=this._prepareValue(g,d);void 0!==g&&(this.values[b]=e);(d=this.cfg.setTo||d.setTo)&&(d[b]=e);return e},_wrapListener:function(b,d){return function(){var e=B(arguments),g;var f=0;for(g=e.length;f<g;f++)d["$"+(f+1)]=e[f];b(d);f=0;for(g=e.length;f<g;f++)delete d["$"+(f+1)]}},_prepareValue:function(b,d){if(!d.type)return b;!0===b&&"bool"!==d.type&&"boolean"!==d.type&&d.defaultValue&&(b=d.defaultValue);switch(d.type){case "int":return parseInt(b);case "float":case "number":return parseFloat(b);case "bool":case "boolean":return za(b);
case "array":case "list":return H(b)?b:[b];case "string":case "str":return null===b||void 0===b?"":""+b}return b},_onPropMutated:function(b,d,e){var g=this.properties[e],f=g.setTo||this.cfg.setTo;b=this._prepareValue(b,g);this.values[e]=b;f&&(f[e]=b);c.trigger(this.id,e,b,d);c.trigger(this.id+"-"+e,b,d)},setOption:function(b,d){this.cfg[b]=d},getOption:function(b){return this.cfg[b]},addProperties:function(b,d,e){var g;for(g in b){var f=b[g];if(null!==f&&void 0!==f){if(R.app.prebuilt.isKey(f)){var h=
R.app.prebuilt.get("config",f);h={expression:f,prebuilt:h}}else"string"===typeof f?(h={},h[d||"expression"]=f):Aa(f)?h={defaultValue:f}:(h=f,!h.expression||"string"!==typeof h.expression||h.mode||"defaultValue"!==d||this.properties[g]&&this.properties[g].mode||(h.mode=2));this.setProperty(g,h,void 0,e)}}},setProperty:function(b,d,e,g){var f=this.properties,h=!1,l={};void 0===g&&(g=!0);f[b]||(f[b]={},this.keys.push(b),h=!0);d||(d={});f=f[b];if(!0===f.final)return!1;if(void 0===e||null===e)for(var n in d)if("value"===
n)var m=d[n];else{if(void 0===f[n]||d[n]!==f[n]&&g)l[n]=!0,f[n]=d[n]}else if("value"===d)m=e;else if(void 0===f[d]||f[d]!==e&&g)l[d]=!0,f[d]=e;f.mode||(f.defaultMode?f.mode=f.defaultMode:!0===f.expression||!1===f.expression?f.mode=1:this.cfg.defaultMode?f.mode=this.cfg.defaultMode:h&&void 0!==m&&null!==m&&(f.mode=1));f.scope||(f.scope=this.cfg.scope);2!==f.mode||!f.expression||f.mo||f.disabled||this._initMo(b);void 0!==m&&null!==m?this.values[b]=m:void 0!==this.values[b]&&(l.mode||l.expression||!f.mode&&
l.defaultMode)&&delete this.values[b]},getProperty:function(b){return this.properties[b]||null},copyProperty:function(b){var d=this.properties[b];return d?(d=D({},d,!1,!1),d.scope=d.scope||this.cfg.scope,delete d.mo,1!==d.mode&&(d.mode||d.defaultMode)||void 0===this.values[b]||(d.value=this.values[b]),d):null},getMode:function(b){return(b=this.getProperty(b))?b.mode||null:null},getExpression:function(b){return(b=this.getProperty(b))?b.expression||null:null},getAll:function(){var b,d={};for(b in this.properties)this._isValue(this.values[b])?
d[b]=this.values[b]:d[b]=this._calcProperty(b);return d},_isValue:function(b){return void 0!==b&&null!==b&&!("number"===typeof b&&isNaN(b))},eachProperty:function(b,d){for(var e in this.properties)b.call(d,e,this.properties[e],this)},hasProperty:function(b){return!!this.properties[b]},hasExpression:function(b){return!(!this.properties[b]||!this.properties[b].expression&&!this.properties[b].prebuilt)},hasValue:function(b){return void 0!==this.values[b]},has:function(b){return this._isValue(this.values[b])||
this.properties[b]&&(void 0!==this.properties[b].defaultValue||void 0!==this.properties[b].expression||void 0!==this.properties[b].prebuilt)},_toggleProperty:function(b,d){var e=this.properties[b],g=e?e.disabled||!1:!1;e?g!==d&&(2===e.mode&&this[d?"_unsetMo":"_initMo"](b),e.disabled=d):this.setProperty(b,{disabled:d})},disableProperty:function(b){this._toggleProperty(b,!0)},enableProperty:function(b){this._toggleProperty(b,!1)},removeProperty:function(b){this.properties[b]&&(this._toggleProperty(b,
!0),delete this.properties[b],delete this.values[b],b=this.keys.indexOf(b),-1!==b&&this.keys.splice(b,1))},setMode:function(b,d,e){d={mode:d};void 0!==e&&(d.expression=e);this.setProperty(b,d)},setType:function(b,d,e,g,f){d&&this.setProperty(b,"type",d,f);e&&this.setProperty(b,"defaultMode",e,f);void 0!==g&&this.setProperty(b,"defaultValue",g,f)},setDefaultMode:function(b,d,e){this.setProperty(b,"defaultMode",d,e)},setDefaultValue:function(b,d,e){this.setProperty(b,"defaultValue",d,e)},makeLocalDynamic:function(b,
d,e){var g;e=e||this.cfg.scope;(g=this.properties[b])?g.final||g.mode&&1!==g.mode&&3!==g.mode||(g=this.get(b),this.setProperty(b,{expression:d,mode:2,scope:e}),this.values[b]=g,this.set(b,g)):this.setProperty(b,{expression:d,mode:2,scope:e})},setStatic:function(b,d){if(!this.properties[b]||!this.properties[b].final){var e=this.values[d];this.setMode(b,1);this.values[b]=d;e!=d&&(c.trigger(this.id,b,d,e),c.trigger(this.id+"-"+b,d,e))}},setFinal:function(b){this.setProperty(b,"final",!0)},set:function(b,
d){this.properties[b]||this.setProperty(b);var e=this.properties[b];switch(e.mode){case 2:!e.mo&&this._initMo(b);e.mo.setValue(d);break;case 4:case 6:case 5:case 7:throw Error("Incompatible property mode");case 3:case 1:this.setStatic(b,d);break;default:this.setStatic(b,d)}},getKeys:function(){return this.keys},getAllValues:function(){var b,d={};var e=0;for(b=this.keys.length;e<b;e++){var g=this.keys[e];if("value"===g)var f="";else if(0===g.indexOf("value."))f=g.replace("value.","");else continue;
d[f]=this.get(g)}return d},get:function(b){return this._isValue(this.values[b])?this.values[b]:this._calcProperty(b)},on:function(b,d,e,g){if("string"===typeof b)c.on(this.id+"-"+b,d,e,g);else c.on(this.id,b,d,e)},un:function(b,d,e){if("string"===typeof b)c.on(this.id+"-"+b,d,e);else c.on(this.id,b,d)},setTo:function(b){this.cfg.setTo=b},importConfig:function(b,d){var e,g=this.properties,f=this.values;for(e in b.properties)!b.properties.hasOwnProperty(e)||g[e]&&!d||(g[e]=D({},b.properties[e]),f[e]=
b.values[e])},slice:function(b,d){var e={},g,f={},h=this.properties;var l=0;for(g=b.length;l<g;l++){var n=b[l];h[n]&&(e[n]=D({},h[n],!1,!1),f[n]=this.values[n],delete e[n].mo)}b=new a(e,D({},this.cfg,d,!0,!1));b.values=f;return b},check:function(b){var d=b?[b]:this.keys,e,g=b?0:!1;var f=0;for(e=d.length;f<e;f++){var h=d[f];h=this.properties[h];if(h.mo){if(b)return h.mo.check();g+=h.mo.check()?1:0}}return g},checkScope:function(b){var d=this.properties[b];if(d){var e=d.scope||this.cfg.scope;b=d.prebuilt?
d.prebuilt.descr||"":R.lib.Expression.describeExpression(this.getExpression(b));return-1!==b.indexOf("r")?e.$root.$check():-1!==b.indexOf("p")?e.$parent?e.$parent.$check():e.$root.$check():e.$check()}},clear:function(){var b=this.id,d;if(null!==this.properties){for(d in this.properties)this._unsetMo(d),c.destroyEvent(b+"-"+d);c.destroyEvent(b);this.unsubscribe=this.subscribe=M}},$isDestroyed:function(){return null===this.properties},$destroy:function(){null!==this.properties&&this.clear();this.cfg=
this.values=this.properties=null}});a.MODE_STATIC=1;a.MODE_DYNAMIC=2;a.MODE_SINGLE=3;a.MODE_GETTER=4;a.MODE_SETTER=5;a.MODE_FUNC=6;a.MODE_FNSET=7;a.MODE_LISTENER=8;a.create=function(b,d,e){return b instanceof a?b:new a(b,d,e)};return a}();R.dom.isField=function(a){var c=a&&a.nodeName?a.nodeName.toLowerCase():null;a=a.type;return"input"!=c&&"textarea"!=c&&"select"!=c||"submit"==a||"reset"==a||"button"==a?!1:!0};R.dom.getInputValue=function(){var a=/\r/,c={option:function(b){var d=b.getAttribute("value")||b.value;return void 0!==d?d:(b.innerText||b.textContent).trim()},select:function(b){for(var d,e=b.options,g=b.selectedIndex,f=(b="select-one"===b.type||0>g)?null:[],h=b?g+1:e.length,l,n=0>g?h:b?g:0;n<h;n++)if(d=e[n],l=d.disabled||d.parentNode.disabled,(d.selected||n===g)&&!l){d=R.dom.getInputValue(d);if(b)return d;f.push(d)}return f},radio:function(b){return null===b.getAttribute("value")?"on":b.value},
checkbox:function(b){return null===b.getAttribute("value")?"on":b.value}};return function(b){var d,e;if((d=c[b.type]||c[b.nodeName.toLowerCase()])&&void 0!==(e=d(b,"value")))return e;e=b.value;return I(e)?e.replace(a,""):null==e?"":e}}();R.dom.getAttr=function(a,c){return a.getAttribute?a.getAttribute(c):null};R.dom.removeAttr=function(a,c){return a.removeAttribute(c)};R.dom.setInputValue=function(){var a={select:function(c,b){for(var d,e=c.options,g=B(b),f=e.length,h,l=-1;f--;)b=e[f],(h=-1!==g.indexOf(b.value))?(R.dom.setAttr(b,"selected","selected"),d=b.selected=!0):R.dom.removeAttr(b,"selected"),h||null===R.dom.getAttr(b,"default-option")||(l=f);d||(c.selectedIndex=l);return g}};a.radio=a.checkbox=function(c,b){if(H(b))return c.checked=-1!==b.indexOf(R.dom.getInputValue(c))};return function(c,b){if(c.nodeType===window.document.ELEMENT_NODE){null===b?b="":1===
ca(b)&&(b+="");var d=a[c.type]||a[c.nodeName.toLowerCase()];d&&void 0!==d(c,b,"value")||(c.value=b)}}}();R.lib.DomEvent=function(){var a=function d(b){if(b instanceof d)return b;if(!(this instanceof d))return new d(b);for(var e in b)if(!this[e])try{this[e]=b[e]}catch(h){}this.originalEvent=b;this.type=b.type;!this.target&&b.srcElement&&(this.target=b.srcElement);var g=b.button;if(void 0===this.pageX&&null!==b.clientX){var f=this.target?this.target.ownerDocument||window.document:window.document;e=f.documentElement;f=f.body;this.pageX=b.clientX+(e&&e.scrollLeft||f&&f.scrollLeft||0)-(e&&e.clientLeft||f&&
f.clientLeft||0);this.pageY=b.clientY+(e&&e.scrollTop||f&&f.scrollTop||0)-(e&&e.clientTop||f&&f.clientTop||0)}this.which||void 0===g||(this.which=g&1?1:g&2?3:g&4?2:0);this.isDefaultPrevented=b.defaultPrevented||void 0===b.defaultPrevented&&!1===b.returnValue?Ca:Ba;this.timeStamp=b&&b.timeStamp||(new Date).getTime()};D(a.prototype,{isDefaultPrevented:Ba,isPropagationStopped:Ba,isImmediatePropagationStopped:Ba,preventDefault:function(){var b=this.originalEvent;this.isDefaultPrevented=Ca;b.returnValue=
!1;b&&b.preventDefault&&b.preventDefault()},stopPropagation:function(){var b=this.originalEvent;this.isPropagationStopped=Ca;b.cancelBubble=!0;b&&b.stopPropagation&&b.stopPropagation()},stopImmediatePropagation:function(){var b=this.originalEvent;this.isImmediatePropagationStopped=Ca;b&&b.stopImmediatePropagation&&b.stopImmediatePropagation();this.stopPropagation()}},!0,!1);return a}();R.dom.normalizeEvent=function(a){return a instanceof R.lib.DomEvent?a:new R.lib.DomEvent(a)};var Xa=function(){function a(e){return function(g){var f=R.dom.normalizeEvent(g||window.event),h=slice.call(arguments,1),l=0,n=0,m=0,p=0;f.type="mousewheel";"detail"in f&&(n=-1*f.detail);"wheelDelta"in f&&(n=f.wheelDelta);"wheelDeltaY"in f&&(n=f.wheelDeltaY);"wheelDeltaX"in f&&(l=-1*f.wheelDeltaX);"axis"in f&&f.axis===f.HORIZONTAL_AXIS&&(l=-1*n,n=0);var r=0===n?l:n;"deltaY"in f&&(r=n=-1*f.deltaY);"deltaX"in f&&(l=f.deltaX,0===n&&(r=-1*l));if(0!==n||0!==l){var q=Math.max(Math.abs(n),Math.abs(l));if(!d||
q<d)d=q,"mousewheel"===f.type&&0===q%120&&(d/=40);"mousewheel"===f.type&&0===q%120&&(r/=40,l/=40,n/=40);r=Math[1<=r?"floor":"ceil"](r/d);l=Math[1<=l?"floor":"ceil"](l/d);n=Math[1<=n?"floor":"ceil"](n/d);this.getBoundingClientRect&&(q=this.getBoundingClientRect(),m=f.clientX-q.left,p=f.clientY-q.top);f.deltaX=l;f.deltaY=n;f.deltaFactor=d;f.offsetX=m;f.offsetY=p;f.deltaMode=0;h.unshift(f,r,l,n);b&&clearTimeout(b);b=setTimeout(c,200);return e.apply(this,h)}}}function c(){d=null}var b,d;a.events=function(){var e=
window.document;return"onwheel"in e||9<=e.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"]};return a}();R.dom.addListener=function(){var a=null,c=null;return function(b,d,e,g){null===a&&(b.addEventListener?(a="addEventListener",c=""):(a="attachEvent",c="on"));g=g||{};g.capture=g.capture||!1;if("mousewheel"===d){e=Xa(e);d=Xa.events();var f;var h=0;for(f=d.length;h<f;h++)b[a](c+d[h],e,g)}else b[a](c+d,e,g);return e}}();R.dom.removeListener=function(){var a=null,c=null;return function(b,d,e){null===a&&(b.removeEventListener?(a="removeEventListener",c=""):(a="detachEvent",c="on"));b[a](c+d,e)}}();var Za=R.dom.isAttached=function Ya(a){if(a===window)return!0;if(a.nodeType==window.document.TEXT_NODE)return a.parentElement?Ya(a.parentElement):!0;var b=window.document.documentElement;return a===b?!0:b.contains(a)};R.browser=R.browser||{};R.browser.isAndroid=function(){var a=null;return function(){null===a&&(a=parseInt((/android (\d+)/i.exec(navigator.userAgent)||[])[1],10)||!1);return a}}();var $a=R.browser.isIE=function(){var a;return function(){if(null===a){var c=navigator.userAgent;a=parseInt((/msie (\d+)/i.exec(c)||[])[1],10);isNaN(a)&&(a=parseInt((/trident\/.*; rv:(\d+)/i.exec(c)||[])[1],10)||!1)}return a}}();R.browser.hasEvent=function(){var a={},c;return function(b){if(void 0===a[b]){if("input"===b&&9==R.browser.isIE())return a[b]=!1;c||(c=window.document.createElement("div"));a[b]=!!("on"+b in c)}return a[b]}}();var ab=R.dom.select=function(a,c){c=c||window.document;return B(c.querySelectorAll(a))};R.lib.Input=function(){function a(d,e,g,f){if(d.$$input){if(e)d.$$input.on("change",e,g);return d.$$input}f=f||{};this.el=d;this.id=++b;this.inputType=d.type?d.type.toLowerCase():"none";this.dataType=f.type||R.dom.getAttr(d,"data-type")||this.inputType;this.listeners=[];if(e)this.on("change",e,g)}var c=new R.lib.Observable,b=0;D(a.prototype,{el:null,inputType:null,dataType:null,listeners:null,radio:null,keydownDelegate:null,changeInitialized:!1,$destroy:function(){var d;c.destroyEvent("change-"+this.id);
c.destroyEvent("key-"+this.id);this._addOrRemoveListeners(R.dom.removeListener,!0);this.el.$$input=null;for(d in this)this.hasOwnProperty(d)&&(this[d]=null)},_addOrRemoveListeners:function(d,e){var g=this.inputType,f=this.listeners,h=this.radio,l=this.el,n,m;var p=0;for(n=f.length;p<n;p++){var r=!!f[p][2];if(r===e){if("radio"===g)for(r=0,m=h.length;r<m;r++)d(h[r],f[p][0],f[p][1]);else d(l,f[p][0],f[p][1]);f[p][2]=!e}}},initInputChange:function(){var d=this.inputType;"radio"===d?this.initRadioInput():
"checkbox"===d?this.initCheckboxInput():this.initTextInput();this._addOrRemoveListeners(R.dom.addListener,!1);this.changeInitialized=!0},initRadioInput:function(){var d=this.el,e=d.name;if(R.dom.isAttached(d))d=d.ownerDocument;else for(;d.parentNode;)d=d.parentNode;this.radio=R.dom.select("input[name="+e+"]",d);this.onRadioInputChangeDelegate=this.onRadioInputChange.bind(this);this.listeners.push(["click",this.onRadioInputChangeDelegate,!1])},initCheckboxInput:function(){this.clicked=!1;this.onCheckboxInputChangeDelegate=
this.onCheckboxInputChange.bind(this);this.onCheckboxInputClickDelegate=this.onCheckboxInputClick.bind(this);this.listeners.push(["click",this.onCheckboxInputClickDelegate,!1]);this.listeners.push(["change",this.onCheckboxInputChangeDelegate,!1])},initTextInput:function(){function d(m){m=m||window.event;var p=m.keyCode;91===p||15<p&&19>p||37<=p&&40>=p||e(m)}function e(m){l||(l=setTimeout(function(){n(m);l=null},0))}var g=!1,f=this,h=f.listeners,l;R.browser.isAndroid()||"none"===f.inputType||(h.push(["compositionstart",
function(){g=!0},!1]),h.push(["compositionend",function(){g=!1;n()},!1]));var n=f.onTextInputChangeDelegate=function(m){if(!g)f.onTextInputChange(m)};R.browser.hasEvent("input")&&"none"!==f.inputType?h.push(["input",n,!1]):(h.push(["keydown",d,!1]),R.browser.hasEvent("paste")&&"none"!==f.inputType&&(h.push(["paste",e,!1]),h.push(["cut",e,!1])));"none"!==f.inputType&&h.push(["change",n,!1])},processValue:function(d){switch(this.dataType){case "number":case "float":case "double":if(""===d||isNaN(d=
parseFloat(d)))d=void 0;break;case "int":case "integer":if(""===d||isNaN(d=parseInt(d,10)))d=void 0;break;case "bool":case "boolean":return!("false"===d||"0"===d||0===d||"off"===d||!1===d||""===d)}return d},onTextInputChange:function(){var d=this.getValue();c.trigger("change-"+this.id,this.processValue(d))},_checkboxChange:function(){var d=this.el;c.trigger("change-"+this.id,this.processValue(d.checked?R.dom.getAttr(d,"value")||!0:!1))},onCheckboxInputChange:function(){this.clicked||this._checkboxChange();
this.clicked=!1},onCheckboxInputClick:function(){this._checkboxChange();this.clicked=!0},onRadioInputChange:function(d){d=d||window.event;c.trigger("change-"+this.id,this.processValue((d.target||d.srcElement).value))},setValue:function(d){var e=this.inputType,g;d=this.processValue(d);if("radio"===e){e=this.radio;var f=0;for(g=e.length;f<g;f++)e[f].checked=this.processValue(e[f].value)==d}else"checkbox"===e?(e=this.el,e.checked=!0===d||d==this.processValue(e.value)):(void 0===d&&(d=""),R.dom.setInputValue(this.el,
d));this.triggerChange()},getValue:function(){var d=this.inputType,e;if("radio"===d){d=this.radio;var g=0;for(e=d.length;g<e;g++)if(d[g].checked)return this.processValue(d[g].value);return null}return"checkbox"===d?this.processValue(this.el.checked?R.dom.getAttr(this.el,"value")||!0:!1):this.processValue(R.dom.getInputValue(this.el))},on:function(d,e,g,f){"change"!==d||this.changeInitialized?"key"!==d||this.keydownDelegate||(this.keydownDelegate=this.keyHandler.bind(this),this.listeners.push(["keydown",
this.keydownDelegate,!1]),R.dom.addListener(this.el,"keydown",this.keydownDelegate),c.createEvent("key-"+this.id,{returnResult:!1,triggerFilter:this.keyEventFilter})):this.initInputChange();return c.on(d+"-"+this.id,e,g,f)},un:function(d,e,g){return c.un(d+"-"+this.id,e,g)},onChange:function(d,e){return this.on("change",d,e)},unChange:function(d,e){return this.un("change",d,e)},onKey:function(d,e,g,f){return this.on("key",e,g,D({},f,{key:d}))},unKey:function(d,e,g){this.un("key",e,g)},keyEventFilter:function(d,
e){d=d.key;e=e[0];return"object"!==typeof d?d===e.keyCode:void 0!==d.ctrlKey&&d.ctrlKey!==e.ctrlKey||void 0!==d.shiftKey&&d.shiftKey!==e.shiftKey?!1:!(void 0!==d.keyCode&&d.keyCode!==e.keyCode)},keyHandler:function(d){c.trigger("key-"+this.id,R.dom.normalizeEvent(d||window.event))},triggerChange:function(){if("createEvent"in document){var d=document.createEvent("HTMLEvents");d.initEvent("change",!1,!0);this.el.dispatchEvent(d)}else this.el.fireEvent("onchange")}},!0,!1);a.get=function(d,e){return d.$$input?
d.$$input:e&&e.$app&&!d.type&&(e=e.$app.getParentCmp(d,!0))&&e.getInputApi?e.getInputApi():new a(d)};a.getValue=R.dom.getInputValue;a.setValue=R.dom.setInputValue;return a}();R.mixin.Observable={$$observable:null,$$callbackContext:null,$$events:null,$beforeInit:function(a){this.$$observable=new R.lib.Observable;this.$initObservable(a)},$initObservable:function(a){R.lib.Observable.$initHost(this,a,this.$$observable)},on:function(){var a=this.$$observable;return a?a.on.apply(a,arguments):null},un:function(){var a=this.$$observable;return a?a.un.apply(a,arguments):null},once:function(){var a=this.$$observable;return a?a.once.apply(a,arguments):null},trigger:function(){var a=
this.$$observable;return a?a.trigger.apply(a,arguments):null},$beforeDestroy:function(){this.$$observable.trigger("before-destroy",this)},$afterDestroy:function(){this.$$observable.trigger("destroy",this);this.$$observable.$destroy();this.$$observable=null}};R.lib.Cache=function(){function a(b){var d={},e=[];0==arguments.length&&(b=!0);return{addFinder:function(g,f,h){e[h?"unshift":"push"]({fn:g,context:f})},add:function(g,f,h){if(d[g]&&!1===d[g].rewritable)return d[g];d[g]={rewritable:"undefined"!=typeof h?h:b,value:f};return f},get:function(g,f){if(d[g])return d[g].value;if(e.length){var h;var l=0;for(h=e.length;l<h;l++){var n=e[l].fn.call(e[l].context,g,this);if(void 0!==n)return this.add(g,n,!0)}}if(void 0!==f)return this.add(g,f)},remove:function(g){var f=
d[g];f&&!0===f.rewritable&&delete d[g];return f?f.value:void 0},exists:function(g){return!!d[g]},eachEntry:function(g,f){for(var h in d)g.call(f,d[h].value,h)},clear:function(){d={}},$destroy:function(){this===c&&(c=null);this.remove=this.exists=this.destroy=this.get=this.add=b=d=null}}}var c;a.global=function(){c||(c=new a(!0));return c};return a}();R.lib.Namespace=function(a){function c(d,e){var g=b.get(d);if(void 0!==g||e)return g;e=d.split(".");var f=e.length,h=a;for(g=0;g<f;g++){var l=e[g];if(void 0===h[l])return;h=h[l]}h&&b.add(d,h);return h}a=a||{};var b=new R.lib.Cache(!1);this.register=function(d,e){var g=d.split("."),f=g.pop();var h=g.join(".");var l=g.length,n=a;if(b[h])d=[b[h],f,d];else{if(0<l)for(h=0;h<l;h++){var m=g[h];void 0===n[m]&&(n[m]={});n=n[m]}d=[n,f,d]}g=d[0];f=d[1];Da(g)&&void 0===g[f]&&(g[f]=e,b.add(d[2],e));return e};
this.exists=function(){return void 0!==c(ns,!0)};this.get=c;this.add=function(d,e){return b.add(d,e)};this.remove=function(d){return b.remove(d)};this.makeAlias=function(d,e){d=b.get(d);void 0!==d&&b.add(e,d);return d};this.$destroy=function(){var d;b.eachEntry(function(e){e&&e.$destroy&&e.$destroy()});b.$destroy();b=null;for(d in this)this[d]=null}};var bb=function(){function a(e){function g(n,m){return(m=I(m)&&e?e.get(m):m)?n instanceof m:!1}function f(n,m,p){n=n||{};var r=n.$class,q=p||n.$extends,t=n.$mixins;p=n.$mixinEvents||[];var u=n.$alias,y,w;if(q)if(I(q))var v=e.get(q);else v=q,q=v.$class||"";else v=h,q="";if(q&&!v)throw q+" not found";n.$class=r;n.$extends=q;delete n.$mixins;delete n.$mixinEvents;q=p;for(y=v;y;){var x=y.prototype;x.$mixinEvents&&(q=q.concat(x.$mixinEvents));y=y.$parent}y=q;q=Object.create(v.prototype);n.$constructor=
n.$constructor||d;c(q,n,v,!1,y);if(t)for(n=0,x=t.length;n<x;n++){var A=t[n];if(I(A)){if(!e)throw Error("Mixin "+A+" not found");A=e.get(A,!0)}var C=void 0,J=q,ba=y;for(C in A)A.hasOwnProperty(C)&&(-1!==ba.indexOf(C)?J[C].push(A[C]):J[C]||(J[C]=A[C]))}t=l(r);q.constructor=t;q.$self=t;q.$mixinEvents=p;t.prototype=q;for(w in h)"prototype"!==w&&h.hasOwnProperty(w)&&(t[w]=h[w]);for(w in v)"prototype"!==w&&v.hasOwnProperty(w)&&(t[w]=v[w]);if(m)for(w in m)"prototype"!==w&&m.hasOwnProperty(w)&&(t[w]=m[w]);
t.$parent=v;t.$self=t;e&&(r&&e.register(r,t),u&&e.register(u,t));return t}function h(){}function l(n){return function(){var m=[],p=[],r=arguments,q,t;if(!this)throw Error("Must instantiate via new: "+n);this.$plugins=[];(q=this.$constructor.apply(this,arguments))&&H(q)&&(r=q);var u=this.$plugins;var y=this.$pluginMap={};if(this.$beforeInit)for(q=-1,t=this.$beforeInit.length;++q<t;m.push([this.$beforeInit[q],this]));if(this.$afterInit)for(q=-1,t=this.$afterInit.length;++q<t;p.push([this.$afterInit[q],
this]));if(u&&u.length)for(q=0,t=u.length;q<t;q++){var w=u[q];if(I(w)){var v=w;w=e?e.get(w):null;if(!w)throw v+" not found";}w=new w(this,r);y[w.$class]=w;w.$beforeHostInit&&m.push([w.$beforeHostInit,w]);u[q]=w}q=-1;for(t=m.length;++q<t;m[q][0].apply(m[q][1],r));this.$init&&this.$init.apply(this,r);if(u&&u.length)for(q=0,t=u.length;q<t;q++)w=u[q],w.$afterHostInit&&p.push([w.$afterHostInit,w]);q=-1;for(t=p.length;++q<t;p[q][0].apply(p[q][1],r));}}e||(e=new R.lib.Namespace);D(h.prototype,{$class:null,
$extends:null,$plugins:null,$pluginMap:null,$mixins:null,$mixinEvents:["$beforeInit","$afterInit","$beforeDestroy","$afterDestroy"],$destroyed:!1,$destroying:!1,$constructor:M,$init:M,$beforeInit:[],$afterInit:[],$beforeDestroy:[],$afterDestroy:[],$callMixins:function(n){var m=this[n],p,r=B(arguments);r.shift();var q=0;for(p=m.length;q<p;q++)m[q].apply(this,r)},$getClass:function(){return this.$class},$is:function(n){return g(this,n)},$getParentClass:function(){return this.$extends},$intercept:function(n,
m,p,r,q){var t=this[n];this[n]=Fa(t||M,m,p||this,this,r,q);return t||M},$implement:function(n){var m=this.constructor;m&&m.$parent&&c(this,n,m.$parent,!0)},$addPlugin:function(n){var m=this.$pluginMap;if(I(n)){var p=n;n=e?e.get(n):null;if(!n)throw p+" not found";}else p=n.$class;if(m[p])throw p+" already initialized on this instance";n=new n(this);m[p]=n;this.$plugins.push(n)},$hasPlugin:function(n){return n?!!this.$pluginMap[n]:!1},$getPlugin:function(n){return n?this.$pluginMap[n]||null:null},$bind:function(n){var m=
this;return function(){if(!m.$isDestroyed())return n.apply(m,arguments)}},$isDestroyed:function(){return this.$destroying||this.$destroyed},$destroy:function(){var n=this.$beforeDestroy,m=this.$afterDestroy,p=this.$plugins,r;if(!this.$destroying&&!this.$destroyed){this.$destroying=!0;var q=-1;for(r=n.length;++q<r;n[q].apply(this,arguments));q=0;for(r=p.length;q<r;q++)p[q].$beforeHostDestroy&&p[q].$beforeHostDestroy.call(p[q],arguments);n=this.onDestroy.apply(this,arguments);q=-1;for(r=m.length;++q<
r;m[q].apply(this,arguments));q=0;for(r=p.length;q<r;q++)p[q].$destroy.apply(p[q],arguments);if(!1!==n)for(q in this)this.hasOwnProperty(q)&&(this[q]=null);this.$destroying=!1;this.$destroyed=!0}},onDestroy:function(){}});h.$self=h;h.$instantiate=function(){var n=arguments;switch(n.length){case 0:return new this;case 1:return new this(n[0]);case 2:return new this(n[0],n[1]);case 3:return new this(n[0],n[1],n[2]);case 4:return new this(n[0],n[1],n[2],n[3]);default:return Ea(this,n)}};h.$override=function(n){var m=
this.$self,p=this.$parent;m&&p&&c(m.prototype,n,p)};h.$extend=function(n,m){return f(n,m,this)};h.$destroy=function(){for(var n in this)this[n]=null};f.classManagerFactory=a;f.factory=function(n){var m=e?e.get(n):null,p=B(arguments).slice(1);if(!m)throw n+" not found";return m.$instantiate.apply(m,p)};f.isSubclassOf=function(n,m){var p=n,r=e?e.get:function(){};I(m)||(m=m.prototype.$class);for(I(n)&&(p=r(n));p&&p.prototype;){if(p.prototype.$class===m)return!0;p=p.$parent}return!1};f.isInstanceOf=g;
f.define=f;f.Namespace=R.lib.Namespace;f.BaseClass=h;f.ns=e;f.$destroy=function(){h.$destroy();h=null;e&&(e.$destroy(),e=null)};return f}function c(e,g,f,h,l){var n,m=f.prototype;for(n in g)if(g.hasOwnProperty(n)){var p=m[n];var r=g[n];e[n]=!G(r)||p&&!G(p)?r:b(f,n,r)}if(!h&&(e.$plugins=null,e.$pluginMap=null,l))for(g=0,f=l.length;g<f;g++)if(h=l[g],m[h]){if("function"===typeof m[h])throw Error("Cannot override method "+h+" with mixin event");e[h]=m[h].slice()}else e[h]=[]}function b(e,g,f){var $super=
e.prototype[g]||("$constructor"===g?e:M)||M;return function(){var l=this.$super;if(this.$destroyed)return this.$super=null;this.$super=$super;var n=f.apply(this,arguments);this.$super=l;return n}}function d(){this.$super&&this.$super!==M&&this.$super.apply(this,arguments)}return a}();var cb=new R.lib.Namespace;cb.register("MetaphorJs",R);cb.register("mjs",R);var U=bb(cb);var V=R.app.Directive=function(){function a(f,h){return f.priority-h.priority}var c={},b={},d={},e=[],g=!1;R.directive=R.directive||{attr:c,tag:b,component:d};return U({$mixins:[R.mixin.Observable],scope:null,node:null,component:null,attrSet:null,renderer:null,wrapperOpen:null,wrapperClose:null,_apis:["node"],_autoOnChange:!0,_initPromise:null,_nodeAttr:null,_initial:!0,_asyncInit:!1,$init:function(f,h,l,n,m){this.scope=f;this.config=l;this.renderer=n;this.attrSet=m;this._nodeAttr=h;this.initConfig();
this.initScope();this._asyncInit&&this.initAsyncInit();this.initNodeAttr();this._initPromise?this._initPromise.done(this.initDirective,this):this.initDirective()},initAsyncInit:function(){var f=this;f._initPromise=new R.lib.Promise;var h=new R.lib.Promise;f._initPromise.after(h);F(function(){f.$destroyed||h.resolve()})},initNodeAttr:function(){var f=this,h=f._nodeAttr;h instanceof window.Node?(f.node=h,f.initNode(h),f._initPromise&&f._initPromise.resolve()):h.$is&&h.$is("MetaphorJs.app.Component")?
(f.component=h,f.initComponent(h),f._initPromise&&f._initPromise.resolve()):Q(h)&&h.done(function(l){f._nodeAttr=l}).done(f.initNodeAttr,f)},initConfig:function(){var f=this.config;this.$self.initConfig(f,this);R.lib.Observable.$initHostConfig(this,f,this.scope)},initScope:function(){var f=this.scope;f.$on("destroy",this.onScopeDestroy,this);f.$on("reset",this.onScopeReset,this)},initComponent:function(f){var h=this._apis,l;var n=0;for(l=h.length;n<l;n++){var m=this.initApi(f,h[n]);Q(m)&&(!this._initPromise&&
(this._initPromise=new R.lib.Promise),this._initPromise.after(m))}},initNode:function(f){-1!==this._apis.indexOf("input")&&R.dom.isField(f)&&(this.input=R.lib.Input.get(f,this.scope))},initApi:function(f,h){var l=this;f=f.getApi(h,l.id);if(Q(f))return f.done(function(n){l._onApiResolved(h,n)});l._onApiResolved(h,f)},_onApiResolved:function(f,h){this[f]=h},initDirective:function(){this.initChange()},initChange:function(){var f;this.config.on("value",this.onScopeChange,this);if(this._autoOnChange&&
void 0!==(f=this.config.get("value")))this.onScopeChange(f,void 0)},createCommentWrap:function(f,h){f=R.dom.commentWrap(f,h||this.$class);this.wrapperOpen=f[0];this.wrapperClose=f[1]},onScopeDestroy:function(){this.$destroy()},onScopeReset:function(){},onScopeChange:function(f){this.saveStateOnChange(f)},saveStateOnChange:function(f){void 0!==this._prevState&&this.trigger("change",f,this._prevState);this._prevState=f},onDestroy:function(){Q(this.node)&&this.node.$destroy();this._initPromise&&this._initPromise.$destroy();
this.scope&&(this.scope.$un("destroy",this.onScopeDestroy,this),this.scope.$un("reset",this.onScopeReset,this));this.config&&this.config.$destroy();this.wrapperOpen&&this.wrapperOpen.parentNode&&this.wrapperOpen.parentNode.removeChild(this.wrapperOpen);this.wrapperClose&&this.wrapperClose.parentNode&&this.wrapperClose.parentNode.removeChild(this.wrapperClose);this.$super()}},{attr:{},tag:{},getDirective:function(f,h){return cb.get("MetaphorJs.directive."+f+"."+h)},registerAttribute:function(f,h,l){c[f]||
(e.push({priority:h,name:f,handler:c[f]=l}),g=!1)},getAttributes:function(){g||(e.sort(a),g=!0);return e},registerTag:function(f,h){b[f]||(b[f]=h)},registerComponent:function(f,h){h||(h=f);I(h)&&(h=cb.get(h,!0));d[f]||(d[f]=h)},resolveNode:function(f,h,l,n){if(f instanceof window.Node)l(f);else if(f.getApi){var m=f;f=f.getApi(n||"node",h);Q(f)?f.done(function(p){l(p,m)}):f&&l(f,m)}},initConfig:function(f){var h=R.lib.Config.MODE_LISTENER;f.setDefaultMode("callbackContext",R.lib.Config.MODE_SINGLE);
f.eachProperty(function(l){"on--"===l.substring(0,4)&&f.setMode(l,h)})}})}();R.dom.getAttrSet=function(){function a(h){return-1!==h.indexOf("--")?h:Ga(h)}function c(){return{directives:{},attributes:{},config:{},rest:{},references:[],renderer:{},at:null,__plain:!0,__directives:{},__attributes:{},__config:[],__remove:b}}function b(h,l,n){if("all"===l)b(h,"directives"),b(h,"attributes"),b(h,"config");else{if("directives"===l){for(p in this.__directives)d.call(this,h,p);return}if("directive"===l){d.call(this,h,n);return}if("attributes"===l)var m=this.__attributes;else if("attribute"===
l&&this.__attributes[n])m=[this.__attributes[n]];else if("config"===l)m=this.__config;else if("reference"===l)m=["#"+n];else if("references"===l){m=[];var p=0;for(l=this.references.length;p<l;p++)m.push("#"+this.references[p])}else"at"===l&&(m=["@"+this.at])}if(m)if(H(m))for(p=0,l=m.length;p<l;p++)R.dom.removeAttr(h,m[p]);else for(p in m)R.dom.removeAttr(h,m[p])}function d(h,l){var n=this.__directives,m,p,r;if(!this.inflated&&n[l]){var q=0;for(m=n[l].length;q<m;q++){var t=n[l][q];t.original&&R.dom.removeAttr(h,
t.original);if(r=t.names)for(t=0,p=r.length;t<p;t++)R.dom.removeAttr(h,r[t])}}}var e=/^([\[({#$@!])([^)\]}"':\*!]+)[\])}]?([:\*!]?)$/,g={"*":R.lib.Config.MODE_DYNAMIC,":":R.lib.Config.MODE_STATIC,"!":R.lib.Config.MODE_SINGLE,"":null},f={"{":"dir","(":"event","[":"attr",$:"cfg","!":"renderer"};return function(h){var l=c(),n,m,p=l.directives,r=l.__directives,q=!0;var t=H(h)?h:h.attributes;if(h.nodeType&&h.hasAttribute&&h.hasAttribute("mjs"))return l=R.prebuilt.configs[h.getAttribute("mjs")],D(l,c(),
!1,!1),l.inflated=!0,l;h=0;for(n=t.length;h<n;h++){var u=t[h].name;var y=t[h].value;var w=null;if(m=u.match(e)){q=!1;u=m[2];var v=m[1];w=g[m[3]];if("#"===v){l.references.push(u);continue}if("@"===v){l.at=u;continue}if("!"===v){l.renderer[a(u)]=!0;continue}}else if("mjs-"===u.substr(0,4))u=u.substr(4),v="{",q=!1;else{l.rest[u]=y;continue}if("$"===v)""===y&&(y=!0),l.config[a(u)]={expression:y,mode:w},l.__config.push(t[h].name);else if("("===v||"{"===v){m=u.split(".");u=m.shift();var x=m.length?m.join("."):
null;""===y&&(y=!0);p[u]||(p[u]={},r[u]={type:f[v],original:null,names:[]});x||(r[u].original=t[h].name);x&&"$"===x[0]?(v=a(x.substr(1)),p[u][v]={mode:w,expression:y,attr:t[h].name},r[u].names.push(t[h].name)):x?(v="value."+m.join("."),p[u][v]={mode:w,expression:y,attr:t[h].name},r[u].names.push(t[h].name)):p[u].value={mode:w,expression:y,attr:t[h].name}}else"["===v&&(l.attributes[u]=y,l.__attributes[u]=t[h].name)}for(u in p)-1!==u.indexOf("|")&&(m=u.split("|"),t=m[1],u!==t&&t&&(p[t]?H(p[t])||(p[t]=
[p[t]],r[t]=[r[t]]):(p[t]=[],r[t]=[]),H(p[t])&&(p[t].push(p[u]),r[t].push(r[u]),delete p[u],delete r[u]))),p[u]&&!H(p[u])&&(p[u]=[p[u]],r[u]=[r[u]]);l.directives=p;l.__directives=r;l.__plain=q;return l}}();R.app.Renderer=function(){function a(m){this.id=E();this.parent=m;this._texts=[];this._flowControlState={};this._treeState={countdown:0};n.createEvent("transclude-sources-"+this.id,"all");n.createEvent("rendered-"+this.id,{limit:1});if(m)m.on("destroy",this.$destroy,this)}function c(m,p,r,q,t,u){function y(A){if(A&&A.$destroy)if(u)if(u.$destroyed)A.$destroy();else u.on("destroy",A.$destroy,A);else p.$on("destroy",A.$destroy,A);else if("function"===typeof A)if(u)if(u.$destroyed)A();else u.on("destroy",
A);else p.$on("destroy",A)}q.setDefaultMode("scope",R.lib.Config.MODE_STATIC);var w=q.has("scope")?R.lib.Scope.$produce(q.get("scope"),p):p,v=p.$app||w.$app,x={$scope:w,$node:r,$config:q,$attrSet:t,$renderer:u};r=[w,r,q,u,t];q.has("scope")&&q.setOption("scope",w);m=v?v.inject(m,null,x,r):m.$instantiate?m.$instantiate.apply(m,r):m.apply(null,r);Q(m)?m.done(y):y(m);return m}function b(m,p){if(p)if(p.nodeType)m.push(p);else if(H(p))for(var r=-1,q=p.length;++r<q;b(m,p[r]));}var d=null,e=R.directive,g=
window.document.COMMENT_NODE,f=window.document.TEXT_NODE,h=window.document.ELEMENT_NODE,l={script:!0,template:!0,"mjs-template":!0,style:!0,link:!0},n=new R.lib.Observable;D(a.prototype,{id:null,parent:null,_flowControlState:null,_treeState:null,_texts:null,$destroyed:!1,on:function(m,p,r,q){return n.on(m+"-"+this.id,p,r,q)},un:function(m,p,r){return n.un(m+"-"+this.id,p,r)},trigger:function(m){arguments[0]=m+"-"+this.id;return n.trigger.apply(n,arguments)},attached:function(m){this.trigger("attached",
this,m)},detached:function(){this.trigger("detached",this)},flowControl:function(m,p){this._flowControlState[m]=p},_resetFC:function(){var m=this._flowControlState;m.waitFor=null;m.nodes=null;m.stop=!1;m.ignoreInside=!1;m.newScope=null},_checkFCState:function(m,p,r){var q=this._flowControlState;q.waitFor&&m&&m.push(q.waitFor);q.nodes&&p&&b(p,q.nodes);q.ignoreInside&&r&&(r.renderer.ignoreInside=!0);q.newScope&&(this._treeState.newScope=q.newScope);this._resetFC()},_processCommentNode:function(m){var p=
m.textContent||m.data;"##"===p.substring(0,2)&&this.trigger("reference","node",p.substring(2),m)},_processTextNode:function(m){var p=this._texts,r=m.textContent||m.nodeValue;R.lib.Text.applicable(r)&&(r=new R.lib.Text(this._treeState.scope,r),r.subscribe(this._onTextChange,this,{append:[p.length]}),p.push({node:m,tr:r}),this._renderText(p.length-1))},_processSlotNode:function(m){this.trigger("reference","node",m.getAttribute("name"),m);return!1},_processComponent:function(m,p,r){var q=new R.lib.Config(r.config,
{scope:this._treeState.scope}),t=R.app.Directive.getDirective("attr","cmp");q.setProperty("value",{mode:R.lib.Config.MODE_STATIC,expression:m});this.on("destroy",q.$destroy,q);return c(t,this._treeState.scope,p,q,r,this)},_processTag:function(m,p,r){var q=new R.lib.Config(r.config,{scope:this._treeState.scope});this.on("destroy",q.$destroy,q);return c(m,this._treeState.scope,p,q,r,this)},_processDirAttribute:function(m,p,r,q,t){r=new R.lib.Config(q,{scope:this._treeState.scope});this.on("destroy",
r.$destroy,r);return c(p,this._treeState.scope,m,r,t,this)},_processReferences:function(m,p){var r,q=this._treeState.scope;var t=0;for(r=p.references.length;t<r;t++){var u=p.references[t];"#"===u[0]?this.trigger("reference","node",u.substring(1),m):q[u]=m;R.dom.removeAttr(m,"#"+u)}},_processAttribute:function(m,p,r){var q=this._texts,t=r.attributes[p];t=new R.lib.Text(this._treeState.scope,t,{recursive:!!r.renderer.recursive,fullExpr:!R.lib.Text.applicable(t)});R.dom.removeAttr(m,r.__attributes[p]);
t.subscribe(this._onTextChange,this,{append:[q.length]});q.push({node:m,attr:p,tr:t});this._renderText(q.length-1)},_processNode:function(m,p){var r=m.nodeType;if(r===g)this._processCommentNode(m);else if(r===f)this._processTextNode(m);else if(r===h){this._resetFC();var q=m.tagName.toLowerCase();r=[];var t=[],u=this._flowControlState,y,w,v,x;p=p||R.dom.getAttrSet(m);"mjs-"===q.substr(0,4)&&(q=q.substr(4));if("slot"===q)return this._processSlotNode(m);if(p.renderer.ignore)return!1;if(p.__plain&&!e.component[q]&&
!e.tag[q])return;(y=e.component[q])?(p.__remove(m,"config"),this._processComponent(y,m,p)):(w=e.tag[q])&&this._processTag(w,m,p);if(u.stop)return!1;this._checkFCState(r,t,p);p.references&&p.references.length&&this._processReferences(m,p);y=0;for(v=d.length;y<v;y++)if(w=d[y].name,void 0!==(q=p.directives[w])&&!p.__directives[w].handled){p.__remove(m,"directive",w);p.__directives[w].handled=!0;var A=0;for(x=q.length;A<x;A++){this._processDirAttribute(m,d[y].handler,w,q[A],p);if(u.stop)return!1;this._checkFCState(r,
t,p)}}for(y in p.attributes)this._processAttribute(m,y,p);if(p.renderer.ignoreInside)return!1;if(r.length){var C=new R.lib.Promise;R.lib.Promise.all(r).done(function(J){b(t,J);C.resolve(t)});return C}return t.length?t:!0}return!0},processNode:function(m,p,r){this._treeState.scope=p;this._processNode(m,r)},process:function(m,p){d||(d=R.app.Directive.getAttributes());m&&(this._treeState.scope=p,m.nodeType?(this._treeState.countdown++,this._eachNode(m)):0===this._nodeChildren(null,m)&&0===this._treeState.countdown&&
this._onProcessingFinished())},_nodeChildren:function(m,p){var r=[];var q=this._treeState;if(m&&!0!==m){if(m.nodeType)return q.countdown+=1,this._eachNode(m),1;r=m.slice()}r.length||(r=B(p.childNodes||p));m=r.length;q.countdown+=m;for(q=-1;++q<m;this._eachNode(r[q]));return m},_eachNode:function(m){if(m){var p=this;var r=m.nodeName;var q={thisLevelScope:null,childLevelScope:null},t=p._treeState;r&&l[r.toLowerCase()]?0===--t.countdown&&p._onProcessingFinished():(r=p._processNode(m),t.newScope&&(q.thisLevelScope=
t.scope,q.childLevelScope=t.newScope,delete t.newScope),Q(r)?r.done(function(u){p._eachNodeRun(u,m,q)}):p._eachNodeRun(r,m,q))}},_eachNodeRun:function(m,p,r){var q=this._treeState;!1!==m&&(r.childLevelScope&&(q.scope=r.childLevelScope),this._nodeChildren(m,p),r.thisLevelScope&&(q.scope=r.thisLevelScope));0===--q.countdown&&this._onProcessingFinished()},_onProcessingFinished:function(){n.trigger("rendered-"+this.id,this)},_onTextChange:function(m,p){this._renderText(p)},_renderText:function(m){m=this._texts[m];
var p=m.tr.getString(),r=m.attr;if(void 0===p||null===p)p="";r?("value"===r?m.node.value=p:"class"===r?m.node.className=p:"src"===r&&(m.node.src=p),!1===p?R.dom.removeAttr(m.node,r):R.dom.setAttr(m.node,r,p)):m.node.nodeValue=p},$destroy:function(){var m=this._texts,p;if(!this.$destroyed){var r=-1;for(p=m.length;++r<p;m[r].tr.$destroy());this.parent&&this.parent.un("destroy",this.$destroy,this);n.trigger("destroy-"+this.id);n.destroyEvent("transclude-sources-"+this.id);n.destroyEvent("destroy-"+this.id);
n.destroyEvent("rendered-"+this.id);n.destroyEvent("reference-"+this.id);n.destroyEvent("reference-promise-"+this.id);n.destroyEvent("attached-"+this.id);for(var q in this)this.hasOwnProperty(q)&&(this[q]=null);this.$destroyed=!0}}});a.skip=function(m,p){l[m]=p};a.applyDirective=c;return a}();R.lib.LocalText=function(){function a(d){this.store={};d&&(this.locale=d)}function c(d,e){"pt_BR"===e&&(e="xbr");3<e.length&&(e=e.substr(0,-e.lastIndexOf("_")));switch(e){case "bo":case "dz":case "id":case "ja":case "jv":case "ka":case "km":case "kn":case "ko":case "ms":case "th":case "tr":case "vi":case "zh":return 0;case "af":case "az":case "bn":case "bg":case "ca":case "da":case "de":case "el":case "en":case "eo":case "es":case "et":case "eu":case "fa":case "fi":case "fo":case "fur":case "fy":case "gl":case "gu":case "ha":case "he":case "hu":case "is":case "it":case "ku":case "lb":case "ml":case "mn":case "mr":case "nah":case "nb":case "ne":case "nl":case "nn":case "no":case "om":case "or":case "pa":case "pap":case "ps":case "pt":case "so":case "sq":case "sv":case "sw":case "ta":case "te":case "tk":case "ur":case "zu":return 1===
d?0:1;case "am":case "bh":case "fil":case "fr":case "gun":case "hi":case "ln":case "mg":case "nso":case "xbr":case "ti":case "wa":return 0===d||1===d?0:1;case "be":case "bs":case "hr":case "ru":case "sr":case "uk":return 1===d%10&&11!==d%100?0:2<=d%10&&4>=d%10&&(10>d%100||20<=d%100)?1:2;case "cs":case "sk":return 1===d?0:2<=d&&4>=d?1:2;case "ga":return 1===d?0:2===d?1:2;case "lt":return 1===d%10&&11!==d%100?0:2<=d%10&&(10>d%100||20<=d%100)?1:2;case "sl":return 1===d%100?0:2===d%100?1:3===d%100||4===
d%100?2:3;case "mk":return 1===d%10?0:1;case "mt":return 1===d?0:0===d||1<d%100&&11>d%100?1:10<d%100&&20>d%100?2:3;case "lv":return 0===d?0:1===d%10&&11!==d%100?1:2;case "pl":return 1===d?0:2<=d%10&&4>=d%10&&(12>d%100||14<d%100)?1:2;case "cy":return 1===d?0:2===d?1:8===d||11===d?2:3;case "ro":return 1===d?0:0===d||0<d%100&&20>d%100?1:2;case "ar":return 0===d?0:1===d?1:2===d?2:3<=d&&10>=d?3:11<=d&&99>=d?4:5;default:return 0}}D(a.prototype,{store:null,locale:"en",setLocale:function(d){this.locale=d},
set:function(d,e){var g=this.store;void 0===g[d]&&(g[d]=e)},load:function(d){D(this.store,d,!1,!1)},get:function(d){return this.store[d]||(this===b?"-- "+d+" --":b.get(d))},plural:function(d,e){d="string"===typeof d?this.get(d):d;var g=c(e,this.locale);return H(d)?d[g]:ea(d)?d[e]?d[e]:1===e&&void 0!==d.one?d.one:0>e&&void 0!==d.negative?d.negative:d.other:d},$destroy:function(){this.store=null}},!0,!1);var b=new a;a.global=function(){return b};return a}();R.lib.Provider=function(){function a(){this.store={}}D(a.prototype,{store:null,instantiate:function(b,d,e,g){return b.$instantiate?b.$instantiate.apply(b,e):g?Ea(b,e):b.apply(d,e)},inject:function(b,d,e,g,f){e=e||{};g=g||[];var h=this;if(G(b))if(b.inject)g=b.inject.slice(),g.push(b),b=g;else return h.instantiate(b,d,g,f);else{if(I(b))return h.resolve(b,e);b=b.slice()}g=[];var l=b.pop(),n;var m=-1;for(n=b.length;++m<n;g.push(h.resolve(b[m],e)));return R.lib.Promise.all(g).then(function(p){return h.instantiate(l,
d,p,f)})},value:function(b,d){this.store[b]={type:1,value:d}},constant:function(b,d){var e=this.store;e[b]||(e[b]={type:2,value:d})},factory:function(b,d,e,g){fa(e)&&(g=e,e=null);this.store[b]={type:3,singleton:g,fn:d,context:e}},service:function(b,d,e){this.store[b]={type:4,singleton:e,fn:d}},provider:function(b,d){this.store[b+"Provider"]={name:b,type:5,fn:d,instance:null}},isResolved:function(b){return(b=this.store[b])&&(1===b.type||2===b.type)},resolve:function(b,d,e){var g=this.store,f;d=d||
{};e=e||[];if(void 0!==d[b])return d[b];if(f=g[b]){var h=f.type;if(1===h||2===h)return f.value;if(3===h)var l=this.inject(f.fn,f.context,d,e);else if(4===h)l=this.inject(f.fn,null,d,e,!0);else if(5===h)return f.instance||(f.instance=R.lib.Promise.resolve(this.inject(f.fn,null,d)).done(function(n){f.instance=n;g[f.name]={type:3,fn:n.$get,context:n}})),f.instance;f.singleton&&(f.type=1,f.value=l,3===h&&Q(l)&&l.done(function(n){f.value=n}));return d[b]=l}if(g[b+"Provider"])return this.resolve(b+"Provider",
d),this.resolve(b,d);if(this===c)throw Error("Could not provide value for "+b);return c.resolve(b)},$destroy:function(){this.store=null}},!0,!1);a.global=function(){return c};var c=new a;return a}();R.mixin.Provider={$$provider:null,$beforeInit:function(){this.$$provider=new R.lib.Provider},value:function(){var a=this.$$provider;return a.value.apply(a,arguments)},constant:function(){var a=this.$$provider;return a.constant.apply(a,arguments)},factory:function(){var a=this.$$provider;return a.factory.apply(a,arguments)},service:function(){var a=this.$$provider;return a.service.apply(a,arguments)},provider:function(){var a=this.$$provider;return a.provider.apply(a,arguments)},isResolved:function(){var a=
this.$$provider;return a.isResolved.apply(a,arguments)},resolve:function(){var a=this.$$provider;return a.resolve.apply(a,arguments)},inject:function(){var a=this.$$provider;return a.inject.apply(a,arguments)},$afterDestroy:function(){this.$$provider.$destroy();this.$$provider=null}};R.app.App=U({$mixins:[R.mixin.Observable,R.mixin.Provider],lang:null,scope:null,renderer:null,cmpPromises:null,cmpListeners:null,components:null,sourceObs:null,$init:function(a,c){var b=c instanceof R.lib.Scope?c:new R.lib.Scope(c);R.dom.removeAttr(a,"mjs-app");b.$app=this;this.$super();this.lang=new R.lib.LocalText;this.node=a;this.scope=b;this.cmpListeners={};this.components={};this.cmpPromises={};this.$refs={node:{},cmp:{}};this.factory("$parentCmp",["$node",this.getParentCmp],this);this.value("$app",
this);this.value("$rootScope",b.$root);this.value("$lang",this.lang);this.value("$locale",this.lang);this.renderer=new R.app.Renderer;this.renderer.on("rendered",this.afterRender,this);this.renderer.on("reference",this._onChildReference,this);var d=B(arguments);d[1]=b;this.initApp.apply(this,d)},initApp:M,afterRender:function(){},_onChildReference:function(a,c,b){this.$refs[a]||(this.$refs[a]={});this.$refs[a][c]=b},run:function(){this.renderer.process(this.node,this.scope)},createSource:function(a,
c){a="source-"+a;this.$$observable.getEvent(a)||this.$$observable.createEvent(a,c||"nonempty")},registerSource:function(a,c,b){this.on("source-"+a,c,b)},unregisterSource:function(a,c,b){this.un("source-"+a,c,b)},collect:function(a){arguments[0]="source-"+arguments[0];return this.trigger.apply(this,arguments)},getParentCmp:function(a,c){for(a=c?a:a.parentNode;a&&a!==window.document.documentElement;){if(c=a.$$cmpId)return this.getCmp(c);a=a.parentNode}return null},getRefEl:function(a){return this.$refs.node[a]},
onAvailable:function(a,c,b){var d=this.cmpPromises,e=this.components,g="available-"+a;this.$$observable.createEvent(g);if(c)this.$$observable.on(g,c,b);d[a]||(d[a]=new R.lib.Promise,this.$$observable.once(g,d[a].resolve,d[a]));e[a]&&this.$$observable.trigger(g,e[a]);return d[a]},getCmp:function(a){return this.components[a]||null},registerCmp:function(a,c){function b(){delete d.cmpPromises[e];delete d.components[e]}var d=this,e=a[c];d.components[e]=a;d.$$observable.trigger("available-"+e,a);if(a.on)a.on("destroy",
b)},onDestroy:function(){this.renderer.$destroy();this.scope.$destroy();this.lang.$destroy();this.$super()}});R.dom.data=function(a,c,b,d){var e="$$mjs-"+c;if("remove"===d)c&&delete a[e];else return void 0!==b?a[e]=b:a[e]};R.dom.toFragment=function(a,c){c=(c||window.document).createDocumentFragment();var b;if(I(a)){var d=window.document.createElement("div");d.innerHTML=a;a=d.childNodes}if(!a)return c;if(a.nodeType)c.appendChild(a);else{if(a.item){var e=a;a=[];d=-1;for(b=e.length>>>0;++d!==b;a.push(e[d]));}d=-1;for(b=a.length;++d!==b;c.appendChild(a[d]));}return c};R.dom.clone=function db(a){var b;if(H(a)){var d=[];var e=0;for(b=a.length;e<b;e++)d.push(db(a[e]));return d}if(a)switch(a.nodeType){case window.document.ELEMENT_NODE:return a.cloneNode(!0);case window.document.TEXT_NODE:return window.document.createTextNode(a.innerText||a.textContent);case window.document.DOCUMENT_FRAGMENT_NODE:return a.cloneNode(!0)}return null};R.animate=R.animate||{};R.animate.getPrefixes=function(){var a=["Moz","Webkit","ms","O","Khtml"],c="animationDelay",b="animationDuration",d="transitionDelay",e="transitionDuration",g="transform",f=null,h=null,l=!1;return function(){if(!l){var n=window.document.createElement("div"),m=!1,p;if(n.style&&void 0!==n.style.animationName)m=!0;else{var r=0;for(p=a.length;r<p;r++){var q=a[r];if(n.style&&void 0!==n.style[q+"AnimationName"]){m=!0;c=q+"AnimationDelay";b=q+"AnimationDuration";d=q+"TransitionDelay";e=q+"TransitionDuration";
g=q+"Transform";break}}}m&&("ontransitionend"in window?f="transitionend":"onwebkittransitionend"in window&&(f="webkitTransitionEnd"));h=m?{animationDelay:c,animationDuration:b,transitionDelay:d,transitionDuration:e,transform:g,transitionend:f}:{};l=!0}return h}}();R.animate.getDuration=function(){function a(h,l,n){var m,p=l.length;for(m=0;m<p;m++){var r=c(l[m])+c(n[m]);h=Math.max(r,h)}return h}function c(h){if(!h)return 0;var l=parseFloat(h);-1===h.indexOf("ms")&&(l*=1E3);return l}var b=!1,d=null,e=null,g=null,f=null;return function(h){!1===b&&(d=(b=R.animate.getPrefixes())?b.animationDuration:null,e=b?b.animationDelay:null,g=b?b.transitionDuration:null,f=b?b.transitionDelay:null);if(!b)return 0;var l=window.getComputedStyle?window.getComputedStyle(h,null):
h.style;h=0;var n=(l[d]||"").split(","),m=(l[e]||"").split(","),p=(l[g]||"").split(",");l=(l[f]||"").split(",");h=Math.max(h,a(h,n,m));return h=Math.max(h,a(h,p,l))}}();R.animate.isCssSupported=function(){var a=null;return function(){null===a&&(a=!!R.animate.getPrefixes());return a}}();R.animate.easing={linear:function(a){return a},easeInQuad:function(a){return a*a},easeOutQuad:function(a){return a*(2-a)},easeInOutQuad:function(a){return.5>a?2*a*a:-1+(4-2*a)*a},easeInCubic:function(a){return a*a*a},easeOutCubic:function(a){return--a*a*a+1},easeInOutCubic:function(a){return.5>a?4*a*a*a:(a-1)*(2*a-2)*(2*a-2)+1},easeInQuart:function(a){return a*a*a*a},easeOutQuart:function(a){return 1- --a*a*a*a},easeInOutQuart:function(a){return.5>a?8*a*a*a*a:1-8*--a*a*a*a},easeInQuint:function(a){return a*
a*a*a*a},easeOutQuint:function(a){return 1+--a*a*a*a*a},easeInOutQuint:function(a){return.5>a?16*a*a*a*a*a:1+16*--a*a*a*a*a}};R.dom.getClsReg=function(a){return Ha("(?:^|\\s)"+a+"(?!\\S)")};R.dom.hasClass=function(a,c){return c?a.classList?a.classList.contains(c):R.dom.getClsReg(c).test(a.className):!1};R.dom.addClass=function(a,c){c&&!R.dom.hasClass(a,c)&&(a.classList?a.classList.add(c):a.className+=" "+c)};R.dom.removeClass=function(a,c){c&&(a.classList?a.classList.remove(c):a.className=a.className.replace(R.dom.getClsReg(c),""))};var X=function(){if("undefined"!==typeof window){var a=window;var c=a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame;var b=a.cancelAnimationFrame||a.webkitCancelAnimationFrame||a.mozCancelAnimationFrame||a.webkitCancelRequestAnimationFrame;if(c)return function(d,e,g){var f=c(e||g?function(){d.apply(e,g||[])}:d);return function(){b(f)}}}return function(d,e,g){var f=F(d,e,g,0);return function(){clearTimeout(f)}}}();R.animate.animate=function(){function a(f,h,l,n){var m=new R.lib.Promise,p=R.dom.data(f,"mjsAnimationQueue")||[],r=++e;if(h){if(I(h))var q=d[h];else if(G(h))var t=h;else if(H(h))if(I(h[0]))q=h;else{var u=h[0];var y=h[1]}else if(ea(h)){q=h.stages;t=h.fn;u=h.before;y=h.after;var w=h.options?D({},h.options):{};var v=h.context||null;var x=h.duration||null;l=l||w.start}if(R.animate.isCssSupported()&&q)return p.push({el:f,stages:q,start:l,step:n,deferred:m,position:0,id:r}),R.dom.data(f,"mjsAnimationQueue",
p),1===p.length&&g(f,q,0,l,m,!0,r,n),m;if(h.draw)return c(f,h,m,l,n),m;w=w||{};l&&(w.start=function(){l(f)});w.complete=function(){m.resolve(f)};x&&(w.duration=x);if(t&&G(t))return u&&D(f.style,u,!0,!1),l&&l(f),R.dom.data(f,"mjsAnimationQueue",t.call(v,f,function(){m.resolve(f)})),m;if(window.jQuery){h=$(f);u&&h.css(u);R.dom.data(f,"mjsAnimationQueue","stop");if(t&&I(t))return h[t](w),m;if(y)return h.animate(y,w),m}}l?(t=l(f),Q(t)?t.done(function(){m.resolve(f)}):m.resolve(f)):m.resolve(f);return m}
function c(f,h,l,n,m){function p(){var x=((new Date).getTime()-v)/r;1<x&&(x=1);var A=q(x);if(ea(u)){var C={};for(var J in u)C[J]=w(t[J],u[J],A,J)}else C=w(t,u,A);y(f,C);m&&m(f,C);1>x?X(p):l.resolve(f)}var r=h.duration||500,q=h.timing||"linear",t=h.from,u=h.to,y=h.draw;q="string"===typeof q?R.animate.easing[q]:q;if(!q)throw Error("Missing easing function "+h.timing);"function"===typeof t&&(t=t(f));"function"===typeof u&&(u=u(f));var w=h.calc||function(x,A,C){return x+(A-x)*C},v=(new Date).getTime();
n&&n(f);p(v)}function b(f,h,l){function n(){(new Date).getTime()-h>=l?f():X(n)}X(n)}var d={show:["mjs-show"],hide:["mjs-hide"],enter:["mjs-enter"],leave:["mjs-leave"],move:["mjs-move"]},e=0,g=function u(h,l,n,m,p,r,q,t){function y(){x()||(R.dom.addClass(h,l[n]),R.lib.Promise.waterfall([t&&t(h,n,"start"),function(){return m?m(h):null}]).done(function(){!x()&&X(w)}))}function w(){x()||(R.dom.addClass(h,l[n]+"-active"),R.lib.Promise.resolve(t&&t(h,n,"active")).done(function(){if(!x()){var A=R.animate.getDuration(h);
A?b(v,(new Date).getTime(),A):X(v)}}))}function v(){if(!x()){var A=n;n++;if(n===l.length){p.resolve(h);R.dom.data(h,"mjsAnimationQueue").shift();var C=R.dom.data(h,"mjsAnimationQueue");C.length?(C=C[0],g(C.el,C.stages,0,C.start,C.deferred,!1,C.id,C.step)):R.dom.data(h,"mjsAnimationQueue",null)}else R.dom.data(h,"mjsAnimationQueue")[0].position=n,u(h,l,n,null,p,!1,q,t);R.dom.removeClass(h,l[A]);R.dom.removeClass(h,l[A]+"-active")}}function x(){var A=R.dom.data(h,"mjsAnimationQueue");return A&&A.length&&
A[0].id==q?!1:(p.reject(h),!0)}r?X(y):y()};a.addAnimationType=function(h,l){d[h]=l};return a}();R.mixin.Promise={$$promise:null,$beforeInit:function(){this.$$promise=new R.lib.Promise},then:function(){return this.$$promise.then.apply(this.$$promise,arguments)},done:function(){this.$$promise.done.apply(this.$$promise,arguments);return this},always:function(){this.$$promise.always.apply(this.$$promise,arguments);return this},fail:function(){this.$$promise.fail.apply(this.$$promise,arguments);return this}};R.ajax=R.ajax||{transport:{}};R.ajax.serializeParam=function(){function a(d,e,g){var f;if(H(e)){var h=0;for(f=e.length;h<f;h++){var l=e[h];b.test(d)?g(d,l):a(d+"["+("object"===typeof l?h:"")+"]",l,g)}}else if(ea(e))for(h in e)a(d+"["+h+"]",e[h],g);else g(d,e)}var c=/%20/g,b=/\[\]$/;return function(d){function e(h,l){l=G(l)?l():null==l?"":l;f[f.length]=encodeURIComponent(h)+"="+encodeURIComponent(l)}var g,f=[];for(g in d)a(g,d[g],e);return f.join("&").replace(c,"+")}}();R.ajax.transport.XHR=function(){var a={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"};return U({type:"xhr",_xhr:null,_deferred:null,_ajax:null,$init:function(c,b,d){var e;window.XMLHttpRequest&&(e=new XMLHttpRequest)||(e=new ActiveXObject("Msxml2.XMLHTTP"));this._xhr=e;this._deferred=b;this._opt=c;this._ajax=d;c.progress&&(e.onprogress=c.progress.bind(c.context));c.uploadProgress&&
e.upload&&(e.upload.onprogress=c.uploadProgress.bind(c.context));e.onreadystatechange=this.onReadyStateChange.bind(this)},setHeaders:function(){var c=this._opt,b=this._xhr,d;if(c.xhrFields)for(d in c.xhrFields)b[d]=c.xhrFields[d];c.data&&c.contentType&&b.setRequestHeader("Content-Type",c.contentTypeHeader||c.contentType);b.setRequestHeader("X-Requested-With","XMLHttpRequest");b.setRequestHeader("Accept",c.dataType&&a[c.dataType]?a[c.dataType]+", */*; q=0.01":a._default);for(d in c.headers)b.setRequestHeader(d,
c.headers[d])},onReadyStateChange:function(){var c=this._xhr,b=this._deferred;if(0===c.readyState)c.onreadystatechange=M,b.resolve(c);else if(4===c.readyState){c.onreadystatechange=M;a:{try{var d=!c.status&&window.location&&"file:"===window.location.protocol||200<=c.status&&300>c.status||304===c.status||1223===c.status;break a}catch(e){S(e)}d=!1}if(d)this._ajax.processResponse(I(c.responseText)?c.responseText:void 0,c.getResponseHeader("content-type")||"");else{c.responseData=null;try{this._ajax.$$promise=
new R.lib.Promise,c.responseData=this._ajax.returnResponse(I(c.responseText)?c.responseText:void 0,c.getResponseHeader("content-type")||""),this._ajax.$$promise=b}catch(e){S(e)}b.reject(c)}}},abort:function(){this._xhr.onreadystatechange=M;this._xhr.abort()},send:function(){var c=this._opt;try{this._xhr.open(c.method,c.url,!0,c.username,c.password),this.setHeaders(),this._xhr.send(c.data)}catch(b){S(b),this._deferred&&this._deferred.reject(b)}}})}();R.ajax.transport.Script=U({type:"script",_opt:null,_deferred:null,_ajax:null,_el:null,$init:function(a,c,b){this._opt=a;this._ajax=b;this._deferred=c},send:function(){var a=document.createElement("script");R.dom.setAttr(a,"async","async");R.dom.setAttr(a,"charset","utf-8");R.dom.setAttr(a,"src",this._opt.url);R.dom.addListener(a,"load",bind(this.onLoad,this));R.dom.addListener(a,"error",bind(this.onError,this));document.head.appendChild(a);this._el=a},onLoad:function(a){this._deferred&&this._deferred.resolve(a)},
onError:function(a){this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},onDestroy:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)}});R.ajax.transport.IFrame=U({type:"iframe",_opt:null,_deferred:null,_ajax:null,_el:null,_sent:!1,$init:function(a,c,b){this._opt=a;this._ajax=b;this._deferred=c},send:function(){function a(){g++;try{e.submit(),c._sent=!0}catch(f){S(f),2<g?c._deferred.reject(f):F(a,null,[],1E3)}}var c=this,b=document.createElement("iframe"),d="frame-"+E(),e=c._opt.form;R.dom.setAttr(b,"id",d);R.dom.setAttr(b,"name",d);b.style.display="none";document.body.appendChild(b);R.dom.setAttr(e,"action",c._opt.url);R.dom.setAttr(e,
"target",d);R.dom.addListener(b,"load",c.onLoad.bind(c));R.dom.addListener(b,"error",c.onError.bind(c));c._el=b;var g=0;a()},onLoad:function(){var a=this._el;if(this._sent&&this._opt&&!this._opt.jsonp)try{var c=a.contentDocument||a.contentWindow.document;var b=c.body.innerHTML;this._ajax.processResponse(b)}catch(d){S(d),this._deferred.reject(d)}},onError:function(a){this._sent&&this._deferred.reject(a)},abort:function(){this._el.parentNode&&this._el.parentNode.removeChild(this._el)},onDestroy:function(){this._el.parentNode&&
this._el.parentNode.removeChild(this._el)}});R.ajax.transport.Fetch=function(){var a={xml:"application/xml, text/xml",html:"text/html",script:"text/javascript, application/javascript",json:"application/json, text/javascript",text:"text/plain",_default:"*/*"};return U({type:"fetch",_deferred:null,$init:function(c,b,d){this._deferred=b;this._opt=c;this._ajax=d;c.body=c.data},setHeaders:function(){var c=this._opt;c.headers=c.headers||{};c.data&&c.contentType&&(c.headers["Content-Type"]=c.contentTypeHeader||c.contentType);c.headers["X-Requested-With"]=
"Fetch";c.headers.Accept=c.dataType&&a[c.dataType]?a[c.dataType]+", */*; q=0.01":a._default},send:function(){var c=this,b=c._opt,d;try{c.setHeaders();var e=window.fetch(b.url,b);e.then(function(g){d=g.headers.map["content-type"]||"";return g.text()},function(g){c._deferred.reject(g)}).then(function(g){c._ajax.processResponse(g,d)})}catch(g){error(g),c._deferred=new R.lib.Promise,c._deferred&&c._deferred.reject(g)}}})}();(function(a){R.ajax.Ajax=function(){function c(q){var t=eval;q&&(/^[^\S]*use strict/.test(q)?(t=document.createElement("script"),t.text=q,document.head.appendChild(t).parentNode.removeChild(t)):t(q))}function b(q){for(var t,u,y={},w=0;w<q.elements.length;w++)if(t=q.elements[w],null!==R.dom.getAttr(t,"name"))if(u="INPUT"===t.nodeName.toUpperCase()?R.dom.getAttr(t,"type").toUpperCase():"TEXT","FILE"===u)for(u=0;u<t.files.length;y[t.name]=t.files[u++].name);else if("RADIO"!==u&&"CHECKBOX"!==u||t.checked)y[t.name]=
t.value;return R.ajax.serializeParam(y)}function d(q,t,u){var y;if(!Da(q)&&!G(q)&&u){var w=document.createElement("input");R.dom.setAttr(w,"type","hidden");R.dom.setAttr(w,"name",u);R.dom.setAttr(w,"value",q);t.appendChild(w)}else if(H(q)&&u)for(w=0,y=q.length;w<y;w++)d(q[w],t,u+"["+w+"]");else if(Da(q))for(w in q)q.hasOwnProperty(w)&&d(q[w],t,u?u+"["+w+"]":w)}function e(q,t){q.replace(n,"");if(!t.allowCache){var u=(new Date).getTime();q=m.test(q)?q.replace(m,"$1_="+u):q+(h.test(q)?"&":"?")+"_="+
u}!t.data||"POST"==t.method||t.contentType||r&&t.data instanceof window.FormData||(t.data=I(t.data)?t.data:R.ajax.serializeParam(t.data),q+=(h.test(q)?"&":"?")+t.data,t.data=null);return q}function g(q){return"/"==q.substr(0,1)?location.protocol+"//"+location.host+q:q}function f(q,t,u){var y=t?t.dataType:null;t=t?t.selector:null;if(!I(q))return q;u=u||"";if("xml"===y||!y&&0<=u.indexOf("xml"))return q=Ia(q.trim()),t?R.dom.select(t,q):q;if("html"===y)return q=Ia(q,"text/html"),t?R.dom.select(t,q):q;
if("fragment"==y){u=document.createDocumentFragment();y=document.createElement("div");for(y.innerHTML=q;y.firstChild;)u.appendChild(y.firstChild);return u}if("json"===y||!y&&0<=u.indexOf("json"))return JSON.parse(q.trim());("script"===y||!y&&0<=u.indexOf("javascript"))&&c(q);return q+""}var h=/\?/,l=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,n=/#.*$/,m=/([?&])_=[^&]*/,p=new R.lib.Observable,r=!(!window||!window.FormData);return U({$mixins:[R.mixin.Promise],_jsonpName:null,_transport:null,
_opt:null,_deferred:null,_promise:null,_timeout:null,_form:null,_removeForm:!1,$init:function(q){q.url&&(q.url=g(q.url));q.transport=q.transport||R.ajax.Ajax.defaultTransport;var t=l.exec((window?window.location.href:"").toLowerCase())||[],u=l.exec(q.url.toLowerCase());this._opt=q;!0!==q.crossDomain&&!0!==q.ignoreCrossDomain&&(q.crossDomain=!(!u||u[1]===t[1]&&u[2]===t[2]&&(u[3]||("http:"===u[1]?"80":"443"))===(t[3]||("http:"===t[1]?"80":"443"))));var y;q.files&&!r&&(q.transport="iframe");"iframe"!=
q.transport||q.form?q.form&&(this._form=q.form,"POST"!=q.method||r||(q.transport="iframe")):(this.createForm(),q.form=this._form);if(q.form&&"iframe"!=q.transport&&"POST"==q.method)r?q.data=new FormData(q.form):(q.contentType="application/x-www-form-urlencoded",q.data=b(q.form));else if("json"===q.contentType)q.contentType=q.contentTypeHeader||"application/json",q.data=I(q.data)?q.data:JSON.stringify(q.data);else if(ea(q.data)&&"POST"==q.method&&r){t=q.data;var w;q.data=new FormData;for(w in t)q.data.append(w,
t[w])}q.files&&this.importFiles();q.url=e(q.url,q);p.trigger("before-transport",q);!q.crossDomain&&"script"!==q.transport||q.form?"iframe"===q.transport?y=new R.ajax.transport.IFrame(q,this.$$promise,this):"fetch"===q.transport?y=new R.ajax.transport.Fetch(q,this.$$promise,this):"xhr"===q.transport&&(y=new R.ajax.transport.XHR(q,this.$$promise,this)):y=new R.ajax.transport.Script(q,this.$$promise,this);this._transport=y;this.$$promise.done(function(v){p.trigger("success",v)});this.$$promise.fail(function(v){p.trigger("error",
v)});this.$$promise.always(function(){p.trigger("end")});p.trigger("start");q.timeout&&(this._timeout=setTimeout(this.onTimeout.bind(this),q.timeout));q.jsonp&&this.createJsonp();!1===p.trigger("before-send",q,y)&&this.$$promise.reject();q.beforeSend&&!1===q.beforeSend.call(q.context,q,y)&&this.$$promise.reject();this.$$promise.isPending()?(F(y.send,y),this.$$promise.always(this.asyncDestroy,this)):F(this.asyncDestroy,this,[],1E3)},asyncDestroy:function(){this.$isDestroyed()||(this.$$promise.hasListeners()?
F(this.asyncDestroy,this,[],1E3):this.$destroy())},abort:function(q){this.$$promise.reject(q||"abort");this._transport.abort();return this},onTimeout:function(){this.abort("timeout")},getTransport:function(){return this._transport},createForm:function(){var q=document.createElement("form");q.style.display="none";R.dom.setAttr(q,"method",this._opt.method);R.dom.setAttr(q,"enctype","multipart/form-data");d(this._opt.data,q,null);document.body.appendChild(q);this._form=q;this._removeForm=!0},importFiles:function(){var q=
this._opt,t=q.files,u=this._form;q=q.data;var y,w;var v=0;for(y=t.length;v<y;v++){var x=t[v];if(H(x)){var A=x[0];x=x[1]}else A=window.File&&x instanceof File?x.uploadName||"upload"+(1<y?"[]":""):x.name||"upload"+(1<y?"[]":"");if(!(window.File&&x instanceof File)){var C=x;x=null}if(u)C&&u.appendChild(C);else if(x)q.append(A,x);else if(C.files&&C.files.length)for(x=0,w=C.files.length;x<w;x++)q.append(A,C.files[x])}},createJsonp:function(){var q=this._opt,t=q.jsonpParam||"callback",u=q.jsonpCallback||
"jsonp_"+E();q.url+=(h.test(q.url)?"&":"?")+t+"="+u;this._jsonpName=u;"undefined"!=typeof window&&(window[u]=this.jsonpCallback.bind(this));"undefined"!=typeof a&&(a[u]=this.jsonpCallback.bind(this));return u},jsonpCallback:function(q){try{var t=this.processResponseData(q)}catch(u){S(u);this.$$promise&&this.$$promise.reject(u);return}this.$$promise&&this.$$promise.resolve(t)},processResponseData:function(q,t){var u=this._opt;q=f(q,u,t);p.hasListener("process-response")&&p.trigger("process-response",
q,this.$$promise);u.processResponse&&(q=u.processResponse.call(u.context,q,this.$$promise));return q},returnResponse:function(q,t){return this._opt.jsonp?null:this.processResponseData(q,t)},processResponse:function(q,t){var u=this.$$promise;if(this._opt.jsonp)if(q){try{c(q)}catch(w){S(w),u.reject(w)}u.isPending()&&u.reject(Error("jsonp script didn't invoke callback"))}else u.reject(Error("jsonp script is empty"));else{try{var y=this.processResponseData(q,t)}catch(w){S(w);u.reject(w);return}u.resolve(y)}},
onDestroy:function(){this._timeout&&clearTimeout(this._timeout);this._form&&this._form.parentNode&&this._removeForm&&this._form.parentNode.removeChild(this._form);this._transport.$destroy();this._jsonpName&&("undefined"!=typeof window&&delete window[this._jsonpName],"undefined"!=typeof a&&delete a[this._jsonpName])}},{prepareUrl:e,global:p,defaultTransport:"xhr"})}()}).call(this,Ua);var eb=function(){function a(d,e){e=e||{};d&&!I(d)?e=d:e.url=d;if(!e.url&&(e.form&&(e.url=R.dom.getAttr(e.form,"action")),!e.url))throw Error("Must provide url");D(e,b,!1,!0);D(e,c,!1,!0);e.method=e.method?e.method.toUpperCase():e.form?R.dom.getAttr(e.form,"method").toUpperCase()||"GET":"GET";return new R.ajax.Ajax(e)}var c={url:null,data:null,method:"GET",headers:null,username:null,password:null,dataType:null,timeout:0,contentType:null,contentTypeHeader:null,xhrFields:null,jsonp:!1,jsonpParam:null,
jsonpCallback:null,transport:null,replace:!1,selector:null,form:null,beforeSend:null,progress:null,uploadProgress:null,processResponse:null,context:null,files:null},b={};a.setup=function(d){D(b,d,!0,!0)};a.on=function(){R.ajax.Ajax.global.on.apply(R.ajax.Ajax.global,arguments)};a.un=function(){R.ajax.Ajax.global.un.apply(R.ajax.Ajax.global,arguments)};a.get=function(d,e){e=e||{};e.method="GET";return a(d,e)};a.post=function(d,e){e=e||{};e.method="POST";return a(d,e)};a.load=function(d,e,g){g=g||{};
I(e)||(g=e);g.dataType="fragment";return a(e,g).done(function(f){if(g.replace)for(;d.firstChild;)d.removeChild(d.firstChild);d.appendChild(f)})};a.loadScript=function(d){return a(d,{transport:"script"})};a.submit=function(d,e){e=e||{};e.form=d;return a(null,e)};a.prepareUrl=function(d,e){return R.ajax.Ajax.prepareUrl(d,e||{})};return a}();R.app.Template=function(){function a(m){D(this,m,!0,!1);this.parentRenderer&&(this._parentRenderer=this.parentRenderer,delete this.parentRenderer);this.id=E();this._virtualSets={};this._namedNodes={};e.createEvent("rendered-"+this.id,{returnResult:!1,autoTrigger:!0});e.createEvent("attached-"+this.id);this.scope=R.lib.Scope.$produce(this.scope);this.config=R.lib.Config.create(this.config,{scope:this.scope});R.lib.Observable.$initHost(this,m,e);m=this.config;m.on("name",this._onNameChange,this);m.on("html",
this._onHtmlChange,this);a.initConfig(m);!h&&m.setStatic("useShadow",!1);m.get("useShadow")&&m.setStatic("useComments",!1);m.get("useShadow")&&m.setStatic("makeTranscludes",!1);this.scope.$on("destroy",this._onScopeDestroy,this);this._collectInitialNodes(this.attachTo||this.replaceNode);this.resolve();m.get("deferRendering")||this.render()}function c(m){var p;l||(l=R.prebuilt.templates);if(p=l[m])return delete l[m],p}function b(m){var p=g.get(m),r=f[m]||{};"function"===typeof p&&(p=p(m));if("string"!==
typeof p||r.text)p&&p.nodeType&&p.nodeType!==window.document.DOCUMENT_FRAGMENT_NODE&&(p="content"in p?p.content:R.dom.toFragment(p.childNodes),g.add(m,p));else{if(!r.processed){if("\x3c!--{"===p.substring(0,5)){var q=p.indexOf("--\x3e");r=R.lib.Expression.get(p.substr(4,q-4),{});f[m]=r;p=p.substr(q+3)}f[m]||(f[m]={});r=f[m];r.processed=!0;p=p.replace(/\x3c!--\s*include (.+?)--\x3e/ig,d);p=r.text?p:R.dom.toFragment(p)}p=R.dom.toFragment(p);g.add(m,p)}return p}function d(m,p){m=b(p.trim());if(!m)return"";
if("string"===typeof m)return m;p=window.document.createElement("div");p.appendChild(R.dom.clone(m));return p.innerHTML}var e=new R.lib.Observable,g=new R.lib.Cache,f={},h=!(!window.document.head||!window.document.head.attachShadow),l,n={};R.prebuilt&&R.prebuilt.templates&&g.addFinder(c);g.addFinder(function(m){m=window.document.getElementById(m);if(m){var p=m.tagName.toLowerCase();return"script"===p?(p=m.innerHTML,m.parentNode.removeChild(m),p):m}});D(a.prototype,{_rendering:!1,_rendered:!1,_renderer:null,
_attached:!1,_initial:!0,_fragment:null,_template:null,_nodes:null,_prevEl:null,_nextEl:null,_attachTo:null,_attachBefore:null,_replaceNode:null,_shadowRoot:null,_resolvePromise:null,_pubResolvePromise:null,_parentRenderer:null,_virtualSets:null,_namedNodes:null,attachTo:null,attachBefore:null,replaceNode:null,rootNode:null,scope:null,config:null,render:function(){!this._rendering&&this._initial&&(this._rendering=!0,this.config.setStatic("deferRendering",!1),this.config.has("name")||this.config.has("html")?
(this._prepareTranscludes(),this.resolve().done(this._runRenderer,this).done(this.attachOrReplace,this)):(this._runRenderer(),this.attachOrReplace()),this._rendering=this._initial=!1)},attach:function(m,p){var r=this;r._attachTo!==m&&(r._attached&&r.detach(),r._nextEl&&r._removeComments(),r._shadowRoot&&r._destroyShadow(),delete r.attachTo,delete r.attachBefore,r._attachTo=m,r._attachBefore=p,r._rendered&&(window.requestAnimationFrame&&R.dom.isAttached(r._attachTo)?window.requestAnimationFrame(function(){r._rafAttach()}):
r._rafAttach()))},_rafAttach:function(){this.$destroyed||(this._createShadow(),this._createComments(),this._nodes?this._doAttach():this._setAttached())},replace:function(m,p){var r=this;if((r._replaceNode!==m||r._attachTo!==p)&&m.parentNode)return r._attached&&r.detach(),r._nextEl&&r._removeComments(),r._shadowRoot&&r._destroyShadow(),delete r.replaceNode,delete r.attachTo,r._replaceNode=m,r._attachTo=p,r._attachBefore=null,r._rendered&&(window.requestAnimationFrame?window.requestAnimationFrame(function(){r._rafReplace()}):
r._rafReplace()),!0},_rafReplace:function(){this.$destroyed||(this._attachTo?(this._replaceNodeWithNode(node,this._attachTo),this._createShadow()):this._replaceNodeWithComments(this._replaceNode),this._nodes?this._doAttach():this._setAttached())},attachOrReplace:function(){!this._attached&&this._rendered&&(this.replaceNode&&this.replaceNode.parentNode?this.replace(this.replaceNode,this.attachTo):this.attachTo?this.attachBefore?this.attachBefore.parentNode&&this.attach(this.attachTo,this.attachBefore):
this.attach(this.attachTo):this._nextEl||this._attachTo||this._shadowRoot?this._doAttach():this._nodes&&this._nodes.length&&R.dom.isAttached(this._nodes[0])&&this._setAttached())},isAttached:function(){return this._attached},detach:function(){this._attached&&(this._nodes=this._clear())},resolve:function(m){var p=this.config;if(this._resolvePromise)if(m)this._resolvePromise.$destroy(),this._resolvePromise=null,this._pubResolvePromise.$destroy(),this._fragment=this._template=this._nodes=this._pubResolvePromise=
null;else return this._pubResolvePromise;this._pubResolvePromise=new R.lib.Promise;p.has("name")?p.get("name")&&(this._resolvePromise=this._resolveTemplate()):p.has("html")&&p.get("html")&&(this._resolvePromise=this._resolveHtml());!this._resolvePromise&&(this._resolvePromise=R.lib.Promise.resolve());this._resolvePromise.fail(this._onTemplateNotFound,this);return this._resolvePromise.done(this._onTemplateResolved,this)},getVirtualSet:function(m){return this._virtualSets[m]?Va(this._virtualSets[m]):
null},setNamedNode:function(m,p){var r=this._namedNodes[m];p.__namedRenderer&&p.__namedRenderer[m]||(r||(r=this._namedNodes[m]=[]),p&&-1===r.indexOf(p)&&(r.push(p),this._renderer&&this._virtualSets[m]&&this._renderer.processNode(p,this.scope,this.getVirtualSet(m))))},removeNamedNode:function(m,p){m=this._namedNodes[m];var r;m&&-1===(r=m.indexOf(p))||m.splice(r,1)},_extractVirtualSets:function(m){for(var p=m.firstChild,r=window.document.COMMENT_NODE,q,t;p;)t=p.nextSibling,p.nodeType===r&&(q=p.textContent||
p.data,"<"===q.substring(0,1)&&">"===q.substring(q.length-1)&&(this._processVirtualSet(q),m.removeChild(p))),p=t},_processVirtualSet:function(m){var p=window.document.createElement("div");p.innerHTML=m;if(p=p.firstChild)m=p.tagName.toLowerCase(),p=R.dom.getAttrSet(p),this._virtualSets[m]=p},_onTemplateResolved:function(m){var p=this.rootNode;this._attached&&this._clear();if(m)if(this._template="string"===typeof m?R.dom.toFragment(m):m,this._fragment=R.dom.clone(this._template),this._extractVirtualSets(this._fragment),
p){for(;p.firstChild;)p.removeChild(p.firstChild);p.appendChild(this._fragment);p.parentNode||this._fragment.appendChild(p);this._nodes=[p]}else this._nodes=B(this._fragment.childNodes);else p&&(this._nodes=[p]);this._pubResolvePromise.resolve()},_onTemplateNotFound:function(){throw Error("Template "+this.config.get("name")+" not found");},_collectInitialNodes:function(m){this.config.has("name")||this.config.has("html")||(m=m||this._attachTo||this.attachTo)&&(this._nodes=B(m.childNodes))},createEvent:function(m,
p){return e.createEvent(m+"-"+this.id,p)},on:function(m,p,r,q){return e.on(m+"-"+this.id,p,r,q)},un:function(m,p,r){return e.un(m+"-"+this.id,p,r)},_prepareTranscludes:function(){if(this.replaceNode){var m=this.replaceNode.parentNode;var p=this.replaceNode}else this.attachTo&&(m=p=this.attachTo);m&&p&&this.config.get("makeTranscludes")&&p.firstChild&&!R.dom.data(m,"mjs-transclude")&&R.dom.data(m,"mjs-transclude",R.dom.toFragment(p.childNodes))},_replaceNodeWithComments:function(m){var p=R.dom.commentWrap(m,
this.id);m.parentNode&&m.parentNode.removeChild(m);this._prevEl=p[0];this._nextEl=p[1]},_replaceNodeWithNode:function(m,p){var r=R.dom.toFragment(m.childNodes);m.parentNode&&m.parentNode.replaceChild(m,p);p.appendChild(r)},_createComments:function(){var m=this._attachTo,p=this._attachBefore;if(m&&!this._prevEl&&this.config.get("useComments")){var r=[window.document.createComment("<"+this.id),window.document.createComment(this.id+">")];m.insertBefore(r[0],p);m.insertBefore(r[1],p);this._prevEl=r[0];
this._nextEl=r[1]}},_removeComments:function(){var m=this._nextEl,p=this._prevEl;m.parentNode&&m.parentNode.removeChild(m);p.parentNode&&p.parentNode.removeChild(p);this._prevEl=this._nextEl=null},_createShadow:function(){this._attachTo&&!this._shadowRoot&&this.config.get("useShadow")&&(this._shadowRoot=this._attachTo.shadowRoot||this._attachTo.attachShadow({mode:"open"}))},_destroyShadow:function(){this._shadowRoot=null},_runRenderer:function(){if(this.config.get("runRenderer")){this._destroyRenderer();
e.trigger("before-render-"+this.id,this);this._renderer=new R.app.Renderer;if(this.config.get("passReferences")&&this._parentRenderer)this._renderer.on("reference",this._parentRenderer.trigger,this._parentRenderer,{prepend:["reference"]});this._renderer.on("transclude-sources",this._onTranscludeSource,this);this._renderer.on("rendered",this._collectedNodesAfterRendered,this);this._renderer.on("rendered",this._processNamedNodes,this);e.relayEvent(this._renderer,"rendered","rendered-"+this.id);e.relayEvent(this._renderer,
"reference","reference-"+this.id);this._nodes?this._renderer.process(this._nodes,this.scope):this._renderer.trigger("rendered",this._renderer)}},_onTranscludeSource:function(){return this._replaceNode||this.replaceNode||this._attachTo||this.attachTo},_collectedNodesAfterRendered:function(){this._rendered=!0;this._fragment&&(this._nodes=B(this._fragment.childNodes))},_processNamedNodes:function(){var m=this._namedNodes,p=this._virtualSets,r,q,t;for(r in m)if(p[r]){var u=0;for(q=m[r].length;u<q;u++){var y=
m[r][u];var w=y.__namedRenderer||{};w[r]=this._renderer.id;y.__namedRenderer=w;w=this.getVirtualSet(r);if(w.rest&&y.nodeType===window.document.ELEMENT_NODE)for(t in w.rest)y.setAttribute(t,w.rest[t]);this._renderer.processNode(y,this.scope,w)}}},_destroyRenderer:function(){this._rendered=!1;if(this._renderer){var m=this._renderer.id,p=this._namedNodes,r,q;this._renderer.$destroy();this._renderer=null;for(r in p){var t=0;for(q=p[r].length;t<q;t++){var u=p[r][t];(u=u.__namedRenderer)&&u[r]===m&&(u[r]=
null)}}this._namedNodes={}}},_resolveTemplate:function(){var m=this.config.get("name");return new R.lib.Promise(function(p,r){m?(m=b(m))?p(m):r():r()})},_resolveHtml:function(){var m=this.config.get("html");return new R.lib.Promise(function(p,r){m?p(m):r()})},_onHtmlChange:function(){this.config.get("deferRendering")||this.resolve(!0).done(this._runRenderer,this).done(this.attachOrReplace,this)},_onNameChange:function(){this.config.get("deferRendering")||this.resolve(!0).done(this._runRenderer,this).done(this.attachOrReplace,
this)},_collectBetweenComments:function(){var m=this._nextEl,p=this._prevEl,r=p,q=[];if(p&&m)for(;r&&r.nextSibling&&r.nextSibling!==m;)q.push(r.nextSibling),r=r.nextSibling;return q},_doAttach:function(){var m,p=this._nodes,r=!1,q=this._nextEl,t=this._shadowRoot||this._attachTo,u=this._attachBefore;if(p&&!this._attached){if(this._fragment||this.rootNode){this._fragment&&this._fragment.firstChild&&(this._nodes=p=B(this._fragment.childNodes));var y=0;for(m=p.length;y<m;y++){var w=p[y];q?(q.parentNode.insertBefore(w,
q),r=!0):t&&(u?t.insertBefore(w,u):t.appendChild(w),r=!0)}}else r=!0;(this._attached=r)&&this._setAttached(p)}},_setAttached:function(m){this._attached=!0;e.trigger("attached-"+this.id,this,m);this._renderer&&this._renderer.attached(this._attachTo)},_collectNodes:function(){var m=[],p;this._nextEl?m=this._collectBetweenComments():(p=this._shadowRoot||this._attachTo)&&(m=B(p.childNodes));return m},_clear:function(){var m=this._collectNodes(),p;var r=0;for(p=m.length;r<p;r++){var q=m[r];q.parentNode&&
q.parentNode.removeChild(q)}this._attached=!1;this._renderer&&(this._renderer.detached(),e.trigger("detached-"+this.id,this,m));return m},_onScopeDestroy:function(){this.$destroy()},$destroy:function(){this.$destroyed=!0;this._nextEl&&this._nextEl.parentNode&&this._nextEl.parentNode.removeChild(this._nextEl);this._prevEl&&this._prevEl.parentNode&&this._prevEl.parentNode.removeChild(this._prevEl);this._renderer&&this._renderer.$destroy();e.destroyEvent("rendered-"+this.id);e.destroyEvent("attached-"+
this.id);this.config&&(this.config.clear(),this.config=null)}});a.load=function(m,p){return g.exists(m)?R.lib.Promise.resolve(g.get(m)):(n[p]||(n[p]=eb(p,{dataType:"fragment"}).always(function(r){g.add(m,r)}).then(function(r){delete n[p];return r})),n[p])};a.cache=g;a.add=function(m,p){a.cache.add(m,p)};a.get=b;a.prepareConfig=function(m,p){"string"===typeof p?m.setDefaultValue("name",p):p&&(p.name||p.html||!p.expression||(p.name={expression:p.expression}),m.addProperties(p,"defaultValue"))};a.initConfig=
function(m){var p=R.lib.Config.MODE_STATIC;m.setDefaultMode("value",p);m.setDefaultMode("name",p);m.setDefaultMode("html",p);m.setType("runRenderer","bool",p);m.setType("useComments","bool",p);m.setType("useShadow","bool",p);m.setType("deferRendering","bool",p);m.setType("makeTranscludes","bool",p);m.setType("passReferences","bool",p);m.setProperty("useComments","defaultValue",!0,!1);m.setProperty("makeTranscludes","defaultValue",!0,!1);m.setProperty("passReferences","defaultValue",!1,!1)};return a}();R.app.Controller=U({$mixins:[R.mixin.Observable],$mixinEvents:["$initConfig"],id:null,node:null,scope:null,parentRenderer:null,config:null,destroyScope:!1,__nodeId:"$$ctrlId",__idPfx:"ctrl-",__initInstance:"initController",$init:function(a){a=a||{};this._protoCfg=this.config;this.config=null;this.$super(a);D(this,a,!0,!1);if(!this.scope||"string"===typeof this.scope&&-1!==this.scope.indexOf(":new"))this.destroyScope=!0;var c=this.scope=R.lib.Scope.$produce(this.scope);var b=this.config=R.lib.Config.create(this.config,
{scope:c},"defaultValue");b.setOption("scope",c);c.$cfg={};b.setTo(c.$cfg);this.initConfig();this.$callMixins("$initConfig",b);this._protoCfg&&b.addProperties(this._protoCfg,"defaultValue");this.id=b.get("id");this.$refs={node:{},cmp:{}};this.node&&(this.$refs.node.main=this.node);b.has("init")&&b.get("init")(c);b.has("as")&&(c[b.get("as")]=this);this[this.__initInstance].apply(this,arguments);c.$app&&c.$app.registerCmp(this,"id");if(this.parentRenderer)this.parentRenderer.on("destroy",this._onParentRendererDestroy,
this);this._claimNode()},initConfig:function(){var a=this.scope,c=this.config;c.setType("id","string",R.lib.Config.MODE_STATIC,this.id||this.__idPfx+E());this.$self.initConfig(c);this.as&&c.setDefaultValue("as",this.as);R.lib.Observable.$initHostConfig(this,c,a,this.node)},_claimNode:function(){this.node&&(this.node[this.__nodeId]=this.id)},_releaseNode:function(){this.node&&(this.node[this.__nodeId]=null)},_onChildReference:function(a,c,b){this.$refs[a]||(this.$refs[a]={});var d=this.$refs[a][c];
d||(this.$refs[a][c]=b);Q(d)&&d.resolve(b)},getRefEl:function(a){return this.$refs.node[a]},getRefCmp:function(a){return this.$refs.cmp[a]},_getRefPromise:function(a,c){var b=this.$refs[a][c];return b?Q(b)?b:R.lib.Promise.resolve(b):this.$refs[a][c]=new R.lib.Promise},getRefElPromise:function(a){return this._getRefPromise("node",a)},getRefCmpPromise:function(a){return this._getRefPromise("cmp",a)},getEl:function(){return this.node},isDestroyed:function(){return this.$$destroyed},initController:M,
_onParentRendererDestroy:function(){this.$destroy()},onDestroy:function(){this.destroyScope&&this.scope&&this.scope.$destroy();this._releaseNode();this.config.$destroy();this.$super()}},{initConfig:function(a){var c=R.lib.Config.MODE_STATIC;a.setMode("init",R.lib.Config.MODE_FUNC);a.setDefaultMode("as",c);a.setDefaultMode("scope",c)}});var fb=R.dom.htmlTags="a abbr address area article aside audio b base bdi bdo blockquote body br button canvas caption cite code col colgroup data datalist dd del details dfn dialog div dl dt em embed fieldset figcaption figure footer form h1 h2 h3 h4 h5 h6 head header hgroup hr html i iframe img input ins kbd keygen label legend li link main map mark math menu menuitem meta meter nav noscript object ol optgroup option output p param picture pre progress q rb rp rt rtc ruby s samp script section select slot small source span strong style sub summary sup svg table tbody td template textarea tfoot th thead time title tr track u ul var video wbr".split(" ");R.app.Component=R.app.Controller.$extend({useShadowDOM:!1,replaceCustomNode:!0,renderTo:null,autoRender:!1,autoAttach:!1,destroyEl:!0,template:null,_nodeReplaced:!1,_nodeCreated:!1,_rendered:!1,_attached:!1,__nodeId:"$$cmpId",__idPfx:"cmp-",__initInstance:"_initComponent",$constructor:function(a){(a=this.$view||(a?a.$view:null))&&this.$plugins.push(a);this.$super()},$init:function(){this.$super.apply(this,arguments);this.config.getAll();this._initTemplate();this.afterInitComponent.apply(this,arguments);
this.autoRender&&this.template.resolve().done(this.template.render,this.template).done(this.render,this)},_initComponent:function(){this.$view&&(this.scope.$view=this.$view);this.initComponent.apply(this,arguments)},_initTemplate:function(){var a=this.template,c=null,b=null,d=null,e=this.config;this.node&&((this._nodeReplaced=this.replaceCustomNode&&-1===fb.indexOf(this.node.tagName.toLowerCase()))?(b=this.node,this.node=null,this.$refs.node.main=null):d=this.node);!a&&e.has("template")&&(a=e.get("template"));
!this.node&&e.has("tag")&&(this.node=c=window.document.createElement(e.get("tag")),this.$refs.node.main=c,this._nodeCreated=!0,this._nodeReplaced&&b.parentNode&&(b.parentNode.replaceChild(b,c),c=null,d=this.node));e=new R.lib.Config({deferRendering:!0,runRenderer:!0,useShadow:e.copyProperty("useShadow"),makeTranscludes:e.copyProperty("makeTranscludes")},{scope:this.scope});d&&e.setStatic("useComments",!1);R.app.Template.prepareConfig(e,a);this._initTplConfig(e);this.template=new R.app.Template({scope:this.scope,
config:e,rootNode:c,attachTo:d,replaceNode:b,callback:{context:this,reference:this._onChildReference,rendered:this._onRenderingFinished,attached:this._onTemplateAttached}});this._nodeCreated&&this.template.setNamedNode("main",this.node)},_initTplConfig:function(){},initConfig:function(){this.$super();this.$self.initConfig(this.config)},hasDirective:function(a){return this.directives&&!!this.directives[a]},applyDirective:function(a,c){var b=this.$self.supportsDirectives;if(b&&(!0===b||b[a]))if(this._rendered)if(c=
R.app.Directive.getDirective("attr",a))R.app.Renderer.applyDirective(c.handler,this._getDirectiveScope(),this,this._prepareDirectiveCfg(dirCfg));else throw Error("Directive "+a+" not found");else this.directives||(this.directives={}),this.directives[a]?this.directives[a].push(c):this.directives[a]=[c]},_getDirectiveScope:function(){return(this.directives||{}).scope||this.parentScope||this.scope.$parent||this.config.getOption("scope")||this.scope},_prepareDirectiveCfg:function(a){if(a instanceof R.lib.Config)return a;
"string"===typeof a&&(a={value:{value:a}});a=new R.lib.Config(a,{scope:this._getDirectiveScope()});this.on("destroy",a.$destroy,a);return a},_initDirectives:function(){var a=this.directives,c=this.$self.supportsDirectives,b,d=R.app.Directive.getAttributes(),e,g;if(c){var f=0;for(e=d.length;f<e;f++){var h=d[f].name;if((!0===c||c[h])&&(b=a[h])!==undf)for(!isArray(b)&&(b=[b]),h=0,g=b.length;h<g;h++)R.app.Renderer.applyDirective(d[f].handler,this._getDirectiveScope(),this,this._prepareDirectiveCfg(b[h]))}}},
_onChildReference:function(a,c,b){b&&(b.nodeType&&b.nodeType===window.document.COMMENT_NODE?b.textContent="*"+this.id+"*"+c+"*":(this.node||"node"!==a||"main"!==c||(this.node=b,this._claimNode()),this.template instanceof R.app.Template&&this.template.setNamedNode(c,b)));this.$super.apply(this,arguments)},render:function(a,c){a&&a.nodeType===window.document.COMMENT_NODE&&(c=a,a=a.parentNode);this._rendered?a&&this.attach(a,c):a&&(this.renderTo=a,this.renderBefore=c);this.onBeforeRender();this.trigger("render",
this);this.template&&this.template.render()},isAttached:function(a){return this.template.isAttached(a)},attach:function(a,c){if(!a)throw Error("Parent node is required");this.template.attach(a,c)},detach:function(){this.template.isAttached()&&this.template.detach()},onBeforeRender:function(){},_onRenderingFinished:function(){this._rendered=!0;this.afterRender();this.trigger("after-render",this);this.renderTo&&this.template.attach(this.renderTo,this.renderBefore);this.directives&&this._initDirectives()},
_onTemplateAttached:function(){this._attached=!0;this.afterAttached();this.trigger("after-attached",this)},isRendered:function(){return this._rendered},isDestroyed:function(){return this.$destroyed},getDomApi:function(a){var c=this.$self.supportsDirectives;if(!c||!c[a])return null;a=!0===c[a]?"main":c[a];return this.getRefEl(a)||this.getRefElPromise(a)},getInputApi:function(){return null},getApi:function(a,c){if("node"===a)return this.getDomApi(c);if("input"===a)return this.getInputApi()},beforeInitComponent:M,
initComponent:M,afterInitComponent:M,afterRender:M,afterAttached:M,afterDetached:M,onDestroy:function(){this.template&&this.template.$destroy();this.node&&(this.destroyEl?R.dom.isAttached(this.node)&&this.node.parentNode.removeChild(this.node):this._releaseNode());this.$super()}},{initConfig:function(a){var c=R.lib.Config.MODE_STATIC;a.setType("makeTranscludes","bool",c,!1);a.setType("useShadow","bool",c,!1);a.setDefaultMode("tag",c)},registerWebComponent:function(a){Directive.registerComponent(a,
this);return R.dom.webComponentWrapper(a,this)},registerDirective:function(a){"string"===typeof a?Directive.registerComponent(a):Directive.registerComponent(a.prototype.$class,a)},supportsDirectives:!1,configProps:[],createFromPlainObject:function(a){if(a instanceof this)return a;if(!a.config){var c={},b=this.configProps,d;a.config=c;var e=0;for(d=b.length;e<d;e++){var g=b[e];a[g]&&(c[g]=a[g],delete a[g])}}return new this(a)}});R.app.component.View=U({$init:function(a){this.component=a;this.component.$view=this}});R.app=R.app||{};R.app.resolve=function(a,c,b,d){c=c||{};d=d||[];b=b||c.node;var e=c.scope,g=c.config||null;c.config=g;c.scope=c.scope||e;c.node=c.node||b;0===d.length&&d.push(c);g&&(g instanceof R.lib.Config||(g=new R.lib.Config(g,{scope:e},"defaultValue")));var f=I(a)?cb.get(a):a;if(!f)throw Error("Component "+a+" not found");var h,l=[];a=e?e.$app:null;var n=R.lib.Provider.global(),m=a?a.inject:n.inject,p=a?a:n,r=g&&g.has("cloak")?g.get("cloak"):null,q={$node:b||null,$scope:e||null,$config:g||null,$args:d||null};
if(f.resolve)for(h in f.resolve)(function(u){var y=new R.lib.Promise;l.push(y.done(function(v){q[u]=v;c[u]=v;d.push(v)}));var w=f.resolve[h];G(w)?y.resolve(w(e,b,g)):y.resolve(m.call(p,w,null,D({},q,c,!1,!1)));y.fail(function(v){v instanceof Error&&S(v)})})(h);if(l.length){var t=new R.lib.Promise;R.lib.Promise.all(l).done(function(){t.resolve(m.call(p,f,null,D({},q,c,!1,!1),d))}).fail(t.reject,t)}else t=R.lib.Promise.resolve(m.call(p,f,null,D({},q,c,!1,!1),d));b&&t.isPending()&&null!==r&&(!0!==r?
R.dom.addClass(b,r):b.style.visibility="hidden",t.then(function(){!0!==r?R.dom.removeClass(b,r):b.style.visibility=""}));b&&t.then(function(){R.dom.removeClass(b,"mjs-cloak")});return t};R.dom.is=function(a,c){if(!c)return!1;if("function"===typeof c)return a instanceof c;c=R.dom.select(c,a.parentNode);var b;var d=-1;for(b=c.length;++d<b;)if(c[d]===a)return!0;return!1};R.app.Container=R.app.Component.$extend({$mixinEvents:["$initChildItem"],_itemsInitialized:!1,defaultAddTo:"main",_initComponent:function(){this.$super.apply(this,arguments);this.node&&this.template&&this.node.firstChild&&this._prepareDeclaredItems(B(this.node.childNodes));this._initItems()},_initTplConfig:function(a){a.setStatic("makeTranscludes",!1);a.setFinal("makeTranscludes")},_prepareDeclaredItems:function(a){function c(u,y,w,v){w.node===e&&(l=u,q=v.at)}function b(u,y,w,v,x){v.node===e&&(h=
w,q=x.at)}var d,e,g=!1,f=this._getIdKey(),h,l,n=this.scope,m=this.items||[];!this._itemsInitialized&&H(m)&&(m={body:m});var p=0;for(d=a.length;p<d;p++)if(e=a[p]){var r=null;if(e.nodeType===window.document.ELEMENT_NODE&&!e[f]){e.parentNode&&!e.hasAttribute("slot")&&e.parentNode.removeChild(e);var q=l=h=null;var t=new R.app.Renderer;n.$on("destroy",t.$destroy,t);t.on("reference",b);t.on("reference-promise",c);t.process(e,n);h||l?(q||(q=this.defaultAddTo),r=D({type:"component",renderRef:q,renderer:t,
component:h||l,resolved:!!h},this._createDefaultItemDef()),e[f]=r.id):(g=R.dom.getAttrSet(e),q=g.at||g.rest.slot||this.defaultAddTo,r=D({type:"node",renderRef:q,node:e},this._createDefaultItemDef()));g=!0;t.un("reference",b);t.un("reference-promise",c);this._itemsInitialized?this.addItem(r):(m[q]||(m[q]=[]),m[q].push(r))}}g&&!this._itemsInitialized&&(this.items=m)},_initItems:function(){var a=this.items||[],c=this.$self.propsToItems,b=[],d,e,g;this._itemsInitialized=!0;this.itemsMap={};if(H(a)){var f=
{};f[this.defaultAddTo]=a;a=f}if(c)for(d in c)this[d]&&this._initIntoItems(this[d],c[d]);for(g in a)for(c=a[g],H(c)||(c=[c]),f=-1,e=c.length;++f<e;)if(d=this._processItemDef(c[f]))d.renderRef=g,b.push(d);this.items=b},_getIdKey:function(){return"$$container_"+this.id},_createDefaultItemDef:function(){var a=E();return{__containerItemDef:!0,type:"component",placeholder:window.document.createComment("*"+this.id+"*"+a+"*"),id:a,resolved:!0,processed:!1,attached:!1}},_processItemDef:function(a,c){var b=
this,d=b._getIdKey();if(a.__containerItemDef){var e=a;b.itemsMap[e.id]=e}else if(e=b._createDefaultItemDef(),c&&D(e,c,!1,!1),b.itemsMap[e.id]=e,"string"===typeof a&&(a=b._initStringItem(a)),ea(a)&&(a=b._initObjectItem(a)),ea(a))e=D({},a,e,!1,!1),b.itemsMap[e.id]=e;else if("function"===typeof a)e.component=new a({scope:b.scope.$new()});else if(a instanceof R.app.Component)e.component=a;else if(a instanceof window.Node)e.type="node",e.node=a;else if(a instanceof R.app.Template)e.component=new R.app.Component({scope:b.scope,
template:a});else if("string"===typeof a)e.component=R.app.resolve(a,{scope:b.scope});else if(Q(a))e.component=a;else throw Error("Failed to initialize item");if(!e.processed){a=e;if(!b._allowChildItem(e))return null;"node"===e.type?(e=b._wrapChildItem(e),e.node[d]=e.id):"component"===e.type&&(Q(e.component)?(e.resolved=!1,e.component.done(function(g){e.component=g;if(!b._allowChildItem(e))return null;e=b._wrapChildItem(e);e.component[d]=e.id;b._onChildResolved(e.component)})):(e=b._wrapChildItem(e),
e.component[d]=e.id,b._onChildResolved(e.component)));a!==e&&(delete b.itemsMap[a.id],b.itemsMap[e.id]=e);b._initChildItem(e);b.$callMixins("$initChildItem",e);e.processed=!0}return e},_initChildItem:function(){},_allowChildItem:function(a){var c=this.$self.allowItems||["*"];"string"===typeof c&&(c=[c]);return-1!==c.indexOf("*")?!0:"component"===a.type?-1!==c.indexOf(a.component.$class):!0},_wrapChildItem:function(a){var c=this.$self,b=c.allowUnwrapped||[];c=c.wrapper;"string"===typeof b&&(b=[b]);
if(!c||-1!==b.indexOf("*"))return a;if("component"===a.type){if(-1!==b.indexOf(a.component.$class))return a;b="string"===typeof c?cb.get(c):c;c=this._createDefaultItemDef();c.component=new b({scope:this.scope,items:[a.component]});return c}return a},_initObjectItem:function(a){return a},_initStringItem:function(a){if("<"===a.substring(0,1)){var c=document.createElement("div");c.innerHTML=a;return c.firstChild}return a},_initChildEvents:function(a,c){c[a]("remove-from-container",this._onChildRemove,
this)},_onChildRemove:function(a){var c=this._getIdKey(),b=a[c],d;b&&(d=this.itemsMap[b])&&(delete a[c],delete this.itemsMap[b],c=this.items.indexOf(d),a instanceof R.app.Component&&this._initChildEvents("un",a),-1!==c&&this.items.splice(c,1),this._detachChildItem(d))},_onChildResolved:function(a){var c=this._getIdKey();c=a[c];var b,d;c&&(b=this.itemsMap[c])&&(b.resolved=!0,b.component=a,(d=a.config.get("ref"))&&this._onChildReference("cmp",d,a),this._initChildEvents("on",a),this._rendered&&(b.component.render(),
this._putItemInPlace(b)))},_initIntoItems:function(a,c){var b=this._createDefaultItemDef();"string"===typeof c&&(c=cb.get(c));a instanceof c||(a=c.createFromPlainObject(a));b.component=a;b.resolved=!Q(a);!this.items&&(this.items=[]);H(this.items)?this.items.push(b):this.items.body.push(b)},render:function(){var a=this.items||[],c;var b=-1;for(c=a.length;++b<c;)"component"===a[b].type&&a[b].resolved&&a[b].component.render();this.$super.apply(this,arguments)},_onTemplateAttached:function(){var a,c=
this.items;var b=-1;for(a=c.length;++b<a;)this._putItemInPlace(c[b]);this.$super()},_putItemInPlace:function(a){a.placeholder&&!a.placeholder.parentNode&&this._preparePlaceholder(a);a.resolved&&!a.attached&&(a.renderRef&&this.template.setNamedNode(a.renderRef,a.node||a.component),this._attachChildItem(a))},_preparePlaceholder:function(a){var c=this.getRefEl(a.renderRef);if("node"!==a.type||!a.node.hasAttribute("slot")){if(!c)throw Error("Can't find referenced node: "+a.renderRef);c instanceof window.HTMLSlotElement||
(c.nodeType===window.document.COMMENT_NODE?c.parentNode.insertBefore(a.placeholder,c):c.appendChild(a.placeholder))}},_attachChildItem:function(a){var c=this.getRefEl(a.renderRef);if(!a.attached){if("node"===a.type){if(a.node.hasAttribute("slot")){a.attached=!0;return}c instanceof window.HTMLSlotElement?a.node.setAttribute("slot",c.getAttribute("name")):c.nodeType===window.document.COMMENT_NODE?c.parentNode.insertBefore(a.node,a.placeholder):c.insertBefore(a.node,a.placeholder)}else"component"===
a.type&&(c.nodeType===window.document.COMMENT_NODE?a.component.render(c.parentNode,a.placeholder):a.component.render(c,a.placeholder));a.attached=!0}},_detachChildItem:function(a){a.attached&&("node"===a.type?a.node.parentNode&&a.node.parentNode.removeChild(a.node):"component"===a.type&&(a.component.detach(),a.placeholder.parentNode&&a.placeholder.parentNode.removeChild(a.placeholder)),a.attached=!1)},hasItem:function(a){var c=this._getIdKey(),b;if("string"===typeof a||"function"===typeof a){for(b in this.itemMap)if(c=
this.itemMap[b],"component"===c.type&&(c.componet.id===a||c.component.$is(a)))return!0;return!1}return!!a[c]},hasItemIn:function(a,c){if(!this.items[a]||0===this.items[a].length)return!1;var b;var d=0;for(b=this.items[a].length;d<b;d++){var e=this.items[a][d];if("component"===e.type&&e.component.$is(c))return!0}return!1},addItem:function(a,c){this.hasItem(a)||(a instanceof R.app.Component&&a.trigger("remove-from-container",a),a=this._processItemDef(a,{renderRef:c||this.defaultAddTo}),this.items.push(a),
"node"===a.type&&this._attached&&this._putItemInPlace(a))},removeItem:function(a){this.hasItem(a)&&(a instanceof R.app.Component?a.trigger("remove-from-container",a):this._onChildRemove(a))},onDestroy:function(){var a;var c=0;for(a=this.items.length;c<a;c++){var b=this.items[c];b.renderer&&b.renderer.$destroy();"component"===b.type&&b.component.$destroy&&b.component.$destroy()}this.items=null;this.$super()}},{allowItems:["*"],allowUnwrapped:["*"],wrapper:null});R.lib.Queue=function(){function a(c){c=c||{};this._queue=[];this._map={};this.id="$$"+E();this._f=this._finish.bind(this);for(var b in c)this[b]=c[b]}a.REPLACE=1;a.ONCE=2;a.MULTIPLE=3;a.ONCE_EVER=4;D(a.prototype,{_queue:null,_map:null,_nextRequested:!1,_running:!1,currentItemNo:null,length:0,id:null,async:!0,auto:!0,thenable:!1,stack:!1,context:null,onResult:null,onFinish:null,counter:0,mode:a.MULTIPLE,add:function(c,b,d,e,g,f){var h=this.id,l=c[h]||E();b={id:l,fn:c,context:b,args:d,async:f,itemno:++this.counter};
e=e||this.mode;if(e===a.ONCE_EVER&&c[h])return c[h];c[h]=l;if(this._map[l])if(e===a.REPLACE)this.remove(l);else if(e===a.ONCE)return l;this._queue[g?"unshift":"push"](b);this._map[l]=b;this.length=this._queue.length;this.auto&&this.next();return l},append:function(c,b,d,e,g){return this.add(c,b,d,e,!1,g)},prepend:function(c,b,d,e,g){return this.add(c,b,d,e,!0,g)},remove:function(c){var b=this._queue,d;var e=0;for(d=b.length;e<d;e++)if(b[e].id===c){b.splice(e,1);break}delete this._map[c]},isEmpty:function(){return 0===
this.length},isRunning:function(){return this._running},next:function(){var c=this,b;if(c._running)c._nextRequested=!0;else{c._nextRequested=!1;var d=c._queue[c.stack?"pop":"shift"]();c.length=c._queue.length;if(!d)return!1;c._running=!0;c.currentItemNo=d.itemno;delete c._map[d.id];var e=function(){try{b=d.fn.apply(d.context||c.context,d.args||[])}catch(f){S(f)}finally{Q(b)?b.then(c._f,c._f):c._finish(b)}},g=d.async||c.async||!1;!g&&e();"raf"===g&&X(e);g&&"raf"!==g&&F(e,null,null,1===ca(g)?g:0)}},
_finish:function(c){this.onResult&&this.onResult.call(this.context,c);this._running&&(this._running=!1,this.currentItemNo=null,this.auto||this._nextRequested?!1===this.next()&&this.onFinish&&this.onFinish.call(this.context):0===this.length&&this.onFinish&&this.onFinish.call(this.context))},$destroy:function(){this.context=this._map=this._queue=null;this._running=this._nextRequested=!1;this.next=M}},!0,!1);return a}();R.app.ListRenderer=U({id:null,config:null,scope:null,listSourceExpr:null,itemScopeName:null,_tagMode:!1,_animateMove:!1,_animate:!1,_buffered:!1,_trackBy:null,_parentRenderer:null,_template:null,_items:null,_prevEl:null,_nextEl:null,_renderQueue:null,_attachQueue:null,_mo:null,_trackByFn:null,_filterFn:null,_localTrack:!1,_griDelegate:null,$constructor:function(a,c,b){this.config=b;this.scope=a;this.initConfig();this._tagMode="mjs-each"===c.nodeName.toLowerCase();this._animateMove=!this._tagMode&&
!b.hasValue("buffered")&&b.get("animateMove")&&R.animate.isCssSupported();(this._animate=!this._tagMode&&!b.hasValue("buffered")&&b.get("animate"))&&this.$plugins.push(b.get("animatePlugin"));b.hasValue("observable")&&this.$plugins.push("MetaphorJs.plugin.Observable");b.hasValue("buffered")&&!this._tagMode&&(this._buffered=!0,a=b.get("buffered"),!0===a&&(a=b.getProperty("buffered").defaultValue),this.$plugins.push(a));b.has("plugin")&&this.$plugins.push(b.get("plugin"));if(b.has("filter")&&(this._filterFn=
b.get("filter"),"function"!==typeof this._filterFn))throw Error("{each.$filter} must be a function");this._trackBy=b.get("trackBy")},$init:function(a,c,b,d){a=this._tagMode?R.dom.getAttr(c,"value"):b.getExpression("value");this._parseExpr(a);this._template=this._tagMode?R.dom.toFragment(c.childNodes):c;this._items=[];this.id=b.has("id")?b.get("id"):E();this._trackBy||!1===this._trackBy||(this._localTrack=!0);b=R.dom.commentWrap(c,"list-"+this.id);this._prevEl=b[0];this._nextEl=b[1];this._parentRenderer=
d;this._renderQueue=new R.lib.Queue({async:!1,auto:!0,thenable:!0,stack:!1,context:this,mode:R.lib.Queue.ONCE});this._attachQueue=new R.lib.Queue({async:"raf",auto:!0,thenable:!0,stack:!1,context:this,mode:R.lib.Queue.ONCE});c.parentNode.removeChild(c);this.initDataSource();this.scope.$app.registerCmp(this,"id");this._renderQueue.add(this.render,this,[this.getList()])},getList:function(){var a=B(this._mo.getValue()),c,b=this._filterFn;if(b){var d=a;a=[];var e=0;for(c=d.length;e<c;e++)b(d[e])&&a.push(d[e])}return a},
initConfig:function(){var a=this.config,c=R.lib.Config.MODE_STATIC;a.setType("animate","bool",c,!1);a.setType("animateMove","bool",c,!1);a.setDefaultMode("trackBy",c);a.setDefaultMode("id",c);a.setDefaultMode("plugin",c);a.setType("observable","bool",c,!1);a.setDefaultValue("buffered","MetaphorJs.plugin.ListBuffered");a.setType("animatePlugin",null,c,"MetaphorJs.plugin.ListAnimated")},initDataSource:function(){this._mo=R.lib.MutationObserver.get(this.scope,this.listSourceExpr,this.onChange,this,{localFilter:this.localTracklistFilter.bind(this)});
this._localTrack&&!this._trackBy&&(this._trackBy="$$"+this._mo.id);this._griDelegate=this.scopeGetRawIndex.bind(this)},trigger:M,render:function(a){var c=this._items,b=this._template,d;var e=0;for(d=a.length;e<d;e++)c.push(this.createItem(b.cloneNode(!0),a,e));this.renderOrUpdate();this._attachQueue.add(this.attachAllItems,this)},createItem:function(a,c,b){var d=this.itemScopeName,e=this.scope.$new(),g=this._tagMode;e.$on("changed",this.scope.$check,this.scope);e[d]=this.getListItem(c,b);a=g?B(a.childNodes):
a;return{index:b,action:"enter",el:a,placeholder:window.document.createComment("*list*"+b+"*"),scope:e,attached:!1,rendered:!1,hidden:!1}},attachAllItems:function(){var a=window.document.createDocumentFragment(),c=this._items,b=this._tagMode,d;var e=0;for(d=c.length;e<d;e++)c[e].hidden||(b?a.appendChild(R.dom.toFragment(c[e].el)):a.appendChild(c[e].el),c[e].attached=!0,a.appendChild(c[e].placeholder));this._nextEl.parentNode&&this._nextEl.parentNode.insertBefore(a,this._nextEl);this.trigger("attached",
this)},renderOrUpdate:function(a,c,b,d){var e=this._items;a=a||0;var g=e.length;c=c||g-1;var f=this.getList(),h=this.getTrackByFunction();for(c>g-1&&(c=g-1);a<=c;a++)b&&e[a].action!==b||this.renderItem(a,e,f,h,d)},renderItem:function(a,c,b,d,e){b=b||this.getList();c=c||this._items;d=d||this.getTrackByFunction();var g=c[a],f=g.scope;c=c.length-1;var h=!(a%2);e&&g.rendered||(f.$index=a,f.$first=0===a,f.$last=a===c,f.$even=h,f.$odd=!h,f.$trackId=d(b[a]),f.$getRawIndex=this.griDelegate,g.renderer?f.$check():
(g.renderer=new R.app.Renderer,f.$on("destroy",g.renderer.$destroy,g.renderer),g.renderer.process(g.el,f),g.rendered=!0))},onChange:function(a,c){this._renderQueue.prepend(this.applyChanges,this,[c],R.lib.Queue.REPLACE)},applyChanges:function(a){var c=this._items,b=this._template,d=0,e=this.getList(),g=null,f=this._animateMove,h=[],l=this.itemScopeName,n=c.slice(),m=!1;if(this._trackBy){a=this.getTrackList(a);var p=this.getTrackList(e);var r=Ja(a,p);r=Ka(a,p,r.prescription,function(u){return u});
a=0;for(p=r.length;a<p;a++){var q=r[a];if(1===ca(q)){var t=q;q=c[t];t!==d&&null===g&&(g=a);q.action="move";q.scope[l]=this.getListItem(e,a);m=f;h.push(q);c[t]=null;d++}else null===g&&(g=a),q=this.createItem(b.cloneNode(!0),e,a),h.push(q)}}else for(c=this._items.slice(),g=0,m=!1,a=0,p=e.length;a<p;a++)q=this.createItem(b.cloneNode(!0),e,a),h.push(q);this._items=h;this.reflectChanges({oldItems:c,updateStart:g,newItems:h,origItems:n,doesMove:m})},reflectChanges:function(a){this.renderOrUpdate();this.applyDomPositions(a.oldItems);
this.removeOldElements(a.oldItems);this.trigger("change",this)},removeOldElements:function(a){var c,b,d,e=this._tagMode;var g=0;for(c=a.length;g<c;g++){if((b=a[g])&&b.attached){b.attached=!1;if(e){var f=0;for(d=b.el.length;f<d;f++)b.el[f].parentNode&&b.el[f].parentNode.removeChild(b.el[f])}else b.el.parentNode&&b.el.parentNode.removeChild(b.el);b.placeholder.parentNode&&b.placeholder.parentNode.removeChild(b.placeholder)}b&&b.scope&&(b.scope.$destroy(),b.rendered=!1)}},applyDomPositions:function(){var a=
this._items,c=this._tagMode,b=this._nextEl,d,e;var g=0;for(e=a.length;g<e;g++){var f=a[g];var h=f.el;var l=null;if(f.hidden)c?R.dom.toFragment(h):h.parentNode&&h.parentNode.removeChild(h),f.placeholder.parentNode&&f.placeholder.parentNode.removeChild(f.placeholder),f.attached=!1;else{for(d=Math.max(g-1,0);0<=d;d--)if(a[d].attached){l=a[d].placeholder.nextSibling;break}l||(l=b);var n=c?h[0]:h;d=l.parentNode;n!==l&&(l&&f.placeholder.nextSibling!==l?(d.insertBefore(c?R.dom.toFragment(h):h,l),d.insertBefore(f.placeholder,
l)):l||(d.appendChild(c?R.dom.toFragment(h):h),d.appendChild(f.placeholder)));f.attached=!0}}},getListItem:function(a,c){return a[c]},getTrackByFunction:function(){var a=this,c;a._trackByFn||((c=a._trackBy)&&"$"!==c?G(c)?a._trackByFn=c:a._trackByFn=function(b){if(b&&!Aa(b))return a._localTrack&&!b[c]&&(b[c]=E()),b[c]}:a._trackByFn=function(b){return Aa(b)?b:void 0});return a._trackByFn},localTracklistFilter:function(a,c){if(!a)return[];H(a)||(a=[a]);!1!==this._trackBy&&this._localTrack&&(this._trackBy||
(this._trackBy="$$"+c.id),this.getTrackList(a));return a},getTrackList:function(a){var c=this.getTrackByFunction(),b=[],d;var e=-1;for(d=a.length;++e<d;b.push(c(a[e])));return b},scopeGetRawIndex:function(a){if(void 0===a)return-1;var c=this.getList(),b=this.getTrackByFunction(),d;var e=0;for(d=c.length;e<d;e++)if(b(c[e])===a)return e;return-1},_parseExpr:function(a){if(R.app.prebuilt.isKey(a)){var c=R.app.prebuilt.get("config",a);a={model:c,name:c.inflate.itemName};this.listSourceExpr=c}else a=R.app.Directive.getDirective("attr",
"each").splitExpression(a),this.listSourceExpr=a.model;this.itemScopeName=a.name},onDestroy:function(){var a=this._items,c;var b=0;for(c=a.length;b<c;b++)a[b].renderer&&!a[b].renderer.$destroyed&&a[b].renderer.$destroy();this._renderQueue.$destroy();this._attachQueue.$destroy();this._mo&&(this._mo.unsubscribe(this.onChange,this),this._mo.$destroy(!0))}});R.app.StoreRenderer=R.app.ListRenderer.$extend({store:null,$constructor:function(a,c,b,d,e){b.setDefaultMode("pullNext",R.lib.Config.MODE_STATIC);if(b.hasValue("pullNext")&&b.get("pullNext")){b.hasValue("buffered")&&(b.setStatic("bufferedPullNext",!0),b.setStatic("buffered",!1));var g=b.get("pullNext");this.$plugins.push("string"===typeof g?g:"MetaphorJs.plugin.ListPullNext")}this.$super(a,c,b,d,e)},initDataSource:function(){var a;this.store=a=R.lib.Expression.get(this.listSourceExpr,this.scope);
!1!==this._trackBy&&(this._trackByFn=a.getRecordId.bind(a));this._mo=R.lib.MutationObserver.get(a,"current",this.onChange,this);this._griDelegate=a.indexOfId.bind(a);this.bindStore(a,"on")},bindStore:function(a,c){a[c]("update",this.onStoreUpdate,this);a[c]("clear",this.onStoreUpdate,this);a[c]("destroy",this.onStoreDestroy,this)},onStoreUpdate:function(){this._mo.check()},getListItem:function(a,c){return this.store.getRecordData(a[c])},onStoreDestroy:function(){this._mo&&(this.onStoreUpdate(),this._mo.unsubscribe(this.onChange,
this),this._mo.$destroy(!0),this._mo=null)},onDestroy:function(){this.store.$destroyed||this.bindStore(this.store,"un");this.$super()}});R.app.view.Base=U({$mixins:[R.mixin.Observable],$init:function(a){D(this,a,!0,!1);this.config||(this.config=new R.lib.Config(null,{scope:this.scope}));this.initConfig();(a=this.node)&&a.firstChild&&R.dom.data(a,"mjs-transclude",R.dom.toFragment(a.childNodes));this.id||(this.id=this.config.get("id")||E());this.scope.$app.registerCmp(this,"id");this.initView()},initView:function(){},initConfig:function(){var a=this.config,c=R.lib.Config.MODE_STATIC;a.setType("scrollOnChange","bool",c);a.setDefaultMode("defaultCmp",
c);a.setDefaultMode("id",c)},clearComponent:function(){var a=this,c=a.node,b=a.currentComponent;if(b){var d=null,e=a.config;e&&!e.$isDestroyed()&&e.get("animate")&&(d="leave");R.animate.animate(c,d).done(function(){for(b&&!b.$isDestroyed()&&b.$destroy();c.firstChild;)c.removeChild(c.firstChild);a.currentComponent=null})}},onCmpDestroy:function(){},setComponent:function(a){var c=this,b=c.node;c.beforeCmpChange(a);R.animate.stop(c.node);c.clearComponent();R.animate.animate(b,c.config.get("animate")?
"enter":null,function(){var d=Da(a)?a:{},e=(I(a)?a:null)||"MetaphorJs.app.Component",g=d.scope||c.scope.$new();d.destroyEl=!1;d.autoRender=!0;d.scope=g;return R.app.resolve(e,d,b,[d]).done(function(f){f.on("destroy",c.onCmpDestroy,c);c.currentComponent=f;c.afterCmpChange()})})},currentIs:function(a){return this.currentComponent&&this.currentComponent.$is(a)},beforeCmpChange:function(){},afterCmpChange:function(){var a=this;a.trigger("change",a);a.config.get("scrollOnChange")&&X(function(){a.node.scrollTop=
0})},onDestroy:function(){this.clearComponent();this.node&&R.dom.data(this.node,"mjs-transclude",null,"remove");this.currentView=this.currentComponent=this.scope=null;this.$super()}});R.app.view.Component=R.app.view.Base.$extend({initConfig:function(){this.config.setDefaultMode("value",R.lib.Config.MODE_DYNAMIC);this.$super()},initView:function(){this.config.on("value",this.onCmpChange,this);this.onCmpChange()},onCmpChange:function(){var a=this.config.get("value")||this.config.get("defaultCmp");a?this.setComponent(a):this.currentComponent&&this.clearComponent()}});R.regexp.location=/^(((([^:\/#\?]+:)?(?:(\/\/)((?:(([^:@\/#\?]+)(?::([^:@\/#\?]+))?)@)?(([^:\/#\?\]\[]+|\[[^\/\]@#?]+\])(?::([0-9]+))?))?)?)?((\/?(?:[^\/\?#]+\/+)*)([^\?#]*)))?(\?[^#]+)?)(#.*)?/;R.browser.parseLocation=function(a){var c=a.match(R.regexp.location)||[],b=("undefined"!=typeof window?window.location:null)||{};return{protocol:c[4]||b.protocol||"http:",hostname:c[11]||b.hostname||"",host:(c[11]||"")+(c[12]?":"+c[12]:"")||b.host||"",username:c[8]||b.username||"",password:c[9]||b.password||"",port:parseInt(c[12],10)||b.port||"",href:a,path:(c[13]||"/")+(c[16]||""),pathname:c[13]||"/",search:c[16]||"",hash:c[17]&&"#"!=c[17]?c[17]:""}};R.browser.joinLocation=function(a,c){var b="";c=c||{};c.onlyPath||(b+=a.protocol+"//",a.username&&a.password&&(b+=a.username+":"+a.password+"@"),b+=a.hostname,a.hostname&&a.port&&(b+=":"+a.port));c.onlyHost||(b+=a.pathname||"/",a.search&&"?"!=a.search&&(b+=a.search),a.hash&&"#"!=a.hash&&(b+=a.hash));return b};R.lib.History=function(){function a(){r=window;q=r.history;t=r.location;O=!!q.pushState;Z="onhashchange"in r;N=!1;ba=D({},t,!0,!1);if(O)R.dom.addListener(r,"popstate",b),A=function(K,P,da){if(!1===c("before-location-change",K,P))return!1;q.pushState(p(da),null,h(K));d(K)},C=function(K,P,da){q.replaceState(m(da),null,h(K));d(K)},F(function(){C(e())});else if(Z)A=function(K,P,da){if(!1===c("before-location-change",K,P))return!1;F(g,null,[h(K),p(da)])},C=function(K,P,da){F(g,null,[h(K),m(da)])},R.dom.addListener(r,
"hashchange",b);else{var z=null,L=!1;r.onIframeHistoryChange=function(K){L||F(function(){g(K);b()})};var W=function(K){var P=z.contentDocument?z.contentDocument:z.contentWindow.document;P.open();P.write("<html><head><title>"+document.title+'</title><script type="text/javascript">var hashValue = "'+K+'";window.top.onIframeHistoryChange(hashValue);\x3c/script></head><body>&nbsp;</body></html>');P.close()};A=function(K,P){if(!1===c("before-location-change",K,P))return!1;W(h(K))};C=function(K,P){if(!1===
c("before-location-change",K,P))return!1;z.contentWindow.hashValue=h(K)};var Y=function(){z=window.document.createElement("iframe");z.src="about:blank";z.style.display="none";window.document.body.appendChild(z);L=!0;W(h(t.hash.substr(1)));L=!1};J?Y():R.dom.addListener(r,"load",Y)}R.dom.addListener(window.document.documentElement,"click",function(K){K=R.dom.normalizeEvent(K||r.event);for(var P=K.target,da;P&&"a"!=P.nodeName.toLowerCase();)P=P.parentNode;if(P&&!K.isDefaultPrevented()){da=R.dom.getAttr(P,
"href");if("#"==da&&!u.trigger("void-click",P))return K.preventDefault(),K.stopPropagation(),!1;if(da&&"#"!=da.substr(0,1)&&!R.dom.getAttr(P,"target")){var Ra=D({},t,!0,!1),Sa=R.browser.parseLocation(da);if(n(Ra,Sa))return null;l(Ra,Sa)?A(da,P):c("same-location",null,P);K.preventDefault();K.stopPropagation();return!1}}return null});a=M}function c(z,L,W){L=L||e();var Y=R.browser.parseLocation(L);return u.trigger(z,Y.pathname+Y.search+Y.hash,W,L)}function b(){if(l(ba,t)){var z=e();c("before-location-pop",
z);v=O?q.state?q.state[w]:null:f(t.hash).id;ba=D({},t,!0,!1);c("location-change",z)}}function d(z){ba=D({},t,!0,!1);c("location-change",z)}function e(){if(O)var z=R.browser.joinLocation(t);else{z=t.hash.substr(1);var L=D({},t,!0,!1);z&&(z=f(z).hash,"!"==z.substr(0,1)&&(z=z.substr(1)),z=decodeURIComponent(z).split("?"),L.pathname=z[0],L.search=z[1]?"?"+z[1]:"");z=R.browser.joinLocation(L)}return z}function g(z){z?("#"!=z.substr(0,1)&&(z=f(z).hash,z="!"+z+"#"+y+"="+v),t.hash=z):t.hash=""}function f(z){var L=
null;z=z.replace(x,function(W,Y){L=Y;return""});return{hash:z,id:L}}function h(z){z=R.browser.parseLocation(z);return!O||N?z.path:R.browser.joinLocation(z,{onlyPath:!0})}function l(z,L){"string"==typeof z&&(z=R.browser.parseLocation(z));"string"==typeof L&&(L=R.browser.parseLocation(L));return n(z,L)||z.pathname!=L.pathname||z.search!=L.search||z.hash!=L.hash}function n(z,L){"string"==typeof z&&(z=R.browser.parseLocation(z));"string"==typeof L&&(L=R.browser.parseLocation(L));var W=["protocol","host",
"port"],Y;var K=0;for(Y=W.length;K<Y;K++){var P=W[K];if(z[P]&&L[P]&&z[P]!=L[P])return!0}return!1}function m(z){z=z||{};z[w]||(z[w]=v);return z}function p(z){z=z||{};z[w]||(z[w]=E());v=z[w];return z}var r,q,t,u=new R.lib.Observable,y=E(),w="$$"+y,v=E(),x=new RegExp("#"+y+"=([A-Z0-9]+)"),A,C,J="undefined"==typeof window,ba=null,O,Z,N;u.createEvent("before-location-change",!1);u.createEvent("void-click",!1);R.dom.addListener(window,"load",function(){J=!0});return D({},{on:function(){return u.on.apply(u,
arguments)},un:function(){return u.un.apply(u,arguments)},once:function(){return u.once.apply(u,arguments)},push:function(z,L){a();var W=D({},t,!0,!1),Y=R.browser.parseLocation(z);if(n(W,Y))return null;l(W,Y)&&A(z,null,L)},replace:function(z,L){a();var W=D({},t,!0,!1),Y=R.browser.parseLocation(z);if(n(W,Y))return null;l(W,Y)&&C(z,null,L)},saveState:function(z){a();C(e(),null,z)},mergeState:function(z){this.saveState(D({},q.state,z,!0,!1))},getState:function(){return q.state},getCurrentStateId:function(){return v},
current:function(){a();return e()},init:function(){return a()},polyfill:function(){a();window.history.pushState=function(z,L,W){A(W,null,z)};window.history.replaceState=function(z,L,W){C(W,null,z)}}})}();R.lib.UrlParam=function(){var a={},c=U({$mixins:[R.mixin.Observable],id:null,name:null,extractor:null,context:null,regexp:null,valueIndex:1,prev:null,value:null,enabled:!0,$init:function(b){D(this,b,!0,!1);this.regexp&&I(this.regexp)&&(this.regexp=Ha(this.regexp));!this.name||this.regexp||this.extractor||(this.regexp=Ha(this.name+"=([^&]+)"));if(!this.regexp&&!this.extractor)throw Error("Invalid UrlParam config, missing regexp or extractor");this.enabled&&(this.enabled=!1,this.enable())},enable:function(){if(!this.enabled){this.enabled=
!0;R.lib.History.on("location-change",this.onLocationChange,this);var b=R.lib.History.current();b=R.browser.parseLocation(b);this.onLocationChange(b.pathname+b.search+b.hash)}},disable:function(){this.enabled&&(this.enabled=!1,R.lib.History.un("location-change",this.onLocationChange,this))},onLocationChange:function(b){b=this.extractValue(b);this.value!=b&&(this.prev=this.value,this.value=b,this.trigger("change",b,this.prev))},extractValue:function(b){if(this.regexp)return(b=b.match(this.regexp))?
b[this.valueIndex]:null;if(this.extractor)return this.extractor.call(this.context,b)},getValue:function(){return this.value},getPrev:function(){return this.prev},destroyIfIdle:function(){this.$$observable.hasListener()||this.$destroy()},onDestroy:function(){this.disable()}},{get:function(b){return b.id&&a[b.id]?a[b.id]:new c(b)}});return c}();R.animate.stop=function(a){var c=R.dom.data(a,"mjsAnimationQueue");if(H(c)&&c.length){if(c=c[0]){if(c.stages){var b=c.position;var d=c.stages;R.dom.removeClass(a,d[b]);R.dom.removeClass(a,d[b]+"-active")}c.deferred&&c.deferred.reject(c.el)}}else G(c)?c(a):"stop"===c&&$(a).stop(!0,!0);R.dom.data(a,"mjsAnimationQueue",null)};R.app.view.Router=R.app.view.Base.$extend({initView:function(){this.routeMap={};this.cmpCache={};this.domCache={};this.route=this.route||[];R.lib.History.init();R.lib.History.on("location-change",this.onLocationChange,this);this.initRoutes();this.onLocationChange()},initRoutes:function(){var a=this.route,c,b;var d=0;for(c=a.length;d<c;d++){var e=a[d];e.id=e.id||E();if(e.params){var g={};var f=0;for(b=e.params.length;f<b;f++){var h=e.params[f];h.name&&(g[h.name]=new R.lib.UrlParam(D({},h,{enabled:!1},
!0,!1)))}e.params=g}this.routeMap[e.id]=e}},onLocationChange:function(){if(!this.$destroyed&&!this.$destroying){var a=this,c=R.lib.History.current();c=R.browser.parseLocation(c);var b=c.pathname+c.search+c.hash,d=a.route,e,g,f;var h=0;for(g=d.length;h<g;h++){var l=d[h];if(l.regexp&&(f=c.pathname.match(l.regexp))){a.resolveRoute(l,f);return}if(l.regexpFull&&(f=b.match(l.regexp))){a.resolveRoute(l,f);return}l["default"]&&!e&&(e=l)}(f=a.onNoMatchFound(c))?Q(f)?(f.done(a.resolveRoute,a),f.fail(function(){a.finishOnLocationChange(e)})):
a.resolveRoute(f):a.finishOnLocationChange(e)}},finishOnLocationChange:function(a){this.$destroyed||this.$destroying||(a?this.resolveRoute(a):this.config.hasExpression("defaultCmp")&&this.setComponent(this.config.get("defaultCmp")))},resolveRoute:function(a,c){var b=this;c=c||[];if(a.resolve){var d=a.resolve.call(b,a,c);Q(d)?d.done(function(){b.setRouteComponent(a,c)}):d&&b.setRouteComponent(a,c)}else b.setRouteComponent(a,c)},onNoMatchFound:function(){},toggleRouteParams:function(a,c){if(a.params)for(var b in a.params)a.params[b][c]()},
setRouteClasses:function(a){a.cls&&(this.currentCls=a.cls,R.dom.addClass(this.node,a.cls));a.htmlCls&&(this.currentHtmlCls=a.htmlCls,R.dom.addClass(window.document.documentElement,a.htmlCls))},onRouteFail:function(){},onRouteParamChange:function(){},setRouteComponent:function(a,c){var b=this,d=b.node,e=a.params,g=b.currentView||{};if(!b.$destroyed&&!b.$destroying)if(a.id!==g.id||a.resetOnParamChange)a.ttlTmt&&clearTimeout(a.ttlTmt),b.beforeRouteCmpChange(a),b.toggleRouteParams(g,"disable"),b.toggleRouteParams(a,
"enable"),R.animate.stop(b.node),b.clearComponent(),g.teardown&&g.teardown(g,a,c),b.setRouteClasses(a),b.currentView=a,R.animate.animate(d,b.config.get("animate")?"enter":null,function(){var f=c||[],h={destroyEl:!1,autoRender:!0,node:d,destroyScope:!0,scope:b.scope.$new()};a.config&&(h.config=a.config);a.template&&(h.template=a.template);f.shift();e&&D(h,e,!1,!1);f.unshift(h);if(b.cmpCache[a.id])b.currentComponent=b.cmpCache[a.id],d.appendChild(b.domCache[a.id]),b.currentComponent.unfreeze(b),b.afterRouteCmpChange(),
b.afterCmpChange();else if(a.setup)a.setup(a,c);else return R.app.resolve(a.cmp||"MetaphorJs.app.Component",h,d,f).done(function(l){b.currentComponent=l;a.keepAlive&&(l[b.id]=a.id,b.cmpCache[a.id]=l,b.domCache[a.id]=window.document.createDocumentFragment(),l.on("destroy",b.onCmpDestroy,b));b.afterRouteCmpChange();b.afterCmpChange()}).fail(function(){b.onRouteFail(a)})});else if(b.currentComponent&&b.currentComponent.onViewRepeat)b.currentComponent.onViewRepeat()},currentIs:function(a){return this.currentView&&
this.currentView.id==a?!0:this.$super(a)},clearComponent:function(){var a=this,c=a.node,b=a.currentView||{};a.$destroyed||a.$destroying||(a.currentCls&&R.dom.removeClass(a.node,a.currentCls),a.currentView=null,a.currentHtmlCls&&R.dom.removeClass(window.document.documentElement,a.currentHtmlCls),a.currentComponent&&R.animate.animate(c,a.config.get("animate")?"leave":null).done(function(){if(b.keepAlive){a.currentComponent.freeze(a);for(var d=a.domCache[b.id];c.firstChild;)d.appendChild(c.firstChild);
b.ttl&&(b.ttlTmt=F(a.onCmpTtl,a,[b],b.ttl))}else for(!a.currentComponent||a.currentComponent.$destroyed||a.currentComponent.$destroying||a.currentComponent.$destroy();c.firstChild;)c.removeChild(c.firstChild);a.currentComponent=null}))},onCmpTtl:function(a){a=a.id;route.ttlTmt=null;this.$destroyed||this.$destroying||!this.cmpCache[a]||(this.cmpCache[a].$destroy(),delete this.cmpCache[a],delete this.domCache[a])},onCmpDestroy:function(a){a=a[this.id];!this.$destroyed&&!this.$destroying&&a&&this.cmpCache[a]&&
(delete this.cmpCache[a],delete this.domCache[a])},beforeRouteCmpChange:function(){},afterRouteCmpChange:function(){},onDestroy:function(){var a,c;R.lib.History.un("location-change",this.onLocationChange,this);var b=0;for(a=this.route.length;b<a;b++)if(this.route[b].params)for(c in this.route[b].params)this.route[b].params[c].$destroy();this.route=null;this.$super()}});La.$prebuild={defaultMode:R.lib.Config.MODE_STATIC,ignore:!0};R.app.Directive.registerAttribute("app",100,La);V.registerAttribute("in-focus",500,V.$extend({$class:"MetaphorJs.app.Directive.attr.Autofocus",id:"autofocus",initChange:function(){},initDirective:function(){var a=this,c=a.config.get("value");(c=""+parseInt(c)===c?parseInt(c):"false"===c?!1:!!c)&&F(function(){a.node.focus();a.$destroy()},null,[],!0===c?300:c)}}));V.registerAttribute("bind",1E3,V.$extend({$class:"MetaphorJs.app.Directive.attr.Bind",id:"bind",_apis:["node","input"],input:null,textRenderer:null,initDirective:function(){var a=this.config;if(this.input)this.input.onChange(this.onInputChange,this);this.optionsChangeDelegate=this.onOptionsChange.bind(this);R.dom.addListener(this.node,"optionschange",this.optionsChangeDelegate);if(a.has("if"))a.on("if",this.onIfChange,this);a.get("recursive")?(a.disableProperty("value"),a.disableProperty("recursive"),
this.textRenderer=new R.lib.Text(this.scope,a.getExpression("value"),{recursive:!0,fullExpr:!0,once:a.get("once")}),this.textRenderer.subscribe(this.onTextRendererChange,this),this.onTextRendererChange()):this.$super()},initNode:function(a){R.dom.isField(a)&&(this.input=R.lib.Input.get(a))},onInputChange:function(){var a=this.config;if(a.has("locked")&&a.get("locked")){a=this.config.get("value")||null;var c=this.input.getValue()||null;if(a!=c)this.onScopeChange()}},onTextRendererChange:function(){this.onScopeChange()},
onOptionsChange:function(){this.onScopeChange()},onIfChange:function(){if(this.config.get("if"))this.onScopeChange()},onScopeChange:function(){var a=this.config;if(!a.has("if")||a.get("if"))a=this.textRenderer?this.textRenderer.getString():this.config.get("value"),this.updateElement(a)},updateElement:function(a){this.input?this.input.getValue()!=a&&this.input.setValue(a):this.node["string"===typeof this.node.textContent?"textContent":"innerText"]=a},onDestroy:function(){R.dom.removeListener(this.node,
"optionschange",this.optionsChangeDelegate);this.textRenderer&&(this.textRenderer.$destroy(),this.textRenderer=null);this.input&&(this.input.unChange(this.onInputChange,this),this.input.$destroy(),this.input=null);this.$super()}},{initConfig:function(a){a.setType("if","bool");a.setType("recursive","bool");a.setType("once","bool",R.lib.Config.MODE_STATIC);a.setType("locked","bool")}}));V.registerAttribute("bind-html",1E3,V.attr.Bind.$extend({$class:"MetaphorJs.app.Directive.attr.BindHtml",id:"bind-html",_apis:["node"],updateElement:function(a){this.node.innerHTML=a}}));(function(){function a(c,b,d,e){c.className||(c.className="");if(null!==d){if(d===R.dom.hasClass(c,b))return;d=!d}else d=R.dom.hasClass(c,b);d?e?R.animate.animate(c,[b+"-remove"]).done(function(){R.dom.removeClass(c,b)}):R.dom.removeClass(c,b):e?R.animate.animate(c,[b+"-add"]).done(function(){R.dom.addClass(c,b)}):R.dom.addClass(c,b)}V.registerAttribute("class",1E3,V.$extend({$class:"MetaphorJs.app.Directive.attr.Class",id:"class",_initial:!0,_prev:null,initConfig:function(){var c=this,b=c.config;
b.eachProperty(function(d){if("value"===d||0===d.indexOf("value."))b.on(d,c.onScopeChange,c)});c.$super()},initChange:function(){if(this._autoOnChange)this.onScopeChange()},getCurrentValue:function(){var c=this.config.getAllValues(),b=[];c[""]&&(b.push(c[""]),delete c[""]);b.push(c);c={};var d,e;var g=0;for(d=b.length;g<d;g++){var f=b[g];if("string"===typeof f)c[f]=!0;else{if(H(f)){var h=-1;for(e=f.length;++h<e;c[f[h]]=!0);}for(h in f)if("_"===h)for(h=-1,e=f._.length;++h<e;c[f._[h]]=!0);else c[h]=
f[h]}}return c},onScopeChange:function(){var c=this.node,b=this.getCurrentValue(),d=this._prev,e;R.animate.stop(c);if(d)for(e in d)d.hasOwnProperty(e)&&void 0===b[e]&&a(c,e,!1,!1);for(e in b)b.hasOwnProperty(e)&&a(c,e,!!b[e],!this._initial&&this.config.get("animate"));this._prev=b;this._initial=!1}},{initConfig:function(c){c.setType("animate","bool")}}))})();(function(){function a(c,b,d,e,g){if(!(b instanceof window.Node))throw Error("cmp directive can only work with DOM nodes");d.has("scope")||(c=c.$new());a.initConfig(d);var f=d.get("value"),h=b.tagName.toLowerCase();d.removeProperty("value");var l={scope:c,node:b,config:d,parentRenderer:e,autoRender:!0};R.directive.component[h]&&(l.directives=g.directives,e.flowControl("stop",!0));b=R.app.resolve(f,l,b,[l]).done(function(n){e.$destroyed||c.$$destroyed?n.$destroy():(e.on("destroy",n.$destroy,n),e.trigger("reference",
"cmp",d.get("ref")||n.id,n,l,g))});e.trigger("reference-promise",b,f,l,g);e.flowControl("ignoreInside",!0)}a.initConfig=function(c){var b=R.lib.Config.MODE_STATIC;c.setDefaultMode("value",b);c.setDefaultMode("init",R.lib.Config.MODE_FUNC);c.setDefaultMode("as",b);c.setDefaultMode("ref",b);c.setDefaultMode("scope",b);c.setMode("into",b);c.setType("cloak","bool",b)};a.deepInitConfig=function(c){var b=c.get("value");(b="string"===typeof b?cb.get(b):b)&&b.initConfig&&b.initConfig(c)};V.registerAttribute("cmp",
200,a)})();(function(){function a(c,b,d,e,g){a.initConfig(d);var f=d.get("value");d.removeProperty("value");d.has("scope")&&e.flowControl("newScope",c);d={scope:c,node:b,config:d,parentRenderer:e,attrSet:g};R.app.resolve(f,d,b,[d]).done(function(h){if(e.$destroyed||c.$$destroyed)h.$destroy();else e.on("destroy",h.$destroy,h)})}a.initConfig=function(c){var b=R.lib.Config.MODE_STATIC;c.setDefaultMode("value",b);c.setDefaultMode("as",b);c.setDefaultMode("scope",b)};a.deepInitConfig=function(c){var b=c.get("value");
(b="string"===typeof b?cb.get(b):b)&&b.initConfig&&b.initConfig(c)};V.registerAttribute("controller",200,a)})();(function(){function a(b,d,e,g,f){if(!(d instanceof window.Node))throw Error("'each' directive can only work with DOM nodes");g&&g.flowControl("stop",!0);e.disableProperty("value");a:{var h="mjs-each"===d.nodeName.toLowerCase()?R.dom.getAttr(d,"value"):e.getExpression("value");var l=0;var n=c.length,m;R.app.prebuilt.isKey(h)?m=R.app.prebuilt.get("config",h):"string"!==typeof h&&(m=h);m?h=R.lib.Expression.construct(m,{getterOnly:!0})(b):(m=h.split(" in "),h=R.lib.Expression.get(1===m.length?h:m[1],
b));for(;l<n;l++)if(h instanceof c[l][0]){l=c[l][1];break a}l=null}return new (l||R.app.ListRenderer)(b,d,e,g,f)}var c=[];a.registerType=function(b,d){c.push([b,d])};a.deepInitConfig=function(b){b=b.getProperty("value");var d=this.splitExpression(b.expression);b.expression=d.model;b.inflate=b.inflate||{};b.inflate.itemName=d.name};a.splitExpression=function(b){b=b.split(" ");var d;var e=0;for(d=b.length;e<d;e++){var g=b[e];if(""!==g&&"in"!==g)if(h){var f=b.slice(e).join(" ");break}else var h=g}return{model:f,
name:h||"item"}};a.registerType(Array,R.app.ListRenderer);V.registerAttribute("each",100,a);V.registerTag("each",a)})();R.dom.getStyle=function(a,c,b){if(window.getComputedStyle){if(a===window)return c?b?0:null:{};a=window.getComputedStyle(a,null)}else a=a.currentStyle||a.style||{};c=c?a[c]:a;return b?parseFloat(c)||0:c};var Ma=function(){var a;return function(){if(void 0===a){var c=window.document,b=c.createElement("div"),d=c.createElement("div");c=c.body;d.style&&window.getComputedStyle?(b.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",b.appendChild(d),d.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",d.innerHTML="",c.appendChild(b),d=
"4px"===window.getComputedStyle(d,null).width,c.removeChild(b),a=d):a=!1}return a}}();R.dom.getWidth=Na("","Width");R.dom.getHeight=Na("","Height");R.dom.getScrollTop=Oa(!0);R.dom.getScrollLeft=Oa(!1);R.lib.EventBuffer=function(){function a(c,b,d,e){var g="$$"+b+"_"+d;if(c[g])return c[g];c[g]=this;this.eventOptions=e||{};this.id=g;this.breaks={};this.watchers={};this.node=c;this.event=b;this.observable=new R.lib.Observable;this.interval=d||0;this.handlerDelegate=this.handler.bind(this);this.triggerDelegate=this.trigger.bind(this);this.up()}D(a.prototype,{observable:null,handlerDelegate:null,triggerDelegate:null,watchers:null,breaks:null,running:!1,lastEvent:null,currentEvent:null,interval:null,
id:null,handler:function(c){this.running?c&&(this.lastEvent=c):this.next(c)},next:function(c){var b=this.interval;if(c=c||this.lastEvent)this.lastEvent=null,this.running=!0,this.currentEvent=c,"raf"===b?X(this.triggerDelegate):setTimeout(this.triggerDelegate,b)},watchWidth:function(){this.addWatcher("width",R.dom.getWidth)},watchHeight:function(){this.addWatcher("height",R.dom.getHeight)},watchScrollTop:function(){this.addWatcher("scrollTop",R.dom.getScrollTop)},watchScrollLeft:function(){this.addWatcher("scrollLeft",
R.dom.getScrollLeft)},addWatcher:function(c,b,d){this.watchers[c]||(this.watchers[c]={fn:b,context:d,prev:null,current:parseInt(b.call(d,this.node),10)})},removeWatcher:function(c){delete this.watchers[c]},breakFilter:function(c,b,d){if(!this.watchers[d.watcher])return!1;var e=c.breakValue,g=c.breakLuft||0,f=e-(c.breakLowLuft||g);c=e+(c.breakHighLuft||g);g=this.watchers[d.watcher];d=g.current;g=g.prev;var h=Math.min(g,d),l=Math.max(g,d);if("!="===e)return g!=d;b[0].breakPosition=d<f?-1:d>=c?1:0;return h<=
f&&f<=l||h<=c&&c<=l},onBreak:function(c,b,d,e,g){var f=c+"_"+b;g=g||{};g.breakValue=b;this.breaks[f]||(this.breaks[f]=this.observable.createEvent(f,{watcher:c,triggerFilter:this.breakFilter,filterContext:this}));this.breaks[f].on(d,e,g)},unBreak:function(c,b,d,e,g){c=c+"_"+b;this.breaks[c]&&(this.breaks[c].un(d,e),this.breaks[c].hasListener()||(this.observable.destroyEvent(c),this.breaks[c]=null,delete this.breaks[c]));g&&this.destroyIfIdle()},on:function(c,b,d){this.observable.on(this.event,c,b,
d)},un:function(c,b,d){this.observable.un(this.event,c,b);d&&this.destroyIfIdle()},trigger:function(){var c=this.currentEvent,b=this.watchers,d=this.breaks,e=this.node,g,f;this.observable.trigger(this.event,c);for(g in b)b[g].prev=b[g].current,b[g].current=parseInt(b[g].fn.call(b[g].context,e,c),10);for(f in d)d[f].trigger(c);this.running=!1;this.currentEvent=null;this.next()},up:function(){R.dom.addListener(this.node,this.event,this.handlerDelegate,this.eventOptions)},down:function(){R.dom.removeListener(this.node,
this.event,this.handlerDelegate)},destroyIfIdle:function(){if(this.observable&&!this.observable.hasListener())return this.$destroy(),!0},$destroy:function(){delete this.node[this.id];this.down();this.observable.$destroy()}});a.get=function(c,b,d,e){var g="$$"+b+"_"+d;return c[g]?c[g]:c[g]=new a(c,b,d,e)};return a}();R.lib.EventHandler=function(a,c,b,d){this.config=d;this.event=a;this.prevEvent={};this.scope=c;this.node=b;this.buffer=this.handler=null;if(d.hasExpression("if"))d.on("if",this.onIfChange,this);this.up()};
D(R.lib.EventHandler.prototype,{$destroyed:!1,$destroying:!1,onIfChange:function(a){this[a?"up":"down"]()},createHandler:function(){function a(g){if(!c.$destroyed&&!c.$destroying){var f,h=!1,l=void 0,n=!1,m=!1,p=d.getAll(),r=p.not,q=[],t=[],u=!1;d.eachProperty(function(x){0===x.indexOf("value")&&(q.push(d.get(x)),t.push(x))});void 0!==p.preventDefault&&(h=p.preventDefault);void 0!==p.stopPropagation&&(n=p.stopPropagation);void 0!==p.stopImmediatePropagation&&(m=p.stopImmediatePropagation);void 0!==
p.returnValue&&(l=p.returnValue);void 0!==p.keyCode&&(f=p.keyCode);g=R.dom.normalizeEvent(g||window.event);if(r){H(r)||(r=[r]);var y;var w=0;var v=r.length;a:for(;w<v;w++)for(y=g.target;y&&y!==c.node;){if(R.dom.is(y,r[w])){u=!0;break a}y=y.parentNode}}if(f&&("number"===typeof f&&f!==g.keyCode||-1===f.indexOf(g.keyCode)))return null;b.$event=g;b.$eventNode=c.node;b.$prevEvent=c.prevEvent[g.type];b.$eventCmp=d.get("targetComponent");if(!u&&0<q.length)for(w=0,v=q.length;w<v;w++)f=q[w],(f=f.call(p.context||
null,b))&&ea(f)&&(void 0!==f.preventDefault&&(h=f.preventDefault),void 0!==f.stopPropagation&&(n=f.stopPropagation),void 0!==f.returnValue&&(l=f.returnValue));n&&g.stopPropagation();m&&g.stopImmediatePropagation&&g.stopImmediatePropagation();h&&g.preventDefault();if(c.$destroyed||c.$destroying)return void 0!==l?l:void 0;b.$event=null;b.$eventNode=null;b.$eventCmp=null;c.prevEvent[g.type]=g;w=0;for(v=t.length;w<v;w++)d.checkScope(t[w]);if(void 0!==l)return l}}var c=this,b=c.scope,d=c.config,e;return(e=
c.config.get("async"))?function(g){F(a,null,[g],"number"==typeof e?e:null)}:a},up:function(){var a=this.config,c=a.get("buffer");if(!a.hasExpression("if")||a.get("if"))this.handler=this.createHandler(),c?(this.buffer=R.lib.EventBuffer.get(this.node,this.event,c,this._getEventConfig()),this.buffer.on(this.handler)):R.dom.addListener(this.node,this.event,this.handler,this._getEventConfig())},down:function(){this.buffer?(this.buffer.un(this.handler),this.buffer.destroyIfIdle(),this.buffer=null):R.dom.removeListener(this.node,
this.event,this.handler)},_getEventConfig:function(){var a={};this.config.hasExpression("passive")&&(a.passive=this.config.get("passive"));return a},$destroy:function(){this.$destroyed||this.$destroying||(this.$destroying=!0,this.down(),this.config.clear(),this.$destroying=!1,this.$destroyed=!0)}});(function(){function a(f,h,l){function n(q){m&&(r=q,R.lib.Input.get(q).onKey(13,m))}function m(){p(f);l.checkScope("value")}b(l);var p=l.get("value"),r;"complete"===window.document.readyState&&c(h,l,"submit",n);R.dom.addListener(window,"load",function(){c(h,l,"submit",n)});return function(){r&&R.lib.Input.get(r).unKey(13,m);p=m=null}}function c(f,h,l,n){V.resolveNode(f,l,function(m,p){p&&h.setProperty("targetComponent",{mode:R.lib.Config.MODE_STATIC,value:p});n(m)})}function b(f){var h=R.lib.Config.MODE_STATIC;
f.setProperty("preventDefault",{type:"bool",defaultValue:!0,defaultMode:h});f.setDefaultMode("scope",h);f.setType("stopPropagation","bool",h);f.setType("stopImmediatePropagation","bool",h);f.setType("if","bool");f.setType("passive","bool");f.setType("not","string",h);f.eachProperty(function(l){"value"!==l&&0!==l.indexOf("value.")||f.setMode(l,R.lib.Config.MODE_FUNC)});return f}var d="click dblclick mousedown mouseup mouseover mouseout mousemove keydown keyup keypress change focus blur copy cut paste load mousewheel touchstart touchend touchcancel touchleave touchmove".split(" "),
e;var g=0;for(e=d.length;g<e;g++)(function(f){function h(l,n,m){function p(u){q||(r=new R.lib.EventHandler(f,l,u,b(m)))}var r,q=!1,t=window.document.readyState;"complete"===t||void 0===t?c(n,m,f,p):R.dom.addListener(window,"load",function(){c(n,m,f,p)});return function(){q=!0;r&&(r.$destroy(),r=null)}}h.initConfig=function(l){b(l)};V.registerAttribute(f,1E3,h)})(d[g]);a.initConfig=b;V.registerAttribute("submit",1E3,a);d=null})();V.registerAttribute("focused",600,V.$extend({$class:"MetaphorJs.app.Directive.attr.InFocus",id:"focused",initChange:function(){},initDirective:function(){this.focusDelegate=this.onInputFocus.bind(this);this.blurDelegate=this.onInputBlur.bind(this);R.dom.addListener(this.node,"focus",this.focusDelegate);R.dom.addListener(this.node,"blur",this.blurDelegate)},onInputFocus:function(){this.config.get("value")(this.scope,!0);this.scope.$check()},onInputBlur:function(){this.config.get("value")(this.scope,
!1);this.scope.$check()},onDestroy:function(){R.dom.removeListener(this.node,"focus",this.focusDelegate);R.dom.removeListener(this.node,"blur",this.blurDelegate);this.$super()}},{initConfig:function(a){a.setMode("value",R.lib.Config.MODE_SETTER)}}));V.registerAttribute("show",500,V.$extend({$class:"MetaphorJs.app.Directive.attr.Show",id:"show",_initial:!0,runAnimation:function(a){function c(){d.display=a?b.config.get("display"):"none";e||b.trigger(a?"show":"hide",b.node)}var b=this,d=b.node.style,e=this._initial;e||!b.config.get("animate")?e?c():X(c):R.animate.animate(b.node,a?"show":"hide",function(){if(a)return new R.lib.Promise(function(g){X(function(){d.display=b.config.get("display");g()})})}).done(c)},onScopeChange:function(a){this.runAnimation(a);
this._initial=!1;this.$super(a)}},{initConfig:function(a){a.setType("display","string",R.lib.Config.MODE_STATIC,"");a.setType("animate","bool",R.lib.Config.MODE_STATIC,!1)}}));V.registerAttribute("hide",500,V.attr.Show.$extend({$class:"MetaphorJs.app.Directive.attr.Hide",id:"hide",onScopeChange:function(a){this.runAnimation(!a);this._initial=!1;this.saveStateOnChange(a)}}));V.registerAttribute("if",500,V.$extend({$class:"MetaphorJs.app.Directive.attr.If",id:"if",_initial:!0,initDirective:function(){this.createCommentWrap(this.node,"if");this.$super()},onScopeChange:function(){function a(){e.parentNode.removeChild(e);g||X(b.trigger,b,["hide",e])}function c(){b.wrapperClose.parentNode.insertBefore(e,b.wrapperClose);g||X(b.trigger,b,["show",e])}var b=this,d=b.config.get("value"),e=b.node,g=b._initial;d?g||!b.config.get("animate")?g?c():X(c):R.animate.animate(e,"enter",
c):e.parentNode&&(g||!b.config.get("animate")?g?a():X(a):R.animate.animate(e,"leave").done(a));b.$super(d);b._initial?b._initial=!1:b.config.get("once")&&b.$destroy()}},{initConfig:function(a){a.setType("animate","bool",R.lib.Config.MODE_STATIC);a.setType("value","bool");a.setType("once","bool",R.lib.Config.MODE_STATIC)}}));V.registerAttribute("include",1100,function(){function a(c,b,d,e){if(!(b instanceof window.Node))throw Error("'include' directive can only work with Node");d.disableProperty("value");d.setProperty("name",d.getProperty("value"));d.removeProperty("value");d.enableProperty("name");d.set("passReferences",!0);a.initConfig(d);var g=new R.app.Template({scope:c,attachTo:b,parentRenderer:e,config:d});e.on("destroy",function(){g.$destroy();g=null});e.flowControl("ignoreInside",!0)}a.initConfig=function(c){c.setType("asis",
"bool",R.lib.Config.MODE_STATIC);c.setDefaultValue("runRenderer",!c.get("asis"))};a.deepInitConfig=function(c){R.app.Template.initConfig(c)};return a}());V.registerAttribute("init",250,function(){function a(c,b,d){a.initConfig(d);d.eachProperty(function(e){("value"===e||0===e.indexOf("value."))&&(e=d.get(e))&&e(c)});d.clear()}a.initConfig=function(c){var b=R.lib.Config.MODE_FUNC;c.eachProperty(function(d){"value"!==d&&0!==d.indexOf("value.")||c.setDefaultMode(d,b)})};return a}());V.registerAttribute("input",1E3,V.$extend({$class:"MetaphorJs.app.Directive.attr.Model",id:"input",_apis:["node","input"],_inProg:!1,_prev:null,initDirective:function(){this.input.onChange(this.onInputChange,this);this._prev=this.input.getValue();this.$super()},initChange:M,onOptionsChange:function(){this.onScopeChange()},onInputChange:function(a){var c=this.scope,b=this.config;if((!b.has("if")||b.get("if"))&&this._prev!=a&&!this._inProg){this._inProg=!0;var d=b.get("value");c.$prev=this._prev;c.$value=
a;d(c);c.$prev=null;c.$value=null;b.checkScope("value");this._prev=a;this._inProg=!1}},onDestroy:function(){this.input.unChange(this.onInputChange,this);this.input.$destroy();this.input=null;this.$super()}},{initConfig:function(a){a.setType("if","bool");a.setMode("value",R.lib.Config.MODE_FUNC)},$prebuild:{skip:!0}}));(function(){function a(d,e,g){function f(p){if(l)for(n in l)l.hasOwnProperty(n)&&l[n]&&m.push(h(p,n,l[n]))}function h(p,r,q){function t(w){d.$event=w;d.$eventCmp=g.get("targetComponent");u(d);d.$event=null;d.$eventCmp=null;d.$check()}"function"===typeof q&&(q={handler:q});var u=q.handler,y=q.context||d;delete q.handler;delete q.context;q.keyCode||(q.keyCode=b[r]||parseInt(r,10));R.lib.Input.get(p).onKey(q,t,y);return function(){R.lib.Input.get(p).unKey(q,t,y)}}a.initConfig(g);var l=g.getAllValues(),
n,m=[];"complete"===window.document.readyState&&c(e,g,f);R.dom.addListener(window,"load",function(){c(e,g,f)});return function(){var p;var r=0;for(p=m.length;r<p;r++)m[r]();m=null}}function c(d,e,g){V.resolveNode(d,"key",function(f,h){h&&e.setProperty("targetComponent",{mode:R.lib.Config.MODE_STATIC,value:h});g(f)})}var b={enter:13,esc:27,escape:27,backspace:8,tab:9,shift:16,ctrl:17,alt:18,pause:19,caps:20,space:32,pageup:33,pagedown:34,end:35,home:36,left:37,up:38,right:39,down:40,insert:45,"delete":46,
0:48,1:49,2:50,3:51,4:52,5:53,6:54,7:55,8:56,9:57,a:65,b:66,c:67,d:68,e:69,f:70,g:71,h:72,i:73,j:74,k:75,l:76,m:77,n:78,o:79,p:80,q:81,r:82,s:83,t:84,u:85,v:86,w:87,x:88,y:89,z:90,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,leftwin:91,rightwin:92,select:93,num0:96,num1:97,num2:98,num3:99,num4:100,num5:101,num6:102,num7:103,num8:104,num9:105,"*":106,multiply:106,"+":107,add:107,"-":109,subtract:109,decimal:110,"/":111,divide:111,numlock:144,scrolllock:145,
semicolon:186,equal:187,comma:188,dash:189,period:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,quote:222};a.initConfig=function(d){d.disableProperty("value");d.eachProperty(function(e,g){0===e.indexOf("value.")&&"{"!==g.expression.charAt(0)&&d.setMode(e,R.lib.Config.MODE_FUNC)})};V.registerAttribute("key",1E3,a)})();V.registerAttribute("model",1E3,V.$extend({$class:"MetaphorJs.app.Directive.attr.Model",id:"model",_apis:["node","input"],_binding:null,_inProg:!1,initDirective:function(){var a=this.config.getExpression("value");this.mo=R.lib.MutationObserver.get(this.scope,a,null,null,{setter:!0});this.mo.subscribe(this.onScopeChange,this);this.input.onChange(this.onInputChange,this);this.optionsChangeDelegate=this.onOptionsChange.bind(this);R.dom.addListener(this.node,"optionschange",this.optionsChangeDelegate);
this.$super();a=this.input.getValue();var c=this.mo.getValue(),b=this.config.get("binding");if(c!==a)if("input"!==b&&void 0!==c)this.onScopeChange(c);else if("scope"!==b&&void 0!==a)this.onInputChange(a)},initChange:M,onOptionsChange:function(){this.onScopeChange()},onInputChange:function(a){var c=this.config;"scope"===(this._binding||c.get("binding"))||c.has("if")&&!c.get("if")||(a&&I(a)&&-1!==a.indexOf("\\{")&&(a=a.replace(/\\{/g,"{")),this.mo.getValue()!=a&&(this.mo.setValue(a),this._inProg=!0,
this.config.checkScope("value"),this._inProg=!1,this.saveStateOnChange(a)))},onScopeChange:function(){var a=this.config,c=this.mo.getValue(),b;"input"===(this._binding||a.get("binding"))||this._inProg||a.has("if")&&!a.get("if")||(window.document.activeElement!==this.node&&(this._binding="scope"),(b=$a())&&8>b?F(this.input.setValue,this.input,[c]):this.input.setValue(c),this._binding=null,this.saveStateOnChange(c))},onDestroy:function(){R.dom.removeListener(this.node,"optionschange",this.optionsChangeDelegate);
this.input.unChange(this.onInputChange,this);this.input.$destroy();this.input=null;this.mo&&(this.mo.unsubscribe(this.onScopeChange,this),this.mo.$destroy(!0));this.$super()}},{initConfig:function(a){a.setMode("value",R.lib.Config.MODE_FNSET);a.setType("if","bool");a.setProperty("binding",{defaultValue:"both",defaultMode:R.lib.Config.MODE_STATIC})},$prebuild:{}}));R.dom.triggerEvent=function(a,c){var b="string"===typeof c,d=b?c:c.type;if(a.fireEvent)return a.fireEvent("on"+d);b&&(document.createEvent?(c=document.createEvent("Event"),c.initEvent(d,!0,!0)):c=new Event(c));return a.dispatchEvent(c)};V.registerAttribute("options",100,V.$extend({$class:"MetaphorJs.app.Directive.attr.Options",id:"options",model:null,store:null,_getterFn:null,_defOption:null,_prevGroup:null,_groupEl:null,_fragment:null,_initial:!1,$init:function(a,c,b,d,e){if(!(c instanceof window.HTMLSelectElement))throw Error("'options' directive can only work with <select>");this.$super(a,c,b,d,e)},initConfig:function(){var a=this.config;a.disableProperty("value");var c=a.getExpression("value");a.on("placeholderName",this.onPlaceholderChange,
this);a.on("placeholderValue",this.onPlaceholderChange,this);this.parseExpr(c);this.$super()},initDirective:function(){var a=this.node;for(this._defOption=a.options.length?a.options[0]:null;a.firstChild;)a.removeChild(a.firstChild);this.config.get("keepDefault")?this._defOption&&R.dom.setAttr(this._defOption,"default-option",""):this._defOption=null;try{var c=R.lib.Expression.get(this.model,this.scope);U.isInstanceOf(c,"MetaphorJs.model.Store")?this.bindStore(c,"on"):this.watcher=R.lib.MutationObserver.get(this.scope,
this.model,this.onScopeChange,this)}catch(b){S(b)}this.watcher?this.renderAll():this.store&&this.renderStore()},bindStore:function(a,c){a[c]("update",this.renderStore,this);this.store=a},getSourceList:function(){return this.store?this.store.toArray():B(this.watcher.getValue())},renderStore:function(){this.render(this.getSourceList());this.dispatchOptionsChange()},renderAll:function(){this.render(this.getSourceList());this.dispatchOptionsChange()},onScopeChange:function(){this.renderAll()},onPlaceholderChange:function(){var a=
this.getSourceList();a&&0!==a.length||this.render(a)},dispatchOptionsChange:function(){!this._initial&&this.node.dispatchEvent&&R.dom.triggerEvent(this.node,"optionschange");this._initial=!1},renderOption:function(a,c,b){var d=this._groupEl||this._fragment,e=R.browser.isIE();b.item=a;b.$index=c;a=this._getterFn(b);void 0!==a.group&&(a.group=""+a.group);a.group!==this.prevGroup&&(a.group?(this._groupEl=d=window.document.createElement("optgroup"),R.dom.setAttr(d,"label",a.group),a.disabledGroup&&R.dom.setAttr(d,
"disabled","disabled"),this._fragment.appendChild(d)):(d=this._fragment,this._groupEl=null));this._prevGroup=a.group;c=window.document.createElement("option");R.dom.setAttr(c,"value",""+a.value||"");c.text=a.name||""+a.value||"";e&&9>e&&(c.innerHTML=a.name||""+a.value||"");a.disabled&&R.dom.setAttr(c,"disabled","disabled");d.appendChild(c)},render:function(a){var c=this.node,b=R.dom.getInputValue(c),d=this._defOption,e=this.scope.$new(),g=R.browser.isIE(),f=this.config.get("placeholderValue"),h=this.config.get("placeholderName")||
f,l;this._fragment=window.document.createDocumentFragment();for(this.groupEl=this.prevGroup=null;c.firstChild;)c.removeChild(c.firstChild);var n=0;for(l=a.length;n<l;n++)this.renderOption(a[n],n,e);d&&c.insertBefore(d,c.firstChild);!f||l||d||(a=document.createElement("option"),a.value=f,a.text=h,c.insertBefore(a,c.firstChild));e.$destroy();if(g&&8>g){var m=c.nextSibling;var p=c.parentNode;p.removeChild(c)}c.appendChild(this._fragment);this._fragment=null;g&&8>g&&p.insertBefore(c,m);R.dom.setInputValue(c,
b)},parseExpr:function(a){a=this.$self.splitExpression(a);this.model=a.model;a.item&&(this._getterFn="function"===typeof a.item?a.item:R.lib.Expression.getter(a.item))},onDestroy:function(){this.store&&this.bindStore(this.store,"un");this.watcher&&(this.watcher.unsubscribe(this.onScopeChange,this),this.watcher.$destroy(!0));this.$super()}},{splitExpression:function(a){if(R.app.prebuilt.isKey(a)){var c=a=R.app.prebuilt.get("config",a);a=a.inflate.item}else{var b=a.indexOf(" in ");-1===b?(c=a,a="{name: this.item, value: this.$index}"):
(c=a.substr(b+4),a=a.substr(0,b))}return{model:c,item:a}},initConfig:function(a){a.setType("keepDefault","bool",R.lib.Config.MODE_STATIC,!0)},deepInitConfig:function(a){a=a.getProperty("value");parts=this.splitExpression(a.expression);a.expression=parts.model;a.inflate=a.inflate||{};a.inflate.item=R.lib.Expression.expression(parts.item)}}));(function(){var a="selected checked disabled readonly open required".split(" "),c,b=V.$extend({$init:function(e,g,f,h,l,n){this.id=e;this.$super(g,f,h,l,n)},onScopeChange:function(e){var g=this.id;e?R.dom.setAttr(this.node,g,g):R.dom.removeAttr(this.node,g)}},{initConfig:function(e){e.setType("value","bool")}});var d=0;for(c=a.length;d<c;d++)(function(e){function g(f,h,l,n,m){return new b(e,f,h,l,n,m)}g.initConfig=b.initConfig;V.registerAttribute(""+e,1E3,g)})(a[d])})();R.app.Directive.registerAttribute("router",200,function(){function a(c,b,d,e){a.initConfig(d);var g=[],f;d.eachProperty(function(h){0===h.indexOf("value.")&&(f=d.get(h),f.id=h.replace("value.",""),g.push(f))});R.app.Directive.resolveNode(b,"router",function(h){if(!e.$destroyed){var l={scope:c,node:h,config:d};0!==g.length&&(l.route=g);R.app.resolve(d.get("value"),l,h,[l]).done(function(n){e.$destroyed||c.$$destroyed?n.$destroy():(e.on("destroy",n.$destroy,n),c.$on("destroy",n.$destroy,n))})}});e.flowControl("ignoreInside",
!0)}a.initConfig=function(c){var b=R.lib.Config.MODE_STATIC;c.setDefaultMode("scope",b);c.setDefaultMode("id",b);c.setProperty("value",{defaultMode:b,defaultValue:"MetaphorJs.app.view.Router"});c.eachProperty(function(d){0===d.indexOf("value.")&&c.setDefaultMode(d,R.lib.Config.MODE_SINGLE)})};return a}());V.registerAttribute("scope",1E3,function(){function a(c,b,d,e){a.initConfig(d);c=R.lib.Scope.$produce(d.get("value"),c);e.flowControl("newScope",c);d.clear()}a.initConfig=function(c){c.setDefaultMode("value",R.lib.Config.MODE_STATIC)};return a}());V.registerAttribute("source-src",1E3,V.$extend({$class:"MetaphorJs.app.Directive.attr.SourceSrc",id:"source-src",usePreload:!0,attr:null,lastPromise:null,src:null,$constructor:function(a,c,b,d,e){this.$self.initConfig(b);b.get("deferred")&&this.$plugins.push("plugin.SrcDeferred");if(b.get("plugin")){var g=b.get("plugin").split(","),f;var h=0;for(f=g.length;h<f;h++)this.$plugins.push(g[h].trim())}this.$super(a,c,b,d,e)},initConfig:function(){},onScopeChange:function(){this.doChange()},doChange:function(){if(!this.$destroyed&&
!this.$destroying){var a=this.config.get("value");a&&(this.src=a,this.config.get("noCache")&&(a+=(-1!==a.indexOf("?")?"&amp;":"?")+"_"+(new Date).getTime()),this.doChangeSource(a),this.onSrcChanged())}},doChangeSource:function(a){var c=this.node,b=R.dom.select("source",c),d=window.document.createElement("source"),e;if(b.length){var g=0;for(e=b.length;g<e;g++)c.removeChild(b[g])}R.dom.setAttr(d,"src",a);c.appendChild(d)},onSrcChanged:function(){}},{initConfig:function(a){var c=R.lib.Config.MODE_STATIC;
a.setType("deferred","bool",c);a.setType("noCache","bool",c);a.setDefaultMode("plugin",c)}}));R.dom.preloadImage=function(){function a(e){if(void 0!==c[e])return!1===c[e]?R.lib.Promise.reject(e):R.lib.Promise.resolve(c[e]);if(b[e])return b[e];1E3<d&&(c={},d=0);var g=window.document,f=g.createElement("img"),h=f.style,l=new R.lib.Promise;b[e]=l;l.always(function(){delete b[e]});R.dom.addListener(f,"load",function(){c[e]||(c[e]={src:e,width:f?f.width:null,height:f?f.height:null},d++);l&&l.resolve(c[e]);f&&f.parentNode&&f.parentNode.removeChild(f);l=h=f=null});R.dom.addListener(f,"error",function(){c[e]=
!1;f&&f.parentNode&&f.parentNode.removeChild(f);l&&l.reject(e)});l.abort=function(){f&&f.parentNode&&f.parentNode.removeChild(f);l&&l.reject(e);l=h=f=null};h.position="absolute";h.visibility="hidden";h.left="-10000px";h.top="0";g.body.appendChild(f);f.src=e;return l}var c={},b={},d=0;a.check=function(e){return void 0!==c[e]?c[e]:b[e]||null};return a}();V.registerAttribute("src",1E3,V.$extend({$class:"MetaphorJs.app.Directive.attr.Src",queue:null,usePreload:!0,noCache:!1,attr:null,lastPromise:null,src:null,$constructor:function(a,c,b){this.$self.initConfig(b);b.get("deferred")&&this.$plugins.push("MetaphorJs.plugin.SrcDeferred");b.get("preloadSize")&&this.$plugins.push("MetaphorJs.plugin.SrcSize");if(b.get("plugin")){var d=b.get("plugin").split(","),e;var g=0;for(e=d.length;g<e;g++)this.$plugins.push(d[g].trim())}this.$super(a,c,b)},initDirective:function(a,
c,b,d,e){if(this.usePreload=!b.get("noPreload"))c.style.visibility="hidden";this.queue=new R.lib.Queue({auto:!0,async:!0,mode:R.lib.Queue.REPLACE,thenable:!0});this.$super(a,c,b,d,e)},onScopeChange:function(){this.cancelPrevious();this.usePreload&&(this.node.style.visibility="hidden");this.queue.add(this.doChange,this)},doChange:function(){if(!this.$destroyed&&!this.$destroying){var a=this.config.get("value");a&&(this.src=a,this.config.get("noCache")&&(a+=(-1!==a.indexOf("?")?"&amp;":"?")+"_"+(new Date).getTime()),
this.usePreload?(this.lastPromise=R.dom.preloadImage(a))&&this.lastPromise.done(this.onImagePreloaded,this):this.node&&(this.node.src=a,R.dom.setAttr(this.node,"src",a),this.onSrcChanged()))}},cancelPrevious:function(){this.lastPromise&&(this.lastPromise.isPending()&&this.lastPromise.abort(),this.lastPromise=null)},onImagePreloaded:function(){var a=this,c=a.src;a&&a.node&&X(function(){a.node&&(a.node.src=c,R.dom.setAttr(a.node,"src",c),a.onSrcChanged(),a.node.style.visibility="",a.scope.$scheduleCheck(50))});
a.lastPromise=null},onSrcChanged:function(){},onScopeReset:function(){this.cancelPrevious();this.$super()},onDestroy:function(){this.$destroyed||(this.cancelPrevious(),this.queue.$destroy(),this.$super())}},{initConfig:function(a){var c=R.lib.Config.MODE_STATIC;a.setType("deferred","bool",c);a.setType("noCache","bool",c);a.setType("noPreload","bool",c);a.setDefaultMode("preloadSize",c);a.setDefaultMode("plugin",c)}}));R.dom.removeStyle=function(){var a=window.document.createElement("div");return a.style&&a.style.removeProperty?function(c,b){c.style.removeProperty(b)}:function(c,b){c.style.removeAttribute(b)}}();V.registerAttribute("style",1E3,V.$extend({$class:"MetaphorJs.app.Directive.attr.Style",id:"style",initDirective:function(){var a=this,c=a.config;c.on("value",a.onScopeChange,a);c.eachProperty(function(b){if(0===b.indexOf("value."))c.on(b,a.onScopeChange,a)});this.$super()},initChange:function(){this.onScopeChange()},getCurrentValue:function(){var a=this.config.getAllValues();a[""]&&(D(a,a[""]),delete a[""]);return a},_applyStyle:function(){var a=this.node,c=a.style,b=this.getCurrentValue(),d=this.prev,
e;for(e in d)b&&void 0!==b[e]||R.dom.removeStyle(a,e);if(b)for(e in b)d=Ga(e),void 0!==b[e]&&null!==b[e]?c[d]=b[e]:R.dom.removeStyle(a,e);this.prev=b},onScopeChange:function(){var a=this.config.get("async");za(a)?(a=parseInt(a)==a?parseInt(a):null,F(this._applyStyle,this,[],a)):this._applyStyle()}},{initConfig:function(a){a.setDefaultMode("async",R.lib.Config.MODE_STATIC)}}));R.dom.transclude=function(a,c,b){b=b||[];b.unshift(a.parentNode);var d;var e=0;for(d=b.length;e<d;e++){a:{for(var g=b[e];g;){var f=R.dom.data(g,"mjs-transclude");if(void 0!==f)break a;g=g.parentNode}f=void 0}if(f)break}return f?(a.firstChild&&R.dom.data(a,"mjs-transclude",R.dom.toFragment(a.childNodes)),b=a.parentNode,e=R.dom.clone(f),d=B(e.childNodes),c?b.replaceChild(a,e):a.appendChild(e),d):null};V.registerAttribute("transclude",1E3,function(a,c,b,d){if(!(c instanceof window.Node))throw Error("'transclude' directive can only work with Node");d.flowControl("nodes",R.dom.transclude(c,null,d.trigger("transclude-sources")))});R.app.Directive.registerAttribute("view",200,function(a,c,b,d){R.app.Directive.resolveNode(c,"view",function(e){if(!d.$destroyed){var g={scope:a,node:e,config:b};R.app.resolve("MetaphorJs.app.view.Component",g,e,[g]).done(function(f){d.$destroyed||a.$$destroyed?f.$destroy():(d.on("destroy",f.$destroy,f),a.$on("destroy",f.$destroy,f))})}});d.flowControl("ignoreInside",!0)});var gb=function(){function a(d,e,g){ea(e)||G(e)||(e={$:e});var f=[],h;var l=-1;for(h=d.length;++l<h;)c(d[l],e,g)&&f.push(d[l]);return f}function c(d,e,g){if(G(e))return e(d,g);if(Aa(d))return void 0===e.$?!0:b(d,e.$,g);var f,h;for(f in e)if("$"===f)for(h in d){if(b(d[h],e.$,g))return!0}else if(b(d[f],e[f],g))return!0;return!1}function b(d,e,g){if(G(e))return e(d,g);if(""===e||void 0===e)return!0;if(void 0!==d){if(fa(d))return d===e;if(e instanceof RegExp)return e.test(""+d);if("strict"===g)return""+
d===""+e;if(!0===g||null===g||void 0===g)return-1!=(""+d).toLowerCase().indexOf((""+e).toLowerCase());if(!1===g)return-1==(""+d).toLowerCase().indexOf((""+e).toLowerCase())}return!1}a.compare=c;return a}();R.model=R.model||{};R.model.Model=function(){var a={},c={};return U({$mixins:[R.mixin.Observable],type:null,fields:null,record:null,store:null,plain:!1,lastAjaxResponse:null,$init:function(b){this.fields||(this.fields={});D(this,{record:{load:null,save:null,"delete":null,id:null,data:null,success:null,extra:{}},store:{load:null,save:null,"delete":null,id:null,data:null,total:null,start:null,limit:null,success:null,extra:{}}},!1,!0);D(this,b,!0,!0);this.plain=!this.type},isPlain:function(){return this.plain},getRecordProp:function(b,
d){return this.getProp("record",b,d)},setRecordProp:function(b,d){this.record[b]=d},getStoreProp:function(b,d){return this.getProp("store",b,d)},setStoreProp:function(b,d){this.store[b]=d},getProp:function(b,d,e){b=this[b];return b[d]&&b[d][e]||b[e]||this[e]||null},setProp:function(b,d){return this[b]=d},_prepareRequestUrl:function(b,d){b=b.replace(/:([a-z0-9_\-]+)/gi,function(e,g){var f=d[g];return void 0!=f?(delete d[g],f):e});return/:([a-z0-9_\-]+)/.test(b)?null:b},_makeRequest:function(b,d,e,
g){var f=this,h=f[b],l=D({},I(h[d])||G(h[d])?{url:h[d]}:h[d]),n=f.getProp(b,d,"id"),m=f.getProp(b,d,"root"),p=f.getProp(b,d,"url"),r=f.getProp(b,d,"json"),q={};if(!l)if(p)l={url:p};else throw b+"."+d+" not defined";if(I(l)||G(l))l={url:l};if(!l.url){if(!p)throw b+"."+d+" url not defined";l.url=p}q.url=l.url;l.ajax&&D(q,l.ajax,!0,!1);if(l.validate&&(p=l.validate.call(f,e,g),!1===p))return R.lib.Promise.reject(p);if(l.resolve){if((p=l.resolve.call(f,e,g))&&Q(p))return p;if(p)return R.lib.Promise.resolve(p)}q.data=
D({},l.data,f.extra,h.extra,h[d]?h[d].extra:null,q.data,g,!0,!0);if(G(l.url)){e=l.url(q.data);var t=new R.lib.Promise;e.then(function(y){"record"===b?f._processRecordResponse(d,y,t):"store"===b&&f._processStoreResponse(d,y,t)});return t}e&&n&&(q.data[n]=e);g&&m&&"load"!==d&&(q.data[m]=g);q.url=f._prepareRequestUrl(q.url,q.data);if(!q.url)return R.lib.Promise.reject();q.method||(q.method="controller"!==b?"load"===d?"GET":"POST":"GET");r&&q.data&&"GET"!==q.method&&(q.contentType="text/plain",q.data=
JSON.stringify(q.data));q.context=f;if("record"===b){q.processResponse=function(y,w){f.lastAjaxResponse=y;f._processRecordResponse(d,y,w)};var u=f._processRecordRequest(eb(q),d,e,g)}else"store"===b?(q.processResponse=function(y,w){f.lastAjaxResponse=y;f._processStoreResponse(d,y,w)},u=f._processStoreRequest(eb(q),d,e,g)):"controller"===b&&(q.processResponse=function(y,w){f.lastAjaxResponse=y;f._processControllerResponse(d,y,w)},u=f._processControllerRequest(eb(q),d,e,g));l.processRequest&&l.processRequest.call(f,
u,e,g);return u},_processRecordRequest:function(b){return b},_processRecordResponse:function(b,d,e){var g=this.getRecordProp(b,"id"),f=this.getRecordProp(b,"root");g=(f=f?d[f]:d)&&f[g]||d[g];this._getSuccess("record",b,d)?e.resolve({id:g,data:this.extendPlainRecord(f)}):e.reject(d)},_processStoreRequest:function(b){return b},_processStoreResponse:function(b,d,e){var g=this.getStoreProp(b,"root"),f=this.getStoreProp(b,"total");g=g?d[g]:d;f=f?d[f]:null;this._getSuccess("store",b,d)?e.resolve({data:g,
total:f}):e.reject(d)},_processControllerRequest:function(b){return b},_processControllerResponse:function(b,d,e){this._getSuccess("controller",b,d)?e.resolve(d):e.reject(d)},_getSuccess:function(b,d,e){b=this.getProp(b,d,"success");return"function"===typeof b?b(e):b&&void 0!=e[b]?e[b]:!0},runController:function(b,d,e){return this._makeRequest("controller",b,d,e)},loadRecord:function(b){return this._makeRequest("record","load",b)},saveRecord:function(b,d,e){return this._makeRequest("record",b.getId()?
"save":"create",b.getId(),D({},b.storeData(b.getData(d)),e))},deleteRecord:function(b){return this._makeRequest("record","delete",b.getId())},loadStore:function(b,d){return this._makeRequest("store","load",null,d)},saveStore:function(b,d){return this._makeRequest("store","save",null,d)},deleteRecords:function(b,d){return this._makeRequest("store","delete",d)},extendPlainRecord:function(b){var d=this.getRecordProp(null,"extend");b=d?D(b,d,!1,!1):b;b.$$model=this;return b},getFields:function(){return this.fields},
getRecordId:function(b){var d=this.getRecordProp("load","id");return b?(b.getId?b.getId():b[d])||null:null},restoreField:function(b,d,e){var g=this.fields[d];if(g){switch(I(g)?g:g.type){case "int":e=parseInt(e);break;case "bool":case "boolean":I(e)?(e=e.toLowerCase(),e=!("off"===e||"no"===e||"0"===e||"false"==e||"null"==e)):e=e?!0:!1;break;case "double":case "float":e=parseFloat(e);break;case "date":g.parseFn?e=g.parseFn(e,g.format):Date.parse?e=Date.parse(e,g.format):("timestamp"===g.format&&(e=
1E3*parseInt(e)),e=new Date(e))}g.restore&&(e=g.restore.call(b,e,d))}return this.onRestoreField(b,d,e)},onRestoreField:function(b,d,e){return e},storeField:function(b,d,e){var g=this.fields[d];if(g){switch(I(g)?g:g.type){case "bool":case "boolean":e=e?"1":"0";break;case "date":e=g.formatFn?g.formatFn(e,g.format):Date.format?Date.format(e,g.format):"timestamp"===g.format?e.getTime()/1E3:e.format?e.format(g.format):e.toString();break;default:e=e.toString()}g.store&&(e=g.store.call(b,e,d))}return this.onStoreField(b,
d,e)},onStoreField:function(b,d,e){return e}},{create:function(b,d){return"MetaphorJs.model.Model"===b?U.factory(b,d):d?U.factory(b,d):a[b]?a[b]:a[b]=U.factory(b)},addToCache:function(b){var d=b.getId(),e=b.$getClass();b instanceof R.model.Record||!e||(c[e]||(c[e]={}),c[e][d]=b)},getFromCache:function(b,d){return c[b]&&c[b][d]?c[b][d]:null},removeFromCache:function(b,d){c[b]&&c[b][d]&&delete c[b][d]}})}();R.model.Record=U({$mixins:[R.mixin.Observable],id:null,data:null,orig:null,modified:null,loaded:!1,loading:!1,dirty:!1,model:null,standalone:!0,stores:null,importUponSave:!1,importUponCreate:!1,$init:function(a,c,b){var d=arguments.length;1===d?(b=a,c=a=null):2===d&&(b=c,c=null);this.data={};this.orig={};this.stores=[];this.modified={};b=b||{};this.$super(b);I(this.model)?this.model=R.model.Model.create(this.model):this.model instanceof R.model.Model||(this.model=new R.model.Model(this.model));this.id=
a;c?this.importData(c):!1!==b.autoLoad&&a&&this.load();"MetaphorJs.model.Record"!==this.$getClass()&&R.model.Model.addToCache(this)},isLoaded:function(){return this.loaded},isLoading:function(){return this.loading},isStandalone:function(){return this.standalone},isDirty:function(){return this.dirty},getModel:function(){return this.model},attachStore:function(a){a=a.getId();-1==this.stores.indexOf(a)&&this.stores.push(a)},detachStore:function(a){a=a.getId();var c;this.$destroyed||-1==(c=this.stores.indexOf(a))||
(this.stores.splice(c,1),0!=this.stores.length||this.standalone||this.$destroy())},setDirty:function(a){this.dirty!=a&&(this.dirty=!!a,this.trigger("dirty-change",this,a))},importData:function(a){var c={},b;if(a){for(b in a)c[b]=this.model.restoreField(this,b,a[b]);this.data=c}this.orig=D({},this.data);this.modified={};this.loaded=!0;this.setDirty(!1)},storeData:function(a){var c={},b;for(b in a)c[b]=this.model.storeField(this,b,a[b]);return c},getId:function(){return this.id},getData:function(a){var c=
{};if(a){var b;a=I(a)?[a]:a;var d=0;for(b=a.length;d<b;d++)c[a[d]]=this.data[a[d]]}else for(d in a=this.data,a)"$"!==d.substr(0,1)&&(c[d]=a[d]);return c},getChanged:function(){return D({},this.modified)},isChanged:function(a){return this.modified[a]||!1},get:function(a){return this.data[a]},setId:function(a){!this.id&&a&&(this.id=a)},set:function(a,c){var b=this.data[a];c=this.model.restoreField(this,a,c);this.data[a]=c;b!=c&&(this.modified[a]=!0,this.setDirty(!0),this.trigger("change",this,a,c,b),
this.trigger("change-"+a,this,a,c,b))},revert:function(){this.dirty&&(this.data=D({},this.orig),this.modified={},this.setDirty(!1))},load:function(){var a=this;a.loading=!0;a.trigger("before-load",a);return a.model.loadRecord(a.id).always(function(){a.loading=!1}).done(function(c){a.setId(c.id);a.importData(c.data);a.trigger("load",a)}).fail(function(){a.trigger("failed-load",a)})},save:function(a,c){var b=this;b.trigger("before-save",b);var d=b.getId()?b.importUponSave:b.importUponCreate;return b.model.saveRecord(b,
a,c).done(function(e){e.id&&b.setId(e.id);d&&b.importData(e.data);b.trigger("save",b)}).fail(function(){b.trigger("failed-save",b)})},"delete":function(){var a=this;a.trigger("before-delete",a);return a.model.deleteRecord(a).done(function(){a.trigger("delete",a);a.$destroy()}).fail(function(){a.trigger("failed-delete",a)})},reset:function(){this.id=null;this.data={};this.orig={};this.modified={};this.dirty=this.loaded=!1;this.trigger("reset",this)},onDestroy:function(){R.model.Model.removeFromCache(this.$getClass(),
this.id);this.$super()}});R.model.Store=function(){var a={};return U({$mixins:[R.mixin.Observable],id:null,autoLoad:!1,clearOnLoad:!0,model:null,extraParams:null,loaded:!1,loading:!1,local:!1,items:null,current:null,map:null,currentMap:null,length:0,currentLength:0,maxLength:0,totalLength:0,start:0,pageSize:null,pages:null,filtered:!1,sorted:!1,filterBy:null,filterOpt:null,sortBy:null,sortDir:null,publicStore:!1,idProp:null,loadingPromise:null,$init:function(c,b,d){this.items=[];this.current=[];this.map={};this.currentMap=
{};this.loaded=!1;this.extraParams=this.extraParams||{};c&&!I(c)&&(d=b,b=c,c=null);b=b||{};c&&(b.url=c);this.$super(b);D(this,b,!0,!1);this.id=this.id||E();this.filtered=!!this.filterBy;this.publicStore&&(a[this.id]=this);this.initModel(b);this.$$observable.createEvent("beforeload",!1);!this.local&&this.autoLoad?this.load():d&&(H(d)?this._loadArray(d):this._loadAjaxData(d));this.local&&(this.loaded=!0);this.sourceStore&&this.initSourceStore(this.sourceStore,"on")},setModel:function(c){this.model=
c;this.initModel({})},initModel:function(c){I(this.model)?this.model=R.model.Model.create(this.model):this.model instanceof R.model.Model||(this.model=new R.model.Model(this.model));c.url&&(this.model.store.load=c.url);this.idProp=this.model.getStoreProp("load","id")},initSourceStore:function(c,b){c[b]("update",this.onSourceStoreUpdate,this)},onSourceStoreUpdate:function(){this.$$observable.suspendAllEvents();this.clear();this.addMany(this.sourceStore.toArray());this.$$observable.resumeAllEvents();
this.trigger("update",this)},getId:function(){return this.id},isLoaded:function(){return this.loaded},isLocal:function(){return this.local},setLocal:function(c){this.local=!!c},isLoading:function(){return this.loading},isFiltered:function(){return this.filtered},isSorted:function(){return this.sorted},getLength:function(c){return c?this.length:this.currentLength},getTotalLength:function(){return this.totalLength||this.currentLength},isEmpty:function(c){return c?0===this.length:0===this.currentLength},
getPagesCount:function(){return null!==this.pageSize?parseInt(this.totalLength/this.pageSize):1},setParam:function(c,b){null===b?delete this.extraParams[c]:this.extraParams[c]=b},getParam:function(c){return this.extraParams[c]},getParams:function(){return D({},this.extraParams)},clearParams:function(){this.extraParams={}},setStart:function(c){this.start=c},setPageSize:function(c){this.pageSize=c},getAjaxData:function(){return this.ajaxData},hasDirty:function(c){if(this.model.isPlain())return!1;var b=
!1;this.each(function(d){return d.isDirty()?(b=!0,!1):!0},null,c);return b},getDirty:function(c){var b=[];if(this.model.isPlain())return b;this.each(function(d){d.isDirty()&&b.push(d)},null,c);return b},getModel:function(){return this.model},toArray:function(){return this.current.slice()},_loadAjaxData:function(c,b){var d=this;b=b||{};if(b.silent||!1!==d.trigger("before-load",d))d.ajaxData=c,d.model._processStoreResponse("load",c,{resolve:function(e){d._onModelLoadSuccess(e,b)},reject:function(e){d._onModelLoadFail(e,
b)}})},_loadArray:function(c,b){b=b||{};(b.silent||!1!==this.trigger("before-load",this))&&H(c)&&(this._load(c,b),this.totalLength=this.length)},_load:function(c,b){var d=b.prepend;b=b||{};c=c||[];d?this.insertMany(0,c,!0,!0):this.addMany(c,!0,!0);this.loaded=!0;this.loading=!1;this.trigger("loading-end",this);this.onLoad();b.skipUpdate||this.update();b.silent||this.trigger("load",this)},load:function(c,b){var d=this,e=d.model.store,g=e.start;e=e.limit;var f=d.pageSize;d.loadingPromise&&d.loadingPromise.abort&&
d.loadingPromise.abort();b=b||{};if(d.local)return null;c=D({},d.extraParams,c||{});null===f||c[g]||c[e]||(g&&(c[g]=d.start),e&&(c[e]=f));if(!b.silent&&!1===d.trigger("before-load",d))return null;d.loading=!0;d.trigger("loading-start",d);return d.loadingPromise=d.model.loadStore(d,c).done(function(h){d.$destroyed||(d.loadingPromise=null,d.ajaxData=d.model.lastAjaxResponse,d._onModelLoadSuccess(h,b))}).fail(function(h){d.$destroyed||(d.loadingPromise=null,d.ajaxData=d.model.lastAjaxResponse,d._onModelLoadFail(h,
b))})},_onModelLoadSuccess:function(c,b){b=b||{};if(!b.noopOnEmpty||c.data.length)!b.prepend&&!b.append&&this.clearOnLoad&&0<this.length&&this.clear(!0),this.totalLength=parseInt(c.total),this._load(c.data,b)},_onModelLoadFail:function(c,b){this.onFailedLoad();b.silent||this.trigger("failed-load",this,c)},onLoad:M,onFailedLoad:M,save:function(c){var b=this,d={},e=0;if(b.local)return null;if(b.model.isPlain())throw Error("Cannot save plain store");b.each(function(g){g.isDirty()&&(d[g.getId()]=g.storeData(g.getData()),
e++)});return!e||!c&&!1===b.trigger("before-save",b,d)?null:b.model.saveStore(b,d).done(function(g){b._onModelSaveSuccess(g,c)}).fail(function(g){b._onModelSaveFail(g,c)})},_onModelSaveSuccess:function(c,b){var d,e=c.data;if(e&&e.length)for(c=0,d=e.length;c<d;c++){var g=this.getRecordId(e[c]);(g=this.getById(g))&&g.importData(e[c])}this.onSave();b||this.trigger("save",this)},_onModelSaveFail:function(c,b){this.onFailedSave(c);b||this.trigger("failed-save",this,c)},onSave:M,onFailedSave:M,deleteById:function(c,
b,d){var e=this,g;if(e.local)return null;if(!c||H(c)&&!c.length)throw Error("Record id required");H(c)||(c=[c]);var f=0;for(g=c.length;f<g;f++){var h=e.getById(c[f]);e.remove(h,b,d);h instanceof R.model.Record&&h.$destroy()}return b||!1!==e.trigger("before-delete",e,c)?e.model.deleteRecords(e,c).done(function(){e.totalLength-=c.length;e.onDelete();b||e.trigger("delete",e,c)}).fail(function(){e.onFailedDelete();b||e.trigger("failed-delete",e,c)}):null},onDelete:M,onFailedDelete:M,deleteAt:function(c,
b,d){var e=this.getAt(c);if(!e)throw Error("Record not found at "+c);return this["delete"](e,b,d)},"delete":function(c,b,d){return this.deleteById(this.getRecordId(c),b,d)},deleteRecords:function(c,b,d){var e=[],g;var f=0;for(g=c.length;f<g;f++)e.push(this.getRecordId(c[f]));return this.deleteById(e,b,d)},loadOr:function(c){return this.local||this.isLoading()||this.isLoaded()?R.lib.Promise.resolve(this):this.load(null,c)},addPrevPage:function(c){c=c||{};c.append=!1;c.prepend=!0;c.noopOnEmpty=!0;return this.loadPrevPage(c)},
addNextPage:function(c){c=c||{};c.append=!0;c.prepend=!1;c.noopOnEmpty=!0;return this.local||this.totalLength&&!(this.length<this.totalLength)?R.lib.Promise.resolve():this.load({start:this.length,limit:this.pageSize},c)},loadNextPage:function(c){if(!this.totalLength||this.local||this.length<this.totalLength)if(this.start+=this.pageSize,this.local)this.update();else return this.load(null,c);return R.lib.Promise.resolve()},loadPrevPage:function(c){if(0<this.start)if(this.start-=this.pageSize,0>this.start&&
(this.start=0),this.local)this.update();else return this.load(null,c);return R.lib.Promise.resolve()},loadPage:function(c,b){this.start=parseInt(c,10);0>this.start&&(this.start=0);if(this.local)this.update();else return this.load(null,b);return R.lib.Promise.resolve()},getRecordId:function(c){return c?c instanceof R.model.Record?c.getId():this.model?this.model.getRecordId(c)||c[this.idProp]||null:c[this.idProp]||null:null},getRecordData:function(c){return this.model.isPlain()?c:c.data},processRawDataItem:function(c){if(c instanceof
R.model.Record)return c;if(this.model.isPlain())return this.model.extendPlainRecord(c);var b=this.model.type,d=this.getRecordId(c),e;d&&(e=R.model.Model.getFromCache(b,d));e||(e=U.factory(b,d,c,{model:this.model,standalone:!1}));return e},bindRecord:function(c,b){b[c]("change",this.onRecordChange,this);b[c]("destroy",this.onRecordDestroy,this);b[c]("dirty-change",this.onRecordDirtyChange,this);return b},onRecordDirtyChange:function(c){this.trigger("update",this,c)},onRecordChange:function(c){this.trigger("update",
this,c)},onRecordDestroy:function(c){this.remove(c)},shift:function(c,b,d){return this.removeAt(0,1,c,b,d)},unshift:function(c,b,d){return this.insert(0,c,b,d)},pop:function(c,b,d){return this.removeAt(this.length-1,1,c,b,d)},addMany:function(c,b,d){var e,g=this.length;var f=0;for(e=c.length;f<e;f++)this.insert(g+f,c[f],!0,!0);d||this.update();0<e&&!b&&this.trigger("add",c)},add:function(c,b,d){return this.insert(this.length,c,b,d)},onAdd:M,removeAt:function(c,b,d,e,g){var f=0,h=this.length;if(0!==
h&&null!==c){for(;0>c;)c=h+c;null==b&&(b=1);for(g||(c=this.items.indexOf(this.current[c]));c<this.length&&0<=c&&f<b;){this.length--;g=this.items[c];this.items.splice(c,1);h=this.getRecordId(g);void 0!==h&&(delete this.map[h],delete this.currentMap[h]);this.onRemove(g,h);e||this.update();d||this.trigger("remove",g,h);if(g instanceof R.model.Record){if(this.bindRecord("un",g),g.detachStore(this),1===b)return g.$destroyed?void 0:g}else if(1===b)return g;f++}}},removeRange:function(c,b,d,e,g){var f=this.length;
if(0!==f){if(null==c&&null==b)return this.clear(d);for(null==c&&(c=0);0>c;)c=f+c;for(null==b&&(b=f-1);0>b;)b=f+c;return this.removeAt(c,b-c+1,d,e,g)}},onRemove:M,insertMany:function(c,b,d,e){var g;var f=0;for(g=b.length;f<g;f++)this.insert(c+f,b[f],!0,!0);0<g&&!e&&this.update();0<g&&!d&&this.trigger("add",b)},insert:function(c,b,d,e){var g=!1;b=this.processRawDataItem(b);var f=this.getRecordId(b);this.map[f]&&(this.$$observable.suspendAllEvents(),this.removeId(f),this.$$observable.resumeAllEvents());
c>=this.length?(this.items.push(b),g=!0):this.items.splice(c,0,b);this.length++;this.maxLength&&this.length>this.maxLength&&(g?this.pop(d,!0):this.shift(d,!0));void 0!==f&&(this.map[f]=b);b instanceof R.model.Record&&(b.attachStore(this),this.bindRecord("on",b));this.onAdd(c,b);e||this.update();d||this.trigger("add",[b]);return b},replace:function(c,b,d,e){var g=this.items.indexOf(c);this.removeAt(g,1,!0,!0,!0);this.insert(g,b,!0,!0);e||this.update();this.onReplace(c,b);d||this.trigger("replace",
c,b);return b},replaceId:function(c,b,d,e){c=this.indexOfId(c);return this.replace(this.getAt(c),b,d,e)},onReplace:M,remove:function(c,b,d){c=this.indexOf(c,!0);return-1!==c?this.removeAt(c,1,b,d,!0):null},removeId:function(c,b,d){c=this.indexOfId(c,!0);if(-1!==c)return this.removeAt(c,1,b,d,!0)},contains:function(c,b){return-1!==this.indexOf(c,b)},containsId:function(c,b){return b?void 0!==this.map[c]:void 0!==this.currentMap[c]},clear:function(c){var b=this.getRange();this._reset();this.onClear();
c||(this.trigger("update",this),this.trigger("clear",this,b))},onClear:M,reset:function(){this._reset();this.start=0},_reset:function(c){var b;if(!c)for(c=0,b=this.items.length;c<b;c++){var d=this.items[c];d instanceof R.model.Record&&(this.bindRecord("un",d),d.detachStore(this))}this.totalLength=this.currentLength=this.length=0;this.items=[];this.current=[];this.map={};this.currentMap={};this.loaded=this.local},getAt:function(c,b){return b?this.items[c]||void 0:this.current[c]||void 0},getById:function(c,
b){return b?this.map[c]||void 0:this.currentMap[c]||void 0},indexOf:function(c,b){return b?this.items.indexOf(c):this.current.indexOf(c)},indexOfId:function(c,b){return this.indexOf(this.getById(c,b),b)},each:function(c,b,d){d=d?this.items.slice():this.current.slice();for(var e=0,g=d.length;e<g&&!1!==c.call(b,d[e],e,g);e++);},eachId:function(c,b,d){var e=this;e.each(function(g,f,h){return c.call(b,e.getRecordId(g),f,h)},null,d)},collect:function(c,b){var d=[],e=!this.model.isPlain();this.each(function(g){(g=
e?g.get(c):g[c])&&d.push(g)},null,b);return d},first:function(c){return c?this.items[0]:this.current[0]},last:function(c){return c?this.items[this.length-1]:this.current[this.current-1]},getRange:function(c,b,d){d=d?this.items:this.current;var e=[];if(1>d.length)return e;c=c||0;b=Math.min(void 0==b?this.length-1:b,this.length-1);if(c<=b)for(;c<=b;c++)e.push(d[c]);else for(;c>=b;c--)e.push(d[c]);return e},findBy:function(c,b,d,e){c=this.findIndexBy(c,b,d,e);return-1===c?void 0:this.getAt(c,e)},findIndexBy:function(c,
b,d,e){e=e?this.items:this.current;d=d||0;for(var g=e.length;d<g;d++)if(c.call(b,e[d],this.getRecordId(e[d])))return d;return-1},find:function(c,b,d,e){var g=!this.model.isPlain(),f,h=this.findIndexBy(function(l){f=g?l.get(c):l[c];return d?f===b:f==b},this,0,e);return-1!==h?this.getAt(h,e):null},findExact:function(c,b,d){return this.find(c,b,!0,d)},findBySet:function(c,b){var d=null,e,g;this.each(function(f){e=!0;for(g in c)if(c[g]!=f[g]){e=!1;break}return e?(d=f,!1):!0},null,b);return d},update:function(){var c=
this,b=c.filtered,d=c.sorted,e=c.model.isPlain();c.local&&(c.totalLength=c.length=c.items.length);c.currentLength=c.length;c.currentMap=c.map;c.current=c.items;if(b){var g=c.filterBy,f=c.filterOpt,h,l;c.current=h=[];c.currentMap=l={};c.each(function(p){gb.compare(e?p:p.data,g,f)&&(h.push(p),l[c.getRecordId(p)]=p)},null,!0);c.currentLength=c.current.length}c.local&&c.pageSize&&(c.current=c.current.slice(c.start,c.start+c.pageSize),c.currentLength=c.current.length);if(d){var n=c.sortBy,m=!c.model.isPlain();
b=function(p){return m?p.get(n):p[n]};c.current=Pa(c.current,isFunction(n)?{fn:n}:b,c.sortDir)}c.trigger("update",c)},filter:function(c,b){this.filtered=!0;this.filterBy=c;this.filterOpt=b;this.update()},clearFilter:function(){this.filtered&&(this.filterOpt=this.filterBy=null,this.update())},sort:function(c,b){this.sorted=!0;this.sortBy=c;this.sortDir=b;this.update()},clearSorting:function(){this.sorted=!1;this.sortDir=this.sortBy=null;this.update()},onDestroy:function(){delete a[this.id];this.sourceStore&&
this.initSourceStore(this.sourceStore,"un");this.clear();this.trigger("destroy",this);this.$super()}},{lookupStore:function(c){return a[c]||null},eachStore:function(c,b){for(var d in a)if(!1===c.call(b,a[d]))break}})}();V.getDirective("attr","each").registerType(R.model.Store,R.app.StoreRenderer);V.registerTag("transclude",function(a,c,b,d){d&&d.flowControl("nodes",R.dom.transclude(c,!0))});R.filter.collect=function(a,c,b){c=[];var d;if(!a)return c;var e=0;for(d=a.length;e<d;e++){var g=a[e][b];void 0!=g&&c.push(g)}return c};R.filter.filter=function(a,c,b,d){return gb(a,b,d)};R.filter.get=function(a,c,b){for(c=(""+b).split(".");b=c.shift();)if(a=a[b],void 0===a)return;return a};R.filter.join=function(a,c,b){b=b||", ";return a&&a.length?(H(a)||(a=B(a)),a.join(b)):""};R.filter.l=function(a,c){return c.$app.lang.get(a)};R.filter.limitTo=function(a,c,b){c=I(a);if(!H(a)&&!c)return a;b=Infinity===Math.abs(Number(b))?Number(b):parseInt(b,10);if(c)return b?0<=b?a.slice(0,b):a.slice(b,a.length):"";c=[];b>a.length?b=a.length:b<-a.length&&(b=-a.length);if(0<b)var d=0;else d=a.length+b,b=a.length;for(;d<b;d++)c.push(a[d]);return c};R.filter.linkify=function(a,c,b){return a?a.replace(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig,'<a href="$1"'+(b?' target="'+b+'"':"")+">$1</a>"):""};R.filter.lowercase=function(a){return(""+a).toLowerCase()};R.filter.map=function(a,c,b){var d=[],e=cb.get(b,!0)||window[b]||R.lib.Expression.get(b,c);a=a||[];if(e)for(c=0,b=a.length;c<b;c++)d.push(e(a[c]));return d};R.filter.moment=function(a,c,b){return a?moment(a).format(R.lib.Cache.global().get(b,b)):""};R.filter.numeral=function(a,c,b){return numeral(a).format(R.lib.Cache.global().get(b,b))};R.filter.offset=function(a,c,b){c=I(a);if(!H(a)&&!c)return a;b=Infinity===Math.abs(Number(b))?Number(b):parseInt(b,10);return c?a.substr(b):a.slice(b)};R.filter.p=function(a,c,b){return c.$app.lang.plural(a,parseInt(b,10)||0)};R.filter.pl=function(a,c,b){return c.$app.lang.plural(b,parseInt(a,10)||0)};(function(){var a=R.filter.preloaded=function(c,b){if(!c)return!1;c=R.dom.preloadImage.check(c);return!0!==c&&c?Q(c)?(c.always(function(){b.$check()}),!1):!0:!!c};a.$undeterministic=!0;return a})();R.filter.r=function(a,c){return c.$app.lang.get(key)};R.filter.sortBy=function(a,c,b,d){return Pa(a,b,d)};R.filter.split=function(a,c,b,d){d=d||void 0;b=b||"/\\n|,/";if(!a)return[];a=""+a;"/"===b.substr(0,1)&&"/"===b.substr(b.length-1)&&(b=Ha(b.substring(1,b.length-1)));a=a.split(b,d);c=-1;for(b=a.length;++c<b;a[c]=a[c].trim());return a};R.filter.toArray=function(a){if(ea(a)){var c=[],b;for(b in a)a.hasOwnProperty(b)&&c.push({key:b,value:a[b]});return c}return B(a)};R.filter.ucfirst=function(a){return a.substr(0,1).toUpperCase()+a.substr(1)};R.filter.uppercase=function(a){return(""+a).toUpperCase()};R.app.init=function(a,c,b,d){var e=R.dom.getAttrSet(a),g=e.directives.app||{};e.__remove("directive",a,"app");try{var f=R.app.resolve(c||"MetaphorJs.app.App",D({scope:b},g),a,[a,b]);return!1!==d?f.done(function(h){h.run()}):f}catch(h){return S(h),R.lib.Promise.reject(h)}};R.dom.onReady=function(a,c){function b(){try{l.doScroll("left")}catch(n){setTimeout(b,50);return}d("poll")}function d(n){if("readystatechange"!=n.type||"complete"==h.readyState)R.dom.removeListener("load"==n.type?f:h,n.type,d),!e&&(e=!0)&&a.call(f,n.type||n)}var e=!1,g=!0,f=c||window;var h=f.document;var l=h.documentElement;if("complete"==h.readyState)a.call(f,"lazy");else{if(h.createEventObject&&l.doScroll){try{g=!f.frameElement}catch(n){}g&&b()}R.dom.addListener(h,"DOMContentLoaded",d);R.dom.addListener(h,
"readystatechange",d);R.dom.addListener(f,"load",d)}};(R.app.run=function(a,c){var b=a||window;if(!b)throw Error("Window object neither defined nor provided");R.dom.onReady(function(){var d=R.dom.select("[mjs-app]",b.document),e;var g=-1;for(e=d.length;++g<e;){var f=d[g];R.app.init(f,R.dom.getAttr(f,"mjs-app"),c,!0)}},b)})();R.validator=R.validator||{};R.validator.messages={required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date (ISO).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",accept:"Please enter a value with a valid extension.",maxlength:"Please enter no more than {0} characters.",
minlength:"Please enter at least {0} characters.",rangelength:"Please enter a value between {0} and {1} characters long.",range:"Please enter a value between {0} and {1}.",max:"Please enter a value less than or equal to {0}.",min:"Please enter a value greater than or equal to {0}."};R.validator.checkable=function(a){return/radio|checkbox/i.test(a.type)};var ib=R.dom.eachNode=function hb(a,c,b){var e,g=a.childNodes;if(!1!==c.call(b,a))for(a=-1,e=g.length>>>0;++a!==e;hb(g[a],c,b));};R.validator.getLength=function(a,c){var b=0;switch(c.nodeName.toLowerCase()){case "select":return ib(c,function(g){g.selected&&b++}),b;case "input":if(R.validator.checkable(c)){if(c.form)ib(c.form,function(g){g.type==c.type&&g.name==c.name&&g.checked&&b++});else{var d;if(Za(c))a=c.ownerDocument;else for(a=c;a.parentNode;)a=a.parentNode;a=ab("input[name="+c.name+"]",a);var e=0;for(d=a.length;e<d;e++)a[e].checked&&b++}return b}}return a.length};R.validator.empty=function(a,c){if(!c)return a==undf||""===a;switch(c.nodeName.toLowerCase()){case "select":return a=R.dom.getInputValue(c),!a||0==a.length;case "input":if(R.validator.checkable(c))return 0==R.validator.getLength(a,c)}return 0==a.trim().length};R.regexp.url=/^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:\/\S*)?$/i;R.regexp.email=/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i;(function(){var a=R.validator.empty,c=R.validator.getLength;return R.validator.methods={required:function(b,d,e){return!1===e?!0:!a(b,d)},regexp:function(b,d,e){e=e instanceof RegExp?e:new RegExp(e);return a(b,d)||e.test(b)},notregexp:function(b,d,e){e=e instanceof RegExp?e:new RegExp(e);return a(b,d)||!e.test(b)},minlength:function(b,d,e){return a(b,d)||(d?c(b.trim(),d)>=e:b.toString().length>=e)},maxlength:function(b,d,e){return a(b,d)||(d?c(b.trim(),d)<=e:b.toString().length<=e)},rangelength:function(b,
d,e){var g=d?c(b.trim(),d):b.toString().length;return a(b,d)||g>=e[0]&&g<=e[1]},min:function(b,d,e){return a(b,d)||parseInt(b,10)>=e},max:function(b,d,e){return a(b,d)||parseInt(b,10)<=e},range:function(b,d,e){b=parseInt(b,10);return a(b,d)||b>=e[0]&&b<=e[1]},email:function(b,d){return a(b,d)||R.regexp.email.test(b)},url:function(b,d){return a(b,d)||R.regexp.url.test(b)},date:function(b,d){return a(b,d)||!/Invalid|NaN/.test(new Date(b))},dateiso:function(b,d){return a(b,d)||/^\d{4}[\/-]\d{1,2}[\/-]\d{1,2}$/.test(b)},
number:function(b,d){return a(b,d)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)(?:\.\d+)?$/.test(b)},digits:function(b,d){return a(b,d)||/^\d+$/.test(b)},creditcard:function(b,d){if(a(b,d))return!0;if(/[^0-9-]+/.test(b))return!1;d=0;var e=!1;b=b.replace(/\D/g,"");for(var g=b.length-1;0<=g;g--){var f=b.charAt(g);f=parseInt(f,10);e&&9<(f*=2)&&(f-=9);d+=f;e=!e}return 0==d%10},accept:function(b,d,e){e=I(e)?e.replace(/,/g,"|"):"png|jpe?g|gif";return a(b,d)||b.match(new RegExp(".("+e+")$","i"))},equalto:function(b,
d,e,g){e=(d=g.getValidator().getField(e))?d.getElem():e;return b==R.dom.getInputValue(e)},notequalto:function(b,d,e,g){e=(d=g.getValidator().getField(e))?d.getElem():e;return b!=R.dom.getInputValue(e)},remote:function(){return!1},zxcvbn:function(b,d,e){return zxcvbn(b).score>=parseInt(e)}}})();R.validator.format=function(a,c){if(G(c))return a;H(c)||(c=[c]);var b,d=c.length;for(b=-1;++b<d;a=a.replace(new RegExp("\\{"+b+"\\}","g"),c[b]));return a};R.validator.Field=function(){function a(f){function h(l,n,m){var p=f[l],r=!1;if(void 0!==p){switch(m){case "string":r=I(p);break;case "function":r=G(p);break;case "boolean":r=fa(p)}r&&(f[l]={},f[l][n]=p)}}if(!f)return{};h("errorBox","enabled","boolean");h("errorBox","tag","string");h("errorBox","fn","function");return f}var c={allowSubmit:!0,alwaysCheck:!1,alwaysDisplayState:!1,data:null,ignore:null,disabled:!1,cls:{valid:"",error:"",ajax:""},errorBox:{cls:"",fn:null,tag:"",position:"after",elem:null,
enabled:!0},callback:{scope:null,destroy:null,statechange:null,errorchange:null,submit:null,check:null,beforeAjax:null,afterAjax:null,displaystate:null},rules:{},messages:{}},b=R.validator.messages,d=R.validator.methods,e=R.validator.empty,g=R.validator.format;return U({$mixins:[R.mixin.Observable],vldr:null,elem:null,rules:null,cfg:null,input:null,enabled:!0,valid:null,dirty:!1,id:null,prev:"",error:null,errorRule:null,pending:null,rulesNum:0,displayState:!1,data:null,checking:!1,checkTmt:null,errorBox:null,
customError:!1,$init:function(f,h,l){h=h||{};var n;this.cfg=n=D({},c,a(R.validator.Field.defaults),a(h),!0,!0);this.input=R.lib.Input.get(f);this.input.onChange(this.onInputChange,this);this.input.onKey(13,this.onInputSubmit,this);this.elem=f;this.vldr=l;this.enabled=!f.disabled;this.id=R.dom.getAttr(f,"name")||R.dom.getAttr(f,"id");this.data=h.data;this.rules={};n.messages=D({},b,n.messages,!0,!0);R.dom.setAttr(f,"data-validator",l.getVldId());this.input.radio&&this.initRadio();n.rules&&this.setRules(n.rules,
!1);this.readRules();this.prev=this.input.getValue();n.disabled&&this.disable()},getValidator:function(){return this.vldr},initRadio:function(){var f=this.input.radio,h=this.vldr.getVldId(),l;var n=0;for(l=f.length;n<l;n++)R.dom.setAttr(f[n],"data-validator",h)},setRules:function(f,h){h=void 0==h?!0:h;for(var l in f)this.setRule(l,f[l],!1);h?this.check(!1):this.setValidState(null);return this},setRule:function(f,h,l){var n=this.rules;l=void 0==l?!0:l;null===h?(n[f]&&this.rulesNum--,delete n[f]):(n[f]||
this.rulesNum++,n[f]=h,null!==this.valid&&this.setValidState(!1));l?this.check(!1):this.setValidState(null);return this},setMessage:function(f,h){this.cfg.messages[f]=h;return this},setMessages:function(f){for(var h in f)this.setMessage(h,f[h]);return this},getMessages:function(){return D({},this.cfg.messages)},readRules:function(){var f=this.elem,h=f.className,l={};for(m in d)if(d.hasOwnProperty(m)){var n=R.dom.getAttr(f,m)||R.dom.getAttr(f,"data-validate-"+m);void 0!=n&&!1!==n&&("minlength"!==m&&
"maxlength"!==m||-1!==(n=parseInt(n,10)))&&(l[m]=n,(n=R.dom.getAttr(f,"data-message-"+m))&&this.setMessage(m,n))}if(n=R.dom.getAttr(f,"remote"))l.remote=n;if(h){h=h.split(" ");var m=0;for(n=h.length;m<n;m++)if(f=h[m].trim(),d[f]||"remote"===f)l[f]=!0}for(m in l)this.setRule(m,l[m],!1)},setConfigRules:function(f){var h=this.elem,l;this.$self.deepInitConfig(f);for(l in d)if(d.hasOwnProperty(l)){var n=f.get(l);void 0!=n&&!1!==n&&("minlength"!==l&&"maxlength"!==l||-1!==(n=parseInt(n,10)))&&(this.setRule(l,
n,!1),(n=(f?f.get(l+".msg"):null)||R.dom.getAttr(h,"data-message-"+l))&&this.setMessage(l,n))}},getRules:function(){return this.rules},hasRule:function(f){return this.rules[f]?!0:!1},getValue:function(){return this.input.getValue()},getUserData:function(){return this.data},setUserData:function(f){var h=this.data;this.data=f;return h},isEmpty:function(){return e(this.getValue(),this.elem)},enable:function(){this.enabled=!0;this.vldr.reset();return this},disable:function(){this.enabled=!1;!1===this.valid&&
(this.setValidState(!0),this.doDisplayState());return this},enableDisplayState:function(){this.displayState=!0},disableDisplayState:function(){this.displayState=!1},isDisplayStateEnabled:function(){return this.displayState},toggleErrorBox:function(f){var h=this.cfg,l=h.errorBox.enabled;h.errorBox.enabled=f;!l&&f&&f.displayState&&!1===this.valid()&&this.doDisplayState()},isEnabled:function(){return this.enabled},getElem:function(){return this.elem},getName:function(){return this.id},getError:function(){return this.error},
getErrorRule:function(){return this.errorRule},isValid:function(){return this.isEnabled()?this.customError?!1:!0===this.valid&&!this.pending||0===this.rulesNum:!0},getExactValidState:function(){return this.valid},setCustomError:function(f,h){this.customError=f?!0:!1;this.setValidState(f?!1:!0);this.setError(!0===f?null:f,h);this.doDisplayState()},reset:function(){this.abort();this.dirty=!1;this.prev="";this.setValidState(null);this.setError(null);this.doDisplayState();return this},abort:function(){this.pending&&
(this.pending.abort(),this.pending=null);return this},check:function(f){var h=this.rules,l=this.cfg,n=this.elem;if(!this.isEnabled())return!0;if(this.customError)return!1;if(0==this.rulesNum&&!1!==this.valid)return!0;if(this.checking)return this.checkTmt||(this.checkTmt=setTimeout(this.checkTimeout.bind(this),100)),!0===this.valid;this.checking=!0;if(!(!0===f||h.equalTo||h.notEqualTo||this.dirty||null===this.valid||l.alwaysCheck))return this.pending||this.doDisplayState(),this.checking=!1,!0===this.valid;
var m=!0,p=!1,r=this.getValue(),q,t;for(t in h)if("remote"===t){if(this.dirty||l.alwaysCheck||null===this.valid||!0===f)if(r||h[t].checkEmpty)p=!0}else if(!0!==(q=(G(h[t])?h[t]:d[t]).call(this.$$callbackContext,r,n,h[t],this))){m=!1;this.setError(g(q||l.messages[t]||"",h[t]),t);break}p=p&&m;m&&this.setError(null);p?this.ajaxCheck():(this.setValidState(m),this.doDisplayState());this.checking=this.dirty=!1;this.trigger("check",this,this.valid);return!0===this.valid&&!p},doDisplayState:function(){var f=
this.cfg,h=this.isValid(),l=f.cls.error,n=f.cls.valid,m=this.elem;this.displayState||f.alwaysDisplayState||(h=null);null===this.valid&&(h=null);l&&(!1===h?R.dom.addClass(m,l):R.dom.removeClass(m,l));n&&(!0===h?R.dom.addClass(m,n):R.dom.removeClass(m,n));l=this.getErrorBox();n=this.error;l&&(!1===h&&n&&(l.innerHTML=state.error),l.style.display=!1===h&&n&&f.errorBox.enabled?"block":"none");this.trigger("display-state",this,h,this.error)},getErrorBox:function(){var f=this.cfg.errorBox;return f.tag||
f.fn||f.selector?(!this.errorBox&&f.enabled&&this.createErrorBox(),this.errorBox):null},onDestroy:function(){R.dom.removeAttr(this.elem,"data-validator");this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox);this.input.$destroy()},isPending:function(){return null!==this.pending},setValidState:function(f){this.valid!==f&&(this.valid=f,this.trigger("state-change",this,f))},setError:function(f,h){if(this.error!=f||this.errorRule!=h)this.error=f,this.errorRule=h,this.trigger("error-change",
this,f,h)},checkTimeout:function(){this.checkTmt=null;this.checking||this.check(!1)},onInputChange:function(f){this.prev!==f&&(this.dirty=!0,this.customError=!1,this.abort(),this.pending||this.check(!1),this.prev=this.input.getValue())},onInputSubmit:function(f){f=R.dom.normalizeEvent(f);if(!(f.isDefaultPrevented&&f.isDefaultPrevented()||!1!==this.trigger("submit",this,f)))return f.preventDefault(),!1},createErrorBox:function(){var f=this.cfg.errorBox,h=f.tag,l=f.cls,n=f.fn,m=f.position;f=f.elem;
n?this.errorBox=n.call(this.$$callbackContext,this):f?this.errorBox=f:(this.errorBox=window.document.createElement(h),this.errorBox.className=l,h=(h=this.input.radio)?h[h-1]:this.elem,"appendParent"==m?h.parentNode.appendChild(this.errorBox):"before"==m?h.parentNode.insertBefore(this.errorBox,h):h.parentNode.insertBefore(this.errorBox,h.nextSibling))},ajaxCheck:function(){var f=this.elem,h=this.rules.remote,l=this.getValue(),n=this.cfg;h=D({},I(h)?{url:h}:h,!0);h.data=h.data||{};h.data[h.paramName||
R.dom.getAttr(f,"name")||R.dom.getAttr(f,"id")]=l;h.handler||(h.dataType="text");h.cache=!1;n.cls.ajax&&R.dom.addClass(f,n.cls.ajax);this.trigger("before-ajax",this,h);this.pending=eb(h);this.pending.done(this.onAjaxSuccess.bind(this));this.pending.fail(this.onAjaxError.bind(this))},onAjaxSuccess:function(f){var h=this.rules,l=this.cfg;this.pending=null;var n=!0;h.remote.handler?(f=h.remote.handler.call(this.$$callbackContext,this,f),!0!==f&&(this.setError(g(f||l.messages.remote||"",h.remote),"remote"),
n=!1)):f?(this.setError(f,"remote"),n=!1):this.setError(null);l.cls.ajax&&R.dom.removeClass(this.elem,l.cls.ajax);this.setValidState(n);this.doDisplayState();this.trigger("after-ajax",this)},onAjaxError:function(f,h){var l=this.cfg,n=f.responseData,m=this.rules;n&&m.remote.handler&&(n=m.remote.handler.call(this.$$callbackContext,this,n),!0!==n&&this.setError(g(n||l.messages.remote||"",m.remote),"remote"));l.cls.ajax&&R.dom.removeClass(this.elem,l.cls.ajax);this.pending=null;"abort"!=h&&"abort"!=f&&
(this.setValidState(!1),this.doDisplayState(),this.trigger("after-ajax",this))}},{defaults:{},messages:{},deepInitConfig:function(f){var h=R.lib.Config.MODE_STATIC,l;for(l in d)d.hasOwnProperty(l)&&f.hasProperty(l)&&(f.setDefaultMode(l,h),f.setDefaultMode(l+".msg",h))}})}();R.validator.Group=function(){var a={alwaysCheck:!1,alwaysDisplayState:!1,disabled:!1,value:null,elem:null,errorBox:null,errorField:null,data:null,cls:{valid:"",error:""},fields:[],rules:{},messages:{},callback:{scope:null,destroy:null,statechange:null,errorchange:null,displaystate:null}},c=R.validator.messages,b=R.validator.methods,d=R.validator.format;return U({$mixins:[R.mixin.Observable],fields:null,rules:null,cfg:null,vldr:null,enabled:!1,invalid:null,valid:null,displayState:!1,rulesNum:0,error:null,
data:null,errorBox:null,el:null,$init:function(e,g){e=e||{};var f;this._vldr=g;this.cfg=f=D({},a,R.validator.Group.defaults,e,!0,!0);this.data=e.data;this.el=e.elem;this.fields={};this.rules={};f.messages=D({},c,f.messages,!0,!0);f.rules&&this.setRules(f.rules,!1);if(f.fields){var h=0;for(e=e.fields.length;h<e;h++)this.add(g.getField(f.fields[h]))}this.enabled=!f.disabled},enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},
isValid:function(){return!this.enabled||0===this.invalid&&!0===this.valid},getExactValidState:function(){return this.valid},reset:function(){this.invalid=0;this.setValidState(null);this.setError(null);this.doDisplayState();return this},getUserData:function(){return this.data},getName:function(){return this.cfg.name},setRules:function(e,g){g=void 0==g?!0:g;for(var f in e)this.setRule(f,e[f],!1);g?this.check():this.setValidState(null);return this},setRule:function(e,g,f){var h=this.rules;f=void 0==
f?!0:f;null===g?(h[e]&&this.rulesNum--,delete h[e]):(h[e]||this.rulesNum++,h[e]=g,null!==this.valid&&this.setValidState(!1));f?this.check():this.setValidState(null);return this},getRules:function(){return D({},this.rules)},hasRule:function(e){return this.rules[e]?!0:!1},setError:function(e){var g=this.cfg;this.error!=e&&(g.errorField?(this.vldr.getField(g.errorField).setError(e),this.error=null):(this.error=e,this.trigger("error-change",this,e)))},getError:function(){return this.error},getFields:function(){return this.fields},
enableDisplayState:function(){this.displayState=!0;return this},disableDisplayState:function(){this.displayState=!1;return this},check:function(){var e=this.cfg,g=this.fields,f=this.rules;if(!this.enabled||0==this.rulesNum)return this.setValidState(null),this.doDisplayState(),!0;this.countInvalid();if(0<this.invalid)return this.setValidState(null),this.doDisplayState(),!0;var h={},l=!0,n=null,m;if(e.value){for(m in g)h[m]=g[m].getValue();n=e.value.call(this.$$callbackContext,h,this)}for(m in f)if(!0!==
(g=(G(f[m])?f[m]:b[m]).call(this.$$callbackContext,n,null,f[m],this,h))){l=!1;g||e.messages[m]?this.setError(d(g||e.messages[m]||"",f[m])):this.setError(null);break}l&&this.setError(null);this.setValidState(l);this.doDisplayState();return!0===this.valid},doDisplayState:function(){var e=this.valid,g=this.cfg;this.displayState||g.alwaysDisplayState||(e=null);if(g.errorBox){var f=this.getErrorBox();null!==e?f&&(f.innerHTML=this.error||"",f.style.display=!1===this.valid?"block":"none"):f&&(f.style.display=
"none")}f=g.cls.error;g=g.cls.valid;e=this.valid;f&&(!1===e?R.dom.addClass(this.el,f):R.dom.removeClass(this.el,f));g&&(!0===e?R.dom.addClass(this.el,g):R.dom.removeClass(this.el,g));this.trigger("display-state",this,this.valid)},getErrorBox:function(){var e=this.cfg,g=this.fields,f=e.errorBox;if(g[f])return g[f].getErrorBox();this.errorBox||(G(e.errorBox)?this.errorBox=e.errorBox.call(this.$$callbackContext,this):this.errorBox=e.errorBox);return this.errorBox},onDestroy:function(){var e=this.fields,
g;for(g in e)e[g]&&this.setFieldEvents(e[g],"un");this.errorBox&&this.errorBox.parentNode.removeChild(this.errorBox)},add:function(e){var g=this.fields,f=e.getName();g[f]||(g[f]=e,this.setFieldEvents(e,"on"))},setFieldEvents:function(e,g){e[g]("state-change",this.onFieldStateChange,this)},remove:function(e){var g=this.fields,f=e.getName();g[f]&&(delete g[f],this.setFieldEvents(e,"un"));return this},setValidState:function(e){this.valid!==e&&(this.valid=e,this.trigger("state-change",this,e))},countInvalid:function(){var e=
this.fields;this.invalid=0;for(var g in e)this.invalid+=e[g].isValid()?0:1},onFieldStateChange:function(e,g){this.trigger("field-state-change",this,e,g);this.check()}},{defaults:{}})}();R.validator.Validator=function(){var a={},c=R.validator.Field,b=R.validator.Group,d={form:null,all:{},fields:{},rules:{},cls:{valid:"",error:"",checking:""},groups:{},callback:{scope:null,destroy:null,reset:null,beforesubmit:null,submit:null,statechange:null,check:null,displaystate:null,displaystatechange:null}},e=U({$mixins:[R.mixin.Observable],id:null,el:null,cfg:null,enabled:!1,invalid:null,pending:0,grps:0,outside:!0,submitted:!1,displayState:!1,isForm:!1,isField:!1,submitButton:null,hidden:null,
preventFormSubmit:!1,fields:null,groups:null,$init:function(g,f,h){var l=g.nodeName.toLowerCase();this.id=E();a[this.id]=this;R.dom.setAttr(g,"data-validator",this.id);this.el=g;f&&!I(f)&&(h=f,f=null);this.cfg=g=D({},d,e.defaults,e[f],h,!0,!0);this.$initObservable(g);this.isForm="form"===l;this.isField=/input|select|textarea/.test(l);this.fields={};this.groups={};this.$$observable.createEvent("submit",!1);this.$$observable.createEvent("beforesubmit",!1);this.onRealSubmitClickDelegate=this.onRealSubmitClick.bind(this);
this.resetDelegate=this.reset.bind(this);this.onSubmitClickDelegate=this.onSubmitClick.bind(this);this.onFormSubmitDelegate=this.onFormSubmit.bind(this);var n;this.initFields();l=this.fields;for(n in g.rules)l[n]&&l[n].setRules(g.rules[n],!1);g.rules=null;for(n in g.groups)this.addGroup(n,g.groups[n]);this.initForm("bind");delete g.rules;delete g.fields;delete g.groups;this.enabled=!0},getVldId:function(){return this.id},getElem:function(){return this.el},getGroup:function(g){return this.groups[g]||
null},getField:function(g){return this.fields[g]||null},enable:function(){this.enabled=!0;return this},disable:function(){this.enabled=!1;return this},isEnabled:function(){return this.enabled},enableDisplayState:function(){var g=this.fields,f=this.groups,h;if(!0!==this.displayState){this.displayState=!0;for(h in g)g[h].enableDisplayState();for(h in f)f[h].enableDisplayState();this.trigger("display-state-change",this,!0)}return this},disableDisplayState:function(){var g=this.groups,f=this.fields,h;
if(!1!==this.displayState){this.displayState=!1;for(h in f)f[h].disableDisplayState();for(h in g)g[h].disableDisplayState();this.trigger("display-state-change",this,!1)}return this},isDisplayStateEnabled:function(){return this.displayState},isValid:function(){return!1===this.enabled?!0:0===this.invalid&&0===this.pending&&0===this.grps&&!0===this.outside},getErrors:function(g){var f=!0===g?[]:{},h,l,n,m=[this.fields,this.groups];if(!this.isEnabled())return f;for(n=0;2>n;n++){var p=m[n];for(l in p)null===
p[l].getExactValidState()&&p[l].check(),p[l].isValid()||(h=p[l].getError())&&(g?f.push(h):f[l]=h)}return f},check:function(){var g=this.fields,f=this.groups;if(!this.isEnabled())return!0;var h=this.isValid(),l;for(l in g)g[l].check();for(l in f)f[l].check();this.outside=!1!==this.trigger("check",this);g=this.isValid();h!=g&&(this.doDisplayState(),this.trigger("state-change",this,!1));return g},add:function(g,f){if(!R.dom.isField(g)||null!==R.dom.getAttr(g,"data-no-validate")||null!==R.dom.getAttr(g,
"data-validator"))return this;var h=R.dom.getAttr(g,"name")||R.dom.getAttr(g,"id"),l=this.cfg,n=this.fields;if(!h)return this;h=l.fields&&l.fields[h]?l.fields[h]:f||{};I(h)&&(h={rules:[h]});h=D({},l.all||{},h,!0,!0);if(h.ignore)return this;h.callback||(h.callback={context:this.$$callbackContext});g=new c(g,h,this);h=g.getName();if(n[h])return this;n[h]=g;this.setFieldEvents(g,"on");this.displayState&&g.enableDisplayState();this.isEnabled()&&null!==this.invalid&&g.check();return this},addGroup:function(g,
f){var h=this.groups;h[g]||(f.name=g,h[g]=new b(f,this),this.setGroupEvents(h[g],"on"),this.isEnabled()&&null!==this.invalid&&h[g].check());return this},focusInvalid:function(){var g=this.fields,f;for(f in g)if(!g[f].isValid()){g[f].getElem().focus();break}},reset:function(){var g=this.fields,f=this.groups,h;this.submitted=!1;this.disableDisplayState();for(h in f)f[h].reset();for(h in g)g[h].reset();this.pending=0;this.invalid=null;this.grps=0;this.outside=!1;this.doDisplayState();this.trigger("reset",
this);return this},submit:function(){var g=this.el;if(this.isForm)if(G(g.submit))!1!==this.trigger("before-submit",this)&&!1!==this.trigger("submit",this)&&g.submit();else this.onSubmit();else this.onSubmit()},setFieldEvents:function(g,f){g[f]("state-change",this.onFieldStateChange,this);g[f]("before-ajax",this.onBeforeAjax,this);g[f]("after-ajax",this.onAfterAjax,this);g[f]("submit",this.onFieldSubmit,this);g[f]("destroy",this.onFieldDestroy,this);g[f]("error-change",this.onFieldErrorChange,this)},
setGroupEvents:function(g,f){g[f]("state-change",this.onGroupStateChange,this)},initFields:function(){var g=this.el,f;if(this.isField)return this.add(g),this;g=R.dom.select("input, textarea, select",g);var h=-1;for(f=g.length;++h<f;this.add(g[h]));return this},initForm:function(g){var f=this.el,h=f.getElementsByTagName("input"),l=R.dom.select(".submit",f),n=R.dom.select(".reset",f);g="bind"===g?R.dom.addListener:R.dom.removeListener;var m;var p=0;for(m=h.length;p<m;p++){var r=h[p];var q=r.type;"submit"===
q?g(r,"click",this.onRealSubmitClickDelegate):"reset"===q&&g(r,"click",this.resetDelegate)}p=-1;for(m=l.length;++p<m;)"submit"===l[p].type&&"button"!==l[p].tagName.toLowerCase()||g(l[p],"click",this.onSubmitClickDelegate);p=-1;for(m=n.length;++p<m;"reset"!==n[p].type&&g(n[p],"click",this.resetDelegate));this.isForm&&g(f,"submit",this.onFormSubmitDelegate)},onRealSubmitClick:function(g){g=R.dom.normalizeEvent(g||window.event);this.submitButton=g.target||g.srcElement;this.preventFormSubmit=!1;return this.onSubmit(g)},
onSubmitClick:function(g){this.preventFormSubmit=!1;return this.onSubmit(R.dom.normalizeEvent(g||window.event))},onFormSubmit:function(g){g=R.dom.normalizeEvent(g);if(!this.isValid()||this.preventFormSubmit)return g.preventDefault(),!1},onFieldSubmit:function(g,f){this.preventFormSubmit=!1;this.enableDisplayState();this.submitted=!0;return this.onSubmit(f)},onSubmit:function(g){this.enableDisplayState();this.isForm||(g&&g.preventDefault(),g&&g.stopPropagation());if(this.pending)return g&&g.preventDefault(),
!1;var f=!!this.submitButton;this.isForm&&(this.hidden&&(this.el.removeChild(this.hidden),this.hidden=null),this.submitButton&&/input|button/.test(this.submitButton.nodeName)&&(this.hidden=window.document.createElement("input"),this.hidden.type="hidden",R.dom.setAttr(this.hidden,"name",this.submitButton.name),this.hidden.value=this.submitButton.value,this.el.appendChild(this.hidden)));this.submitButton=null;if(!this.isValid()&&(this.check(),this.onFieldStateChange(),this.pending))return this.submitted=
!0,g&&g.preventDefault(),!1;if(!1===this.trigger("before-submit",this)||!this.isValid())return g&&(g.preventDefault(),g.stopPropagation()),this.pending||(this.focusInvalid(),this.submitted=!1),this.trigger("failed-submit",this,f),!1;this.pending||(this.submitted=!1);g=this.trigger("submit",this);this.preventFormSubmit=!1===g;return this.isForm?g:!1},onFieldDestroy:function(g){g=g.getElem();g=R.dom.getAttr(g,"name")||R.dom.getAttr(g,"id");delete this.fields[g]},onFieldErrorChange:function(g,f){this.trigger("field-error-change",
this,g,f)},onFieldStateChange:function(g,f){var h=this.invalid,l=this.fields;this.invalid=0;for(var n in l)this.invalid+=l[n].isValid()?0:1;g&&this.trigger("field-state-change",this,g,f);if(null===h||null!==h&&this.invalid!==h)this.doDisplayState(),this.trigger("state-change",this,this.isValid())},onGroupStateChange:function(){var g=this.groups,f=this.grps;this.grps=0;for(var h in g)this.grps+=g[h].isValid()?0:1;if(null===f||null!==f&&this.grps!==f)this.doDisplayState(),this.trigger("state-change",
this,this.isValid())},doDisplayState:function(){var g=this.cfg,f=this.isValid(),h=g.cls.error;g=g.cls.valid;var l=this.el;if(this.isField||!this.displayState)f=null;null===this.invalid&&(f=null);h&&(!1===f?R.dom.addClass(l,h):R.dom.removeClass(l,h));g&&(!0===f?R.dom.addClass(l,g):R.dom.removeClass(l,g));this.trigger("display-state",this,f)},onBeforeAjax:function(){this.pending++;this.cfg.cls.ajax&&R.dom.addClass(this.el,this.cfg.cls.ajax)},onAfterAjax:function(){var g=this.fields,f=this.cfg;this.pending=
0;for(var h in g)this.pending+=g[h].isPending()?1:0;this.doDisplayState();f.cls.ajax&&R.dom.removeClass(this.el,f.cls.ajax);this.submitted&&0==this.pending&&(this.submitted=!1,this.isValid()?this.submit():this.focusInvalid())},onDestroy:function(){var g=this.groups,f=this.fields,h;this.reset();delete a[this.id];for(h in g)g.hasOwnProperty(h)&&g[h]&&(this.setGroupEvents(g[h],"un"),g[h].$destroy());for(h in f)f.hasOwnProperty(h)&&f[h]&&(this.setFieldEvents(f[h],"un"),f[h].$destroy());this.initForm("unbind");
this.cfg=this.el=this.groups=this.fields=null}},{defaults:{},addMethod:function(g,f,h){var l=ns.get("MetaphorJs.validator.methods");l[g]||(l[g]=f,h&&(e.messages[g]=h))},getValidator:function(g){g=R.dom.getAttr(g,"data-validator");return a[g]||null}});return e}();R.validator.Component=U({node:null,scope:null,validator:null,scopeState:null,fields:null,formName:null,nodeCfg:null,$init:function(a,c,b,d){this.$self.initConfig(d);this.node=a;this.scope=c;this.scopeState={};this.fields=[];this.nodeCfg=d;this.validator=this.createValidator();this.formName=d.get("ref")||R.dom.getAttr(a,"name")||R.dom.getAttr(a,"id")||"$form";this.initScope();this.initScopeState();this.initValidatorEvents();b.on("rendered",this.validator.check,this.validator,{once:!0});b.on("destroy",
this.$destroy,this);c.$on("destroy",this.$destroy,this)},createValidator:function(){var a=this.node,c={},b;if(b=this.nodeCfg.get("submit"))c.callback=c.callback||{},c.callback.submit=function(d,e){return function(){try{return d(e)}catch(g){S(g)}}}(b,this.scope);return new R.validator.Validator(a,c)},initValidatorEvents:function(){var a=this.validator;a.on("field-state-change",this.onFieldStateChange,this);a.on("state-change",this.onFormStateChange,this);a.on("display-state-change",this.onDisplayStateChange,
this);a.on("field-error-change",this.onFieldErrorChange,this);a.on("reset",this.onFormReset,this)},initScope:function(){this.scope[this.formName]=this.scopeState},initScopeState:function(){var a=this.node,c=this.scopeState,b=this.fields,d;if(a.elements)var e=a.elements;else e=[],R.dom.eachNode(a,function(f){R.dom.isField(f)&&e.push(f)});a=-1;for(d=e.length;++a<d;){var g=e[a];(g=R.dom.getAttr(g,"name")||R.dom.getAttr(g,"id"))&&!c[g]&&(b.push(g),c[g]={$error:null,$invalid:null,$pristine:!0,$errorMessage:null})}c.$$validator=
this.validator;c.$invalid=!1;c.$pristine=!0;c.$isDestroyed=this.$isDestroyed.bind(this);c.$submit=this.validator.onSubmit.bind(this.validator);c.$reset=this.validator.reset.bind(this.validator)},onDisplayStateChange:function(a,c){if(c){c=this.scopeState;var b,d=this.fields;var e=0;for(b=d.length;e<b;e++){var g=c[d[e]];g.$real&&(c[d[e]]=g.$real)}c.$invalid=!a.isValid();c.$pristine=!1;this.scope.$check()}else this.onFormReset(a)},onFieldErrorChange:function(a,c){this.onFieldStateChange(a,c,c.isValid())},
onFormReset:function(){var a=this.scopeState,c,b=this.fields;var d=0;for(c=b.length;d<c;d++){var e=a[b[d]];e.$error=null;e.$errorMessage=null;e.$invalid=null;e.$pristine=!0}a.$invalid=!1;a.$pristine=!0;this.scope.$check()},onFormStateChange:function(a,c){var b=this.scopeState;b.$invalid=!1===c&&a.isDisplayStateEnabled();b.$pristine=!1;this.scope.$check()},onFieldStateChange:function(a,c,b){var d=this.scopeState,e=c.getName();a=a.isDisplayStateEnabled();c={$error:c.getErrorRule(),$errorMessage:c.getError(),
$invalid:!1===b,$pristine:null===c.getExactValidState()};a?d[e]=c:d[e].$real=c;this.scope.$check()},onDestroy:function(){this.validator.$destroy();this.scope&&delete this.scope[this.formName]}},{initConfig:function(a){a.setDefaultMode("ref",R.lib.Config.MODE_STATIC)}});V.registerAttribute("form",250,function(){function a(c,b,d,e){a.initConfig(d);var g=d.get("value"),f=cb.get(g);f?V.resolveNode(b,"form",function(h){e.$destroyed||(h=new f(h,c,e,d),e.on("destroy",h.$destroy,h))}):error(Error("Class '"+g+"' not found"))}a.initConfig=function(c){c.setProperty("value",{mode:R.lib.Config.MODE_STATIC,type:"string",defaultValue:"MetaphorJs.validator.Component"});c.setMode("submit",R.lib.Config.MODE_FUNC)};a.deepInitConfig=function(c){R.validator.Component.initConfig(c)};
return a}());V.registerAttribute("validate",200,function(){function a(c,b,d,e){V.resolveNode(b,"validate",function(g){if(!e.$destroyed){var f=R.dom.getAttr(g,"name")||R.dom.getAttr(g,"id");(f=(g=R.validator.Validator.getValidator(g))?g.getField(f):null)&&f.setConfigRules(d);d.clear()}})}a.deepInitConfig=function(c){R.validator.Field.deepInitConfig(c)};return a}());(function(){var a={getNodePositions:function(c,b,d){for(var e=[],g,f,h,l={};c.firstChild;)c.removeChild(c.firstChild);g=0;for(f=b.length;g<f;g++)d&&d[g]&&(h=d[g].el.cloneNode(!0),c.appendChild(h)),h=b[g].el.cloneNode(!0),c.appendChild(h),e.push(h);g=0;for(f=e.length;g<f;g++)c=e[g],(d=b[g].renderer)&&(l[d.id]={left:c.offsetLeft,top:c.offsetTop});return l},calculateTranslates:function(c,b,d){var e=this._nextEl.parentNode,g=e.parentNode,f=e.cloneNode(!0),h=e.offsetWidth,l=[],n=0,m=0;var p=f.style;p.position=
"absolute";p.left="-10000px";p.visibility="hidden";p.width=h+"px";g.insertBefore(f,e);p.width=h-(f.offsetWidth-h)+"px";b=this.getNodePositions(f,b);d=this.getNodePositions(f,c,d);e=this.getNodePositions(f,c);g.removeChild(f);g=0;for(f=c.length;g<f;g++)h=c[g].el,p=c[g].renderer,p=p.id,0===g&&(n=h.offsetLeft,m=h.offsetTop),l.push([{left:e[p].left-n-(d[p].left-n),top:e[p].top-m-(d[p].top-m)},b[p]?{left:b[p].left-n-(d[p].left-n),top:b[p].top-m-(d[p].top-m)}:null]);return l},moveAnimation:function(c,b,
d,e,g){var f=c.style;g.done(function(){if(d){var h=R.animate.getPrefixes();f[h.transform]="translateX("+d.left+"px) translateY("+d.top+"px)"}});return R.animate.animate(c,"move",e,function(h,l,n){0===l&&"start"!==n&&b&&(h=R.animate.getPrefixes(),f[h.transform]="translateX("+b.left+"px) translateY("+b.top+"px)")})},reflectChanges:function(c){function b(){q.countdown();return m}var d=this,e=c.oldItems,g=c.newItems,f,h,l;d.renderOrUpdate();c.doesMove&&(f=d.calculateTranslates(c.newItems,c.origItems,
c.oldItems));var n=[],m=new R.lib.Promise,p=new R.lib.Promise,r=new R.lib.Promise,q=R.lib.Promise.counter(g.length);var t=0;for(h=e.length;t<h;t++)if(l=e[t])l.scope.$destroy(),R.animate.stop(l.el),n.push(R.animate.animate(l.el,"leave").done(function(u){u.style.visibility="hidden"}));t=0;for(h=g.length;t<h;t++)l=g[t],R.animate.stop(l.el),"enter"===l.action?n.push(R.animate.animate(l.el,"enter",b)):n.push(d.moveAnimation(l.el,c.doesMove?f[t][0]:null,c.doesMove?f[t][1]:null,b,p));q.done(function(){X(function(){p.resolve();
d.applyDomPositions(e);c.doesMove||d.renderOrUpdate(c.updateStart,null,"move");X(function(){m.resolve()});d.trigger("change",d)})});R.lib.Promise.all(n).always(function(){X(function(){var u=R.animate.getPrefixes();d.renderOrUpdate(c.updateStart||0);d.removeOldElements(e);if(c.doesMove)for(d.renderOrUpdate(c.updateStart,null,"move"),t=0,h=g.length;t<h;t++)(l=g[t])&&l.el&&(l.el.style[u.transform]=null,l.el.style[u.transform]="");r.resolve()})});return r}};return U({$class:"MetaphorJs.plugin.ListAnimated",
$init:function(c){c.$implement(a)}})})();R.dom.getScrollParent=function(){function a(d){return(d=R.dom.getStyle(d))?d.overflow+d.overflowY+d.overflowY:""}var c=/(auto|scroll)/,b;return function(d){b||(b=window.document.body);for(;d&&d!==b;){if(c.test(a(d)))return d;d=d.parentNode}return window}}();R.dom.getOffsetParent=function(a){var c=window.document.documentElement;for(a=a.offsetParent||c;a&&a!=c&&"static"===R.dom.getStyle(a,"position");)a=a.offsetParent;return a||c};R.dom.getOffset=function(a){var c={top:0,left:0},b=window.document.documentElement;if(!R.dom.isAttached(a)||a===window)return c;a.getBoundingClientRect&&(c=a.getBoundingClientRect());return{top:c.top+R.dom.getScrollTop()-b.clientTop,left:c.left+R.dom.getScrollLeft()-b.clientLeft}};R.dom.getPosition=function(a,c){var b={top:0,left:0},d=window.document.documentElement;if(a===window||a===d)return b;if("fixed"==R.dom.getStyle(a,"position"))var e=a.getBoundingClientRect();else{if(c)return a=R.dom.getOffset(a),b=R.dom.getOffset(c),a={left:a.left-b.left,top:a.top-b.top},0>a.left&&(a.left=0),0>a.top&&(a.top=0),a;c=R.dom.getOffsetParent(a);e=R.dom.getOffset(a);c!==d&&(b=R.dom.getOffset(c));b.top+=R.dom.getStyle(c,"borderTopWidth",!0);b.left+=R.dom.getStyle(c,"borderLeftWidth",!0)}return{top:e.top-
b.top-R.dom.getStyle(a,"marginTop",!0),left:e.left-b.left-R.dom.getStyle(a,"marginLeft",!0)}};U({$class:"MetaphorJs.plugin.ListBuffered",list:null,enabled:!0,itemSize:null,itemsOffsite:5,bufferState:null,scrollOffset:0,horizontal:!1,dynamicOffset:!1,bufferEventDelegate:null,topStub:null,botStub:null,$init:function(a){var c=this;c.list=a;a.$intercept("afterInit",this.afterInit,this,"before");a.$intercept("doRender",this.doRender,this,"instead");a.$implement({scrollTo:c.$bind(c.scrollTo),reflectChanges:function(b){c.enabled?(c.getScrollOffset(),a.removeOldElements(b.oldRenderers),a.queue.append(c.updateScrollBuffer,
c,[!0]),a.trigger("change",a)):c.$super(b)}})},afterInit:function(){var a=this.list.attr;a=a?a.config:{};this.itemSize=a.itemSize;this.itemsOffsite=parseInt(a.itemsOffsite||5,10);this.horizontal=a.horizontal||!1;this.dynamicOffset=a.dynamicOffset||!1;this.initScrollParent(a);this.initScrollStubs(a);this.bufferEventDelegate=this.bufferUpdateEvent.bind(this);this.up();this.list.scope.$on("freeze",this.down,this);this.list.scope.$on("unfreeze",this.up,this)},doRender:function(){this.getScrollOffset();
this.updateScrollBuffer()},up:function(){R.dom.addListener(this.scrollEl,"scroll",this.bufferEventDelegate);R.dom.addListener(window,"resize",this.bufferEventDelegate)},down:function(){R.dom.removeListener(this.scrollEl,"scroll",this.bufferEventDelegate);R.dom.removeListener(window,"resize",this.bufferEventDelegate)},initScrollParent:function(){this.scrollEl=R.dom.getScrollParent(this.list.parentEl)},initScrollStubs:function(a){var c=this.list,b=c.parentEl,d=c.prevEl,e,g,f={fontSize:0,lineHeight:0,
padding:0,paddingTop:0,paddingLeft:0,paddingBottom:0,paddingRight:0,margin:0,marginLeft:0,marginTop:0,marginRight:0,marginBottom:0};this.topStub=e=window.document.createElement(a.stub||"div");this.botStub=a=window.document.createElement(a.stub||"div");R.dom.addClass(e,"mjs-buffer-top");R.dom.addClass(a,"mjs-buffer-bottom");for(g in f)e.style[g]=f[g],a.style[g]=f[g];b.insertBefore(e,d?d.nextSibling:b.firstChild);b.insertBefore(a,c.nextEl);c.prevEl=e;c.nextEl=a},getItemsPerRow:function(){return 1},
getRowHeight:function(){return this.itemSize},getScrollOffset:function(){var a=R.dom.getPosition(this.topStub,this.scrollEl);return this.scrollOffset=this.horizontal?a.left:a.top},getBufferState:function(a){var c=this.scrollEl,b=this.horizontal,d=window.document.documentElement;d=c===window?window[b?"innerWidth":"innerHeight"]||d[b?"clientWidth":"clientHeight"]:c[b?"offsetWidth":"offsetHeight"];b=b?R.dom.getScrollLeft(c):R.dom.getScrollTop(c);c=c.scrollHeight;var e=this.getItemsPerRow(),g=this.getRowHeight(),
f=this.itemsOffsite,h=a?this.getScrollOffset():this.scrollOffset;a=Math.ceil(this.list.renderers.length/e);var l;var n=Math.ceil((b-h)/g);0>n&&(n=0);h=n;var m=l=n+Math.ceil(d/g);n=n>f?n-f:0;m+=f;m>a-1&&(m=a-1);c&&b+d>=c&&this.bufferState&&this.bufferState.last==m*e&&(m+=f);return n>m?this.bufferState:this.bufferState={first:n*e,viewFirst:h*e,last:m*e,viewLast:l*e,ot:n*g,ob:(a-m-1)*g}},updateStubs:function(a){var c=this.horizontal;this.topStub.style[c?"width":"height"]=a.ot+"px";this.botStub.style[c?
"width":"height"]=a.ob+"px"},bufferUpdateEvent:function(){this.list.queue.add(this.updateScrollBuffer,this)},updateScrollBuffer:function(a){var c=this,b=c.list,d=c.bufferState,e=b.parentEl,g=b.renderers,f=c.botStub,h=c.getBufferState(c.dynamicOffset),l=new R.lib.Promise,n=window.document,m,p,r,q;if(!h)return null;d&&h.first==d.first&&h.last==d.last||b.trigger("buffer-change",c,h,d);X(function(){if(!c.$isDestroyed()){if(a||!d||h.last<d.first||h.first>d.last){if(d)for(p=d.first,r=d.last;p<=r;p++)(q=
g[p])&&q.attached&&(e.removeChild(q.el),q.attached=!1);m=n.createDocumentFragment();p=h.first;for(r=h.last;p<=r;p++)if(q=g[p])q.rendered||b.renderItem(p),m.appendChild(q.el),q.attached=!0;e.insertBefore(m,f)}else{if(d.first<h.first)for(p=d.first,r=h.first;p<r;p++)(q=g[p])&&q.attached&&(e.removeChild(q.el),q.attached=!1);else if(d.first>h.first){m=n.createDocumentFragment();p=h.first;for(r=d.first;p<r;p++)if(q=g[p])q.rendered||b.renderItem(p),m.appendChild(q.el),q.attached=!0;e.insertBefore(m,g[d.first].el)}if(d.last<
h.last){m=n.createDocumentFragment();p=d.last+1;for(r=h.last;p<=r;p++)if(q=g[p])q.rendered||b.renderItem(p),m.appendChild(q.el),q.attached=!0;e.insertBefore(m,f)}else if(d.last>h.last)for(p=h.last+1,r=d.last;p<=r;p++)(q=g[p])&&q.attached&&(e.removeChild(q.el),q.attached=!1)}c.updateStubs(h);b.trigger("buffer-update",c);c.onBufferStateChange(h,d);l.resolve()}});return l},scrollTo:function(a){var c=this.list,b=this.itemSize,d=this.scrollEl||R.dom.getScrollParent(c.parentEl),e=this.horizontal,g=e?"scrollLeft":
"scrollTop",f=new R.lib.Promise,h;c.queue.append(function(){X(function(){h=b*a;d===window?window.scrollTo(e?h:R.dom.getScrollLeft(),e?R.dom.getScrollTop():h):d[g]=h;f.resolve()});return f});return f},onBufferStateChange:function(){},$beforeHostDestroy:function(){var a=this.list.parentEl;a.removeChild(this.topStub);a.removeChild(this.botStub);this.down()}});R.plugin.ListBuffered.$extend({$class:"MetaphorJs.plugin.ListPullNext",buffered:!1,$init:function(a,c){var b=a.attr;b=b?b.config:{};b.bufferedPullNext&&(this.buffered=b.bufferedPullNext,a.buffered=!0);this.$super(a,c)},afterInit:function(){this.$super();this.getScrollOffset()},updateScrollBuffer:function(a){if(this.buffered)return this.$super(a);a=this.bufferState;var c=this.getBufferState(this.dynamicOffset);a&&c.first==a.first&&c.last==a.last||(this.list.trigger("buffer-change",this,c,a),this.onBufferStateChange(c,
a))},onBufferStateChange:function(a,c){var b=this.list,d=b.store.getLength();this.$super(a,c);d-a.last<(a.last-a.first)/3&&!b.store.loading&&!b.store.$destroyed&&(b.store.addNextPage(),b.trigger("pull",this))}});U({$class:"MetaphorJs.plugin.SrcDeferred",directive:null,queue:null,scrollEl:null,scrollDelegate:null,resizeDelegate:null,position:null,sw:null,sh:null,checkVisibility:!0,$init:function(a){this.directive=a;a.$intercept("onScopeChange",this.onScopeChange,this,"instead");a.$intercept("initDirective",this.$initDirective,this,"before");this.queue=a.queue||new R.lib.Queue({auto:!0,async:!0,mode:R.lib.Queue.REPLACE,thenable:!0})},$initDirective:function(){this.scrollEl=R.dom.getScrollParent(this.directive.node);
this.scrollDelegate=this.onScroll.bind(this);this.resizeDelegate=this.onResize.bind(this);R.dom.addListener(this.scrollEl,"scroll",this.scrollDelegate);R.dom.addListener(window,"resize",this.resizeDelegate)},isVisible:function(){if(!this.checkVisibility)return!0;var a=this.scrollEl,c=R.dom.getScrollTop(a),b=R.dom.getScrollLeft(a),d=this.sw,e=this.sh;this.position||(this.position=R.dom.getPosition(this.directive.node,a));d||(d=this.sw=R.dom.getWidth(a),e=this.sh=R.dom.getHeight(a));a=this.position.top;
var g=this.position.left;return a>c&&a<c+e&&g>b&&g<b+d},onScroll:function(){this.queue.add(this.changeIfVisible,this)},onResize:function(){this.sw=this.position=null;this.queue.add(this.changeIfVisible,this)},onScopeChange:function(){this.queue.add(this.changeIfVisible,this)},changeIfVisible:function(){if(this.isVisible())return this.stopWatching(),this.directive.doChange()},stopWatching:function(){this.scrollEl&&(R.dom.removeListener(this.scrollEl,"scroll",this.scrollDelegate),R.dom.removeListener(window,
"resize",this.resizeDelegate),this.scrollEl=null,this.checkVisibility=!1)},$beforeHostDestroy:function(){this.stopWatching();this.queue.$destroy()}});U({$class:"MetaphorJs.plugin.SrcSize",directive:null,width:null,height:null,origOnChange:null,$init:function(a){this.directive=a;a.$intercept("initDirective",this.$initDirective,this,"after");this.origOnChange=a.$intercept("onSrcChanged",this.onSrcChanged,this,"after")},$initDirective:function(){var a=self.directive.attr,c=self.directive.node,b=self.directive.scope,d=(a?a.config:{}).preloadSize;a=c.style;"attr"!==d&&(d=R.lib.Expression.parse(d)(b));b="attr"===d?parseInt(R.dom.getAttr(c,"width"),10):
d.width;c="attr"===d?parseInt(R.dom.getAttr(c,"height"),10):d.height;if(b||c)a.display="block";b&&(a.width=b+"px");c&&(a.height=c+"px")},onSrcChanged:function(){var a=this.directive,c=a.node;a.onSrcChanged=this.origOnChange;R.dom.removeStyle(c,"width");R.dom.removeStyle(c,"height");R.dom.removeStyle(c,"display");this.$destroy()}});V.registerAttribute("break-if",500,function(a,c,b,d){b.setType("value","bool");(a=b.get("value"))&&c.parentNode.removeChild(c);d&&d.flowControl("stop",!!a)});V.registerAttribute("ignore",0,function(a,c,b,d){d&&d.flowControl("stop",!0)});R.lib.Stylesheet=function(){function a(c){D(this,c);!this.id&&(this.id=E());this.appended=!1;this.content&&(c=this.content,this.content=null,this.setContent(c))}D(a.prototype,{_initStylesheet:function(){this.stylesheet=window.document.createElement("style");this.stylesheet.type="text/css";this.stylesheet.id="for_"+this.id;this.head=window.document.head||window.document.getElementsByTagName("head")[0]||window.document.body},setContent:function(c){if(c!=this.content){this.content=c;this.stylesheet||
this._initStylesheet();c=this.stylesheet;if(c.styleSheet)c.styleSheet.cssText=this.content;else{for(;c.firstChild;)c.removeChild(c.firstChild);c.appendChild(window.document.createTextNode(this.content))}this.appended||this.append()}},append:function(){this.stylesheet||this._initStylesheet();this.appended||(this.head.appendChild(this.stylesheet),this.appended=!0)},remove:function(){this.appended&&(this.head.removeChild(this.stylesheet),this.appended=!1)},$destroy:function(){this.appended&&this.remove()}});
return a}();V.registerAttribute("stylesheet",1E3,R.app.Directive.attr.Style.$extend({$class:"MetaphorJs.app.Directive.attr.Stylesheet",id:"stylesheet",initDirective:function(){this.styleId="stylesheet_"+E();this.stylesheet=new R.lib.Stylesheet({id:"for_"+this.styleId});this.stylesheet.append();this.$super(arguments)},getSelector:function(){var a=this.node;a.id||a.setAttribute("id",this.styleId);return"#"+a.id},escapeProperty:function(a,c){a=""+a;return"content"===c?'"'+a+'"':a},getCssText:function(){var a=this.getCurrentValue(),
c=this.getSelector(),b,d=[],e={"":[c+" {"]};if(a)for(b in a){var g=b.split(".",2);var f=1<g.length?g[0]||"":"";g=g[1];e[f]||(e[f]=[c+":"+f+" {"]);e[f].push(g+": "+this.escapeProperty(a[b],g)+";")}for(f in e)e[f].push("}"),d.push(e[f].join("\n"));return d.join("\n")},onScopeChange:function(){this.stylesheet.setContent(this.getCssText())},onDestroy:function(){this.stylesheet.$destroy();this.$super()}}));V.registerAttribute("update-on",1E3,function(a,c,b){function d(e){b.eachProperty(function(g){if(0===g.indexOf("value.")){var f=g.replace("value.","");g=b.get(g);g.$destroyed||g.$destroying||g&&(fn=g[e]||g["$"+e])&&fn.call(g,f,a.$check,a)}})}d("on");return function(){d&&(d("un"),d=cfgs=null)}});V.registerTag("bind-html",function(a,c,b,d){b=R.dom.getAttr(c,"value");a=R.lib.Expression.get(b,a);a=R.dom.toFragment(a);b=B(a.childNodes);c.parentNode.replaceChild(c,a);d&&d.flowControl("nodes",b)});V.registerTag("bind",function(a,c,b,d){b=R.dom.getAttr(c,"value");a=R.lib.Expression.get(b,a);a=window.document.createTextNode(a);c.parentNode.replaceChild(c,a);d&&d.flowControl("nodes",[a])});V.registerTag("if",V.attr.If.$extend({$class:"MetaphorJs.app.Directive.tag.If",_autoOnChange:!1,children:null,childrenFrag:null,initDirective:function(a,c,b,d,e){this.children=B(c.childNodes);this.childrenFrag=R.dom.toFragment(this.children);d&&d.flowControl("nodes",this.children);this.createCommentWrap();this.$super(a,c,b,d,e);c.parentNode&&c.parentNode.removeChild(c)},initConfig:function(){this.config.setProperty("value",{expression:R.dom.getAttr(this.node,"value")});this.$super()},onScopeChange:function(){var a=
this.config.get("value"),c=this.wrapperOpen,b=this.wrapperClose,d=c.parentNode;if(a)d.insertBefore(this.childrenFrag,b);else if(!this.initial){a=[];for(this.childrenFrag=window.document.createDocumentFragment();c.nextSibling&&c.nextSibling!==b;){var e=c.nextSibling;d.removeChild(e);a.push(e);this.childrenFrag.appendChild(e)}this.children=a}this.initial?this.initial=!1:this.config.get("once")&&this.$destroy()},onDestroy:function(){this.childrenFrag=this.children=null;this.$super()}},{initConfig:function(a){a.setType("once",
"bool",R.lib.Config.MODE_STATIC);a.setType("value","bool")}}));V.registerTag("include",function(){function a(c,b,d,e){a.initConfig(d);var g=new R.app.Template({scope:c,replaceNode:b,config:d,parentRenderer:e});e&&(e.on("destroy",function(){g.$destroy();g=null}),e.flowControl("ignoreInside",!0))}a.initConfig=function(c){c.setType("asis","bool",R.lib.Config.MODE_STATIC);c.setDefaultValue("runRenderer",!c.get("asis"));c.set("useComments",!0);c.set("passReferences",!0)};return a}());V.registerTag("tag",function(a,c,b,d){b=getAttr(c,"value");a=R.lib.Expression.get(b,a);if(a){for(var e=window.document.createElement(a),g=c.nextSibling,f=c.attributes;c.firstChild;)e.appendChild(c.firstChild);a=0;for(b=f.length;a<b;a++){var h=f[a];"value"!==h.name&&R.dom.setAttr(e,h.name,h.value)}c.parentNode.insertBefore(e,g);c.parentNode.removeChild(c);d&&d.flowControl("nodes",[e])}else c.parentNode.removeChild(c),d&&d.flowControl("stop",!0)});R.dialog=R.dialog||{pointer:{},position:{}};R.dom.setStyle=function(a,c,b){if(a&&a.style){var d=a.style,e;"string"===typeof c?(a={},a[c]=b):a=c;for(e in a)d[e]=a[e]}};R.dom.isVisible=function(a){return a&&!(0>=a.offsetWidth||0>=a.offsetHeight)};R.dom.whenAttached=function(){function a(){var f,h=0,l=[];var n=0;for(f=c.length;n<f;n++)e.contains(c[n])&&(b[n].resolve(),l.push(n));n=0;for(f=l.length;n<f;n++){var m=l[n]-h++;c.splice(m,1);b.splice(m,1)}0===c.length&&(window.MutationObserver?d.disconnect():window.clearInterval(d),d=null)}var c=[],b=[],d,e,g=window.MutationObserver?function(){e=window.document.documentElement;d=new window.MutationObserver(a);d.observe(e,{childList:!0,subtree:!0})}:function(){e=window.document.documentElement;d=window.setInterval(a,
1E3)};return function(f){if(R.dom.isAttached(f))return R.lib.Promise.resolve();!d&&g();var h;-1===(h=c.indexOf(f))&&(c.push(f),b.push(new R.lib.Promise),h=c.length-1);b[h].isCancelled()&&(b[h]=new R.lib.Promise);return b[h]}}();R.dom.getOuterWidth=Na("outer","Width");R.dom.getOuterHeight=Na("outer","Height");R.dom.delegate=function(a,c,b,d){function e(h){h=R.dom.normalizeEvent(h);for(var l=h.target;l;){if(R.dom.is(l,c))return d(h);l=l.parentNode}return null}var g=R.lib.Cache.global().get("dom/delegates",[]),f=c+"-"+b;g[f]||(g[f]=[]);g[f].push({el:a,ls:e,fn:d});R.dom.addListener(a,b,e)};R.dialog.position.Abstract=U({dialog:null,positionBase:null,correct:"solid",$init:function(a){this.dialog=a;D(this,a.getCfg().position,!0,!1);this.onWindowResizeDelegate=this.onWindowResize.bind(this);this.onWindowScrollDelegate=this.onWindowScroll.bind(this);"auto"===this.type&&(this.type=null);var c=this.preferredType||this.type;if("string"===typeof c){var b=this.getAllPositions(),d;-1!==(d=b.indexOf(c))&&(b.splice(d,1),b.unshift(c));this.preferredType=b;!this.type&&(this.type=b[0])}else c||(this.preferredType=
this.getAllPositions()),!this.type&&(this.type=this.preferredType[0]);a.on("reposition",this.onReposition,this);a.on("show-after-delay",this.onShowAfterDelay,this);a.on("hide-after-delay",this.onHideAfterDelay,this);if(a.isVisible())this.onShowAfterDelay()},getPositionBase:function(){if(this.positionBase)return this.positionBase;var a;return(a=this.dialog.getCfg().position.base)?this.positionBase="string"===typeof a?R.dom.select(a).shift():a:null},getBoundary:function(){var a=this.getPositionBase(),
c=this.screenX||0,b=this.screenY||0;if(a){var d=R.dom.getOffset(a);var e=R.dom.getOuterWidth(a);a=R.dom.getOuterHeight(a);return{x:d.left+c,y:d.top+b,x1:d.left+e-c,y1:d.top+a-b,w:e,h:a}}e=R.dom.getWidth(window);a=R.dom.getHeight(window);d=R.dom.getScrollTop(window);var g=R.dom.getScrollLeft(window);return{x:g+c,y:d+b,x1:g+e-c,y1:d+a-b,w:e,h:a}},getPrimaryPosition:function(){return!1},getSecondaryPosition:function(){return!1},getAllPositions:function(){return[]},correctPosition:function(a){var c=this.getPrimaryPosition(),
b=this.correct;if(c&&b){var d=this.dialog;c=this.getBoundary();d=d.getDialogSize();var e=this.preferredType,g=e[0];if(b&&"none"!==b){if(b&&"solid"!=b){if(this.type!=g&&this.checkIfFits(a,g,c,d,!1))return this.changeType(g),this.fitToBoundary(this.getCoords(a),c,d);if(this.checkIfFits(a,this.type,c,d,!1))return this.fitToBoundary(this.getCoords(a),c,d)}if(b&&"position-only"!=b)for(b=0,g=e.length;b<g;b++)if(this.checkIfFits(a,e[b],c,d,!0)){this.changeType(e[b]);break}}return this.getCoords(a)}},checkIfFits:function(a,
c,b,d,e){a=this.getCoords(a,c,!0);if(!e&&this.getSecondaryPosition(c))return!1;if(e)return!(a.x<b.x||a.y<b.y||a.x+d.width>b.x1||a.y+d.height>b.y1);switch(this.getPrimaryPosition(c)){case "t":return a.y>=b.y;case "r":return a.x+d.width<=b.x1;case "b":return a.y+d.height<=b.y1;case "l":return a.x>=b.x}},fitToBoundary:function(a,c,b){var d=this.getPositionBase(),e=d?0:c.x,g=d?0:c.y,f=d?c.w:c.x1;c=d?c.h:c.y1;var h=d=0,l=this.dialog.getPointer();a.x<e&&(d=a.x-e,a.x=e);a.y<g&&(h=a.y-g,a.y=g);a.x+b.width>
f&&(d=a.x+b.width-f,a.x-=d);a.y+b.height>c&&(h=a.y+b.height-c,a.y-=h);l.setCorrectionOffset(d,h);l.reposition();return a},changeType:function(a){var c=this.dialog.getPointer();this.type=a;c.setType(null,null)},onReposition:function(a,c){a.node&&R.dom.isAttached(a.node)&&(a=!1!==this.screenX||!1!==this.screenY?this.correctPosition(c):this.getCoords(c),this.apply(a))},getCoords:function(){return{x:0,y:0}},apply:function(a){if(a&&!isNaN(a.x)&&!isNaN(a.y)){var c=this.dialog,b=c.getCfg().position.axis,
d={};"y"!=b&&(d.left=a.x+"px");"x"!=b&&(d.top=a.y+"px");R.dom.setStyle(c.getElem(),d)}},onWindowResize:function(a){this.dialog.reposition(R.dom.normalizeEvent(a))},onWindowScroll:function(a){this.dialog.reposition(R.dom.normalizeEvent(a))},onShowAfterDelay:function(){(this.resize||this.screenX||this.screenY)&&R.dom.addListener(window,"resize",this.onWindowResizeDelegate);(this.scroll||this.screenX||this.screenY)&&R.dom.addListener(this.dialog.getScrollEl(this.scroll),"scroll",this.onWindowScrollDelegate)},
onHideAfterDelay:function(){(this.resize||this.screenX||this.screenY)&&R.dom.removeListener(window,"resize",this.onWindowResizeDelegate);(this.scroll||this.screenX||this.screenY)&&R.dom.removeListener(this.dialog.getScrollEl(this.scroll),"scroll",this.onWindowScrollDelegate)},onDestroy:function(){var a=this.dialog;R.dom.removeListener(window,"resize",this.onWindowResizeDelegate);R.dom.removeListener(a.getScrollEl(this.scroll),"scroll",this.onWindowScrollDelegate);a.un("reposition",this.onReposition,
this);a.un("show-after-delay",this.onShowAfterDelay,this);a.un("hide-after-delay",this.onHideAfterDelay,this);if(a.isVisible())this.onHideAfterDelay()}});R.dialog.position.Target=R.dialog.position.Abstract.$extend({getCoords:function(a,c,b){var d=this.dialog,e=d.getCfg(),g=d.getTarget();if(!g)return null;c=c||this.type;var f=this.getPositionBase();a=d.getDialogSize();b=f&&!b?R.dom.getPosition(g,f):R.dom.getOffset(g);g=d.getTargetSize();f={};var h=c.substr(0,1),l=c.substr(1),n=e.position.offsetX;e=e.position.offsetY;c=d.pointer.getDialogPositionOffset(c);switch(h){case "t":f.y=b.top-a.height-e;break;case "r":f.x=b.left+g.width+n;break;case "b":f.y=
b.top+g.height+e;break;case "l":f.x=b.left-a.width-n}switch(l){case "t":f.y=b.top+e;break;case "r":f.x=b.left+g.width-a.width-n;break;case "b":f.y=b.top+g.height-a.height-e;break;case "l":f.x=b.left+n;break;case "rc":f.x=b.left+g.width+n;break;case "lc":f.x=b.left-a.width-n;break;case "":switch(h){case "t":case "b":f.x=b.left+g.width/2-a.width/2;break;case "r":case "l":f.y=b.top+g.height/2-a.height/2}}c&&(f.x+=c.x,f.y+=c.y);return f},getPrimaryPosition:function(a){return(a||this.type||"").substr(0,
1)},getSecondaryPosition:function(a){return(a||this.type||"").substr(1)},getAllPositions:function(){return"t r b l tl tr rt rb br bl lb lt tlc trc brc blc".split(" ")}});R.dialog.position.Mouse=R.dialog.position.Target.$extend({correct:"position",$init:function(a){this.onMouseMoveDelegate=this.onMouseMove.bind(this);this.$super(a)},getCoords:function(a,c,b){if(!a)return null;var d=c||this.type,e=this.dialog,g=e.getCfg(),f=e.getDialogSize(),h=this.getPositionBase(),l={};c=(c||this.type).substr(1);var n=g.position.offsetX,m=g.position.offsetY;g=g.position.axis;d=e.getPointer().getDialogPositionOffset(d);var p=0,r=0;!b&&h&&(h=R.dom.getOffset(h),p=h.left,r=h.top);switch(c){case "":l=
this.get.call(e.$$callbackContext,e,a,c,b);break;case "c":l.y=a.pageY-r-f.height/2;l.x=a.pageX-p-f.width/2;break;case "t":l.y=a.pageY-r-f.height-m;l.x=a.pageX-p-f.width/2;break;case "r":l.y=a.pageY-r-f.height/2;l.x=a.pageX-p+n;break;case "b":l.y=a.pageY-r+m;l.x=a.pageX-p-f.width/2;break;case "l":l.y=a.pageY-r-f.height/2;l.x=a.pageX-p-f.width-n;break;case "rt":l.y=a.pageY-r-f.height-m;l.x=a.pageX-p+n;break;case "rb":l.y=a.pageY-r+m;l.x=a.pageX-p+n;break;case "lt":l.y=a.pageY-r-f.height-m;l.x=a.pageX-
p-f.width-n;break;case "lb":l.y=a.pageY-r+m,l.x=a.pageX-p-f.width-n}d&&(l.x+=d.x,l.y+=d.y);g&&(a=this.$super(a,c))&&("x"==g?l.y=a.y:l.x=a.x);return l},onShowAfterDelay:function(){this.$super();R.dom.addListener(window.document.documentElement,"mousemove",this.onMouseMoveDelegate)},onHideAfterDelay:function(){this.$super();R.dom.removeListener(window.document.documentElement,"mousemove",this.onMouseMoveDelegate)},onMouseMove:function(a){this.dialog.reposition(R.dom.normalizeEvent(a))},getPrimaryPosition:function(a){return(a||
this.type).substr(1,1)},getSecondaryPosition:function(a){return(a||this.type).substr(2)},getAllPositions:function(){return"mt mr mb ml mrt mrb mlb mlt".split(" ")}});R.dialog.position.Window=R.dialog.position.Abstract.$extend({getCoords:function(a,c){var b=this.dialog;a=this.getPositionBase()||window;b=b.getDialogSize();var d={};c=(c||this.type).substr(1);var e=this.offsetX,g=this.offsetY,f=R.dom.getScrollTop(a),h=R.dom.getScrollLeft(a),l=R.dom.getOuterWidth(a);a=R.dom.getOuterHeight(a);switch(c){case "c":d.y=a/2-b.height/2+f+g;d.x=l/2-b.width/2+h+e;break;case "t":d.y=f+g;d.x=l/2-b.width/2+h+e;break;case "r":d.y=a/2-b.height/2+f-g;d.x=l-b.width+h-e;break;case "b":d.y=
a-b.height+f-g;d.x=l/2-b.width/2+h+e;break;case "l":d.y=a/2-b.height/2+f+g;d.x=h+e;break;case "rt":d.y=f+g;d.x=l-b.width+h-e;break;case "rb":d.y=a-b.height+f-g;d.x=l-b.width+h-e;break;case "lt":d.y=f+g;d.x=h+e;break;case "lb":d.y=a-b.height+f-g,d.x=h+e}return d},getPrimaryPosition:function(a){return(a||this.type).substr(1,1)},getSecondaryPosition:function(a){return(a||this.type).substr(2)},getAllPositions:function(){return"wt wr wb wl wrt wrb wlb wlt wc".split(" ")},correctPosition:function(a){return this.getCoords(a)}});R.dialog.position.Custom=R.dialog.position.Abstract.$extend({getCoords:function(a){var c=this.dialog;return this.get.call(c.$$callbackContext||this,c,a)}});R.dialog.position.None=R.dialog.position.Abstract.$extend({$init:function(a){this.$super(a);R.dom.removeStyle(a.getElem(),"left");R.dom.removeStyle(a.getElem(),"top")},getCoords:function(){var a=R.dom.getOffset(this.dialog.getElem());return{x:a.left,y:a.top}},apply:function(){},correctPosition:function(a){return this.getCoords(a)}});R.dialog.position.Draggable=R.dialog.position.Abstract.$extend({getCoords:function(a){var c=this.dialog;if(this.get)return this.get.call(c.$$callbackContext,c,a);if(!R.dom.isVisible(c.getElem())){var b=c.getElem();a=b.style.left;b=b.style.top;if(a&&b)return{x:parseInt(a),y:parseInt(b)}}c=R.dom.getOffset(c.getElem());return{x:c.left,y:c.top}},correctPosition:function(a){var c=this.dialog,b=this.getBoundary();c=c.getDialogSize();return this.checkIfFits(a,this.type,b,c,!0)?this.getCoords(a):this.fitToBoundary(this.getCoords(a),
b,c)}});R.dialog.pointer.Abstract=U({enabled:null,node:null,correctX:0,correctY:0,$init:function(a,c){D(this,c,!0,!1);this.origCfg=c;this.dialog=a;this.opposite={t:"b",r:"l",b:"t",l:"r"};this.names={t:"top",r:"right",b:"bottom",l:"left"};this.sides={t:["l","r"],r:["t","b"],b:["r","l"],l:["b","t"]};this.enabled=!1!==this.enabled&&c.size?!0:!1},enable:function(){this.enabled||(this.enabled=!0,this.render(),this.dialog.isVisible()&&this.dialog.reposition())},disable:function(){this.enabled&&(this.remove(),this.enabled=
!1,this.dialog.isVisible()&&this.dialog.reposition())},getElem:function(){return this.node},getSize:function(){return this.enabled?this.size:0},setCorrectionOffset:function(a,c){this.correctX=a;this.correctY=c},getCorrectionValue:function(a,c,b){if(!c)return 0;var d=b.substr(0,1);b=b.substr(1,1);var e=this.dialog.getDialogSize(),g=this.width,f="t"==d||"b"==d?"width":"height";switch(b){case "":var h=e[f]/2-g/2;var l=-h;break;case "l":l=0;h=e[f]-g/2;break;case "r":l=-(e[f]-g/2),h=0}c=0>c?Math.max(l,
c):Math.min(h,c);return("t"==d||"b"==d)&&"x"==a||("l"==d||"r"==d)&&"y"==a?c:0},getDialogPositionOffset:function(a){var c=(this.detectPointerPosition(a)||"").substr(0,1);a=this.dialog.getPosition().getPrimaryPosition(a);var b={x:0,y:0};if(!this.enabled)return b;c==this.opposite[a]&&(b["t"==c||"b"==c?"y":"x"]="b"==c||"r"==c?-this.size:this.size);return b},detectPointerPosition:function(a){if(this.position&&!a)return isFunction(this.position)?this.position.call(this.dialog.$$callbackContext,this.dialog,
this.origCfg):this.position;var c=this.dialog.getPosition().getPrimaryPosition(a)||"";var b=(a=this.dialog.getPosition().getSecondaryPosition(a)||"")?a.substr(1,1):null;if(!c)return null;c=this.opposite[c]||"";a&&(a=a.substr(0,1),c="c"===b?c+this.opposite[a]:c+a);return c},detectPointerDirection:function(a){return this.direction?isFunction(this.direction)?this.direction.call(this.dialog.$$callbackContext,this.dialog,a,this.origCfg):this.direction:a},update:function(){this.remove();this.render();this.append();
this.dialog.isVisible()&&this.dialog.reposition()},setType:function(a,c){this.position=a;this.direction=c;this.update();this.reposition()},render:function(){},onDestroy:function(){this.remove()},reposition:function(){},append:function(){if(this.enabled&&(this.node||this.render(),this.node)){this.reposition();var a=this.dialog.getElem();a&&a.appendChild(this.node)}},remove:function(){var a=this.node;a&&(a.parentNode&&a.parentNode.removeChild(a),this.node=null)}});R.dialog.pointer.Html=function(){var a=null,c={backgroundColor:"transparent",width:"0px",height:"0px",position:"absolute",fontSize:"0px",lineHeight:"0px"};return R.dialog.pointer.Abstract.$extend({node:null,sub:null,$init:function(b,d){null===a&&(a=window.document.all&&!window.XMLHttpRequest);this.$super(b,d);this.width=this.width||2*this.size;this.inner&&(this.enabled=!0)},createInner:function(){var b=extend({},this.origCfg);b.size=this.size-2*this.border;b.width=this.width-4*this.border;b.border=
0;b.borderColor=null;b.borderCls=null;b.offset=0;b.inner=this.border;this.sub=new R.dialog.pointer.Html(this.dialog,b)},getBorders:function(b,d,e){var g={},f=b.substr(0,1);b=d.substr(0,1);var h=d.substr(1);d=a?"dotted":"solid";var l=this.names,n=this.sides,m=this.opposite;g["border"+Qa(l[m[f]])]=this.size+"px solid "+e;g["border"+Qa(l[f])]="0 "+d+" transparent";h?(g["border"+Qa(l[h])]="0 solid transparent",g["border"+Qa(l[m[h]])]=this.width+"px "+d+" transparent"):(e=Math.floor(this.width/2),g["border"+
Qa(l[n[b][0]])]=e+"px "+d+" transparent",g["border"+Qa(l[n[b][1]])]=e+"px "+d+" transparent");return g},getOffsets:function(b,d){var e={},g=this.names,f=this.opposite,h=b.substr(0,1),l="t"==h||"b"==h?"r":"b";e[g[h]]=this.inner?"auto":-this.size+"px";e[g[l]]="auto";if(this.inner)b=d.substr(0,1),d=d.substr(1),e[g[f[l]]]=d?"l"==d||"t"==d?this.inner+"px":-this.width-this.inner+"px":Math.floor(-this.width/2)+"px",e[g[f[b]]]=-(this.size+2*this.inner)+"px";else{switch(b){case "t":case "r":case "b":case "l":d=
d!=b?"l"==d||"t"==d?this.offset:-this.width+this.offset:-this.width/2+this.offset;break;case "bl":case "tl":case "lt":case "rt":d=this.offset;break;default:d=-this.width-this.offset}e["margin"+Qa(g[f[l]])]=d+"px";switch(b){case "t":case "r":case "b":case "l":d="50%";break;case "tr":case "rb":case "br":case "lb":d="100%";break;default:d=0}e[g[f[l]]]=d;g=R.animate.getPrefixes().transform;f="";l=this.correctX;d=this.correctY;g&&(l&&(f+=" translateX("+this.getCorrectionValue("x",l,b)+"px)"),d&&(f+=" translateY("+
this.getCorrectionValue("y",d,b)+"px)"),e[g]=f)}return e},render:function(){if(this.enabled&&!this.node&&this.detectPointerPosition()){this.border&&!this.sub&&this.createInner();this.node=window.document.createElement("div");var b=window.document.createComment(" ");this.node.appendChild(b);R.dom.setStyle(this.node,c);R.dom.addClass(this.node,this.borderCls||this.cls);this.sub&&(this.sub.render(),this.node.appendChild(this.sub.getElem()))}},reposition:function(){var b=this.detectPointerPosition(),
d=this.detectPointerDirection(b);this.node&&(R.dom.setStyle(this.node,this.getBorders(b,d,this.borderColor||this.color)),R.dom.setStyle(this.node,this.getOffsets(b,d)),this.sub&&this.sub.reposition())},update:function(){this.sub&&(this.sub.$destroy(),this.sub=null);this.remove();this.node=null;this.render();this.append();this.dialog.isVisible()&&this.dialog.reposition()},onDestroy:function(){this.sub&&(this.sub.$destroy(),this.sub=null);this.$super()},remove:function(){this.sub&&this.sub.remove();
this.$super()}})}();R.dialog.Overlay=U({dialog:null,enabled:!1,color:"#000",opacity:.5,cls:null,animateShow:!1,animateHide:!1,$mixins:[R.mixin.Observable],$init:function(a){this.dialog=a;this.onClickDelegate=this.onClick.bind(this);D(this,a.getCfg().overlay,!0,!1);this.$$observable.createEvent("click",!1);this.enabled&&(this.enabled=!1,this.enable())},getElem:function(){this.enabled&&!this.node&&this.render();return this.node},enable:function(){this.enabled||(this.enabled=!0)},disable:function(){this.enabled&&(this.remove(),
this.enabled=!1)},show:function(a){this.enabled&&(this.animateShow?this.animate("show",a):this.node.style.display="block")},hide:function(a){this.node&&(this.animateHide?this.animate("hide",a):this.node.style.display="none")},render:function(){if(this.enabled){var a=window.document.createElement("div"),c=this.dialog.getCfg(),b={display:"none",position:"fixed",left:0,top:0,right:0,bottom:0};!1!==this.opacity&&(b.opacity=this.opacity);!1!==this.color&&(b.backgroundColor=this.color);R.dom.setStyle(a,
b);R.dom.addListener(a,"click",this.onClickDelegate);c.render.zIndex&&R.dom.setStyle(a,"zIndex",c.render.zIndex);this.cls&&R.dom.addClass(a,this.cls);this.node=a}},remove:function(){var a=this.node;a&&raf(function(){a.parentNode&&a.parentNode.removeChild(a)})},append:function(){var a=this.dialog.getCfg().render.appendTo||window.document.body;this.enabled&&!this.$destroyed&&(this.node||this.render(),a.appendChild(this.node))},animate:function(a,c){var b=this.node;var d="show"==a?this.animateShow:this.animateHide;
G(d)&&(d=d(this,c));fa(d)?d=a:I(d)&&(d=[d]);return R.animate.animate(b,d,function(){if("show"==a)return new R.lib.Promise(function(e){raf(function(){b.style.display="";e()})})},!1)},onClick:function(a){return!1===this.trigger("click",this.dialog,this,a)?null:this.modal?(a=R.dom.normalizeEvent(a),a.preventDefault(),a.stopPropagation(),!1):null},onDestroy:function(){this.remove()}});R.dialog.Manager=U({all:null,groups:null,$init:function(){this.all={};this.groups={}},register:function(a){var c=a.getInstanceId(),b=a.getGroup(),d=this.groups,e;this.all[c]=a;var g=0;for(e=b.length;g<e;g++){var f=b[g];d[f]||(d[f]={});d[f][c]=!0}a.on("destroy",this.unregister,this)},unregister:function(a){a=a.getInstanceId();delete this.all[a]},hideAll:function(a){var c=a.getInstanceId();a=a.getGroup();var b=this.all,d=this.groups,e,g;var f=0;for(e=a.length;f<e;f++){var h=a[f];h=d[h];for(g in h)b[g]?
g==c||b[g].isHideAllIgnored()||b[g].hide(null,!0,!0):delete h[g]}}});R.dialog.Dialog=function(){function a(f){if(!f)return{};c(f,"content","value","string");c(f,"content","value","boolean");c(f,"content","fn","function");c(f,"ajax","url","string");c(f,"cls","dialog","string");c(f,"render","tpl","string");c(f,"render","fn","function");c(f,"render","el","dom");c(f,"render","el","jquery");c(f,"show","events",!1);c(f,"show","events","string");c(f,"hide","events",!1);c(f,"hide","events","string");c(f,"toggle","events",!1);c(f,"toggle","events","string");c(f,"position",
"type","string");c(f,"position","type",!1);c(f,"position","get","function");c(f,"overlay","enabled","boolean");c(f,"pointer","position","string");c(f,"pointer","size","number");return f}function c(f,h,l,n){var m=f[h],p=!1;if(void 0!==m){switch(n){case "string":p=I(m);break;case "function":p=G(m);break;case "number":p=1===ca(m)||m==parseInt(m);break;case "dom":p=m&&(m.tagName||m.nodeName)?!0:!1;break;case "jquery":(p=m&&m.jquery?!0:!1)&&(m=m.get(0));break;case "boolean":if(!0===m||!1===m)p=!0;break;
default:!0===n&&!0===m&&(p=!0),!1===n&&!1===m&&(p=!0)}p&&(f[h]={},f[h][l]=m)}}function b(f,h,l,n){if("show"===l||!n)return h.preventDefault(),h.stopPropagation(),!1}var d=new R.dialog.Manager,e={target:null,group:null,modal:!1,useHref:!1,content:{value:"",fn:null,prepare:null,attr:null},ajax:{url:null,data:null,dataType:"text",method:"GET"},cls:{dialog:null,visible:null,hidden:null,loading:null},selector:{content:null},buttons:null,render:{tpl:"<div></div>",fn:null,el:null,zIndex:null,lazy:!0,style:null,
appendTo:null,id:null,keepVisible:!1,keepInDOM:!1,lifetime:null},events:{show:{"*":{preventDefault:!1,stopPropagation:!1,returnValue:null,process:b}},hide:{"*":{preventDefault:!1,stopPropagation:!1,returnValue:null,process:b}}},show:{delay:null,single:!1,events:null,animate:!1,ignoreHideAll:!1,focus:!1,preventScroll:!1,display:"block"},hide:{delay:null,timeout:null,events:null,destroy:!1,remove:!1,animate:!1,cancelShowDelay:!0},toggle:{events:null},position:{type:"t",preferredType:null,offsetX:0,
offsetY:0,axis:null,get:null,screenX:!1,screenY:!1,base:null,scroll:!1,resize:!0},pointer:{position:null,direction:null,size:0,width:null,color:null,offset:0,border:0,borderColor:null,el:null,cls:null,borderCls:null},overlay:{enabled:!1,color:"#000",opacity:.5,cls:null,animateShow:!1,animateHide:!1},callback:{context:null,"content-change":null,"before-show":null,show:null,"before-hide":null,hide:null,render:null,lifetime:null,"target-change":null,button:null}},g=U({$mixins:[R.mixin.Observable],id:null,
node:null,overlay:null,pointer:null,cfg:null,position:null,target:null,dynamicTarget:!1,dynamicTargetEl:null,visible:!1,enabled:!0,frozen:!1,rendered:!1,bindSelfOnRender:!1,hideTimeout:null,hideDelay:null,showDelay:null,destroyDelay:null,images:0,positionGetType:null,positionClass:null,positionAttempt:0,$constructor:function(){this.$$events={"before-show":{returnResult:!1},"before-hide":{returnResult:!1}};this.$super.apply(this,arguments)},$init:function(f){f=f||{};var h=f.preset;f.preset=null;this.cfg=
f=D({},e,a(g.defaults),a(g[h]),a(f),!0,!0);this.id=E();this.onPreventScrollDelegate=this.onPreventScroll.bind(this);this.onButtonClickDelegate=this.onButtonClick.bind(this);this.onButtonKeyupDelegate=this.onButtonKeyup.bind(this);this.showDelegate=this.show.bind(this);this.hideDelegate=this.hide.bind(this);this.toggleDelegate=this.toggle.bind(this);this.onImageLoadDelegate=this.onImageLoad.bind(this);d.register(this);f.modal&&(f.overlay.enabled=!0);this.overlay=new R.dialog.Overlay(this);h=Qa(f.pointer.$class||
"Html");this.pointer=U.factory("MetaphorJs.dialog.pointer."+h,this,f.pointer);G(f.position.type)&&(this.positionGetType=f.position.type);this.setTarget(f.target);f.target&&f.useHref&&(h=R.dom.getAttr(this.getTarget(),"href"),"#"===h.substr(0,1)?f.render.el=h:f.ajax.url=h);f.render.lazy||this.render();this.trigger("init",this);this.setHandlers("bind")},getElem:function(){return this.node},getInstanceId:function(){return this.id},getCfg:function(){return this.cfg},getPointer:function(){return this.pointer},
getOverlay:function(){return this.overlay},isEnabled:function(){return this.enabled},isVisible:function(){return this.visible},isHideAllIgnored:function(){return this.cfg.show.ignoreHideAll},isFrozen:function(){return this.frozen},isRendered:function(){return this.rendered},enable:function(){this.enabled=!0},disable:function(){this.hide();this.enabled=!1},freeze:function(){this.frozen=!0},unfreeze:function(){this.frozen=!1},getGroup:function(){var f=this.cfg;return f.group?I(f.group)?[f.group]:f.group:
[""]},toggle:function(f,h){return f&&f.stopPropagation&&this.dynamicTarget&&this.visible&&this.isDynamicTargetChanged(f)?this.show(f):this[this.visible?"hide":"show"](f,h)},resetHandlers:function(f,h){this.setHandlers("unbind");this.bindSelfOnRender=!1;f&&f.call(h,this,this.getCfg());this.setHandlers("bind")},setHandlers:function(f,h){var l=this.cfg,n=["show","hide","toggle"],m="bind"===f?R.dom.addListener:R.dom.removeListener;f="bind"===f?R.dom.delegate:R.dom.undelegate;for(var p,r,q,t,u,y,w,v,x,
A;p=n.shift();)if(r=l[p].events,!1!==r){if(I(r)||H(r))this.dynamicTarget?(u={},u[r]=l.target,r={_html:u}):r={_target:r};for(q in r){if(h)if("_self"===h){if("_self"!==q&&"_overlay"!==q&&">"!==q.substr(0,1))continue}else if(q!==h)continue;if("_self"!==q&&"_overlay"!==q&&">"!==q.substr(0,1)||this.node){if(w=r[q]){switch(q){case "_target":v=[this.getTarget()];break;case "_self":v=[this.node];break;case "_window":v=[window];break;case "_document":v=[window.document];break;case "_html":v=[window.document.documentElement];
break;case "_overlay":v=[this.overlay.getElem()];break;default:v=">"===q.substr(0,1)?R.dom.select(q.substr(1),this.node):R.dom.select(q)}if(v&&v.length)if(I(w)&&(w=[w]),H(w))for(u=0,y=w.length;u<y;u++)for(x=-1,A=v.length;++x<A;m(v[x],w[u],this[p+"Delegate"]));else for(t in w)for(x=-1,A=v.length;++x<A;f(v[x],w[t],t,this[p+"Delegate"]));}}else this.bindSelfOnRender=!0}}},onPreventScroll:function(f){R.dom.normalizeEvent(f).preventDefault()},onButtonClick:function(f){var h=R.dom.normalizeEvent(f).target;
(h=R.dom.data(h,"metaphorjsTooltip-button-id"))&&this.trigger("button",this,h,f)},onButtonKeyup:function(f){if(13===f.keyCode||32===f.keyCode){var h=R.dom.data(f.target,"metaphorjsTooltip-button-id");h&&this.trigger("button",this,h,R.dom.normalizeEvent(f))}},getEventConfig:function(f,h){var l=this.node;for(var n=f.type,m=f.target,p=null,r;m&&m!==l;){if(r=R.dom.getAttr(m,"data-"+h+"-"+n)){p=R.lib.Expression.parse(r)({});break}m=m.parentNode}l=p;n=this.cfg;!l&&n.events[h]&&(l=n.events[h][f.type]||n.events[h]["*"]);
return l},show:function(f,h){var l=this.cfg,n=null,m=l.show,p=null;f&&(f=R.dom.normalizeEvent(f));this.isEnabled()||(p="disabled");!p&&this.visible&&this.hideTimeout&&(window.clearTimeout(this.hideTimeout),this.hideTimeout=F(this.hide,this,null,l.hide.timeout),p="hidetimeout");!p&&this.hideDelay&&(window.clearTimeout(this.hideDelay),this.hideDelay=null,this.visible=!0,p="hidedelay");!p&&this.frozen&&(p="frozen");this.destroyDelay&&(window.clearTimeout(this.destroyDelay),this.destroyDelay=null);l=
!1;f&&this.dynamicTarget&&(l=this.changeDynamicTarget(f));this.visible&&(l?(this.reposition(f),p="reposition"):p=p||"visible");if(!p||l)this.node?l&&this.changeDynamicContent():this.render();p||!1!==this.trigger("before-show",this,f)||(p="beforeshow");var r;f&&(r=this.getEventConfig(f,"show"))&&(r.process?n=r.process(this,f,"show",p):(r.stopPropagation&&f.stopPropagation(),r.preventDefault&&f.preventDefault(),n=r.returnValue));if(p)return n;R.animate.stop(this.node);this.visible=!0;m.single&&d.hideAll(this);
this.toggleTitleAttribute(!1);m.delay&&!h?this.showDelay=F(this.showAfterDelay,this,[f],m.delay):this.showAfterDelay(f,h);return n},showAfterDelay:function(f,h){var l=this,n=l.cfg;l.showDelay=null;if(l.visible){l.trigger("show-after-delay",l,f);n.hide.remove&&l.appendElem();l.reposition(f);if(n.show.preventScroll){var m=n.show.preventScroll,p;!0===m&&(m="body");m=R.dom.select(m);var r=-1;for(p=m.length;++r<p;R.dom.addListener(m[r],"mousewheel",l.onPreventScrollDelegate)&&R.dom.addListener(m[r],"touchmove",
l.onPreventScrollDelegate));}l.overlay.show();n.show.animate&&!h?l.animate("show").done(function(){l.showAfterAnimation(f)}):X(function(){l.showAfterAnimation(f)})}},showAfterAnimation:function(f){var h=this.cfg,l=this.node;this.visible&&(R.dom.removeClass(l,h.cls.hidden),R.dom.addClass(l,h.cls.visible),h.render.keepVisible||(l.style.display=h.show.display||"block"),h.hide.timeout&&(this.hideTimeout=F(this.hide,this,null,h.hide.timeout)),h.show.focus&&F(this.setFocus,this,null,20),this.trigger("show",
this,f))},hide:function(f,h,l){var n=null,m=null,p=this.cfg;this.hideTimeout=null;!this.visible&&this.hideDelay&&h&&(window.clearTimeout(this.hideDelay),this.hideDelay=null,this.visible=!0);this.node&&this.visible&&this.isEnabled()||(m=this.node?this.visible?"disabled":"hidden":"noelem");this.showDelay&&!m&&(p.hide.cancelShowDelay||l?(window.clearTimeout(this.showDelay),this.showDelay=null,this.visible=!1,m="cancel"):m="delay");this.frozen&&!m&&(m="frozen");m||!1!==this.trigger("before-hide",this,
f)||(m="beforehide");var r;f&&f.stopPropagation&&(r=this.getEventConfig(f,"hide"))&&(r.process?n=r.process(this,f,"hide",m):(r.stopPropagation&&f.stopPropagation(),r.preventDefault&&f.preventDefault(),n=r.returnValue));if(m)return n;R.animate.stop(this.node);this.visible=!1;this.dynamicTarget&&this.resetDynamicTarget();p.hide.delay&&!h?this.hideDelay=F(this.hideAfterDelay,this,[f],p.hide.delay):this.hideAfterDelay(f,h);return n},hideAfterDelay:function(f,h){var l=this,n=l.cfg;l.hideDelay=null;if(!l.visible){l.trigger("hide-after-delay",
l,f);if(n.show.preventScroll){var m=n.show.preventScroll,p;!0===m&&(m="body");m=R.dom.select(m);var r=-1;for(p=m.length;++r<p;R.dom.removeListener(m[r],"mousewheel",l.onPreventScrollDelegate)&&R.dom.removeListener(m[r],"touchmove",l.onPreventScrollDelegate));}l.overlay.hide();n.hide.animate&&!h?l.animate("hide").done(function(){l.hideAfterAnimation(f)}):X(function(){l.hideAfterAnimation(f)})}},hideAfterAnimation:function(f){var h=this,l=h.cfg,n=h.node;h.visible||(R.dom.removeClass(n,l.cls.visible),
R.dom.addClass(n,l.cls.hidden),l.render.keepVisible||(n.style.display="none"),h.trigger("hide",h,f),f=l.render.lifetime,null!==f&&(0===f?h.destroyElem():h.destroyDelay=F(h.destroyElem,h,null,f)),n&&l.hide.destroy?X(function(){R.dom.data(n,l.instanceName,null);h.$destroy()}):n&&l.hide.remove&&X(function(){h.removeElem()}))},render:function(){var f=this.cfg;if(!this.node){var h=f.render,l=f.cls;if(h.fn){var n=h.fn.call(this.$$callbackContext,this);h[I(n)?"tpl":"el"]=n}h.el?I(h.el)?(n=R.dom.select(h.el).shift(),
h.keepInDOM=!0):n=h.el:(n=window.document.createElement("div"),n.innerHTML=h.tpl,n=n.firstChild);n||(n=window.document.createElement("div"));this.node=n;h.id&&R.dom.setAttr(n,"id",h.id);f.render.keepVisible||(n.style.display="none");R.dom.addClass(n,l.dialog);R.dom.addClass(n,l.hidden);h.style&&R.dom.setStyle(n,h.style);this.overlay.render();f.hide.remove?n.parentNode&&n.parentNode.removeChild(n):this.appendElem();h.zIndex&&R.dom.setStyle(n,{zIndex:h.zIndex});h=f.content;if(!1!==h.value)if(h.value)this.setContent(h.value);
else if(h.fn)this.setContent(h.fn.call(this.$$callbackContext,this));else this[f.ajax.url?"loadContent":"readContent"]();this.pointer.render();this.pointer.append();if(f.buttons)for(var m in f.buttons)if(h=R.dom.select(f.buttons[m],n).shift())R.dom.data(h,"metaphorjsTooltip-button-id",m),R.dom.addListener(h,"click",this.onButtonClickDelegate),R.dom.addListener(h,"keyup",this.onButtonKeyupDelegate);this.bindSelfOnRender&&(this.setHandlers("bind","_self"),this.bindSelfOnRender=!1);this.rendered=!0;
this.trigger("render",this)}},setPositionType:function(f){var h=this.getPositionClass(f);this.cfg.position.type=f;this.positionClass===h&&this.position?this.position.type=f:(this.position&&(this.position.$destroy(),this.position=null),h&&(this.position=U.factory(h,this)));this.isVisible()&&this.reposition()},getPosition:function(f){var h=this.cfg.position;if(!this.position){!this.positionGetType&&"custom"!==h.type&&G(h.get)&&"m"!==h.type&&(h.type="custom");f=this.positionGetType?this.positionGetType.call(this.$$callbackContext,
this,f):h.type;var l=this.getPositionClass(f);h.type=f;if(!1===l)return;this.positionClass!==l?this.position=U.factory(l,this):this.position.type=f}return this.position},getPositionClass:function(f){return f?G(f)||"custom"===f?"MetaphorJs.dialog.position.Custom":"draggable"===f?"MetaphorJs.dialog.position.Draggable":"none"===f?"MetaphorJs.dialog.position.None":(f=f.substr(0,1))?"w"===f?"MetaphorJs.dialog.position.Window":"m"===f?"MetaphorJs.dialog.position.Mouse":"MetaphorJs.dialog.position.Target":
!1:!1},reposition:function(f){var h=this;h.repositioning||(h.node&&!R.dom.isAttached(h.node)?R.dom.whenAttached(h.node).done(function(){h.reposition(f)}):(h.repositioning=!0,f&&(f=R.dom.normalizeEvent(f)),h.getPosition(f),h.trigger("before-reposition",h,f),h.getPosition(f),h.trigger("reposition",h,f),h.repositioning=!1))},getTarget:function(){return this.dynamicTarget?this.dynamicTargetEl:this.target},setTarget:function(f){if(f){var h=!1,l=this.target;this.target?(this.setHandlers("unbind","_target"),
h=!0):this.dynamicTarget&&(h=!0);var n=I(f);n&&"#"!==f.substr(0,1)?(this.dynamicTarget=!0,this.target=null):(n&&(f=R.dom.select(f).shift()),this.dynamicTarget=!1,this.target=f);h&&(this.setHandlers("bind","_target"),this.trigger("target-change",this,f,l))}},resetDynamicTarget:function(){var f=this.dynamicTargetEl;f&&(this.setHandlers("unbind","_target"),this.trigger("target-change",this,null,f))},isDynamicTargetChanged:function(f){var h=this.cfg.target;f=f.target;for(var l=this.dynamicTargetEl;f&&
!R.dom.is(f,h);)f=f.parentNode;return f?!l||l!==f:!1},changeDynamicTarget:function(f){var h=this.cfg.target;f=f.target;for(var l=this.dynamicTargetEl;f&&!R.dom.is(f,h);)f=f.parentNode;if(!f||l&&l===f)return!1;l&&this.setHandlers("unbind","_target");this.dynamicTargetEl=f;this.setHandlers("bind","_target");this.trigger("target-change",this,f,l);return!0},getContentElem:function(){var f=this.node;return f?this.cfg.selector.content?R.dom.select(this.cfg.selector.content,f).shift()||f:f:null},setContent:function(f,
h){h=h||"";var l=this.node,n=this.cfg,m=this.pointer;if(!l)return n.content.value=f,this;n.content.prepare&&(f=n.content.prepare.call(this.$$callbackContext,this,h,f));var p=this.getContentElem(),r=this.rendered&&!n.selector.content&&m;m=r&&m.getElem();if(r&&m)try{l.removeChild(m)}catch(u){S(u)}if(I(f))p.innerHTML=f;else for(var q in f){var t=n.selector[q];t&&(t=R.dom.select(t,p).shift())&&(t.innerHTML=f[q])}if(r&&m)try{l.appendChild(m)}catch(u){S(u)}l=R.dom.select("img",p);this.images=l.length;q=
-1;for(n=l.length;++q<n;R.dom.addListener(l[q],"load",this.onImageLoadDelegate));this.trigger("content-change",this,f,h);this.onContentChange()},readContent:function(){var f=this.cfg,h=this.getTarget(),l;h&&(l="string"===typeof f.content.attr?R.dom.getAttr(h,f.content.attr):R.dom.getAttr(h,"tooltip")||R.dom.getAttr(h,"title")||R.dom.getAttr(h,"alt"));l&&this.setContent(l,"attribute")},loadContent:function(f){var h=this.cfg;R.dom.addClass(this.node,h.cls.loading);f=D({},h.ajax,f,!0,!0);this.trigger("before-ajax",
this,f);return eb(f).done(this.onAjaxLoad,this)},onAjaxLoad:function(f){R.dom.removeClass(this.node,this.cfg.cls.loading);this.setContent(f,"ajax")},onImageLoad:function(){this.images--;this.onContentChange()},onContentChange:function(){this.visible&&this.reposition()},changeDynamicContent:function(){var f=this.cfg;f.content.fn?this.setContent(f.content.fn.call(this.$$callbackContext,this)):f.content.attr&&this.readContent()},toggleTitleAttribute:function(f){var h=this.getTarget(),l;h&&(!1===f?h.hasAttribute("title")&&
(R.dom.setAttr(h,"tooltip",R.dom.getAttr(h,"title")),R.dom.removeAttr(h,"title")):(l=R.dom.getAttr(h,"tooltip"))&&R.dom.setAttr(h,"title",l))},getDialogSize:function(){this.rendered||this.render();var f=this.cfg,h=this.node,l=f.cls.hidden?R.dom.hasClass(h,f.cls.hidden):!R.dom.isVisible(h),n=h.style.left;l&&(R.dom.setStyle(h,{left:"-1000px"}),h.style.display=f.show.display);f={width:R.dom.getOuterWidth(h),height:R.dom.getOuterHeight(h)};l&&(R.dom.setStyle(h,{left:n}),h.style.display="none");return f},
getTargetSize:function(){var f=this.getTarget();return f?{width:R.dom.getOuterWidth(f),height:R.dom.getOuterHeight(f)}:null},setFocus:function(){var f=this.cfg,h=f.show.focus,l=this.node,n;if(!0===h)if(h=R.dom.select("input",l).concat(R.dom.select("textarea",l)),0<h.length)h[0].focus();else{if(f.buttons)for(n in f.buttons){(f=R.dom.select(f.buttons[n],l).shift())&&f.focus();break}}else(f=R.dom.select(h,l).shift())&&f.focus()},getScrollEl:function(f){return!0===f||!1===f?window:"string"===typeof f?
R.dom.select(f).shift():f},animate:function(f,h){var l=this.cfg,n=this.node;var m=l[f].animate;G(m)&&(m=m(this,h));var p=m.skipDisplayChange||!1;fa(m)?m=f:I(m)&&(m=[m]);return R.animate.animate(n,m,function(){if("show"===f&&!p)return new R.lib.Promise(function(r){X(function(){n.style.display=l.show.display||"block";r()})})},!1)},removeElem:function(){var f=this,h=f.node;f.overlay.remove();h&&h.parentNode&&X(function(){f.visible||h.parentNode.removeChild(h)})},appendElem:function(){var f=this.cfg,
h=window.document.body;h=f.render.appendTo||h;this.overlay.append();this.node&&!1!==f.render.appendTo?(h.appendChild(this.node),this.trigger("attached",this,h)):this.node&&R.dom.isAttached(this.node)&&this.trigger("attached",this,this.node.parentNode)},destroyElem:function(){var f=this.node;this.setHandlers("unbind","_self");this.bindSelfOnRender=!0;this.pointer.remove();this.overlay.remove();f&&(this.cfg.render.keepInDOM||f.parentNode&&f.parentNode.removeChild(f),this.node=null);this.trigger("lifetime",
this)},onDestroy:function(){this.setHandlers("unbind");this.trigger("destroy",this);this.destroyElem();this.overlay&&this.overlay.$destroy();this.pointer&&this.pointer.$destroy();this.position&&this.position.$destroy()}},{defaults:null});return g}();R.mixin.Dialog={dialog:null,dialogPreset:null,dialogCfg:null,_hidden:!0,autoRender:!0,target:null,isTooltip:!1,$beforeInit:function(a){this.autoRender=!0;a&&a.node||this.template||a&&a.template||(this.node=window.document.createElement("div"));this.$intercept("_onRenderingFinished",this._onDialogRenderingFinished,this,"after")},$beforeDestroy:function(){this.dialog&&this.dialog.$destroy()},getDialogCfg:function(){return D({},this.dialogCfg,{preset:this.dialogPreset,render:{el:this.getRefEl("main"),
keepInDOM:!0,appendTo:!1,lazy:!1}},!0,!0)},getDialog:function(){return this.dialog},_onDialogRenderingFinished:function(){var a,c=this.items;if(c){var b=-1;for(a=c.length;++b<a;)this._putItemInPlace(c[b])}this._createDialog()},_createDialog:function(){this.dialog=new R.dialog.Dialog(this.getDialogCfg());this.dialog.on("show",this.onDialogShow,this);this.dialog.on("hide",this.onDialogHide,this);this.dialog.on("before-show",this.onBeforeDialogShow,this);this.dialog.on("before-hide",this.onBeforeDialogHide,
this);this.dialog.on("destroy",this.onDialogDestroy,this);this.dialog.on("attached",this.onDialogAttached,this);this._hidden||this.show()},show:function(a){!a||a instanceof R.lib.DomEvent||(a=null);this.dialog?this.dialog.show(a):this._hidden=!1},hide:function(a){!a||a instanceof R.lib.DomEvent||(a=null);this.dialog?this.dialog.hide(a):this._hidden=!0},onDialogAttached:function(){this._attached||this.render(this.node.parentNode)},onBeforeDialogShow:function(){this._rendered?!this._attached&&this.renderTo&&
this.attach(this.renderTo,this.renderBefore):this.render();this._hidden=!1},onDialogShow:function(){this.trigger("show",this)},onBeforeDialogHide:function(){},onDialogHide:function(){this.$destroyed||(this._hidden=!0,this.trigger("hide",this))},onDialogDestroy:function(){this.$destroying||(this.dialog=null,this.$destroy())}};R.dialog.Component=R.app.Component.$extend({$mixins:[R.mixin.Dialog]});cb.register("Test",{});
U({$class:"Test.MyApp2",$extends:"MetaphorJs.app.App",initApp:function(a,c,b){var d=this,e=0,g=["(level 3 value: {{.b}})","(level 3 value: {{.c}})"];d.scope.resolved=b;d.scope.level1="[ and here comes level 2: {{.level2}} ]";d.scope.level2=g[e];d.scope.b=1;d.scope.c="variable c";d.scope.changeLevel2=function(){e=0==e?1:0;d.scope.level2=g[e]};d.scope.increaseB=function(){d.scope.b++};d.scope.people=0;d.lang.setLocale("ru");d.lang.set("key","text value");d.lang.set("plr",["\u043a\u043e\u0442\u0438\u043a","\u043a\u043e\u0442\u0438\u043a\u0430",
"\u043a\u043e\u0442\u0438\u043a\u043e\u0432"]);d.lang.set("subkey1","subkey: {{'subkey2' | l}}");d.lang.set("subkey2","text value");d.lang.set("viewing",{0:"Nobody is viewing",1:"One person is viewing",2:"Two people are viewing",other:"{{.people}} people are viewing",negative:""})}},{inject:["$node","$scope","someValue"],resolve:{someValue:function(){var a=new R.lib.Promise;setTimeout(function(){a.resolve((new Date).getTime())},100);return a}}});
U({$class:"Test.MyView",$extends:"MetaphorJs.app.view.Router",route:[{template:"test-template.html","default":!0},{regexp:/^\/1$/,cmp:"Test.MyComponent"},{regexp:/^\/2\/(\d+)$/,params:["param"],cmp:"Test.MyComponent2"},{regexp:/^\/2$/,cmp:"Test.MyComponent2"},{regexp:/^\/3$/,template:"a+b.html"}]});U({$class:"Test.MyRecord",$extends:"MetaphorJs.model.Record"});
U({$class:"Test.MyComponent",$extends:"MetaphorJs.app.Component",template:"cmp1-template.html",config:{makeTranscludes:!0},initComponent:function(){this.scope.title="My Component"+(new Date).getTime();var a=new R.model.Model({type:"Test.MyRecord",id:"id",root:"record",total:"total",store:{load:"data.json"}});this.scope.store=new R.model.Store({model:a});this.scope.deferred=this.deferred},afterRender:function(){this.$refs.node.para&&console.log("got child property 'para': ",this.$refs.node.para)},
reverse:function(){this.scope.title=this.scope.title.split("").reverse().join("")},createNew:function(){var a=document.getElementById("newComponent");R.app.resolve("Test.DynamicComponent",{autoRender:!0,scope:this.scope},a)},createRender:function(){var a=document.getElementById("renderToComponent");R.app.resolve("Test.DynamicComponent",{autoRender:!1,scope:this.scope}).done(function(c){c.render(a)})},createDialog:function(){(new R.dialog.Component({id:"small-dialog",dialogCfg:{cls:{dialog:"dialog"},
position:"wc",show:{animate:!0},hide:{destroy:!0}},config:{tag:"div",as:"dlg"},renderTo:window.document.body,scope:this.scope,template:{html:'<p>This is a dialog. <a href="#" (click)="this.dlg.hide()">close</a></p>'}})).show()},loadStore:function(){this.scope.store.load().done(function(){this.scope.$check()},this).fail(function(a){console.log("failed",a)})}},{resolve:{deferred:["$node","$scope","test",function(){return new R.lib.Promise(function(a){setTimeout(function(){a((new Date).getTime())},1E3)})}]}});
U({$class:"Test.MyComponent2",$extends:"MetaphorJs.app.Component",template:"cmp1-template.html",config:{makeTranscludes:!0},initComponent:function(a){a.param&&alert("received param: "+a.param);this.scope.title="My Component2 "+(new Date).getTime()}});
U({$class:"Test.TplComponent",$extends:"MetaphorJs.app.Component",config:{makeTranscludes:!0},initComponent:function(){this.scope.title="Tpl Component";this.scope.tpl="a+b.html";this.scope.$app.onAvailable("myComponent1").done(function(){window.console&&window.console.log&&console.log("on available myComponent1")})}});U({$class:"Test.StringTemplate",$extends:"MetaphorJs.app.Component",config:{makeTranscludes:!0},template:{html:"<p>This template is inlined in components definition ({{this.$root.a}})</p>"}});
U({$class:"Test.DynamicComponent",$extends:"MetaphorJs.app.Component",config:{makeTranscludes:!0},template:{html:"<p>This component was created dynamically</p><div {transclude}></div>"}});U({$class:"Test.ChangeTemplate",$extends:"MetaphorJs.app.Component",config:{makeTranscludes:!0},template:{html:{expression:"this.tpl"}},initComponent:function(){var a=this.scope;a.tpl1="<p>Template 1</p><div {transclude}></div>";a.tpl2="<p>Template 2</p><div {transclude}></div>";a.tpl=a.tpl1}});
U({$class:"Test.ViewComponent1",$extends:"MetaphorJs.app.Component",config:{makeTranscludes:!0},template:{html:"<p>View template 1</p><div {transclude}></div>"}});U({$class:"Test.ViewComponent2",$extends:"MetaphorJs.app.Component",config:{makeTranscludes:!0},template:{html:"<p>View template 2</p><div {transclude}></div>"}});U({$class:"Test.TagComponent",config:{makeTranscludes:!0},$extends:"MetaphorJs.app.Component",$alias:"MetaphorJs.directive.component.tagc",template:"tagc.html"});
R.app.Template.cache.addFinder(function(a){if(a)return R.app.Template.load(a,a)});
R.dom.onReady(function(){var a={linkified:"Linkified text aaa http://www.kuindji.com bbb",newItem:"",date:new Date,num:1E4,list:[{bool:!0,txt:"item 1"},{bool:!1,txt:"item 2"},{bool:!1,txt:"item 3"}]},c=(new Date).getTime(),b=document.getElementById("render");b&&(R.app.init(b,null,a,!1).done(function(d){d.value("test","123");d.run();window.mainApp=d;window.MetaphorJs=R}),a=(new Date).getTime(),window.console&&console.log("render time: ",a-c))});window.MetaphorJs=R;}).call(this || window, (window.__wpcc = window.__wpcc || {}));
